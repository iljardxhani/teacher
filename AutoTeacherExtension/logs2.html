<body ng-app="teacherApp" class="body_status_5">
<!-- hidden audio player -->
<audio id="texbook_player" preload="auto">
	<source type="audio/mp3" src="data:audio/mp3;base64,...">
</audio>
<input type="hidden" id="gTimeZoneChat" value="Asia/Tokyo">
<input type="hidden" id="gmt" value="+09.0">

<div class="page_wrap page_wrap--index cf ng-scope" ng-controller="Home">
	<style>
    .ss-con-2 {
        display: flex;
        flex-direction: column;
        padding: 50px;
        justify-content: center;
        width: 100%;
    }

    #screen_masking {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        backdrop-filter: blur(10px);
        background-color: rgb(0 0 0 / 70%);
        z-index: 100000;
        align-items: center;
        justify-content: center;
        color: white;
        text-align: center;
    }
</style>
<div id="screen_masking">
    <div style="z-index: 31;">
        <h1>Currently Screen Sharing</h1>
        <button class="btn_stop_screen_share" style="width: 250px; margin-top: 1rem;">Stop sharing</button>
    </div>
</div>	<div class="page_inner">
		<div id="newNoticeBar" style="display:none">
			
	<link rel="stylesheet" type="text/css" href="/teacher/css/waiting.css">
<div class="ribbon waiting">
    <div class="status-prompt">
        <span class="timer-svg">
            <svg xmlns="http://www.w3.org/2000/svg" width="29.333" height="35.715" viewBox="0 0 29.333 35.715">
                <g id="timer" transform="translate(-45.745)">
                    <path id="path_1" data-name="path 1" d="M240.044,193.377a.419.419,0,0,0-.569.013l-6.574,5.662a1.784,1.784,0,1,0,1.468,1.468l5.662-6.574A.419.419,0,0,0,240.044,193.377Z" transform="translate(-172.171 -179.789)" fill="currentColor"></path>
                    <path id="path_2" data-name="path 2" d="M73.925,100.447a14.724,14.724,0,1,0,1.153,5.709A14.713,14.713,0,0,0,73.925,100.447ZM60.412,117.335a11.12,11.12,0,1,1,3.325-.5A11.126,11.126,0,0,1,60.412,117.335Z" transform="translate(0 -85.108)" fill="currentColor"></path>
                    <rect id="rect_5" data-name="rect 5" width="4.202" height="5.431" transform="translate(58.311)" fill="currentColor"></rect>
                    <path id="path_3" data-name="path 3" d="M388.728,79.694l-2.187-1.835-2.3,2.736,2.186,1.834Z" transform="translate(-314.888 -72.428)" fill="currentColor"></path>
                    <rect id="rect_6" data-name="rect 6" width="1.104" height="2.576" transform="translate(59.86 11.54)" fill="currentColor"></rect>
                    <rect id="rect_7" data-name="rect 7" width="1.104" height="2.577" transform="translate(59.86 27.981)" fill="currentColor"></rect>
                    <path id="path_4" data-name="path 4" d="M154.016,200.542l1.822,1.822.781-.781-1.822-1.822Z" transform="translate(-100.718 -185.826)" fill="currentColor"></path>
                    <path id="path_5" data-name="path 5" d="M323.274,368.238l-1.822-1.822-.781.781,1.822,1.822Z" transform="translate(-255.748 -340.856)" fill="currentColor"></path>
                    <rect id="rect_8" data-name="rect 8" width="2.576" height="1.104" transform="translate(50.903 20.497)" fill="currentColor"></rect>
                    <path id="path_6" data-name="path 6" d="M355.374,294.936h2.576v-1.1h-2.577Z" transform="translate(-288.03 -273.335)" fill="currentColor"></path>
                    <path id="path_7" data-name="path 7" d="M154.016,368.238l.781.781,1.822-1.822-.781-.781Z" transform="translate(-100.718 -340.856)" fill="currentColor"></path>
                </g>
            </svg>
        </span>
        <p class="fs_14 fw_b">
            Please change the status from “NOT STANDBY” to “STANDBY FOR RESERVATION”.
        </p>
        <div class="avatar-room avatar-path" data-duration="300000">
            <span class="tiny-avatar walk"></span>
        </div>
    </div>
</div>

<script type="text/javascript" async="">
    (() => {
        const avatar_path = document.querySelector('.avatar-path')
        if (!avatar_path) return console.error('Could not find avatar path')

        const waiting_time = avatar_path?.dataset?.duration
        if (!waiting_time) return console.error('Avatar waiting suration is not set')

        /**
         * @param selector {String}
         * @param duration {number}
         * @param x_pos {[start {number}, end {number}]}
         * @return {void}
         */
        const avatarWalk = (selector, duration, x_pos = [95, 0]) => {
            const avatar = document.querySelector(selector)
            if (!avatar) return console.error('Could not find avatar figure')

            let avatar_timeout, avatar_waiting_timeout
            clearTimeout(avatar_waiting_timeout)
            clearTimeout(avatar_timeout)

            avatar.classList.remove('walk')
            avatar.classList.remove('stopped')

            document.documentElement.style.setProperty('--waiting-duration', `${duration}ms`)
            document.documentElement.style.setProperty('--avatar-x-start', `${x_pos[0]}%`)
            document.documentElement.style.setProperty('--avatar-x-end', `${x_pos[1]}%`)

            avatar_timeout = setTimeout(() => {
                avatar.classList.add('walk')
                clearTimeout(avatar_timeout)
            }, 1)

            avatar_waiting_timeout = setTimeout(() => {
                avatar.classList.add('stopped')
                avatar.classList.remove('walk')
                clearTimeout(avatar_waiting_timeout)
            }, duration)

        }

        // testing avatar transition
        const test_walk = document.querySelector('.timer-svg')
        test_walk.addEventListener('click', () => avatarWalk('.tiny-avatar', waiting_time))
    })()
</script>		</div>
		<div class="chat_frame">
			<div class="chat_frame_row chat_frame_row--top" id="chat_frame_row--top">
				<div class="pane_wrap pane_wrap--top" id="pane_wrap--top">
					<div class="pane pane--top_center" id="pane--top_center">
						<div class="notice_bar_area" id="notice_bar_area"></div>
						<div class="chat_loading_area header-area no-print" id="chat_loading_area">
							
	<link rel="stylesheet" type="text/css" href="/teacher/css/waiting.css">
<div class="nc-t-header-wrap fixed" id="nc-t-header-wrap" style="width: calc(-150px + 100vw); left: 150px;">
	<div class="nc-t-header ng-scope" ng-controller="onlineTeachers">
		<!-- NC-6624 -->
		<a id="btnReportStudent" class="btn btn_report reset_report_student_input" style="margin-left: 5px;" href="javascript:void(0)" ng-click="reportProblem()">Report a problem</a>
		<!-- NJ-16456 -->
		<div class="area-next-lesson">
			<!-- ngIf: next_lesson_reservations.length -->
		    <div class="lesson-tab-container">
				<!-- ngRepeat: next_lesson_reservation in next_lesson_reservations -->
			</div>

		</div>
		<!-- NJ-48259 -->
					<div id="screenShareBtnContainer" class="hide">
				
			</div>
				<!-- NJ-48259 -->
		<div class="area-timer">
			<span class="header-live-viewer-count hide" id="header-live-viewer-count">
				<div class="text-area">
					<span>LIVE Viewer : </span>
					<span id="header-live-viewer-count-num" style="margin-left: 5px;">0</span>
				</div>
			</span>
												<p class="t-center cnt_time">
						<small class="img_c hide chocotto-icon"><img src="/teacher/images/chat/icon-chocotto-camp-s.svg" alt="chocotto camp"></small>
						<span class="clock-inner" id="cnt_time" remmins="08" remsecs="00">08:00</span></p>
										<div class="progress-bar-2">
				<div class="progress-bar-2-inner" id="nc-t-header-timer-progress" style="width: 49.3333%;"></div>
			</div>
		</div>
		<div class="area-status">
					<div class="right_area">
				<div class="status_menu_wrap cf" ng-init="sa='status_area'">
					<div class="status_area" id="status_area">
						
						<!-- NJ-1452 disable status_select buttons -->
													<span class="status status--inclass changeable" id="status">ON GOING LESSON</span>
							<ul class="status_select hide" id="status_select">
								<li id="status_online" ng-hide="">
									<a href="javascript:void(0)" ng-click="setStatus($event, 'standby')" class="disable">
										<span class="status status--online">STANDBY</span>
									</a>
								</li>
								<li id="status_offline" ng-hide="1" class="ng-hide">
									<a href="javascript:void(0)" ng-click="setStatus($event, 'notstandby')" class="disable">
										<span class="status status--offline">NOT STANDBY</span>
									</a>
								</li>
							</ul>
											</div>	
				</div>
			</div>
			
			<!-- // .right_area -->
			<div class="status_guide guide hide">
				<div class="guide_inner">
					<div class="d_flex">
						<p>Let’s change the status to</p>
						<img src="/teacher/recruits/images/common/standby.png">
					</div>
				</div>
			</div>
		</div>
		<div class="area-date">
			
				<div class="time-box japan" id="server-time_container">
					<input type="hidden" name="server-time-12" id="server-time-12" value="9:39:PM">
					<p class="date" id="server-time">Sep 01,2025</p>
					<div class="flag"><img src="./webroot/images/flag/japan.png" alt="Japan"></div><span id="japan_time" class="time">9:39 PM</span>
				</div>
				<div class="time-box local m_l_10" id="local-time_container">
					<input type="hidden" name="local-time-12" id="local-time-12" value="2:39:PM">
					<p class="date" id="local-time">Sep 01,2025</p>
					<div class="flag"><img src="/user/images/flag/albania.png" alt="Japan"></div><span id="local_time" class="time">2:39 PM</span>
				</div>
			<!-- <div class="notification-wrap func-notification-toggle m-l-30" data-target="#notificationListWrap">
				<a href="javascript:void(0);" class="notification-bell-btn trigger-notification on" id="triggerNotification">
				</a>
				<div class="notification-list-wrap" id="notificationListWrap">
					<div class="list-header">
						<h3>Notifications</h3>
						<a href="./notification-settings.html" class="t-link">Notifications Settings</a>
					</div>
					<ul class="notification-list">
						<li class="notification unread">
							<div class="img-wrap">
								<div class="img-inner">
									<img src="./webroot/images/icon/mail.svg" alt="mail">
								</div>
							</div>
							<div class="text-wrap">
								<p class="txt-main">You have <span class="fw-b">1 message</span> that you haven't sent to your student. Please follow the link.</p>
								<p class="txt-time">4 min ago</p>
							</div>
							<div class="sub-menu-wrap">
								<a href="javascript:void(0);" class="btn-sub-menu sub-menu-trigger">
								</a>
								<div class="sub-menu hide">
									<ul>
										<li><a href="javascript:void(0);" class="menu-mark-read">Mark as Read</a></li>
										<li><a href="javascript:void(0);" class="menu-remove-notification">Remove this notification</a></li>
									</ul>
								</div>
							</div>
						</li>
						<li class="notification">
							<div class="img-wrap">
								<div class="img-inner">
									<img src="./webroot/images/icon/help-circle.svg" alt="help">
								</div>
							</div>
							<div class="text-wrap">
								<p class="txt-main">Your have a response on Inquiry. Please follow the link.</p>
								<p class="txt-time">6 min ago</p>
							</div>
							<div class="sub-menu-wrap">
								<a href="javascript:void(0);" class="btn-sub-menu sub-menu-trigger">
								</a>
								<div class="sub-menu hide">
									<ul>
										<li><a href="javascript:void(0);" class="menu-remove-notification">Remove this notification</a></li>
									</ul>
								</div>
							</div>
						</li>
						<li class="notification">
							<div class="img-wrap">
								<div class="img-inner">
									<img src="./webroot/images/icon/noun_graduation.svg" alt="graduation">
								</div>
							</div>
							<div class="text-wrap">
								<p class="txt-main">Student reserved your lesson. Please follow the link.</p>
								<p class="txt-time">12 min ago</p>
							</div>
							<div class="sub-menu-wrap">
								<a href="javascript:void(0);" class="btn-sub-menu sub-menu-trigger">
								</a>
								<div class="sub-menu hide">
									<ul>
										<li><a href="javascript:void(0);" class="menu-remove-notification">Remove this notification</a></li>
									</ul>
								</div>
							</div>
						</li>
						<li class="notification unread">
							<div class="img-wrap">
								<div class="img-inner">
									<img src="./webroot/images/icon/noun_graduation.svg" alt="graduation">
								</div>
							</div>
							<div class="text-wrap">
								<p class="txt-main">Your Student Block Request has been approved. Please follow the link.</p>
								<p class="txt-time">22 min ago</p>
							</div>
							<div class="sub-menu-wrap">
								<a href="javascript:void(0);" class="btn-sub-menu sub-menu-trigger">
								</a>
								<div class="sub-menu hide">
									<ul>
										<li><a href="javascript:void(0);" class="menu-mark-read">Mark as Read</a></li>
										<li><a href="javascript:void(0);" class="menu-remove-notification">Remove this notification</a></li>
									</ul>
								</div>
							</div>
						</li>
						<li class="notification">
							<div class="img-wrap">
								<div class="img-inner inner-red">
									<img src="./webroot/images/icon/noun_payment.svg" alt="payment">
								</div>
							</div>
							<div class="text-wrap">
								<p class="txt-main">Please input your bank details until Dec 15 2019. Please follow the link.</p>
								<p class="txt-time">day ago</p>
							</div>
							<div class="sub-menu-wrap">
								<a href="javascript:void(0);" class="btn-sub-menu sub-menu-trigger">
								</a>
								<div class="sub-menu hide">
									<ul>
										<li><a href="javascript:void(0);" class="menu-remove-notification">Remove this notification</a></li>
									</ul>
								</div>
							</div>
						</li>
						<li class="notification">
							<div class="img-wrap">
								<div class="img-inner">
									<img src="./webroot/images/icon/balloon-star.svg" alt="help">
								</div>
							</div>
							<div class="text-wrap">
								<p class="txt-main">Your have 1 lesson review to read. Please follow the link.</p>
								<p class="txt-time">day ago</p>
							</div>
							<div class="sub-menu-wrap">
								<a href="javascript:void(0);" class="btn-sub-menu sub-menu-trigger">
								</a>
								<div class="sub-menu hide">
									<ul>
										<li><a href="javascript:void(0);" class="menu-remove-notification">Remove this notification</a></li>
									</ul>
								</div>
							</div>
						</li>
					</ul>
					<div class="list-footer">
						<a href="./notifications.html" class="btn-see-all">See All</a>
					</div>
				</div>
			</div> -->
		</div>
		<div class="area-account">
						<div class="user-info-wrap">
				<a href="https://nativecamp.net/waiting/detail/449595" class="img-inner" target="_blank">
					<img src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2024_12_14_142456675d16a84af47.png" alt="Voiled">
					<!-- <img src="./webroot/images/sample/thumb.png" alt="Voiled"> -->
				</a>
				<div class="info-inner">
					<div class="info-top">
						<a href="https://nativecamp.net/waiting/detail/449595" class="username no-ic" target="_blank">Voiled</a>
						<div class="user-menu-wrap func-user-menu-toggle" data-target="#userMenuWrap">
							<a href="javascript:void(0);" class="trigger-translation" id="triggerTranslation">
								<img src="./webroot/images/icon/chevron-down.svg" alt="chevron down">
							</a>
							<div class="user-menu-list-wrap" id="userMenuWrap">
								<a class="btn-sign-out" href="javascript:void(0)" ng-click="checkUnSentNote()">Sign Out</a>
							</div>
						</div>
					</div>
					<div class="info-id">
												<a class="id-num no-ic" target="_blank">ID: 449595</a>
											</div>
				</div>
			</div>
		</div>
	</div>
	<canvas id="drawCanvas" style="display:none;" height="480" width="640"></canvas>
	<canvas id="drawCanvasStudent" style="display:none;" height="480" width="640"></canvas>
</div><!-- // .nc-t-header-wrap -->

<!-- report student modals -->
<!-- 1/3 report student input modal -->
<a class="hide" id="trigger_report_student" rel="modal" href="#modal_report_student"></a>
<div class="modal_window dialog modal_report_student hide" id="modal_report_student">
	<div class="modal-report-inner">
		<p class="modal-title">Report a problem</p>
		<div class="modal-desc">
			<p>Please provide details of issue for this student.</p>
		</div>
		<ul class="report-input-area">
			<li class="report-category">
				<p class="input-label">Report Category <span class="c_red">*</span></p>
				<div class="report-category-select">
					<select id="report_st_select_cat">
						<option value="" disabled="" selected="">This field is required</option>
																					<option value="1">Shared account by multiple users</option>
															<option value="2">Multiple accounts by one user</option>
															<option value="3">Sexual harassment</option>
																		</select>
				</div>
			</li>
			<li class="report-reason ui-count_form increment">
				<p class="input-label">Report Details <span class="c_red">*</span></p>
				<div class="report-alert alert-input-length m_t_10 m_b_10">
					<p class="c_red">Please enter at least 10 characters</p>
				</div>
				<div class="report-reason-textarea">
					<textarea class="ui-count_input" maxlength="500" id="report_st_textarea_reason" rows="7" cols="60" placeholder="Please write a comment."></textarea>
				</div>
				<div><p class="t_right"><span class="ui-count_length-current">0</span> / 500</p></div>
			</li>
		</ul>
		<div class="modal-btn">
			<ul class="modal-btn-list">
				<li><a class="btn_style btn_gray close_modal">Cancel</a></li>
				<li><a class="btn_style btn_red btn_go_to_confirm sync_report_student_confirm click_delay disabled" href="javascript:void(0)">Send</a></li>
			</ul>
		</div>
	</div>
	<div class="btn_close"></div>
</div>

<!-- 2/3 report student confirm modal -->
<a class="hide" id="trigger_report_student_confirm" rel="modal" href="#modal_report_student_confirm"></a>
<div class="modal_window dialog modal_report_student hide" id="modal_report_student_confirm">
	<div class="modal-report-inner">
		<p class="modal-title">Are you sure?</p>
		<div class="modal-desc">
			<p>Do you want to report this student?</p>
		</div>
		<ul class="report-input-area">
			<li class="report-category">
				<p class="input-label">Report Category</p>
				<div class="report-category-select-confirm">
					<p id="report_st_select_cat_confirm"></p>
				</div>
			</li>
			<li class="report-reason">
				<p class="input-label">Report Details</p>
				<div class="report-reason-textarea-confirm" style="overflow-y: auto; max-height: 250px;">
					<p id="report_st_textarea_reason_confirm"></p>
				</div>
			</li>
		</ul>
		<div class="modal-btn">
			<ul class="modal-btn-list">
				<li><a class="btn_style btn_gray check_report_student_input click_delay close_modal" href="#trigger_report_student">Edit</a></li>
				<li><a class="btn_style btn_red click_delay close_modal" href="javascript:void(0)" ng-click="sendScreenshot()">Yes</a></li>
			</ul>
		</div>
	</div>
	<div class="btn_close"></div>
</div>

<!-- 3/3 report student success modal -->
<a class="hide" id="trigger_report_student_success" rel="modal" href="#modal_report_student_success"></a>
<div class="modal_window dialog modal_report_student modal_report_student_success hide" id="modal_report_student_success">
	<div class="modal-report-inner">
		<p class="modal-title">You reported a problem.</p>
		<div class="modal-btn">
			<ul class="modal-btn-list j-center">
				<li><a class="btn_style btn_gray close_modal">Close</a></li>
			</ul>
		</div>
	</div>
</div>

<!-- face recog media error -->
<a rel="modal" href="#teacher_face_recog_no_camera" id="trigger_teacher_face_recog_no_camera"></a>
<div class="modal_window dialog hide static_overlay" id="teacher_face_recog_no_camera">
	<h3><u>Media Error</u></h3>
	<p class="t_center">Please ensure that a camera and microphone are connected to your workstation. If this problem persists, please seek an administrator's assistance to resolve this issue.</p>
	<div class="btn_wrap btn_center cf">
		<ul>
			<li><a class="btn_style btn_orange" onclick="closeProtection = false; close_window('/teacher/home?action=teacherRefresh');" href="javascript:void(0);">REFRESH</a></li>
		</ul>
	</div>
	<div class="btn_close hidden"></div>
</div>
<!-- end of face recog media error -->

<!-- media error -->
<a rel="modal" href="#media_teacher_no_camera" id="trigger_media_teacher_no_camera"></a>
<div class="modal_window dialog hide static_overlay" id="media_teacher_no_camera">
	<h3><u>Media Error</u></h3>
	<p class="t_center">Please ensure that a camera and microphone are connected to your workstation. If this problem persists, please seek an administrator's assistance to resolve this issue.</p>
	<div class="btn_wrap btn_center cf">
		<ul>
			<li><a class="btn_style btn_orange" onclick="closeProtection = false; close_window('/teacher/chat?action=teacherRefresh');" href="javascript:void(0);">REFRESH</a></li>
		</ul>
	</div>
	<div class="btn_close hidden"></div>
</div>
<!-- end of media error -->

<!-- socket error -->
<a rel="modal" href="#socket_teacher_error" id="trigger_socket_teacher_error"></a>
<div class="modal_window dialog hide static_overlay" id="socket_teacher_error">
	<h3><u>Socket Error</u></h3>
	<p class="t_center">You were unable to connect to the socket server. Please seek an administrator's assistance to resolve this issue.</p>
	<div class="btn_wrap btn_center cf">
		<ul>
			<li><a class="btn_style btn_orange" onclick="closeProtection = false; close_window('/teacher/chat?action=teacherRefresh');" href="javascript:void(0);">REFRESH</a></li>
		</ul>
	</div>
	<div class="btn_close hidden"></div>
</div>
<!-- end of socket error -->

<!-- standby error -->
<a rel="modal" href="#standby_teacher_error" id="trigger_standby_teacher_error"></a>
<div class="modal_window dialog hide static_overlay" id="standby_teacher_error">
	<h3><u>Network Error</u></h3>
	<p class="t_center">You were unable to complete the "standby" process. Please click "REFRESH" in order to try again.</p>
	<div class="btn_wrap btn_center cf">
		<ul>
			<li><a class="btn_style btn_orange" onclick="closeProtection = false; close_window('/teacher/chat?action=teacherRefresh');" href="javascript:void(0);">REFRESH</a></li>
		</ul>
	</div>
	<div class="btn_close hidden"></div>
</div>
<!-- end of standby error -->

<script type="text/javascript">
	//report student script
	var scope1 = $('#modal_report_student');
	var alert_length = $('.alert-input-length', scope1);
	var next_btn = $('.btn_go_to_confirm');
	var report_select = $('#report_st_select_cat', scope1);
	var report_input = $('#report_st_textarea_reason', scope1);

	//report confirm modal
	var scope2 = $('#modal_report_student_confirm');
	var report_cat_confirm = $('#report_st_select_cat_confirm', scope2);
	var report_detail_confirm = $('#report_st_textarea_reason_confirm', scope2);

	scope1.on('keyup change', function(){
		check_report_student_input();
	});

	function check_report_student_input() {
		var value1 = report_select.val().trim();
		var value2 = report_input.val().trim();

		//alert
		if(value2.length >= 10) {
			alert_length.hide();
		} else {
			alert_length.show();
		}

		//disable/enable btn
		if (value1 != '' && value2.length >= 10) {
			next_btn.removeClass('disabled');
		} else {
			next_btn.addClass('disabled');
		}

		if(value2 != '') {
			$('.ui-count_length-current', scope1).html(value2.length);
		} else {
			$('.ui-count_length-current', scope1).html('0');
		}
	}

	function reset_report_student_input() {
		report_select.val('');
		report_input.val('');
		$('.ui-count_length-current', scope1).html('0');
		check_report_student_input();
	}

	$(document).on('click', '.check_report_student_input', function(){
		check_report_student_input();
	});

	$(document).on('click', '.reset_report_student_input', function(){
		reset_report_student_input();
	});

	//confirm functions
	function sync_report_student_confirm() {
		var value1 = report_select.val().trim();
		var value2 = report_input.val().trim();

		if (value1 != '' && value2.length >= 10) {
			$('.btn_close').click();
			setTimeout(function(){
				$('a#trigger_report_student_confirm').click();
			}, 500);
		}

		var text1 = $('#report_st_select_cat option:selected', scope1).text();
		var text2 = report_input.val();
		text2 = text2.replace(/\n/g, '<br>');

		report_cat_confirm.html(text1);
		report_detail_confirm.html(text2);
	}

	$(document).on('click', '.sync_report_student_confirm', function(){
		sync_report_student_confirm();
	});
</script>
<!-- report student modals END -->

<script type="text/javascript" src="/user/js/webrtcv2/constant.js?v=2.16.352"></script>

<!-- load important tools -->
<script type="text/javascript" src="/user/js/webrtcv2/adapter.js?v=20250901213701"></script>
<script type="text/javascript" src="/teacher/js/socket.debug.js?v=20250901213701"></script>
<script type="text/javascript" src="/user/js/webrtcv2/event.common.js?v=20250901213701"></script>
<script type="text/javascript" src="/user/js/webrtcv2/connect.js?v=20250901213701"></script>
<!-- end of load important tools -->

<script type="text/javascript">
	var $btn_screenshare_el = $('#btnShareScreen').detach();
	var eikenId = JSON.parse("[85,86,102,103]");
	var teacherId = 449595;
	var nowRemarks = '';
	var nowRemarks2 = '';
	var nowStatus = '5';
	var countDrafts = '';
	var teacherLessonStatus = '0';
	var broadcastMemberType = 'teacher';
	var prevBreakTimeLeft = 0;
	var breaktimeNotification = 0;
	//NC-3513
	var suddenLessonFlag = 1;
	var hasImpendingLesson = 1;
	//NC-3869 
	var hasOpenedSlot = 0;
	// initialize breaktime values
	var btAcq = '';
	var btUsed = '';
	var btRem = Number(btAcq) - Number(btUsed);
	var breakTime = '';
	var breaktimeExcess = false;
	var finalCountDownBreakTime = '';
	var breaktimeDate = '';
	var breaktimeAcquired = '';
	var chatHash = "449595-1756730221-c91329";
	var stealthFlag = "0";
	// close protection in class
	var closeProtection = true;
	var threeMinOtherBreak = parseInt('0');
	var broadcastAdminEnvironment = "PRODUCTION";
	var broadcastAdminTeacherIpAddress = "193.163.187.65";
	var customer_support_flg = '0';

	
	var broadcasterData = {};
	
	// initialize teacher workstation
	var workstationId = "";
	var workstationName = "";
	
	// get my current URL
	var myCurrentURL = "https://nativecamp.net";
	
	// broadcast checker
	var sentBroadcastCommand = false;

	//homebase teacher
	var homeBase = true;
	
	// for audio set
	var playing = false; 

	// NJ-10786
	var applySuddenLesson = 0;
	var forceLogoutStatus = 0;

	$(document).keydown(function(e) {
		// Disables Backspace keys
		if (e.keyCode === 8) {
			var tag = e.target.nodeName.toLowerCase();
			var $target = $(e.target);
			if ((tag !== 'input' && tag !== 'textarea' && !$target.attr('contenteditable')) || $target.attr('readonly') || $target.is(':disabled')) {
				return false;
			}
		// Disables F5 keys
		}else if(e.keyCode == 116){
			return false;
		}
		return true;
	});


	// show status change select
			$(document).on('mouseenter', '#status_area', function(e){
			if($(this).hasClass('disable')){
				e.preventDefault();
				return;
			}
			if($('#status', this).hasClass('changeable')){
				$('#status_select').height('auto').stop().slideDown(200);
			}
		});
		// hide status change select
		$(document).on('mouseleave', '#status_area', function(){
			$('#status_select').slideUp(200);
		});
		
	
	$(document).ready(function(){
		// run check session handler
		if (
			typeof reviveSession !== 'undefined' &&
			$.isFunction(reviveSession)
		) { reviveSession(); }
		
		// finish status change
		finishStatusChange();
	});
	
	/**
	 * finishStatusChange
	 * -> this function will clear the memcached
	 */
	var finishStatusError = 0;
	function finishStatusChange(){
		// send student disconnection logic
		$.ajax({
			url: '/teacher/api/finishStatusChange?teacherId=' + teacherId,
			type: 'post',
			timeout: 30000,
			data: {teacherId: teacherId},
			success: function(data){},
			error: function(){
				finishStatusError++;
				console.warn("FINISH_STATUS_CHANGE: error count -> " + finishStatusError);
				connect.enqueueThread({
					key: 'finish_status_change',
					threadType: 'timeout',
					threadTimeout: 5000,
					threadProcess: function(){ finishStatusChange(); }
				});
			}
		});
	}
	
	// revive session objects
	var reviveSessionObject = {};
	
	/**
	 * reviveSession
	 * -> this will revive any session death thay may occur 
	 * during the system's operational phase
	 */
	function reviveSession(){
		reviveSessionObject.isCheckingSession = false;
		
		// revive immediately
		reviveSessionHTTP();
		
		// set interval for session revival
		reviveSessionObject.sessionTimerChecker = setInterval(function(){ reviveSessionHTTP(); }, 20000);
	}
	
	/**
	 * reviveSession
	 * -> this will revive any session death thay may occur 
	 * during the system's operational phase
	 */
	function reviveSessionHTTP(callback){
		// check if still checking session
		if (reviveSessionObject.isCheckingSession === true) { return console.warn("[REVIVE_SESSION] still checking session"); }
		
		// set checker to true
		reviveSessionObject.isCheckingSession = true;
		
		// run AJAX call for checking
		$.ajax({
			type: 'GET',
			url: '/teacher/api/reviveSessionChecker',
			data: {
				teacherID: teacherId,
				workstationID: workstationId,
				workstationName: workstationName,
				status: nowStatus,
				remarks: nowRemarks,
				remarks2: nowRemarks2
			},
			success: function(successData){
				try {
					successData = JSON.parse(successData);
					
					// check if content or error is undefined
					if (
						typeof successData.content === 'undefined' || 
						typeof successData.error === 'undefined'
					) { return console.warn("[REVIVE_SESSION] invalid returns"); }

					// check if 1 hour not standby logged out
					if (successData.content == "1hour_not_standby_logout") {
						clearInterval(reviveSessionObject.sessionTimerChecker);
						angular.element($("body[ng-app='teacherApp']")).scope().intervalServices.stop();

						if(angular.element($("body[ng-app='teacherApp']")).scope().intervalServices2 != false){
							angular.element($("body[ng-app='teacherApp']")).scope().intervalServices2.stop();
						}

						$('#trigger_dialog_1hour_notstandby_teacher_disconnection').click();
					}

					// check if teacher logged out
					if (successData.content == "teacher_logged_out") {
						// If browser is still ongoing lesson but lesson is already ended and deleted due to cron_inactive
						if (successData.is_during_lesson == 0 && (typeof hasOngoingLesson !== 'undefined' && hasOngoingLesson)) {
							// stop recording 
							eventCommon.stopSkywayRecording('teacher_logged_out');

							// Show refresh modal
							$('#trigger_modal_disconnection_occured').click();
							
							// Refresh after 5 seconds to update teacher status
							setTimeout(function(){ location.href = '/teacher/home?action=teacherRefresh'; }, 5000);
						}
						return console.warn("[REVIVE_SESSION] unable to recover session -> last teacher status is 'loggedout'");
					}

					// - if admin forcefully logged out the teacher!
					if (successData.content == "admin_force_teacher_logged_out" || forceLogoutStatus == 1) {
						// - provide mockdata to trigger force disconnection
						var data = {
						    'content' : {
						    	'data': {
						    		'fromIP': "0.0.0.0", // this is okay
						    		"fromURL": myCurrentURL, // this is okay
						    		"fromAdminID": 0, // 0 is okay
						    		"teacherId": teacherId
						    	}
						    }
						}
						
						// - trigger force teacher logged out
						angular.element($("[ng-controller='onlineTeachers']")).scope().forceTeacherLogout(data);

						// - stop interval
						clearInterval(reviveSessionObject.sessionTimerChecker);
						angular.element($("body[ng-app='teacherApp']")).scope().intervalServices.stop();

						if(angular.element($("body[ng-app='teacherApp']")).scope().intervalServices2 != false){
							angular.element($("body[ng-app='teacherApp']")).scope().intervalServices2.stop();
						}

						if (successData.is_during_lesson == 1 || (typeof hasOngoingLesson !== 'undefined' && hasOngoingLesson) && forceLogoutStatus == 1) {

							window.isForceLoggedOut = true;

							var finishType = (connect.config.lessonType == 1) ? 1 : 5;
							var redirectionURL = '/teacher/logout?action=clean';

							$.ajax({
								url: '/teacher/Home/chatClearNormalLesson',
								type: 'POST',
								data: { finishType: finishType, chatHash: chatHash, openLesson: false },
								success: function() {
									$.ajax({
										url: '/teacher/logout',
										type: 'GET',
										async: false,
										data: { forceLogoutFlg: 1 },
									});

									$('#dialog_lesson_completed .lesson_completed_btn, #dialog_lesson_completed .btn_close')
										.attr('data-reload-url', redirectionURL)
										.off('click')
										.on('click', function() {
											window.location.href = '/teacher/login';
										});

									eventCommon.sendCommand({
										command: 'lessonDisconnect',
										content: {
											chatHash: connect.config.chatHash,
											memberType: connect.config.memberType
										}
									});

									$('#dialog_lesson_completed').addClass('static_overlay');
									$('#trigger_modal_lesson_completed').click();
								}
							});
							
							return console.warn("[REVIVE_SESSION] admin forcefully logged out the teacher!");
						} else {
							$.ajax({
								url: '/teacher/logout',
								type: 'get',
								async: true,
								complete: function() {
									window.location.href = '/teacher?action=clean';
								}
							});
						}
						
						// - debug warn
						return console.warn("[REVIVE_SESSION] admin forcefully logged out the teacher!");
					}
					
					// check if session was successfully recovered
					if (
						successData.content == "session_recovered"
					) {
						// log's format that will be sent to the server
						var logs = {
							logs: {info:"Session was recovered for -> " + teacherId, code:"SESSR"}, 
							detail: typeof connect !== 'undefined' ? connect.config : '',
							remarks: ''
						};
						
						// save to general logs
						$.ajax({ type : "POST", url : "/user/WebrtcLogs/save_general_log", data : {logs: JSON.stringify(logs)} });
						
						// log
						return console.warn("[REVIVE_SESSION] session was successfully recovered"); 
					}
				} catch (e) { console.warn(e); }
			},
			
			// on AJAX process completion, return isCheckingSession to false
			complete: function(cData){ 
				reviveSessionObject.isCheckingSession = false;  

				// trigger callback function
				if (typeof callback !== 'undefined' && $.isFunction(callback)) {
					callback();
				}
			}
		});
	}

	var mediaCheck = false;
	async function getCurrentCameraStream() {
		var checkCurrentCamera, cameraListing, checkIfExist;
		try {
			cameraListing = await $.ajax({
				url : "/teacher/Api/virtualCameraAllow",
				type: 'POST'
			});

			// Request access to the user's media devices (cameras and microphones)
			const stream = await navigator.mediaDevices.getUserMedia({ video: true });
			const cameraCheck = stream.getVideoTracks()[0].label;

			checkIfExist = cameraListing.includes(cameraCheck) && (avatarFlg && !testFlg) ? true: false;
			if(!checkIfExist){
				setTimeout(() => {
					if (!$('.modal_window.dialog').is(':visible')) {
						$('#trigger_enable_face_recognition').click();
					}
				}, 500);
			}

			return checkIfExist;
		} catch (error) {
			return null;
		}
	}
	
	/**
	 * beforeUnloadHandler
	 * -> catch before unload handler
	 */
	function beforeUnloadHandler(){
		// disable duplicate redirection
		eventCommon.preventTwice("close_window_for_redirection");
		
		// reset peer
		try {
			connect.emergencyStop = true;
			connect.resetPeer();
		} catch (e) { }
	}
	
	/**
	 * close window
	 * -> this function will handle all closing of windows
	 */
	function close_window(linkClose){
		// Prevent redirect if forced logout is active
		if (window.isForceLoggedOut) {
      		return console.warn("[close_window] Skipped due to forced logout.");
    	}
		// disable duplicate redirection
		if (!eventCommon.preventTwice("close_window_for_redirection")) { return console.warn("[close_window] disabling duplicate window close."); }
		
		// try stopping the internal services before redirecting page
		try {
			angularApp.scope().intervalServices.stop();

			if(angularApp.scope().intervalServices2 != false){
				angularApp.scope().intervalServices2.stop();
			}

		} catch (e) {
			
		} finally { 
			window.location.href = linkClose; 
		}
	}

	function getAnnouncement(event){
		angular.element(document.getElementById('modal_overlay')).scope().getAnnouncement();
	}

	function getAnnouncementRead(){
		angular.element(document.getElementById('modal_overlay')).scope().getAnnouncementRead();
	}
	
	/* func_user_menu_toggle */
	$(document).on('click', function(e){
		if(!$(e.target).closest('.func-user-menu-toggle').length){
			$('.user-menu-list-wrap').fadeOut(200);			
		}else{
			if($('.user-menu-list-wrap').css('display')=='block'){
				if(!$(e.target).closest('.user-menu-list-wrap').length){
					$('.user-menu-list-wrap').fadeOut(200);
				}
			}else{
				$('.user-menu-list-wrap').fadeIn(200);
			}
		}
	});
</script>

<script src="/teacher/js/ng/controllers/header.js?v=2.16.352"></script>

<!-- ▼ popup 5mins extended lesson time -->
<!-- static -->

<!-- <script>
	$(function () {

		/* add text on chat messages -- for display static purpose -- delete after */
        // $('#popup_lesson_time_ext5mins').fadeIn(100).draggable();
        $('#popup_lesson_time_ext5mins').draggable();
        $('.chat_area_cell div#textchat_area').append(
            `<div class="chat_txt info_txt">
                <div class="desc_wrap">
                    <span class="cnt-sentence" style="color: blue;"><p style="color: blue;">─ 5 minutes extended.</p> </span>
                </div>
                <div class="btn_chat_wrap">
                    <a href="javascript:void(0);" class="btn_chat_menu chat_translate_trigger instant_msg_translate_trigger"><span class="tooltip">翻訳する</span></a>
                </div>
            </div>`);
		
		/* end */
    })
</script> -->

<!-- end static -->
<!-- ▲ popup 5mins extended lesson time -->						</div>
					</div>
				</div>
			</div>
			<div class="chat_frame_row chat_frame_row--middle" id="chat_frame_row--middle">
				<div class="chat_frame_cell">

					<div class="pane_wrap pane_wrap--middle" id="pane_wrap--middle">
						<div class="pane pane--middle_left ui-resizable" id="pane--middle_left">
							<div class="page_contents_table" id="page_contents_table">
								<div class="page_contents_row nc-t-container" id="page_contents_row--main">
									<!-- // NJ-12087: add icon sidebar when show/ hide side bar -->
									<div class="page_contents_tabs_icon no-print" id="page_contents_tabs_icon">
										<span class="nc-t-icon icon-sidebar"></span>
									</div>
									<div class="page_contents_tabs nc-t-side-menu no-print ui-resizable" id="page_contents_tabs">
										<style>
	.gu-mirror {
		position: fixed !important;
		margin: 0 !important;
		z-index: 9999 !important;
		opacity: 0.8;
		-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=80)";
		filter: alpha(opacity=80);
	}
	.gu-hide {
		display: none !important;
	}
	.gu-unselectable {
		-webkit-user-select: none !important;
		-moz-user-select: none !important;
		-ms-user-select: none !important;
		user-select: none !important;
	}
	.gu-transit {
		opacity: 0.2;
		-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=20)";
		filter: alpha(opacity=20);
	}

	.side-menu-list > li > .sub-list-title .menu-arrow img {
		width: 9px;
	}
	/* NJ-24697 - Class for hiding the navigation when ongoing lesson */
	.menu-hider-unq{
		display: none !important;
	}
	.nc-t-icon.icon-requests {
		background-image: url(./images/icon/requests.svg);
	}
	a[ui-sref="request"]:has(span.badge) {
		background: #01AEB5;
	}
</style>
<div class="side-menu-inner nc-t-scrollbar-1">
	<div class="menu-logo">
		<div class="menu-logo-content logo-image">
		<a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="dashboard">
			<img src="/teacher/images/common/logo-nativecamp-teacher.svg" alt="NativeCamp. - Online Tutorial Service">
		</a>
		</div>
		<div class="menu-logo-content cubicle">
			<span></span>
		</div>
	</div>

			<ul id="header_menu" class="side-menu-list tab_menu_list">
			<!-- NJ-9825 Make it possible to change the order of menu bar on Teacher Screen -->
			                        <!-- NJ-16016 add guideline sidebar directory and subcategory -->
            <!-- todo get list sidevar and subsidebar -->
<!-- Get list guideline side category and subcategory -->
    <li class="can-drag-drop" draggable="true" data-id="23">
        <span class="sub-list-title">
            <span class="nc-t-icon icon-guide"></span>Guidelines            <span class="guideline-parent menu-arrow active-arrow">
                <img src="./webroot/images/icon/arrow-left.svg" alt="">
            </span>
        </span>

        <ul class="side-menu-sub-list guideline-sub-menu" style="display: none;">

            
                                                                <li data-category-id="162" class="forlinker">
                    <a href="javascript:void(0)" data-menus="about-company,virtual-background,translation,japanese-phrases,chatbot,open-space,inquiry,agreement,confirmation_letter" data-guideline-url="about-company" ng-click="menuChange($event)" data-ui-sref-opts="{reload: true}" ui-sref="home/guideline({type:'category', value:'Platform'})" class="header_menu">Platform</a>
                </li>
            
                                                                <li data-category-id="115" class="forlinker">
                    <a href="javascript:void(0)" data-menus="how-to-deal-with-communication-problems,camera-microphone-and-browser-settings" data-guideline-url="how-to-deal-with-communication-problems" ng-click="menuChange($event)" data-ui-sref-opts="{reload: true}" ui-sref="home/guideline({type:'category', value:'Teaching Requirements'})" class="header_menu">Teaching Requirements</a>
                </li>
            
                                                                <li data-category-id="159" class="forlinker">
                    <a href="javascript:void(0)" data-menus="schedule-overview,sudden-class,booked-class,lesson-request,class-cancellation,lesson-rules-and-policies,textbooks-overview,learning-kit,lesson-history,lesson-review,students-info,message-for-students,notice,summer-time" data-guideline-url="schedule-overview" ng-click="menuChange($event)" data-ui-sref-opts="{reload: true}" ui-sref="home/guideline({type:'category', value:'Lesson &amp; Textbook'})" class="header_menu">Lesson &amp; Textbook</a>
                </li>
            
                                                                <li data-category-id="82" class="forlinker">
                    <a href="javascript:void(0)" data-menus="profile-photo,introduction-video,tutor-rank,tutors-fee,account-deactivation" data-guideline-url="profile-photo" ng-click="menuChange($event)" data-ui-sref-opts="{reload: true}" ui-sref="home/guideline({type:'category', value:'Account '})" class="header_menu">Account </a>
                </li>
            
                                                                <li data-category-id="94" class="forlinker">
                    <a href="javascript:void(0)" data-menus="tutors-incentives,referral-promo,minimum-earnings,leftover-coins,pay-period-and-pay-day-info,payoneer-instructions" data-guideline-url="tutors-incentives" ng-click="menuChange($event)" data-ui-sref-opts="{reload: true}" ui-sref="home/guideline({type:'category', value:'Payment'})" class="header_menu">Payment</a>
                </li>
            
                                                                <li data-category-id="113" class="forlinker">
                    <a href="javascript:void(0)" data-menus="behaviour,cancellations,private-info,list-of-illustrations,warning-and-suspension,immediate-dismissal" data-guideline-url="behaviour" ng-click="menuChange($event)" data-ui-sref-opts="{reload: true}" ui-sref="home/guideline({type:'category', value:'Prohibited Actions List'})" class="header_menu">Prohibited Actions List</a>
                </li>
                    </ul>
    </li>
<script>
    $(function() {
        // default hide guideline category child when refresh page
         // // get and set sidebar status
         let sidebarStatusObj = getGuidelineSidebarStatus();

        for(let sidebarSelectName in sidebarStatusObj ) {
            let status = sidebarStatusObj[sidebarSelectName];
            if(status) {
                // side bar is close, set UI close
                if(typeof $(sidebarSelectName).click == 'function') {
                    if($('.guideline-parent').hasClass('active-arrow')) {
                        // sideline sidebar menu is close, wating UI render
                        setTimeout(() => {
                            $(sidebarSelectName).click();
                        }, 1000)

                    } else {
                        setTimeout(() => {
                            $(sidebarSelectName).click();
                        }, 100)
                    }
                }
            }
        }
    })
</script>
                        <li class="can-drag-drop" draggable="true" data-id="18">
            <span class="sub-list-title">
                <span class="nc-t-icon icon-notice"></span>Announcement                <span class="sidebar-badgge">8</span><span class="menu-arrow active-arrow">
                    <img src="./webroot/images/icon/arrow-left.svg" alt=""></span>
                </span>
            
            <ul class="side-menu-sub-list" style="display: none;">
                                                                                                <li id="tab_menu--notice" data-id="51">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="notice" class="header_menu">
                    Notice                <span class="badge popin">7</span></a>
            </li>
                                                                                            <li id="tab_menu--warning" data-id="52">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="warning" class="header_menu">
                    Warning                <span class="badge popin">1</span></a>
            </li>
                                        </ul>
        </li>
                                            <li class="tab_menu tab_menu--dashboard can-drag-drop" draggable="true" id="tab_menu--dashboard" data-id="13">
                    <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="dashboard" class="header_menu">
                        <span class="nc-t-icon icon-signal"></span>Dashboard                    </a>
                </li>
                                    <li class="can-drag-drop" draggable="true" data-id="14">
            <span class="sub-list-title">
                <span class="nc-t-icon icon-book"></span>Lesson                <span class="sidebar-badgge">12</span><span class="menu-arrow active-arrow">
                    <img src="./webroot/images/icon/arrow-left.svg" alt=""></span>
                </span>
            
            <ul class="side-menu-sub-list" style="display: none;">
                                                                                                <li id="tab_menu--textbook" data-id="33">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="textbook(globalTextbook)" class="header_menu on">
                    Textbook                </a>
            </li>
                                                                                            <li id="tab_menu--learningkit" data-id="34">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="learningkit/learningkit" class="header_menu">
                    Learning kit                </a>
            </li>
                                                                                            <li id="tab_menu--student_info" data-id="37">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="StudentInfo" class="header_menu">
                    Student's Info                </a>
            </li>
                                                                                            <li id="tab_menu--lesson_message" data-id="40">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="LessonMessage" class="header_menu">
                    Message to Student                <span class="badge popin">12</span></a>
            </li>
                                                                                            <li id="tab_menu--lesson_review" data-id="38">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="lessonReview" class="header_menu">
                    Lesson Review                </a>
            </li>
                                                                                            <li id="tab_menu--lesson_log" data-id="39">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="lessonLog" class="header_menu">
                    Lesson History                </a>
            </li>
                                                                                            <li id="tab_menu--ranking" data-id="19">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="ranking" class="header_menu">
                    Teacher Ranking                </a>
            </li>
                                        </ul>
        </li>
                <li class="can-drag-drop" draggable="true" data-id="56">
            <span class="sub-list-title">
                <span class="nc-t-icon icon-user"></span>Reservation                <span class="menu-arrow active-arrow">
                    <img src="./webroot/images/icon/arrow-left.svg" alt=""></span>
                </span>
            
            <ul class="side-menu-sub-list" style="display: none;">
                                                                                                <li id="tab_menu--schedule" data-id="35">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="home/schedule" class="header_menu">
                    Schedule                </a>
            </li>
                                                                                            <li id="tab_menu--reservation" data-id="36">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="announce" class="header_menu">
                    Reservation                </a>
            </li>
                                                                                            <li id="tab_menu--request_setting" data-id="55">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="request/setting" class="header_menu">
                    Request Setting                </a>
            </li>
                                        </ul>
        </li>
                                            <li class="tab_menu tab_menu--request can-drag-drop" draggable="true" id="tab_menu--request" data-id="54">
                    <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="request" class="header_menu">
                        <span class="nc-t-icon icon-requests"></span>Requests                    </a>
                </li>
                                                                <li class="tab_menu tab_menu--settings can-drag-drop" draggable="true" id="tab_menu--settings" data-id="15">
                    <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="account" class="header_menu">
                        <span class="nc-t-icon icon-user"></span>Account                    </a>
                </li>
                                    <li class="can-drag-drop" draggable="true" data-id="44">
            <span class="sub-list-title">
                <span class="nc-t-icon icon-creditcard"></span>Payment                <span class="menu-arrow active-arrow">
                    <img src="./webroot/images/icon/arrow-left.svg" alt=""></span>
                </span>
            
            <ul class="side-menu-sub-list" style="display: none;">
                                                                                                <li id="tab_menu--home_based" data-id="16">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="homeBasedPayment" class="header_menu">
                    Details                </a>
            </li>
                                                                                                                                                    <li id="tab_menu--appreciation" data-id="25">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="appreciation" class="header_menu">
                    Appreciation                </a>
            </li>
                                        </ul>
        </li>
                <li class="can-drag-drop" draggable="true" data-id="45">
            <span class="sub-list-title">
                <span class="nc-t-icon icon-tool"></span>Tools                <span class="menu-arrow active-arrow">
                    <img src="./webroot/images/icon/arrow-left.svg" alt=""></span>
                </span>
            
            <ul class="side-menu-sub-list" style="display: none;">
                                    <li id="#" data-id="#">
                        <a ui-sref="UsefulTools" class="header_menu">
                            Useful tools
                        </a>
                    </li>
                                                                                                <li id="tab_menu--download_app" data-id="30">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="home/download_app/beauty" class="header_menu">
                    NC Apps                </a>
            </li>
                                                                                            <li id="tab_menu--test_cam" data-id="17">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="device-setting" class="header_menu">
                    Environment Check                </a>
            </li>
                                                                                            <li id="tab_menu--virtual_bg" data-id="28">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="VirtualBg" class="header_menu">
                    Virtual background                </a>
            </li>
                                                                                            <li id="tab_menu--translate" data-id="21">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="home/translate" class="header_menu">
                    Translation                </a>
            </li>
                                                                                            <li id="tab_menu--phrase" data-id="20">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="home/phrase" class="header_menu">
                    Japanese Phrases                </a>
            </li>
                                        </ul>
        </li>
                <li class="can-drag-drop" draggable="true" data-id="46">
            <span class="sub-list-title">
                <span class="nc-t-icon icon-social"></span>Social                <span class="menu-arrow active-arrow">
                    <img src="./webroot/images/icon/arrow-left.svg" alt=""></span>
                </span>
            
            <ul class="side-menu-sub-list" style="display: none;">
                                                                                                <li id="tab_menu--spotlight" data-id="29">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="spotlight" class="header_menu header_menu_spotlight">
                    Spotlight                </a>
            </li>
                                                                                            <li id="tab_menu--open_space" data-id="24">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="openSpace" class="header_menu">
                    Open Space                </a>
            </li>
                                                                                            <li id="tab_menu--openspace_groups" data-id="57">
                <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="groups" class="header_menu">
                    Groups                </a>
            </li>
                                        </ul>
        </li>
                                            <li class="tab_menu tab_menu--home_based can-drag-drop" draggable="true" id="tab_menu--home_base_inquiry" data-id="22">
                    <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="HomeBaseInquiry" class="header_menu header_menu_inquiry">
                        <span class="nc-t-icon icon-question"></span>Inquiry                    </a>
                </li>
                                                <li class="tab_menu tab_menu-timezone">
    <a class="func-toggle-menu_sub_panel" style="display: none" href="#menu_sub_panel-timezone"><span class="tab_txt tab_timezone"><span class="nc-t-icon icon-timezone"></span>Time Zone</span></a>
    <!-- ▼ teacher / student time zone ▼ -->
    <div class="menu_sub_panel panel_timezone highlight" id="menu_sub_panel-timezone">
        <div class="tz-box-wrap">
            <div class="tz-box student">
                <p class="tz-title"><i class="custom-icon timezone"></i>Student\'s Time</p>
                <p class="tz-time"><span id="class-current-time-student">--/-- --:--</span></p>
                <p class="tz-tz"><span id="class-time-zone-student"></span></p>
            </div>
            <div class="tz-box teacher">
                <p class="tz-title"><i class="custom-icon timezone"></i>Your Time</p>
                <p class="tz-time"><span id="class-current-time-teacher">--/-- --:--</span></p>
                <p class="tz-tz"><span id="class-time-zone-teacher"></span></p>
            </div>
        </div>
        <div class="btn_close"></div>
    </div>
    <!-- ▲ teacher / student time zone ▲ -->
</li>                                                    <li class="tab_menu tab_menu--promotions can-drag-drop" draggable="true" id="tab_menu--promotions" data-id="53">
                    <a ui-sref-active="on" ng-click="menuChange($event)" ui-sref="HomeBasedPromotion" class="header_menu">
                        <span class="nc-t-icon icon-megaphone_gray"></span>Promotions                    </a>
                </li>
                        		</ul>
	</div>
<script>
	var counseling_flg = '0';
	var customer_support_flg = '0';
	if(customer_support_flg == 1) {
		counseling_flg = 1;
	}
	var sideBarStageLocal = 'sidebarStageLocal16016';
	var sideBarStageGuidelineLocal = 'sidebarGuidelineLocal16016';
	// == NJ-23790
	var modalAndTutorialRes = "0";
	var modalAndTutorial = { current: 0, show: false };

	if(modalAndTutorialRes === '1'){
		modalAndTutorial.current = parseInt("");
		modalAndTutorial.show =  parseInt("0");
	}
	// == NJ-24697 : declarea a global homeflag
	const home_flag = 1;

    // NJ-12087: side menu show/ hide submenu
	window.onload = function() {
		// bind event click parent side bar
        $(".sub-list-title").click(function(){

			const subList = $('.sub-list-title');
			subList.each( function(index, el) {
				$(el).removeClass('on');
			});
			
			// Only add the "ON" if its child menu is visible.
			setTimeout(() => {
				$(this).removeClass('on');
				if($(this).next('ul.side-menu-sub-list').is(':visible')) {
					$(this).addClass('on');
				} 
			}, 300);
			
			toggleParentSidebar(this);
        });

		gotoGuidlineState();

		if(modalAndTutorialRes === '1'){
			$('.can-drag-drop[data-id="23"] span.sub-list-title:first-child').click();
		}
	};

	// NJ-1606: open guideline sidebar and go to guideline page
	function gotoGuidlineState() {
		// get current url
		var pageQueryString = window.location.search;
		var textPattern = "?guide=";

		var isContaintGuideText = pageQueryString.includes(textPattern);

		var paramsArr = pageQueryString.split("="); // expect length = 2, only containt guide data query string only

		if(pageQueryString && isContaintGuideText && paramsArr.length == 2) {
			console.log('open guideline page');
			var guidelineUrl = paramsArr[1];
			gotoGuideUrlParam(guidelineUrl);
			// remove query params for avoiding error when click sidebar other page
			window.history.replaceState(null, null, 'home');
		} else {
			var guidelineUrl = "";
			if(guidelineUrl) {
				gotoGuideUrlParam(guidelineUrl);
			}
		}
	}

	function gotoGuideUrlParam(guidelineUrl) {
		if(guidelineUrl) {
			// get element of guideline sub-sidebar
			var sideSelectName = `[data-guideline-url='${guidelineUrl}']`;
			var eleSubsidebar = $(sideSelectName);

			if(eleSubsidebar.length && typeof eleSubsidebar.click == 'function') {
				// find sidebar sub and open IT
				var parentSubmenu = eleSubsidebar.parent().parent().prev('.sub-list-title').children('.menu-arrow').hasClass('active-arrow');
				if(eleSubsidebar.parent().parent().prev('.sub-list-title').children('.menu-arrow').hasClass('active-arrow')) {
					eleSubsidebar.parent().parent().prev('.sub-list-title').click();
				}

				// find guideline sidebar and open IT
				var guidelineSidebarSublist = eleSubsidebar.parent().parent().prev('.sub-list-title').parent().parent().prev('.sub-list-title');
				if(guidelineSidebarSublist.children('.menu-arrow').hasClass('active-arrow')) {
					guidelineSidebarSublist.click();
				}
				
				// click and show guideline page
				eleSubsidebar.click();
			} else {
				
				// check all menu-details
				$(".guideline-sub-menu").children(".forlinker").children(".header_menu").each(function(){ // change page content
					var data_menus = $(this).attr("data-menus");
					if(data_menus.search(guidelineUrl) != -1) {
						if($(this).parent().parent().prev('.sub-list-title').children('.menu-arrow').hasClass('active-arrow')) {
							$(this).parent().parent().prev('.sub-list-title').click();
						}
						$(this).click();
						// - find the sub link
						setTimeout(() => {
							var sideSelectName = `[data-guideline-sub-url='${guidelineUrl}']`;
							var eleSubsidebar = $(sideSelectName);
							eleSubsidebar.click();
						}, 3000);
					}
				});
			}
		}
	}

	function toggleParentSidebar(context) {
		if(typeof context == 'object') {
			$(context).children('.menu-arrow').toggleClass('active-arrow');
			$(context).next(".side-menu-sub-list").slideToggle('fast');

			// save sidebar status
			// get sidebar id
			var sidebarId = $(context).parent().attr("data-id");
			if(sidebarId) {
				var sideSelectName = `[data-id=${sidebarId}] > .sub-list-title`;

				if($(context).children('.menu-arrow').hasClass('active-arrow')) {
					// arrow is active, side bar is close
					setSidebarStatus(sideSelectName, true);

					toggleParentsidebarBadge(context, true);

				} else {
					// sidebar is open
					setSidebarStatus(sideSelectName, false);

					toggleParentsidebarBadge(context, false);
				}
			}

			// if guideline case
			var categoryId = $(context).parent().attr("data-category-id");
			if(categoryId) {
				var sideSelectName = `[data-category-id=${categoryId}] > .sub-list-title`;
				if($(context).children('.menu-arrow').hasClass('active-arrow')) {
					// arrow is active, side bar is close
					setGuidelineSidebarStatus(sideSelectName, true);

				} else {
					// sidebar is open
					setGuidelineSidebarStatus(sideSelectName, false);
				}

			}
		}
	}

	function toggleParentsidebarBadge(sidebarEle, displayStatus) {

		if($(sidebarEle).children('.sidebar-badgge').length) {
			if(displayStatus) {
				$(sidebarEle).children('.sidebar-badgge').show();
			} else {
				$(sidebarEle).children('.sidebar-badgge').hide();
			}
		}
	}

	// sidebarStatus object containt key-value pair
	// value = true, sidebar is close
	// value = false, sider is open
	function getSidebarStatus() {
		var sidebarStatusObj = localStorage.getItem(sideBarStageLocal);
		try {
			sidebarStatusObj = JSON.parse(sidebarStatusObj);
			if(!sidebarStatusObj || typeof sidebarStatusObj != 'object') {
				sidebarStatusObj = {};
			}
		} catch(e) {
			sidebarStatusObj = {};
		}

		return sidebarStatusObj
	}

	function setSidebarStatus(name, status) {
		var sidebarStatusObj = getSidebarStatus();
		sidebarStatusObj[name] = status;

		localStorage.setItem(sideBarStageLocal, JSON.stringify(sidebarStatusObj));
	}


	/// NJ-16016 guideline category and subcategory
	function getGuidelineSidebarStatus() {
		var sidebarStatusObj = localStorage.getItem(sideBarStageGuidelineLocal);
		try {
			sidebarStatusObj = JSON.parse(sidebarStatusObj);
			if(!sidebarStatusObj || typeof sidebarStatusObj != 'object') {
				sidebarStatusObj = {};
			}
		} catch(e) {
			sidebarStatusObj = {};
		}

		return sidebarStatusObj
	}

	function setGuidelineSidebarStatus(name, status) {
		var sidebarStatusObj = getGuidelineSidebarStatus();
		sidebarStatusObj[name] = status;

		localStorage.setItem(sideBarStageGuidelineLocal, JSON.stringify(sidebarStatusObj));
	}

</script>
<script type="text/javascript" src="/teacher/js/dragula.min.js?v=2.16.352"></script><script type="text/javascript" src="/teacher/js/drag-drop-menu.js?v=2.16.352"></script>									<div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div></div><!-- // .page_contents_tabs -->
									<div class="page_contents_container nc-t-inner-1" id="nc-t-page-content">
										<!-- uiView:  --><div class="page_contents_container_inner ng-scope" id="page_loading_area" ui-view=""><link rel="stylesheet" type="text/css" href="/teacher/css/details-textbook.css?v=1756730251" onload="cssStyleLoaded()" class="ng-scope">
<link rel="stylesheet" href="/teacher/webroot/files/textbook/resources/common/css/ui_toolbars.css?v=1756730251" class="ng-scope">
<style class="ng-scope">
	.ui_toolbars_container{
		position: absolute;
		top: 0;
	}

	.textbook_error_report_btn {
		background: #ff194a;
		color: white;
		padding: 3px 40px;
	}
</style>

<div class="page_contents page_contents--textbook ng-scope" id="page_contents--textbook">
	<div class="section sec-textbook">
		<div class="teacher--tb-btn-list-wrap">
			<ul class="teacher--tb-btn-list">
				<!-- <li>
					<a href="javascript:;" class="func_toggle btn_style btn_green" data-css-text="change" data-target="#tr_textbook_header"></a>
				</li> -->
				<li>
					<ul class="sub-list-1" style="display: none;">
						<li>
															<a href="javascript:;" class="btn_style btn_green func_load_textbook prev-btn disabled"><i class="fa fa-arrow-left m_r_5"></i>Prev Lesson</a>
													</li>
						<li>
															<a href="javascript:;" class="btn_style btn_green func_load_textbook next-btn disabled">Next Lesson<i class="fa fa-arrow-right m_l_5"></i></a>
													</li>
					</ul>
				</li>
			</ul>
		</div>
		<table class="flex-table">
			<tbody><tr class="flex-tr-1" id="tr_textbook_header">
				<td class="flex-td-1-1">
					<!-- <div class="contents_desc">
						<p>Check the text of lesson which student chose. If  you cannot see the chapter please adjust  it manually.</p>
					</div> -->
					<div class="textbook-select-menu-area ui_tab_wrap" style="">
						<div class="ui-tab-contents" id="tab_contents-tb_course">
							<div class="textbook-select-menu">

								
								<dl>
									<!-- <dt>Textbook</dt> -->
									<dd>

										<!-- Textbook -->
										<select ng-model="courseId" id="CourseCourses" class="hide ng-pristine ng-untouched ng-valid ng-not-empty"><option value="? string:undefined-course ?"></option>
											<option class="category_selector" disabled="" value="Select by Course">Select by Course</option>
											<!-- ngRepeat: course in courses --><option ng-repeat="course in courses" type="0" data-jpn="Daily news" data-category-id="76" data-subcategory-id="195" value="76-course" data-html-dir="daily_news" class="ng-binding ng-scope">Daily news</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="6" data-jpn="Callan for Kids Course" data-category-id="80" data-subcategory-id="91" value="80-course" data-html-dir="callan_method_kids" class="ng-binding ng-scope">Callan for Kids Course</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="0" data-jpn="Business Course" data-category-id="3" data-subcategory-id="164" value="3-course" data-html-dir="business_middle" class="ng-binding ng-scope">Business Course</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="0" data-jpn="Beginner Course" data-category-id="1" data-subcategory-id="2" value="1-course" data-html-dir="grammar_entry" class="ng-binding ng-scope">Beginner Course</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="1" data-jpn="Kids Course" data-category-id="2" data-subcategory-id="313" value="2-course" data-html-dir="ogkd_1_teacher" class="ng-binding ng-scope">Kids Course</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="0" data-jpn="Daily Conversation Advanced Course" data-category-id="6" data-subcategory-id="16" value="6-course" data-html-dir="grammar_advanced" class="ng-binding ng-scope">Daily Conversation Advanced Course</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="0" data-jpn="Daily Conversation Intermediate Course" data-category-id="7" data-subcategory-id="13" value="7-course" data-html-dir="grammar_middle" class="ng-binding ng-scope">Daily Conversation Intermediate Course</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="0" data-jpn="Daily Conversation Beginner Course" data-category-id="8" data-subcategory-id="10" value="8-course" data-html-dir="grammar_beginner" class="ng-binding ng-scope">Daily Conversation Beginner Course</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="2" data-jpn="Callan Method Course" data-category-id="60" data-subcategory-id="19" value="60-course" data-html-dir="callan_method" class="ng-binding ng-scope">Callan Method Course</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="4" data-jpn="Pronunciation Course" data-category-id="64" data-subcategory-id="24" value="64-course" data-html-dir="pronunciation_middle" class="ng-binding ng-scope">Pronunciation Course</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="5" data-jpn="Callan for Business Course" data-category-id="71" data-subcategory-id="75" value="71-course" data-html-dir="callan_method_business" class="ng-binding ng-scope">Callan for Business Course</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="0" data-jpn="SIDE by SIDE Course" data-category-id="77" data-subcategory-id="125" value="77-course" data-html-dir="side_by_side_digital_teacher_1" class="ng-binding ng-scope">SIDE by SIDE Course</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="0" data-jpn="Business Course" data-category-id="101" data-subcategory-id="249" value="101-course" data-html-dir="business_middle" class="ng-binding ng-scope">Business Course</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="0" data-jpn="EIKEN - Interview Test Course" data-category-id="103" data-subcategory-id="264" value="103-course" data-html-dir="og_eiken_grade_2_teacher" class="ng-binding ng-scope">EIKEN - Interview Test Course</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="0" data-jpn="Basic Pronunciation Course" data-category-id="104" data-subcategory-id="261" value="104-course" data-html-dir="basic_pronunciation_consonant_teacher" class="ng-binding ng-scope">Basic Pronunciation Training Course - American English -</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="0" data-jpn="Advanced Pronunciation Training Course" data-category-id="108" data-subcategory-id="278" value="108-course" data-html-dir="pr_accent_1_teacher" class="ng-binding ng-scope">Advanced Pronunciation Training Course - American English -</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="0" data-jpn="Practical Pronunciation Training Course" data-category-id="124" data-subcategory-id="408" value="124-course" data-html-dir="pr_pr_read_teacher" class="ng-binding ng-scope">Practical Pronunciation Training Course - American English -</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="0" data-jpn="TOEIC®L&amp;R TEST Score 600 Course" data-category-id="128" data-subcategory-id="424" value="128-course" data-html-dir="toeic_cosmopier_teacher_b_1" class="ng-binding ng-scope">TOEIC®L&amp;R TEST Score 600 Course</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="0" data-jpn="TOEIC®L&amp;R TEST Score 800 Course" data-category-id="129" data-subcategory-id="428" value="129-course" data-html-dir="toeic_cosmopier_teacher_c_1" class="ng-binding ng-scope">TOEIC®L&amp;R TEST Score 800 Course</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="12" data-jpn="Callan Method Course (NEW)" data-category-id="136" data-subcategory-id="448" value="136-course" data-html-dir="callan_method_3rd_teacher" class="ng-binding ng-scope">Callan Method Course (NEW)</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="0" data-jpn="Free Conversation Course" data-category-id="142" data-subcategory-id="473" value="142-course" data-html-dir="freetalk_teacher" class="ng-binding ng-scope">Free Conversation Course</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="0" data-jpn="IELTS Speaking" data-category-id="139" data-subcategory-id="463" value="139-course" data-html-dir="speak_train_ielts_teacher_1" class="ng-binding ng-scope">IELTS Speaking Course</option><!-- end ngRepeat: course in courses --><option ng-repeat="course in courses" type="0" data-jpn="Basic Pronunciation Training Course - British English -" data-category-id="134" data-subcategory-id="444" value="134-course" data-html-dir="basic_pronunciation_british_consonant_teacher" class="ng-binding ng-scope">Basic Pronunciation Training Course - British English -</option><!-- end ngRepeat: course in courses -->

											<option class="category_selector" disabled="" value="Select by Textbook">Select by Textbook</option>

											<!-- ngRepeat: class in classes --><option ng-repeat="class in classes" type="0" data-jpn="Daily News - Life" data-category-id="150" data-subcategory-id="" value="150-class" data-html-dir="daily_news" class="ng-binding ng-scope">Daily News - Life</option><!-- end ngRepeat: class in classes --><option ng-repeat="class in classes" type="0" data-jpn="Daily News - Entertainment" data-category-id="151" data-subcategory-id="" value="151-class" data-html-dir="daily_news" class="ng-binding ng-scope">Daily News - Entertainment</option><!-- end ngRepeat: class in classes --><option ng-repeat="class in classes" type="0" data-jpn="Daily News - Business" data-category-id="152" data-subcategory-id="" value="152-class" data-html-dir="daily_news" class="ng-binding ng-scope">Daily News - Business</option><!-- end ngRepeat: class in classes --><option ng-repeat="class in classes" type="0" data-jpn="SIDE by SIDE" data-category-id="78" data-subcategory-id="" value="78-class" data-html-dir="side_by_side_digital_teacher_1" class="ng-binding ng-scope">SIDE by SIDE</option><!-- end ngRepeat: class in classes --><option ng-repeat="class in classes" type="0" data-jpn="Grammar" data-category-id="5" data-subcategory-id="" value="5-class" data-html-dir="grammar_entry" class="ng-binding ng-scope">Grammar</option><!-- end ngRepeat: class in classes --><option ng-repeat="class in classes" type="0" data-jpn="Five min Discussion" data-category-id="51" data-subcategory-id="" value="51-class" data-html-dir="discussion" class="ng-binding ng-scope">Five min Discussion</option><!-- end ngRepeat: class in classes --><option ng-repeat="class in classes" type="1" data-jpn="Kids" data-category-id="88" data-subcategory-id="" value="88-class" data-html-dir="ogkd_1_teacher" class="ng-binding ng-scope">Kids - Basic English</option><!-- end ngRepeat: class in classes --><option ng-repeat="class in classes" type="0" data-jpn="Free Conversation" data-category-id="4" data-subcategory-id="" value="4-class" data-html-dir="freetalk_teacher" class="ng-binding ng-scope">Free Conversation</option><!-- end ngRepeat: class in classes --><option ng-repeat="class in classes" type="8" data-jpn="Study Sapuri Business English - Weekly" data-category-id="94" data-subcategory-id="" value="94-class" data-html-dir="studysapuri_business_weekly_teacher1-1" class="ng-binding ng-scope">Study Sapuri Business English Weekly</option><!-- end ngRepeat: class in classes --><option ng-repeat="class in classes" type="8" data-jpn="Study Sapuri Business English - Daily" data-category-id="95" data-subcategory-id="" value="95-class" data-html-dir="studysapuri_business_daily_teacher1-1" class="ng-binding ng-scope">Study Sapuri Business English Daily</option><!-- end ngRepeat: class in classes --><option ng-repeat="class in classes" type="8" data-jpn="Study Sapuri Business English Situation" data-category-id="111" data-subcategory-id="" value="111-class" data-html-dir="studysapuri_business_situation_teacher1-1" class="ng-binding ng-scope">Study Sapuri Business English Situation</option><!-- end ngRepeat: class in classes --><option ng-repeat="class in classes" type="9" data-jpn="Study Sapuri Daily Conversation - Weekly" data-category-id="96" data-subcategory-id="" value="96-class" data-html-dir="studysapuri_conversation_weekly_teacher1-1" class="ng-binding ng-scope">Study Sapuri Daily Conversation Weekly</option><!-- end ngRepeat: class in classes --><option ng-repeat="class in classes" type="9" data-jpn="Study Sapuri Daily Conversation - Daily" data-category-id="97" data-subcategory-id="" value="97-class" data-html-dir="studysapuri_conversation_daily_teacher1-1" class="ng-binding ng-scope">Study Sapuri Daily Conversation Daily</option><!-- end ngRepeat: class in classes --><option ng-repeat="class in classes" type="0" data-jpn="Selection of teaching materials after entering the lesson room" data-category-id="119" data-subcategory-id="" value="119-class" data-html-dir="textbook_selection_teacher" class="ng-binding ng-scope">Selection of teaching materials after entering the lesson room</option><!-- end ngRepeat: class in classes -->

										</select>
										<!-- Textbook -->

										<!-- Category -->
										<select [(ngmodel)]="subcategorySelected" ng-model="subcategorySelected" ng-change="updateChapterOptionDropDown(subcategorySelected)" id="subcategoryDropDown" class="hide ng-pristine ng-untouched ng-valid ng-not-empty"><option ng-disabled="null" data-eng="Presentation" data-subcategory-id="160" value="160">
			Presentation
			</option>
		<option ng-disabled="null" data-eng="Small talk / Company dinner" data-subcategory-id="161" value="161" selected="">
			Small talk / Company dinner
			</option>
		<option ng-disabled="null" data-eng="Interview" data-subcategory-id="162" value="162">
			Interview
			</option>
		<option ng-disabled="null" data-eng="At the reception" data-subcategory-id="163" value="163">
			At the reception
			</option>
		<option ng-disabled="null" data-eng="Responding to an order" data-subcategory-id="164" value="164">
			Responding to an order
			</option>
		<option ng-disabled="null" data-eng="Receiving an order" data-subcategory-id="165" value="165">
			Receiving an order
			</option>
		<option ng-disabled="null" data-eng="Sales talk" data-subcategory-id="166" value="166">
			Sales talk
			</option>
		<option ng-disabled="null" data-eng="Walk-in sales" data-subcategory-id="167" value="167">
			Walk-in sales
			</option>
		<option ng-disabled="null" data-eng="Training" data-subcategory-id="168" value="168">
			Training
			</option>
		<option ng-disabled="null" data-eng="Talk with superiors" data-subcategory-id="169" value="169">
			Talk with superiors
			</option>
		<option ng-disabled="null" data-eng="Talk with colleagues" data-subcategory-id="412" value="412">
			Talk with colleagues
			</option>
		<option ng-disabled="null" data-eng="Talk with subordinates" data-subcategory-id="423" value="423">
			Talk with subordinates
			</option>
		<option ng-disabled="null" data-eng="Start/End a meeting" data-subcategory-id="170" value="170">
			Start/End a meeting
			</option>
		<option ng-disabled="null" data-eng="Explaining in a meeting" data-subcategory-id="171" value="171">
			Explaining in a meeting
			</option>
		<option ng-disabled="null" data-eng="Exchanging opinions in a meeting" data-subcategory-id="172" value="172">
			Exchanging opinions in a meeting
			</option>
		<option ng-disabled="null" data-eng="Market analysis and evaluating improvement measure" data-subcategory-id="173" value="173">
			Market analysis and evaluating improvement measure
			</option>
		<option ng-disabled="null" data-eng="Overseas on-site inspection and problem solving" data-subcategory-id="174" value="174">
			Overseas on-site inspection and problem solving
			</option>
		</select>
										<!-- Category -->

										<!-- Chapter -->
										<select [(ngmodel)]="textbookSelected" ng-model="textbookSelected" id="chapter" class="hide ng-pristine ng-untouched ng-valid ng-not-empty"><option ng-disabled="null" data-tc-id="5002" data-textbook_category_type="0" data-live_lesson_flg="1" data-subcategory-id="161" data-html-dir="cosmopier_business" data-textbook-id="1076" data-chapter-id="1" data-chapter-jap="プロジェクトメンバーの初顔合わせ (1)" data-chapter-eng="First meeting of project members (1)" value="1076">First meeting of project members (1)</option><option ng-disabled="null" data-tc-id="5003" data-textbook_category_type="0" data-live_lesson_flg="1" data-subcategory-id="161" data-html-dir="cosmopier_business" data-textbook-id="1077" data-chapter-id="2" data-chapter-jap="プロジェクトメンバーの初顔合わせ (2)" data-chapter-eng="First meeting of project members (2)" value="1077">First meeting of project members (2)</option><option ng-disabled="null" data-tc-id="5004" data-textbook_category_type="0" data-live_lesson_flg="1" data-subcategory-id="161" data-html-dir="cosmopier_business" data-textbook-id="1078" data-chapter-id="3" data-chapter-jap="プロジェクトメンバーの初顔合わせ (3)" data-chapter-eng="First meeting of project members (3)" value="1078">First meeting of project members (3)</option><option ng-disabled="null" data-tc-id="5005" data-textbook_category_type="0" data-live_lesson_flg="1" data-subcategory-id="161" data-html-dir="cosmopier_business" data-textbook-id="1152" data-chapter-id="16" data-chapter-jap="ミーティングの後、 親睦をはかる (1)" data-chapter-eng="Improve friendship after a meeting (1)" value="1152">Improve friendship after a meeting (1)</option><option ng-disabled="null" data-tc-id="5006" data-textbook_category_type="0" data-live_lesson_flg="1" data-subcategory-id="161" data-html-dir="cosmopier_business" data-textbook-id="1153" data-chapter-id="17" data-chapter-jap="ミーティングの後、 親睦をはかる (2)" data-chapter-eng="Improve friendship after a meeting (2)" value="1153">Improve friendship after a meeting (2)</option><option ng-disabled="null" data-tc-id="5007" data-textbook_category_type="0" data-live_lesson_flg="1" data-subcategory-id="161" data-html-dir="cosmopier_business" data-textbook-id="1154" data-chapter-id="18" data-chapter-jap="ミーティングの後、 親睦をはかる (3)" data-chapter-eng="Improve friendship after a meeting (3)" value="1154">Improve friendship after a meeting (3)</option></select>
										<!-- Chapter -->

										<div class="custom-select" id="customSelect">
											<div class="select-styled textbook-title">Business Course</div>
										
											<div class="select-options" onscroll="tbChapterPaginate(this)" data-dailynews-limit="50">
												<div class="select-textbooks">
													<div class="main-select-header">Textbook: Business Course</div>
													<div id="textbookField" class="hide">
														<div class="options-sub-header">Select By Course</div>
													
														<ul class="grid-list">
															<!-- ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="0" data-jpn="Daily news" data-category-id="76">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105739684a341344513_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Daily news</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="6" data-jpn="Callan for Kids Course" data-category-id="80">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105829684a34456f64d_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Callan for Kids Course</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="0" data-jpn="Business Course" data-category-id="3">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105330684a331ab396d_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Business Course</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="0" data-jpn="Beginner Course" data-category-id="1">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105245684a32eda4996_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Beginner Course</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="1" data-jpn="Kids Course" data-category-id="2">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105236684a32e49e2eb_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Kids Course</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="0" data-jpn="Daily Conversation Advanced Course" data-category-id="6">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105225684a32d975d5c_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Daily Conversation Advanced Course</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="0" data-jpn="Daily Conversation Intermediate Course" data-category-id="7">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105152684a32b89d2ce_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Daily Conversation Intermediate Course</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="0" data-jpn="Daily Conversation Beginner Course" data-category-id="8">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105142684a32aec7965_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Daily Conversation Beginner Course</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="2" data-jpn="Callan Method Course" data-category-id="60">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_110005684a34a537e62_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Callan Method Course</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="4" data-jpn="Pronunciation Course" data-category-id="64">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105353684a3331920d8_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Pronunciation Course</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="5" data-jpn="Callan for Business Course" data-category-id="71">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105818684a343acf42b_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Callan for Business Course</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="0" data-jpn="SIDE by SIDE Course" data-category-id="77">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105910684a346e9ba8a_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">SIDE by SIDE Course</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="0" data-jpn="Business Course" data-category-id="101">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105337684a3321ac594_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Business Course</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="0" data-jpn="EIKEN - Interview Test Course" data-category-id="103">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105902684a346687200_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">EIKEN - Interview Test Course</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="0" data-jpn="Basic Pronunciation Course" data-category-id="104">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105440684a336068717_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Basic Pronunciation Training Course - American English -</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="0" data-jpn="Advanced Pronunciation Training Course" data-category-id="108">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105636684a33d42b79c_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Advanced Pronunciation Training Course - American English -</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="0" data-jpn="Practical Pronunciation Training Course" data-category-id="124">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105427684a33533be6a_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Practical Pronunciation Training Course - American English -</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="0" data-jpn="TOEIC®L&amp;R TEST Score 600 Course" data-category-id="128">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105948684a3494502b0_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">TOEIC®L&amp;R TEST Score 600 Course</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="0" data-jpn="TOEIC®L&amp;R TEST Score 800 Course" data-category-id="129">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105955684a349b44ee2_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">TOEIC®L&amp;R TEST Score 800 Course</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="12" data-jpn="Callan Method Course (NEW)" data-category-id="136">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105812684a34347de35_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Callan Method Course (NEW)</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="0" data-jpn="Free Conversation Course" data-category-id="142">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105730684a340abd8ef_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Free Conversation Course</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="0" data-jpn="IELTS Speaking" data-category-id="139">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105940684a348c2fa9d_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">IELTS Speaking Course</span>
															</li><!-- end ngRepeat: course in courses --><li class="grid-list-item ng-scope" ng-repeat="course in courses" type="0" data-jpn="Basic Pronunciation Training Course - British English -" data-category-id="134">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_105747684a341b2ec8e_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Basic Pronunciation Training Course - British English -</span>
															</li><!-- end ngRepeat: course in courses -->
														</ul>

														<div class="options-sub-header">Select By Class</div>
														<ul class="grid-list">
															<!-- ngRepeat: class in classes --><li class="grid-list-item ng-scope" ng-repeat="class in classes" type="0" data-jpn="Daily News - Life" data-category-id="150">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_113451684a3ccb1b7a7_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Daily News - Life</span>
															</li><!-- end ngRepeat: class in classes --><li class="grid-list-item ng-scope" ng-repeat="class in classes" type="0" data-jpn="Daily News - Entertainment" data-category-id="151">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_113459684a3cd33be7b_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Daily News - Entertainment</span>
															</li><!-- end ngRepeat: class in classes --><li class="grid-list-item ng-scope" ng-repeat="class in classes" type="0" data-jpn="Daily News - Business" data-category-id="152">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_113442684a3cc2329f6_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Daily News - Business</span>
															</li><!-- end ngRepeat: class in classes --><li class="grid-list-item ng-scope" ng-repeat="class in classes" type="0" data-jpn="SIDE by SIDE" data-category-id="78">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_113416684a3ca853449_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">SIDE by SIDE</span>
															</li><!-- end ngRepeat: class in classes --><li class="grid-list-item ng-scope" ng-repeat="class in classes" type="0" data-jpn="Grammar" data-category-id="5">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_113232684a3c406ab65_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Grammar</span>
															</li><!-- end ngRepeat: class in classes --><li class="grid-list-item ng-scope" ng-repeat="class in classes" type="0" data-jpn="Five min Discussion" data-category-id="51">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_113240684a3c4828731_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Five min Discussion</span>
															</li><!-- end ngRepeat: class in classes --><li class="grid-list-item ng-scope" ng-repeat="class in classes" type="1" data-jpn="Kids" data-category-id="88">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_112652684a3aecf17eb_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Kids - Basic English</span>
															</li><!-- end ngRepeat: class in classes --><li class="grid-list-item ng-scope" ng-repeat="class in classes" type="0" data-jpn="Free Conversation" data-category-id="4">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_114600684a3f68036b0_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Free Conversation</span>
															</li><!-- end ngRepeat: class in classes --><li class="grid-list-item ng-scope" ng-repeat="class in classes" type="8" data-jpn="Study Sapuri Business English - Weekly" data-category-id="94">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_111925684a392db4017_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Study Sapuri Business English Weekly</span>
															</li><!-- end ngRepeat: class in classes --><li class="grid-list-item ng-scope" ng-repeat="class in classes" type="8" data-jpn="Study Sapuri Business English - Daily" data-category-id="95">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_112136684a39b03bf55_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Study Sapuri Business English Daily</span>
															</li><!-- end ngRepeat: class in classes --><li class="grid-list-item ng-scope" ng-repeat="class in classes" type="8" data-jpn="Study Sapuri Business English Situation" data-category-id="111">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_111902684a391665c1a_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Study Sapuri Business English Situation</span>
															</li><!-- end ngRepeat: class in classes --><li class="grid-list-item ng-scope" ng-repeat="class in classes" type="9" data-jpn="Study Sapuri Daily Conversation - Weekly" data-category-id="96">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_111944684a3940ce9f9_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Study Sapuri Daily Conversation Weekly</span>
															</li><!-- end ngRepeat: class in classes --><li class="grid-list-item ng-scope" ng-repeat="class in classes" type="9" data-jpn="Study Sapuri Daily Conversation - Daily" data-category-id="97">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_112301684a3a05af9b2_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Study Sapuri Daily Conversation Daily</span>
															</li><!-- end ngRepeat: class in classes --><li class="grid-list-item ng-scope" ng-repeat="class in classes" type="0" data-jpn="Selection of teaching materials after entering the lesson room" data-category-id="119">	
															
																<img loading="lazy" src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/2025_06_12_114408684a3ef8e982f_small.webp" width="70" height="70" alt="Thumb image">
																<span class="ng-binding">Selection of teaching materials after entering the lesson room</span>
															</li><!-- end ngRepeat: class in classes -->
														</ul>
													</div>
												</div>
												
												<div class="select-category">
													<div class="main-select-header">Category: Small talk / Company dinner</div>
													<ul class="list hide" id="listall"><li class="list-item " data-eng="Presentation" data-subcategory-id="160" value="160" onclick="textbookSubCtgSelect(this)"><span>Presentation</span></li><li class="list-item selected" data-eng="Small talk / Company dinner" data-subcategory-id="161" value="161" onclick="textbookSubCtgSelect(this)"><span>Small talk / Company dinner</span></li><li class="list-item " data-eng="Interview" data-subcategory-id="162" value="162" onclick="textbookSubCtgSelect(this)"><span>Interview</span></li><li class="list-item " data-eng="At the reception" data-subcategory-id="163" value="163" onclick="textbookSubCtgSelect(this)"><span>At the reception</span></li><li class="list-item " data-eng="Responding to an order" data-subcategory-id="164" value="164" onclick="textbookSubCtgSelect(this)"><span>Responding to an order</span></li><li class="list-item " data-eng="Receiving an order" data-subcategory-id="165" value="165" onclick="textbookSubCtgSelect(this)"><span>Receiving an order</span></li><li class="list-item " data-eng="Sales talk" data-subcategory-id="166" value="166" onclick="textbookSubCtgSelect(this)"><span>Sales talk</span></li><li class="list-item " data-eng="Walk-in sales" data-subcategory-id="167" value="167" onclick="textbookSubCtgSelect(this)"><span>Walk-in sales</span></li><li class="list-item " data-eng="Training" data-subcategory-id="168" value="168" onclick="textbookSubCtgSelect(this)"><span>Training</span></li><li class="list-item " data-eng="Talk with superiors" data-subcategory-id="169" value="169" onclick="textbookSubCtgSelect(this)"><span>Talk with superiors</span></li><li class="list-item " data-eng="Talk with colleagues" data-subcategory-id="412" value="412" onclick="textbookSubCtgSelect(this)"><span>Talk with colleagues</span></li><li class="list-item " data-eng="Talk with subordinates" data-subcategory-id="423" value="423" onclick="textbookSubCtgSelect(this)"><span>Talk with subordinates</span></li><li class="list-item " data-eng="Start/End a meeting" data-subcategory-id="170" value="170" onclick="textbookSubCtgSelect(this)"><span>Start/End a meeting</span></li><li class="list-item " data-eng="Explaining in a meeting" data-subcategory-id="171" value="171" onclick="textbookSubCtgSelect(this)"><span>Explaining in a meeting</span></li><li class="list-item " data-eng="Exchanging opinions in a meeting" data-subcategory-id="172" value="172" onclick="textbookSubCtgSelect(this)"><span>Exchanging opinions in a meeting</span></li><li class="list-item " data-eng="Market analysis and evaluating improvement measure" data-subcategory-id="173" value="173" onclick="textbookSubCtgSelect(this)"><span>Market analysis and evaluating improvement measure</span></li><li class="list-item " data-eng="Overseas on-site inspection and problem solving" data-subcategory-id="174" value="174" onclick="textbookSubCtgSelect(this)"><span>Overseas on-site inspection and problem solving</span></li></ul>
												</div>
													
												<div class="select-chapter">
													<div class="main-select-header">Chapter: First meeting of project members (1)</div>
													<ul class="list hide" style=""><li class="list-item " data-tc-id="5002"><span>First meeting of project members (1)</span></li><li class="list-item " data-tc-id="5003"><span>First meeting of project members (2)</span></li><li class="list-item " data-tc-id="5004"><span>First meeting of project members (3)</span></li><li class="list-item " data-tc-id="5005"><span>Improve friendship after a meeting (1)</span></li><li class="list-item " data-tc-id="5006"><span>Improve friendship after a meeting (2)</span></li><li class="list-item selected" data-tc-id="5007"><span>Improve friendship after a meeting (3)</span></li></ul>
												</div>
											</div>
										</div>
									</dd>
									
									<!-- NJ-30011 ui_toolbars -->
									<dd class="hidden">
										<!-- dialog_clear_all  -->
										<div class="modal-window dialog hide" id="dialog_clear_all">
											<h3 class="modal-title">Do you want to delete everything? <span>※ Deleted items cannot be restored.</span></h3>
											<div class="modal-buttons">
												<a href="javascript:void(0);" class="btn-close btn_close">Cancel</a>
												<a href="javascript:void(0);" class="btn_proceed close_modal hide" id="btn_clear_all">Delete All</a>
											</div>
										</div>
										<!-- end dialog_clear_all  -->

										<div class="color-picker-modal">
											<div class="color-picker-panel">
												<div class="panel-row">
													<div class="saturation-map">
														<button id="saturation-cursor" class="color-btn color-btn--cursor"></button>
														<canvas id="saturation-canvas" height="200"></canvas>
													</div>
												</div>
												<div class="panel-row panel-row--flex panel-row--flex-start-end">
													<div class="saturation-map-icon">
														
													</div>
													<div class="saturation-mix-map">
														<button id="saturation-mix-cursor" class="color-btn color-btn--mix-cursor"></button>
														<canvas id="saturation-mix-canvas" height="16" width="100"></canvas>
													</div>
												</div>
												<div class="panel-row panel-row--flex">
													<ul class="color-picker-map">
														<li>
															<label>Hex</label>
															<input type="text" class="" id="color-picker-hex">
														</li>
														<li>
															<label>R</label>
															<input type="text" class="" id="color-picker-r">
														</li>
														<li>
															<label>G</label>
															<input type="text" class="" id="color-picker-g">
														</li>
														<li>
															<label>B</label>
															<input type="text" class="" id="color-picker-b">
														</li>
													</ul>
												</div>
												<div class="panel-row panel-row--flex panel-row--flex-end">
													<a href="javascript:void(0)" class="btn-color-picker btn-color-picker--cancel" id="btn-color-picker--cancel">Cancel</a>
													<a href="javascript:void(0)" class="btn-color-picker btn-color-picker--ok" id="btn-color-picker--ok">OK</a>
												</div>
											</div>
										</div>

									
										<div class="ui_toolbars_container disabled">
											<ul>
												<li>
													<i class="ui_toolbars_icon icon_color_picker" data-color="#FF9900"><span>Color</span>
														<div class="color_box" style="position: absolute">
															<figure><img src="/teacher/webroot/css/images/icons/colorpicker/no_color.svg" alt="none"><figcaption>None</figcaption></figure>
															<div class="color_list"></div>
															<figure><figcaption>Custom</figcaption></figure>
															<div class="color-picker-control">
																<div class="color-picker-selected" id="color-picker-selected">
																</div>
																<i class="color-picker-modal-btn"><img src="/teacher/webroot/css/images/icons/colorpicker/add.svg" alt="add"></i>
															</div>
														</div></i>
													<i class="ui_toolbars_icon icon_arrow"><span>Select</span></i>
													<i class="ui_toolbars_icon icon_pen"><span>Pen</span></i>
													<i class="ui_toolbars_icon icon_line"><span>Line Thickness</span>
														<div class="line_box">
															<span><i></i></span>
															<span><i></i></span>
															<span><i></i></span>
															<span><i></i></span>
														</div>
													</i>
													<i class="ui_toolbars_icon icon_eraser"><span>Eraser</span></i>
												</li>
												<li>
													<i class="ui_toolbars_icon icon_text"><span>Text</span></i>
													<i class="ui_toolbars_icon icon_decrease_font_size"><span>Minus</span></i>
													<i class="ui_toolbars_icon icon_font_size"><span>Size</span>
														<input type="text" class="icon_textbox_fontsize__number" value="14" min="1" readonly="">
													</i>
													<i class="ui_toolbars_icon icon_increase_font_size"><span>Plus</span></i>
													<i class="ui_toolbars_icon icon_bold_text"><span>Bold</span></i>
													<i class="ui_toolbars_icon icon_text_color_text icon_text_color"> <span>Color</span>
														<span class="text-color"></span>
														<div class="color_text_box" style="position: absolute">
															<figure><img src="/teacher/webroot/css/images/icons/colorpicker/no_color.svg" alt="none"><figcaption>None</figcaption></figure>
															<div class="color_list"></div>
															<figure><figcaption>Custom</figcaption></figure>
															<div class="color-picker-control">
																<div class="color-picker-selected" id="color-picker-selected-text-box">
																</div>
																<i class="color-picker-modal-btn-text-box"><img src="/teacher/webroot/css/images/icons/colorpicker/add.svg" alt="add"></i>
															</div>
														</div>
													</i>

												</li>
												<!-- <li>
													<i class="icon_marker"><span>Marker</span></i>
												</li> -->
												<li>
													<i class="ui_toolbars_icon icon_undo"><span>Undo</span></i>
													<i class="ui_toolbars_icon icon_redo"><span>Redo</span></i>
													<i class="ui_toolbars_icon icon_trash"><span>Erase All</span></i>
												</li>
											</ul>
										</div>
									</dd>
									<!-- NJ-30011 ui_toolbars -->
									<dd>
										<div class="hide">
											<a ng-click="updateTextbook($event)" class="btn_style btn_green size_3 btn_change_textbook" id="textbook_update_course_detail">update</a>
										</div>
									</dd>
								</dl>
								
							</div>
						</div>

						<div class="popup-container" style="width: auto; display: none;">
							<div class="popup-slide-left">
								<button id="popup-closeButton" onclick="closePopup()">x</button>
								<p id="popup-content">
									【To the teachers conducting the Level Check Lesson] Important: You MUST send a message RIGHT AWAY.Please make sure to include the student's level result when sending...</p>
							</div>
						</div>

													<a href="javascript:void(0);" class="textbook_error_report_btn" data-teacher_id="449595" data-connect_id="5002" ng-click="textbookReportInit($event)" data-cat_name="Business Course" data-chapter="Small talk / Company dinner">
								Textbook error report
							</a>
											</div>
				</td>
			</tr>
			<tr class="flex-tr-2 textbook-page-tr">
				<td class="flex-td-2-1">

					<div class="container cf">
						<div class="textbook-page-wrap">
							<div class="textbook-page-body" id="textbook_page_body">
																									<iframe connect-id="5002" class="textbook-iframe" id="textbook-iframe" html-directory="cosmopier_business" order-flag="1" src="https://nativecamp.net/teacher/HtmlTextbook/index?html_dir=cosmopier_business&amp;class_id=cosmopier_business&amp;chapter_id=1&amp;order_no=1&amp;connect_id=5002#statusbar=0&amp;toolbar=0&amp;navpanes=0&amp;timestamp=1756730251" scrolling="yes" frameborder="no"></iframe>
															</div>
						</div>
					</div><!-- // .container -->
				</td>
			</tr>
			<tr>
				<td>
					<div class="webtext_control_footer" id="webtext_control_footer">
				 		<div class="webtext_control_footer_inner" id="webtext_control_footer_inner">
					 		<div class="tb_select_area_footer area_footer_wrp">
					 				<ul class="tb_select_list_footer list_footer_wrp">
									 									 					 					<li class="footer_btn_prev prev_li_wrp disabled isDisabled" id="footer_btn_prev">
					 																	<a class="btn_fixed_prev bullet-footer-left" data-has-prev="0" data-btn-type="previous" href="javascript:void(0)" ng-click="updateTextbook($event)" data-tc-id="5001" data-html-dir="cosmopier_business" data-subcategory-id="160" data-category-id="3" data-chapter-id="79" data-textbook-id="1459">
					 							<span id="prev_label_container">Previous Chapter</span>
					 						</a>
															 					</li>
					 					<li class="center_footer_pageno mid_li_wrp">
					 						<a class="page_no" ng-click="showTextbookPageList()" data-page-no="1">1/1</a>
					 					</li>
					 					<li class="footer_btn_next next_li_wrp disabled isDisabled" id="footer_btn_next">
					 																	<a class="btn_fixed_next bullet-footer-right" data-has-next="0" data-btn-type="next" href="javascript:void(0)" ng-click="updateTextbook($event)" data-tc-id="5003" data-html-dir="cosmopier_business" data-subcategory-id="161" data-category-id="3" data-chapter-id="2" data-textbook-id="1077"> 
					 							<span id="next_label_container">Next Chapter</span>
					 						</a>
															 					</li>
					 				</ul>
					 		</div>
				 		</div>
				 	</div>
				</td>
			</tr>
		</tbody></table><!-- // .flex_table -->

	</div><!-- // .sec_textbook -->
</div>








</div><!-- // .page_contents_conteinr_inner -->
									</div><!-- // .page_contents_conteinr -->
								</div><!-- // .page_contents_row -->
							</div><!-- // page_contents_table -->
						<div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div></div><!-- // .pane  middle_left -->
						<div class="pane pane--middle_right" id="pane--middle_right" style="display: block;">
							<div class="chat_loading_area" id="chat_loading_area">
																	<div class="chat_area_table in-lesson" id="chat_area_table" style="display: flex;">
	<div class="chat_area_row--top" id="chat_area_row--top">
		<div class="chat_area_cell">
			<div class="chat_area cf" id="chat_area">
				<div class="screen_area">
					<div class="screen ui-resizable" id="screen">
						<div class="screen_inner">
							<!-- start of others video -->
							<div class="on others_video_wrap" id="others_video_wrap" style="height: 298px; width: 300px; z-index: 1;">
								<div class="avatar_video_wrap" id="avatar_video_wrap" style="display: none; position: absolute; z-index: 1; height:100%; width: 100%; background:url(/teacher/images/class/video_no_stream.png) no-repeat center center; background-size:cover;">
									<div class="video_overlay_msg">
										<div class="video_overlay_msg_inner">
											<p class="ttl fs_28 lh_15">Don't ask the student why his/her video is off.</p>
										</div>
									</div>
									<video poster="/teacher/images/class/video_no_stream.png"></video>
								</div>
								<video class="othersVideo" autoplay="" id="othersVideo" style="background-color: black;" poster="https://nativecamp-public-web-production.s3-ap-northeast-1.amazonaws.com/1688625009_64a65f7181bf8.png" src="data:video/mp4;base64,AAAAHGZ0eXBtcDQyAAAAAG1wNDJpc29"></video>
							</div>
							<!-- end of others video -->

							<!-- start of my video -->
							<div class="on own_video_wrap" id="own_video_wrap" style="width: 100px; height: 75px; z-index: 2;"><!-- if connected, add class "on" -->
								<video height="0" width="0" class="videoWrap ownVideo" id="ownVideo" style="background-color: black; width: 100%; height: 100%; left: 0%; transform: scale(1, 1);" autoplay="autoplay" poster="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" src="data:video/mp4;base64,AAAAHGZ0eXBtcDQyAAAAAG1wNDJpc29" muted="true"></video>
								<video class="videoWrap ownVideoAvatar" poster="" style="display: none; height: 100%; width: 100%;"></video>
								<canvas id="captureCanvas" width="400" height="300"></canvas>
								
								<!-- background image -->
								<canvas id="ownVideoCanvas" width="0" height="0" style="position: absolute; top: 0px; left: 0%; width: 100%; height: 100%; transform: scale(1, 1);"></canvas>
								<img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" id="back_episode_image" blur="0" style="display: none;" crossorigin="">
								
								<!-- device orientation -->
								<div class="student_device_orientation_left" style="position: absolute; top: 0px; left: 0px; height: 100%; width: 0px; background-color: black;"></div>
								<div class="student_device_orientation_right" style="position: absolute; top: 0px; right: 0px; height: 100%; width: 0px; background-color: black;"></div>

								<!-- live lesson canvas -->
								<canvas id="liveLessonImageCanvas" style="display: none;" width="960" height="540"></canvas>
							</div>
							<!-- end of my video -->
							
							<!-- if connecting -->
							<div class="video_overlay_msg lesson_connecting" id="video_overlay_msg" style="display: none; z-index: 3;">
								<div class="video_overlay_msg_inner" id="lesson_connecting">
									<p class="ttl lh_10" id="lesson_connection_state">
										<img src="/teacher/images/class/loader-connecting.gif">
									</p>
								</div>
							</div>
							<!-- endif -->

							<!-- if electing textbook -->
							<div class="video_overlay_msg selecting_textbook_message" id="video_overlay_msg" style="display: none; z-index: 3;">
								<div class="video_overlay_msg_inner" id="selecting_textbook_message">
									<p class="ttl">Student is selecting textbook…</p>
									<p class="desc t_center">
										Congratulations!!
										Student joined your room!!
										The lesson will start after the student has selected a textbook, please wait a little.
									</p>
								</div>
							</div>
							<!-- endif -->
							<div class="rec_icon" style="display: none;">
								<div class="rec_icon_circle"></div>REC
							</div>
							<!-- NJ-12690 -->
							<div class="speaking-ratio" id="speaking-ratio" style="display: block;">
								<div class="speaking-ratio-inner">
									<div class="area-label label-teacher">
										<img class="profile-image image-teacher" src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" alt="">
										<div class="teacher-ratio" id="teacher-ratio"></div>
									</div>
									<div class="area-chart">
										<ul class="speaking-ratio-chart">
											<li class="chart-item item-teacher" style="height: 50%;"></li>
											<li class="chart-item item-student" style="height: 50%;"></li>
										</ul>
										<p class="chart-label">Speaking Ratio</p>
									</div>
									<div class="area-label label-student">
										<div class="student-ratio" id="student-ratio"></div>
										<img class="profile-image image-student" src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" alt="">
									</div>
								</div>
							</div>
							<!-- /NJ-12690 -->
						</div><!-- .screen_inner END -->
					<div class="ui-resizable-handle ui-resizable-s" style="z-index: 90;"></div></div><!-- .screen END -->


					<div class="controls_area_wrap">
						<div class="controls_area">
							<ul class="controls" id="webrtc_controls">
								<li>
									<div class="btn btn-toggle btn-video btn-video_own on" id="btn-video_others"></div><!-- depending on the case, add class "disabled", "on" -->
									<div class="btn_name_wrap">
										<p class="btn_name btn_name-others side_solid">Student</p>
									</div>
									<div class="tooltip_wrap">
										<span class="tooltip">Turn your student's video on/off.</span>
									</div>
								</li>
								<li>
									<div class="btn btn-toggle btn-sound btn-sound_others on" id="btn-sound_others"></div><!-- depending on the case, add class "disabled", "on" -->
									<div class="volume_slider_wrap volume_slider_wrap-vertical">
										<div class="volume_slider_inner">
											<div class="volume_slider volume_slider-others ui-slider ui-slider-vertical ui-widget ui-widget-content ui-corner-all" id="volume_slider-others" aria-disabled="false"><div class="ui-slider-range ui-widget-header ui-corner-all ui-slider-range-min" style="height: 49.4949%;"></div><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 49.4949%;"></a></div>
										</div>
									</div>
									<div class="tooltip_wrap">
										<span class="tooltip">Toggle the audio level of your student's microphone.</span>
									</div>
								</li>
								<li>
									<div class="btn btn-toggle btn-video btn-video_own on" id="btn-video_own"></div><!-- depending on the case, add class "disabled", "on" -->
									<div class="btn_name_wrap">
										<p class="btn_name btn_name-own side_solid">You</p>
									</div>
									<div class="tooltip_wrap">
										<span class="tooltip">Turn your video on/off.</span>
									</div>
								</li>
								<li>
									<div class="btn btn-toggle btn-sound btn-sound_own on" id="btn-sound_own"></div><!-- depending on the case, add class "disabled", "on" -->
									<div class="volume_slider_wrap volume_slider_wrap-vertical">
										<div class="volume_slider_inner">
											<div class="volume_slider volume_slider-own ui-slider ui-slider-vertical ui-widget ui-widget-content ui-corner-all" id="volume_slider-own" aria-disabled="false"><div class="ui-slider-range ui-widget-header ui-corner-all ui-slider-range-min" style="height: 50%;"></div><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 50%;"></a></div>
										</div>
									</div>
									<div class="tooltip_wrap">
										<span class="tooltip">Toggle your microphone's audio level'.</span>
									</div>
								</li>
								<li>
									<div class="btn btn-swap_video" id="btn-swap_video"></div><!-- depending on the case, add class "disabled", "on" -->
									<div class="tooltip_wrap">
										<span class="tooltip">You can swap the student's video position with yours.</span>
									</div>
								</li>
								<li>
									<div class="btn btn-reflesh on" id="btn-refresh"></div><!-- depending on the case, add class "disabled", "on" -->
									<div class="btn_name_wrap">
										<p class="btn_name btn_name-refresh">Reconnect</p>
									</div>
									<div class="tooltip_wrap">
										<span class="tooltip">When your video or audio stream is unstable, click this to reload connection.</span>
									</div>
								</li>
								<li>
									<div class="btn btn-toggle btn_voice_func on" id="btn_speech_to_text_open_modal"></div>
									<div class="btn_name_wrap">
										<p class="btn_name btn_name-voice">Interpre­tation</p>
									</div>
								</li>
							</ul>
						</div><!-- // .controls_area -->
					</div><!-- // .controls_area_wrap -->
				</div><!-- // .screen_area -->
			</div>
		</div>
	</div>
			<!-- NJ-7101 -->
		<div class="chat-student-info-bar" style="display: block;">
			<div class="bar-inner">
				<div class="area-info">
					<div class="student-img">
						<img src="/user/img/no_profile_img.jpg" alt="User Photo">
					</div>
					<div class="student-name">
						<p>Test</p>
						<span class="lesson_num_w_u fs_15 fw_n hide"><span class="fs_12 fw_b">Lesson number with you :</span> <span id="newLessonHistoryCount"></span>
					</span></div>
				</div>
				<div class="area-btn">
					<a ui-sref-active="on" ng-click="goToUserProfile(lesson_student_id)" class="info-bar-btn" href="javascript:void(0);" ng-hide="(stateChanged.state.name !== 'textbook')">Student's Info</a>
					<!-- ngIf: stateChanged.state.name !== 'textbook' -->
				</div>
			</div>
		</div>
		<div class="chat_area_row chat_area_row--middle" id="chat_area_row--middle">
			<!-- testchat_area -->
			<div class="textchat_area_wrap chat_area_cell">
				<div class="textchat_area" id="textchat_area"><div class="chat_txt info_txt lesson-student-init-info" id="lesson_tutorial_textbook_message_template">
        <div class="cnt-sentence c_gray">

            <div class="desc_wrap">
                <span class="desc_title fw_b">[Requests]</span><br>
                <span class="item_name">Lesson Time</span>: <b><span class="c_blue request-lesson-time">10 minutes</span></b><br>
                <span class="item_name">Self-Introduction:</span> <span class="c_red">Need</span> <br>
                <span class="item_name">Pointing out mistakes:</span> <span class="c_red">Need</span> <br>
                <span class="item_name">Other requests:</span><br>
                <span class="request-other c_blue fw_b">I am a beginner in English and I want my pronunciation corrected. I want you to use a chatbox. I want you to speak slowly.</span>
            </div>

            <div class="desc_wrap">
                <span class="c_red"><b>[Today’s Lesson]</b></span><br>
                Name: <span class="fw_b"><b>Hiroshi</b></span><br>
                Device: <span class="c_blue"><b>PC</b></span><br>
                <p class="student-nation">Nationality: <span class="nation-text">Japan</span></p>
                <span>
                    <a href="javascript: void(0);" oncontextmenu="return false;" data-msgviewtextbook="44261" style="text-decoration: underline;" onclick="msgViewTextbookFunc($(this))">
                    [ Course or Textbook ] <span id="lt_categoryNameEng">Daily news</span><br>
                    [ Category ] <span id="lt_classNameEng">All Articles</span><br>
                    [ Chapter ] <span id="lt_chapterNameEng">How Are New Drugs Changing the Way Americans Eat?</span><br>
                    </a>
                </span>
            </div>

            <div class="desc_wrap">
                <span class="c_red"><b>[Lesson history with you]</b></span><br>
                Number of past lessons: <span class="fw_b">5</span><br>
                Previous lesson date: <span id="lt_defaultLessonDate">08/31/2025 14:37</span><br>
                <span>
                [ Course or Textbook ] <span id="lt_categoryNameEng">Daily news</span><br>
                [ Category ] <span id="lt_classNameEng">All Articles</span><br>
                [ Chapter ]  <span id="lt_chapterNameEng">How Are New Drugs Changing the Way Americans Eat?</span><br>
                </span>
                <div class="btn_chat_wrap">
                    <a href="javascript:void(0);" class="btn_chat_menu chat_translate_trigger instant_msg_translate_trigger" data-msgviewtextbook="44261"><span class="tooltip">translate</span></a>
                </div>
            </div>

        </div>
    </div><div class="chat_txt info_txt">	<div class="desc_wrap">		<span class="cnt-sentence">Teacher chose textbook Business Course Small talk / Company dinner : First meeting of project members (1)		</span>	</div></div><div class="chat_txt info_txt">	<div class="desc_wrap">		<span class="cnt-sentence">Teacher chose textbook ビジネスコース スモールトーク／会食 : プロジェクトメンバーの初顔合わせ (1)		</span>	</div></div></div>
			</div>
			<!-- // .textchate_area -->
		</div>
		<div class="im_row im_row--mid1 hide" id="im_row--mid1"></div>
		<div class="im_row im_row--mid2 hide" id="im_row--mid2"></div><!-- // .chat_area_row -->
	<div class="chat_area_row chat_area_row--bottom" id="chat_area_row--bottom">
		<div class="chat_area_cell">
			<div class="notice_voice_rec">
				<div class="img_wrap">
					<img src="https://nativecamp.net/user/webroot/images/icon/voice.webp" alt="voice" class="ic_voice">
				</div>
				<p class="fs_15 lh_15 c_white t_center m_t_15">Recognizing student's voice. <br>&nbsp;</p>
			</div><!-- // .notice_voice_rec -->
			<div id="chat_save_notif" style="position: fixed; width: inherit; margin-top: -20px; margin-left: 10px; opacity: 0.8; display: none; background:#FFFFFF;">saving...</div>
			<div class="textchat_form_wrap" id="textchat_form_wrap">
				<div class="textchat_form_inner">
					<div class="input-text-area-NEW">
						<div id="nwmsg-container">  
							<div id="nwmsg-popup"> 
								<img id="studentPic" src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" alt="Avatar">  
								<span id="msgText"> </span>
							</div> 
						</div>
						<ul class="" id="input-new">
							<li class="btn-hide correction">
								<a rel="modal" href="#dialog_correction" class="btn-correct">
									<img src="/user/images/chat/check-box.svg" alt="check box" class="ic-correct">
								</a>
							</li>
							<li class="btn-hide upload"><!-- upload -->
								<a href="javascript:void(0);" class="btn-file disabled" id="label-file">
									<img src="/user/images/chat/gallery.svg" alt="file" class="ic-file" id="gallery-change">
								</a>
							</li>
							<li>
								<span class="btn-smile" id="trigger-emoticons-box"></span>
								<div class="emoticons-box" id="emoticons-box">
	<div class="emoticons-box-inner">
		<ul class="tabs-wrap">
			<li class="tab tab-emoticons"> <a href="javascript:void(0);" class="tab-btn tab-emoticons-btn on">Emoticons</a> </li>
		</ul>
		<div class="emoticons-area">
			<div class="emoticons-list-wrap">
				<p class="emoticons-title">Frequently Used</p>
				<div class="emoticons-list emoticons-list-freq" id="emoticon-freq">
					<button type="button" class="list-item doEmotion" data-code="😀">😀</button>
					<button type="button" class="list-item doEmotion" data-code="😃">😃</button>
					<button type="button" class="list-item doEmotion" data-code="😄">😄</button>
					<button type="button" class="list-item doEmotion" data-code="😁">😁</button>
					<button type="button" class="list-item doEmotion" data-code="😆">😆</button>
					<button type="button" class="list-item doEmotion" data-code="😅">😅</button>
					<button type="button" class="list-item doEmotion" data-code="🤣">🤣</button>
					<button type="button" class="list-item doEmotion" data-code="😂">😂</button>
					<button type="button" class="list-item doEmotion" data-code="🙂">🙂</button>
					<button type="button" class="list-item doEmotion" data-code="🙃">🙃</button>
					<button type="button" class="list-item doEmotion" data-code="😉">😉</button>
					<button type="button" class="list-item doEmotion" data-code="😊">😊</button>
					<button type="button" class="list-item doEmotion" data-code="😇">😇</button>
					<button type="button" class="list-item doEmotion" data-code="🥰">🥰</button>
					<button type="button" class="list-item doEmotion" data-code="😍">😍</button>
					<button type="button" class="list-item doEmotion" data-code="🤩">🤩</button>
					<button type="button" class="list-item doEmotion" data-code="😘">😘</button>
					<button type="button" class="list-item doEmotion" data-code="😗">😗</button>
					<button type="button" class="list-item doEmotion" data-code="😚">😚</button>
					<button type="button" class="list-item doEmotion" data-code="😙">😙</button>
				</div>
			</div>
			<div class="emoticons-list-wrap">
				<p class="emoticons-title">Smileys &amp; People</p>
				<div class="emoticons-list" id="emoticon-smileys">
					<button type="button" class="list-item doEmotion" data-code="😀">😀</button>
					<button type="button" class="list-item doEmotion" data-code="😃">😃</button>
					<button type="button" class="list-item doEmotion" data-code="😄">😄</button>
					<button type="button" class="list-item doEmotion" data-code="😁">😁</button>
					<button type="button" class="list-item doEmotion" data-code="😆">😆</button>
					<button type="button" class="list-item doEmotion" data-code="😅">😅</button>
					<button type="button" class="list-item doEmotion" data-code="🤣">🤣</button>
					<button type="button" class="list-item doEmotion" data-code="😂">😂</button>
					<button type="button" class="list-item doEmotion" data-code="🙂">🙂</button>
					<button type="button" class="list-item doEmotion" data-code="🙃">🙃</button>
					<button type="button" class="list-item doEmotion" data-code="😉">😉</button>
					<button type="button" class="list-item doEmotion" data-code="😊">😊</button>
					<button type="button" class="list-item doEmotion" data-code="😇">😇</button>
					<button type="button" class="list-item doEmotion" data-code="🥰">🥰</button>
					<button type="button" class="list-item doEmotion" data-code="😍">😍</button>
					<button type="button" class="list-item doEmotion" data-code="🤩">🤩</button>
					<button type="button" class="list-item doEmotion" data-code="😘">😘</button>
					<button type="button" class="list-item doEmotion" data-code="😗">😗</button>
					<button type="button" class="list-item doEmotion" data-code="😚">😚</button>
					<button type="button" class="list-item doEmotion" data-code="😙">😙</button>
					<button type="button" class="list-item doEmotion" data-code="😋">😋</button>
					<button type="button" class="list-item doEmotion" data-code="😛">😛</button>
					<button type="button" class="list-item doEmotion" data-code="😜">😜</button>
					<button type="button" class="list-item doEmotion" data-code="🤪">🤪</button>
					<button type="button" class="list-item doEmotion" data-code="😝">😝</button>
					<button type="button" class="list-item doEmotion" data-code="🤑">🤑</button>
					<button type="button" class="list-item doEmotion" data-code="🤗">🤗</button>
					<button type="button" class="list-item doEmotion" data-code="🤭">🤭</button>
					<button type="button" class="list-item doEmotion" data-code="🤫">🤫</button>
					<button type="button" class="list-item doEmotion" data-code="🤔">🤔</button>
					<button type="button" class="list-item doEmotion" data-code="🤐">🤐</button>
					<button type="button" class="list-item doEmotion" data-code="🤨">🤨</button>
					<button type="button" class="list-item doEmotion" data-code="😐">😐</button>
					<button type="button" class="list-item doEmotion" data-code="😑">😑</button>
					<button type="button" class="list-item doEmotion" data-code="😶">😶</button>
					<button type="button" class="list-item doEmotion" data-code="😏">😏</button>
					<button type="button" class="list-item doEmotion" data-code="😒">😒</button>
					<button type="button" class="list-item doEmotion" data-code="🙄">🙄</button>
					<button type="button" class="list-item doEmotion" data-code="😬">😬</button>
					<button type="button" class="list-item doEmotion" data-code="🤥">🤥</button>
					<button type="button" class="list-item doEmotion" data-code="😌">😌</button>
					<button type="button" class="list-item doEmotion" data-code="😔">😔</button>
					<button type="button" class="list-item doEmotion" data-code="😪">😪</button>
					<button type="button" class="list-item doEmotion" data-code="🤤">🤤</button>
					<button type="button" class="list-item doEmotion" data-code="😴">😴</button>
					<button type="button" class="list-item doEmotion" data-code="😷">😷</button>
					<button type="button" class="list-item doEmotion" data-code="🤒">🤒</button>
					<button type="button" class="list-item doEmotion" data-code="🤕">🤕</button>
					<button type="button" class="list-item doEmotion" data-code="🤢">🤢</button>
					<button type="button" class="list-item doEmotion" data-code="🤮">🤮</button>
					<button type="button" class="list-item doEmotion" data-code="🤧">🤧</button>
					<button type="button" class="list-item doEmotion" data-code="🥵">🥵</button>
					<button type="button" class="list-item doEmotion" data-code="🥶">🥶</button>
					<button type="button" class="list-item doEmotion" data-code="🥴">🥴</button>
					<button type="button" class="list-item doEmotion" data-code="😵">😵</button>
					<button type="button" class="list-item doEmotion" data-code="🤯">🤯</button>
					<button type="button" class="list-item doEmotion" data-code="🤠">🤠</button>
					<button type="button" class="list-item doEmotion" data-code="🥳">🥳</button>
					<button type="button" class="list-item doEmotion" data-code="😎">😎</button>
					<button type="button" class="list-item doEmotion" data-code="🤓">🤓</button>
					<button type="button" class="list-item doEmotion" data-code="🧐">🧐</button>
					<button type="button" class="list-item doEmotion" data-code="😕">😕</button>
					<button type="button" class="list-item doEmotion" data-code="😟">😟</button>
					<button type="button" class="list-item doEmotion" data-code="🙁">🙁</button>
					<button type="button" class="list-item doEmotion" data-code="😮">😮</button>
					<button type="button" class="list-item doEmotion" data-code="😯">😯</button>
					<button type="button" class="list-item doEmotion" data-code="😲">😲</button>
					<button type="button" class="list-item doEmotion" data-code="😳">😳</button>
					<button type="button" class="list-item doEmotion" data-code="🥺">🥺</button>
					<button type="button" class="list-item doEmotion" data-code="😦">😦</button>
					<button type="button" class="list-item doEmotion" data-code="😧">😧</button>
					<button type="button" class="list-item doEmotion" data-code="😨">😨</button>
					<button type="button" class="list-item doEmotion" data-code="😰">😰</button>
					<button type="button" class="list-item doEmotion" data-code="😥">😥</button>
					<button type="button" class="list-item doEmotion" data-code="😢">😢</button>
					<button type="button" class="list-item doEmotion" data-code="😭">😭</button>
					<button type="button" class="list-item doEmotion" data-code="😱">😱</button>
					<button type="button" class="list-item doEmotion" data-code="😖">😖</button>
					<button type="button" class="list-item doEmotion" data-code="😣">😣</button>
					<button type="button" class="list-item doEmotion" data-code="😞">😞</button>
					<button type="button" class="list-item doEmotion" data-code="😓">😓</button>
					<button type="button" class="list-item doEmotion" data-code="😩">😩</button>
					<button type="button" class="list-item doEmotion" data-code="😫">😫</button>
					<button type="button" class="list-item doEmotion" data-code="🥱">🥱</button>
					<button type="button" class="list-item doEmotion" data-code="😤">😤</button>
					<button type="button" class="list-item doEmotion" data-code="😡">😡</button>
					<button type="button" class="list-item doEmotion" data-code="😠">😠</button>
					<button type="button" class="list-item doEmotion" data-code="🤬">🤬</button>
					<button type="button" class="list-item doEmotion" data-code="😈">😈</button>
					<button type="button" class="list-item doEmotion" data-code="👿">👿</button>
					<button type="button" class="list-item doEmotion" data-code="💀">💀</button>
					<button type="button" class="list-item doEmotion" data-code="💩">💩</button>
					<button type="button" class="list-item doEmotion" data-code="🤡">🤡</button>
					<button type="button" class="list-item doEmotion" data-code="👹">👹</button>
					<button type="button" class="list-item doEmotion" data-code="👺">👺</button>
					<button type="button" class="list-item doEmotion" data-code="👻">👻</button>
					<button type="button" class="list-item doEmotion" data-code="👽">👽</button>
					<button type="button" class="list-item doEmotion" data-code="👾">👾</button>
					<button type="button" class="list-item doEmotion" data-code="🤖">🤖</button>
					<button type="button" class="list-item doEmotion" data-code="😺">😺</button>
					<button type="button" class="list-item doEmotion" data-code="😸">😸</button>
					<button type="button" class="list-item doEmotion" data-code="😹">😹</button>
					<button type="button" class="list-item doEmotion" data-code="😻">😻</button>
					<button type="button" class="list-item doEmotion" data-code="😼">😼</button>
					<button type="button" class="list-item doEmotion" data-code="😽">😽</button>
					<button type="button" class="list-item doEmotion" data-code="🙀">🙀</button>
					<button type="button" class="list-item doEmotion" data-code="😿">😿</button>
					<button type="button" class="list-item doEmotion" data-code="😾">😾</button>
					<button type="button" class="list-item doEmotion" data-code="🙈">🙈</button>
					<button type="button" class="list-item doEmotion" data-code="🙉">🙉</button>
					<button type="button" class="list-item doEmotion" data-code="🙊">🙊</button>
					<button type="button" class="list-item doEmotion" data-code="💋">💋</button>
					<button type="button" class="list-item doEmotion" data-code="💌">💌</button>
					<button type="button" class="list-item doEmotion" data-code="💘">💘</button>
					<button type="button" class="list-item doEmotion" data-code="💝">💝</button>
					<button type="button" class="list-item doEmotion" data-code="💖">💖</button>
					<button type="button" class="list-item doEmotion" data-code="💗">💗</button>
					<button type="button" class="list-item doEmotion" data-code="💓">💓</button>
					<button type="button" class="list-item doEmotion" data-code="💞">💞</button>
					<button type="button" class="list-item doEmotion" data-code="💕">💕</button>
					<button type="button" class="list-item doEmotion" data-code="💟">💟</button>
					<button type="button" class="list-item doEmotion" data-code="💔">💔</button>
					<button type="button" class="list-item doEmotion" data-code="🧡">🧡</button>
					<button type="button" class="list-item doEmotion" data-code="💛">💛</button>
					<button type="button" class="list-item doEmotion" data-code="💚">💚</button>
					<button type="button" class="list-item doEmotion" data-code="💙">💙</button>
					<button type="button" class="list-item doEmotion" data-code="💜">💜</button>
					<button type="button" class="list-item doEmotion" data-code="🤎">🤎</button>
					<button type="button" class="list-item doEmotion" data-code="🖤">🖤</button>
					<button type="button" class="list-item doEmotion" data-code="🤍">🤍</button>
					<button type="button" class="list-item doEmotion" data-code="💯">💯</button>
					<button type="button" class="list-item doEmotion" data-code="💢">💢</button>
					<button type="button" class="list-item doEmotion" data-code="💥">💥</button>
					<button type="button" class="list-item doEmotion" data-code="💫">💫</button>
					<button type="button" class="list-item doEmotion" data-code="💦">💦</button>
					<button type="button" class="list-item doEmotion" data-code="💨">💨</button>
					<button type="button" class="list-item doEmotion" data-code="🕳">🕳</button>
					<button type="button" class="list-item doEmotion" data-code="💣">💣</button>
					<button type="button" class="list-item doEmotion" data-code="💬">💬</button>
					<button type="button" class="list-item doEmotion" data-code="👁">👁</button>
					<button type="button" class="list-item doEmotion" data-code="🗨">🗨</button>
					<button type="button" class="list-item doEmotion" data-code="🗯">🗯</button>
					<button type="button" class="list-item doEmotion" data-code="💭">💭</button>
					<button type="button" class="list-item doEmotion" data-code="💤">💤</button>
					<button type="button" class="list-item doEmotion" data-code="👋">👋</button>
					<button type="button" class="list-item doEmotion" data-code="🤚">🤚</button>
					<button type="button" class="list-item doEmotion" data-code="🖐">🖐</button>
					<button type="button" class="list-item doEmotion" data-code="🖖">🖖</button>
					<button type="button" class="list-item doEmotion" data-code="👌">👌</button>
					<button type="button" class="list-item doEmotion" data-code="🤏">🤏</button>
					<button type="button" class="list-item doEmotion" data-code="🤞">🤞</button>
					<button type="button" class="list-item doEmotion" data-code="🤟">🤟</button>
					<button type="button" class="list-item doEmotion" data-code="🤘">🤘</button>
					<button type="button" class="list-item doEmotion" data-code="🤙">🤙</button>
					<button type="button" class="list-item doEmotion" data-code="👈">👈</button>
					<button type="button" class="list-item doEmotion" data-code="👉">👉</button>
					<button type="button" class="list-item doEmotion" data-code="👆">👆</button>
					<button type="button" class="list-item doEmotion" data-code="🖕">🖕</button>
					<button type="button" class="list-item doEmotion" data-code="👇">👇</button>
					<button type="button" class="list-item doEmotion" data-code="👍">👍</button>
					<button type="button" class="list-item doEmotion" data-code="👎">👎</button>
					<button type="button" class="list-item doEmotion" data-code="👊">👊</button>
					<button type="button" class="list-item doEmotion" data-code="🤛">🤛</button>
					<button type="button" class="list-item doEmotion" data-code="🤜">🤜</button>
					<button type="button" class="list-item doEmotion" data-code="👏">👏</button>
					<button type="button" class="list-item doEmotion" data-code="🙌">🙌</button>
					<button type="button" class="list-item doEmotion" data-code="👐">👐</button>
					<button type="button" class="list-item doEmotion" data-code="🤲">🤲</button>
					<button type="button" class="list-item doEmotion" data-code="🤝">🤝</button>
					<button type="button" class="list-item doEmotion" data-code="🙏">🙏</button>
					<button type="button" class="list-item doEmotion" data-code="💅">💅</button>
					<button type="button" class="list-item doEmotion" data-code="🤳">🤳</button>
					<button type="button" class="list-item doEmotion" data-code="💪">💪</button>
					<button type="button" class="list-item doEmotion" data-code="🦾">🦾</button>
					<button type="button" class="list-item doEmotion" data-code="🦿">🦿</button>
					<button type="button" class="list-item doEmotion" data-code="🦵">🦵</button>
					<button type="button" class="list-item doEmotion" data-code="🦶">🦶</button>
					<button type="button" class="list-item doEmotion" data-code="👂">👂</button>
					<button type="button" class="list-item doEmotion" data-code="🦻">🦻</button>
					<button type="button" class="list-item doEmotion" data-code="👃">👃</button>
					<button type="button" class="list-item doEmotion" data-code="🧠">🧠</button>
					<button type="button" class="list-item doEmotion" data-code="🦷">🦷</button>
					<button type="button" class="list-item doEmotion" data-code="🦴">🦴</button>
					<button type="button" class="list-item doEmotion" data-code="👀">👀</button>
					<button type="button" class="list-item doEmotion" data-code="👁">👁</button>
					<button type="button" class="list-item doEmotion" data-code="👅">👅</button>
					<button type="button" class="list-item doEmotion" data-code="👄">👄</button>
					<button type="button" class="list-item doEmotion" data-code="👶">👶</button>
					<button type="button" class="list-item doEmotion" data-code="🧒">🧒</button>
					<button type="button" class="list-item doEmotion" data-code="👦">👦</button>
					<button type="button" class="list-item doEmotion" data-code="👧">👧</button>
					<button type="button" class="list-item doEmotion" data-code="🧑">🧑</button>
					<button type="button" class="list-item doEmotion" data-code="👱">👱</button>
					<button type="button" class="list-item doEmotion" data-code="👨">👨</button>
					<button type="button" class="list-item doEmotion" data-code="🧔">🧔</button>
					<button type="button" class="list-item doEmotion" data-code="👩">👩</button>
					<button type="button" class="list-item doEmotion" data-code="🧓">🧓</button>
					<button type="button" class="list-item doEmotion" data-code="👴">👴</button>
					<button type="button" class="list-item doEmotion" data-code="👵">👵</button>
					<button type="button" class="list-item doEmotion" data-code="🙍">🙍</button>
					<button type="button" class="list-item doEmotion" data-code="🙎">🙎</button>
					<button type="button" class="list-item doEmotion" data-code="🙅">🙅</button>
					<button type="button" class="list-item doEmotion" data-code="🙆">🙆</button>
					<button type="button" class="list-item doEmotion" data-code="💁">💁</button>
					<button type="button" class="list-item doEmotion" data-code="🙋">🙋</button>
					<button type="button" class="list-item doEmotion" data-code="🧏">🧏</button>
					<button type="button" class="list-item doEmotion" data-code="🙇">🙇</button>
					<button type="button" class="list-item doEmotion" data-code="🤦">🤦</button>
					<button type="button" class="list-item doEmotion" data-code="🤷">🤷</button>
					<button type="button" class="list-item doEmotion" data-code="👨">👨</button>
					<button type="button" class="list-item doEmotion" data-code="👮">👮</button>
					<button type="button" class="list-item doEmotion" data-code="🕵">🕵</button>
					<button type="button" class="list-item doEmotion" data-code="💂">💂</button>
					<button type="button" class="list-item doEmotion" data-code="👷">👷</button>
					<button type="button" class="list-item doEmotion" data-code="🤴">🤴</button>
					<button type="button" class="list-item doEmotion" data-code="👸">👸</button>
					<button type="button" class="list-item doEmotion" data-code="👳">👳</button>
					<button type="button" class="list-item doEmotion" data-code="👲">👲</button>
					<button type="button" class="list-item doEmotion" data-code="🧕">🧕</button>
					<button type="button" class="list-item doEmotion" data-code="🤵">🤵</button>
					<button type="button" class="list-item doEmotion" data-code="👰">👰</button>
					<button type="button" class="list-item doEmotion" data-code="🤰">🤰</button>
					<button type="button" class="list-item doEmotion" data-code="🤱">🤱</button>
					<button type="button" class="list-item doEmotion" data-code="👼">👼</button>
					<button type="button" class="list-item doEmotion" data-code="🎅">🎅</button>
					<button type="button" class="list-item doEmotion" data-code="🤶">🤶</button>
					<button type="button" class="list-item doEmotion" data-code="🦸">🦸</button>
					<button type="button" class="list-item doEmotion" data-code="🦹">🦹</button>
					<button type="button" class="list-item doEmotion" data-code="🧙">🧙</button>
					<button type="button" class="list-item doEmotion" data-code="🧚">🧚</button>
					<button type="button" class="list-item doEmotion" data-code="🧛">🧛</button>
					<button type="button" class="list-item doEmotion" data-code="🧜">🧜</button>
					<button type="button" class="list-item doEmotion" data-code="🧝">🧝</button>
					<button type="button" class="list-item doEmotion" data-code="🧞">🧞</button>
					<button type="button" class="list-item doEmotion" data-code="🧟">🧟</button>
					<button type="button" class="list-item doEmotion" data-code="💆">💆</button>
					<button type="button" class="list-item doEmotion" data-code="💇">💇</button>
					<button type="button" class="list-item doEmotion" data-code="🚶">🚶</button>
					<button type="button" class="list-item doEmotion" data-code="🧍">🧍</button>
					<button type="button" class="list-item doEmotion" data-code="🧎">🧎</button>
					<button type="button" class="list-item doEmotion" data-code="🏃">🏃</button>
					<button type="button" class="list-item doEmotion" data-code="💃">💃</button>
					<button type="button" class="list-item doEmotion" data-code="🕺">🕺</button>
					<button type="button" class="list-item doEmotion" data-code="🕴">🕴</button>
					<button type="button" class="list-item doEmotion" data-code="👯">👯</button>
					<button type="button" class="list-item doEmotion" data-code="🧖">🧖</button>
					<button type="button" class="list-item doEmotion" data-code="🧗">🧗</button>
					<button type="button" class="list-item doEmotion" data-code="🤺">🤺</button>
					<button type="button" class="list-item doEmotion" data-code="🏇">🏇</button>
					<button type="button" class="list-item doEmotion" data-code="🏂">🏂</button>
					<button type="button" class="list-item doEmotion" data-code="🏌">🏌</button>
					<button type="button" class="list-item doEmotion" data-code="🏄">🏄</button>
					<button type="button" class="list-item doEmotion" data-code="🚣">🚣</button>
					<button type="button" class="list-item doEmotion" data-code="🏊">🏊</button>
					<button type="button" class="list-item doEmotion" data-code="🏋">🏋</button>
					<button type="button" class="list-item doEmotion" data-code="🏋">🏋</button>
					<button type="button" class="list-item doEmotion" data-code="🚴">🚴</button>
					<button type="button" class="list-item doEmotion" data-code="🚵">🚵</button>
					<button type="button" class="list-item doEmotion" data-code="🚵">🚵</button>
					<button type="button" class="list-item doEmotion" data-code="🤸">🤸</button>
					<button type="button" class="list-item doEmotion" data-code="🤼">🤼</button>
					<button type="button" class="list-item doEmotion" data-code="🤽">🤽</button>
					<button type="button" class="list-item doEmotion" data-code="🤾">🤾</button>
					<button type="button" class="list-item doEmotion" data-code="🤹">🤹</button>
					<button type="button" class="list-item doEmotion" data-code="🧘">🧘</button>
					<button type="button" class="list-item doEmotion" data-code="🛀">🛀</button>
					<button type="button" class="list-item doEmotion" data-code="🛌">🛌</button>
					<button type="button" class="list-item doEmotion" data-code="🧑">🧑</button>
					<button type="button" class="list-item doEmotion" data-code="👭">👭</button>
					<button type="button" class="list-item doEmotion" data-code="👫">👫</button>
					<button type="button" class="list-item doEmotion" data-code="👬">👬</button>
					<button type="button" class="list-item doEmotion" data-code="💏">💏</button>
					<button type="button" class="list-item doEmotion" data-code="👩">👩</button>
					<button type="button" class="list-item doEmotion" data-code="👨">👨</button>
					<button type="button" class="list-item doEmotion" data-code="👩">👩</button>
					<button type="button" class="list-item doEmotion" data-code="💑">💑</button>
					<button type="button" class="list-item doEmotion" data-code="👩">👩</button>
					<button type="button" class="list-item doEmotion" data-code="👨">👨</button>
					<button type="button" class="list-item doEmotion" data-code="👩">👩</button>
					<button type="button" class="list-item doEmotion" data-code="👪">👪</button>
					<button type="button" class="list-item doEmotion" data-code="👨">👨</button>
					<button type="button" class="list-item doEmotion" data-code="👨">👨</button>
					<button type="button" class="list-item doEmotion" data-code="👨">👨</button>
					<button type="button" class="list-item doEmotion" data-code="👨">👨</button>
					<button type="button" class="list-item doEmotion" data-code="👨">👨</button>
					<button type="button" class="list-item doEmotion" data-code="👨">👨</button>
					<button type="button" class="list-item doEmotion" data-code="👨">👨</button>
					<button type="button" class="list-item doEmotion" data-code="👨">👨</button>
					<button type="button" class="list-item doEmotion" data-code="👨">👨</button>
					<button type="button" class="list-item doEmotion" data-code="👨">👨</button>
					<button type="button" class="list-item doEmotion" data-code="👩">👩</button>
					<button type="button" class="list-item doEmotion" data-code="👩">👩</button>
					<button type="button" class="list-item doEmotion" data-code="👩">👩</button>
					<button type="button" class="list-item doEmotion" data-code="👩">👩</button>
					<button type="button" class="list-item doEmotion" data-code="👩">👩</button>
					<button type="button" class="list-item doEmotion" data-code="👨">👨</button>
					<button type="button" class="list-item doEmotion" data-code="👨">👨</button>
					<button type="button" class="list-item doEmotion" data-code="👨">👨</button>
					<button type="button" class="list-item doEmotion" data-code="👨">👨</button>
					<button type="button" class="list-item doEmotion" data-code="👨">👨</button>
					<button type="button" class="list-item doEmotion" data-code="👩">👩</button>
					<button type="button" class="list-item doEmotion" data-code="👩">👩</button>
					<button type="button" class="list-item doEmotion" data-code="👩">👩</button>
					<button type="button" class="list-item doEmotion" data-code="👩">👩</button>
					<button type="button" class="list-item doEmotion" data-code="👩">👩</button>
				</div>
			</div>
			<div class="emoticons-list-wrap">
				<p class="emoticons-title">Animal</p>
				<div class="emoticons-list" id="emoticon-animal">
					<button type="button" class="list-item doEmotion" data-code="🐵">🐵</button>
					<button type="button" class="list-item doEmotion" data-code="🐒">🐒</button>
					<button type="button" class="list-item doEmotion" data-code="🦍">🦍</button>
					<button type="button" class="list-item doEmotion" data-code="🦧">🦧</button>
					<button type="button" class="list-item doEmotion" data-code="🐶">🐶</button>
					<button type="button" class="list-item doEmotion" data-code="🐕">🐕</button>
					<button type="button" class="list-item doEmotion" data-code="🦮">🦮</button>
					<button type="button" class="list-item doEmotion" data-code="🐩">🐩</button>
					<button type="button" class="list-item doEmotion" data-code="🐺">🐺</button>
					<button type="button" class="list-item doEmotion" data-code="🦊">🦊</button>
					<button type="button" class="list-item doEmotion" data-code="🦝">🦝</button>
					<button type="button" class="list-item doEmotion" data-code="🐱">🐱</button>
					<button type="button" class="list-item doEmotion" data-code="🐈">🐈</button>
					<button type="button" class="list-item doEmotion" data-code="🦁">🦁</button>
					<button type="button" class="list-item doEmotion" data-code="🐯">🐯</button>
					<button type="button" class="list-item doEmotion" data-code="🐅">🐅</button>
					<button type="button" class="list-item doEmotion" data-code="🐆">🐆</button>
					<button type="button" class="list-item doEmotion" data-code="🐴">🐴</button>
					<button type="button" class="list-item doEmotion" data-code="🐎">🐎</button>
					<button type="button" class="list-item doEmotion" data-code="🦄">🦄</button>
					<button type="button" class="list-item doEmotion" data-code="🦓">🦓</button>
					<button type="button" class="list-item doEmotion" data-code="🦌">🦌</button>
					<button type="button" class="list-item doEmotion" data-code="🐮">🐮</button>
					<button type="button" class="list-item doEmotion" data-code="🐂">🐂</button>
					<button type="button" class="list-item doEmotion" data-code="🐃">🐃</button>
					<button type="button" class="list-item doEmotion" data-code="🐄">🐄</button>
					<button type="button" class="list-item doEmotion" data-code="🐷">🐷</button>
					<button type="button" class="list-item doEmotion" data-code="🐖">🐖</button>
					<button type="button" class="list-item doEmotion" data-code="🐗">🐗</button>
					<button type="button" class="list-item doEmotion" data-code="🐽">🐽</button>
					<button type="button" class="list-item doEmotion" data-code="🐏">🐏</button>
					<button type="button" class="list-item doEmotion" data-code="🐑">🐑</button>
					<button type="button" class="list-item doEmotion" data-code="🐐">🐐</button>
					<button type="button" class="list-item doEmotion" data-code="🐪">🐪</button>
					<button type="button" class="list-item doEmotion" data-code="🐫">🐫</button>
					<button type="button" class="list-item doEmotion" data-code="🦙">🦙</button>
					<button type="button" class="list-item doEmotion" data-code="🦒">🦒</button>
					<button type="button" class="list-item doEmotion" data-code="🐘">🐘</button>
					<button type="button" class="list-item doEmotion" data-code="🦏">🦏</button>
					<button type="button" class="list-item doEmotion" data-code="🦛">🦛</button>
					<button type="button" class="list-item doEmotion" data-code="🐭">🐭</button>
					<button type="button" class="list-item doEmotion" data-code="🐁">🐁</button>
					<button type="button" class="list-item doEmotion" data-code="🐀">🐀</button>
					<button type="button" class="list-item doEmotion" data-code="🐹">🐹</button>
					<button type="button" class="list-item doEmotion" data-code="🐰">🐰</button>
					<button type="button" class="list-item doEmotion" data-code="🐇">🐇</button>
					<button type="button" class="list-item doEmotion" data-code="🐿">🐿</button>
					<button type="button" class="list-item doEmotion" data-code="🦔">🦔</button>
					<button type="button" class="list-item doEmotion" data-code="🦇">🦇</button>
					<button type="button" class="list-item doEmotion" data-code="🐻">🐻</button>
					<button type="button" class="list-item doEmotion" data-code="🐨">🐨</button>
					<button type="button" class="list-item doEmotion" data-code="🐼">🐼</button>
					<button type="button" class="list-item doEmotion" data-code="🦥">🦥</button>
					<button type="button" class="list-item doEmotion" data-code="🦦">🦦</button>
					<button type="button" class="list-item doEmotion" data-code="🦨">🦨</button>
					<button type="button" class="list-item doEmotion" data-code="🦘">🦘</button>
					<button type="button" class="list-item doEmotion" data-code="🦡">🦡</button>
					<button type="button" class="list-item doEmotion" data-code="🐾">🐾</button>
					<button type="button" class="list-item doEmotion" data-code="🦃">🦃</button>
					<button type="button" class="list-item doEmotion" data-code="🐔">🐔</button>
					<button type="button" class="list-item doEmotion" data-code="🐓">🐓</button>
					<button type="button" class="list-item doEmotion" data-code="🐣">🐣</button>
					<button type="button" class="list-item doEmotion" data-code="🐤">🐤</button>
					<button type="button" class="list-item doEmotion" data-code="🐥">🐥</button>
					<button type="button" class="list-item doEmotion" data-code="🐦">🐦</button>
					<button type="button" class="list-item doEmotion" data-code="🐧">🐧</button>
					<button type="button" class="list-item doEmotion" data-code="🕊">🕊</button>
					<button type="button" class="list-item doEmotion" data-code="🦅">🦅</button>
					<button type="button" class="list-item doEmotion" data-code="🦆">🦆</button>
					<button type="button" class="list-item doEmotion" data-code="🦢">🦢</button>
					<button type="button" class="list-item doEmotion" data-code="🦉">🦉</button>
					<button type="button" class="list-item doEmotion" data-code="🦩">🦩</button>
					<button type="button" class="list-item doEmotion" data-code="🦚">🦚</button>
					<button type="button" class="list-item doEmotion" data-code="🦜">🦜</button>
					<button type="button" class="list-item doEmotion" data-code="🐸">🐸</button>
					<button type="button" class="list-item doEmotion" data-code="🐊">🐊</button>
					<button type="button" class="list-item doEmotion" data-code="🐢">🐢</button>
					<button type="button" class="list-item doEmotion" data-code="🦎">🦎</button>
					<button type="button" class="list-item doEmotion" data-code="🐍">🐍</button>
					<button type="button" class="list-item doEmotion" data-code="🐲">🐲</button>
					<button type="button" class="list-item doEmotion" data-code="🐉">🐉</button>
					<button type="button" class="list-item doEmotion" data-code="🦕">🦕</button>
					<button type="button" class="list-item doEmotion" data-code="🦖">🦖</button>
					<button type="button" class="list-item doEmotion" data-code="🐳">🐳</button>
					<button type="button" class="list-item doEmotion" data-code="🐋">🐋</button>
					<button type="button" class="list-item doEmotion" data-code="🐬">🐬</button>
					<button type="button" class="list-item doEmotion" data-code="🐟">🐟</button>
					<button type="button" class="list-item doEmotion" data-code="🐠">🐠</button>
					<button type="button" class="list-item doEmotion" data-code="🐡">🐡</button>
					<button type="button" class="list-item doEmotion" data-code="🦈">🦈</button>
					<button type="button" class="list-item doEmotion" data-code="🐙">🐙</button>
					<button type="button" class="list-item doEmotion" data-code="🐚">🐚</button>
					<button type="button" class="list-item doEmotion" data-code="🐌">🐌</button>
					<button type="button" class="list-item doEmotion" data-code="🦋">🦋</button>
					<button type="button" class="list-item doEmotion" data-code="🐛">🐛</button>
					<button type="button" class="list-item doEmotion" data-code="🐜">🐜</button>
					<button type="button" class="list-item doEmotion" data-code="🐝">🐝</button>
					<button type="button" class="list-item doEmotion" data-code="🐞">🐞</button>
					<button type="button" class="list-item doEmotion" data-code="🦗">🦗</button>
					<button type="button" class="list-item doEmotion" data-code="🕷">🕷</button>
					<button type="button" class="list-item doEmotion" data-code="🕸">🕸</button>
					<button type="button" class="list-item doEmotion" data-code="🦂">🦂</button>
					<button type="button" class="list-item doEmotion" data-code="🦟">🦟</button>
					<button type="button" class="list-item doEmotion" data-code="🦠">🦠</button>
					<button type="button" class="list-item doEmotion" data-code="💐">💐</button>
					<button type="button" class="list-item doEmotion" data-code="🌸">🌸</button>
					<button type="button" class="list-item doEmotion" data-code="💮">💮</button>
					<button type="button" class="list-item doEmotion" data-code="🏵">🏵</button>
					<button type="button" class="list-item doEmotion" data-code="🌹">🌹</button>
					<button type="button" class="list-item doEmotion" data-code="🥀">🥀</button>
					<button type="button" class="list-item doEmotion" data-code="🌺">🌺</button>
					<button type="button" class="list-item doEmotion" data-code="🌻">🌻</button>
					<button type="button" class="list-item doEmotion" data-code="🌼">🌼</button>
					<button type="button" class="list-item doEmotion" data-code="🌷">🌷</button>
					<button type="button" class="list-item doEmotion" data-code="🌱">🌱</button>
					<button type="button" class="list-item doEmotion" data-code="🌲">🌲</button>
					<button type="button" class="list-item doEmotion" data-code="🌳">🌳</button>
					<button type="button" class="list-item doEmotion" data-code="🌴">🌴</button>
					<button type="button" class="list-item doEmotion" data-code="🌵">🌵</button>
					<button type="button" class="list-item doEmotion" data-code="🌾">🌾</button>
					<button type="button" class="list-item doEmotion" data-code="🌿">🌿</button>
					<button type="button" class="list-item doEmotion" data-code="🍀">🍀</button>
					<button type="button" class="list-item doEmotion" data-code="🍁">🍁</button>
					<button type="button" class="list-item doEmotion" data-code="🍂">🍂</button>
					<button type="button" class="list-item doEmotion" data-code="🍃">🍃</button>
					<button type="button" class="list-item doEmotion" data-code="🌑">🌑</button>
					<button type="button" class="list-item doEmotion" data-code="🌒">🌒</button>
					<button type="button" class="list-item doEmotion" data-code="🌓">🌓</button>
					<button type="button" class="list-item doEmotion" data-code="🌔">🌔</button>
					<button type="button" class="list-item doEmotion" data-code="🌕">🌕</button>
					<button type="button" class="list-item doEmotion" data-code="🌖">🌖</button>
					<button type="button" class="list-item doEmotion" data-code="🌗">🌗</button>
					<button type="button" class="list-item doEmotion" data-code="🌘">🌘</button>
					<button type="button" class="list-item doEmotion" data-code="🌙">🌙</button>
					<button type="button" class="list-item doEmotion" data-code="🌚">🌚</button>
					<button type="button" class="list-item doEmotion" data-code="🌛">🌛</button>
					<button type="button" class="list-item doEmotion" data-code="🌜">🌜</button>
					<button type="button" class="list-item doEmotion" data-code="🌡">🌡</button>
					<button type="button" class="list-item doEmotion" data-code="🌝">🌝</button>
					<button type="button" class="list-item doEmotion" data-code="🌞">🌞</button>
					<button type="button" class="list-item doEmotion" data-code="🪐">🪐</button>
					<button type="button" class="list-item doEmotion" data-code="🌟">🌟</button>
					<button type="button" class="list-item doEmotion" data-code="🌠">🌠</button>
					<button type="button" class="list-item doEmotion" data-code="🌌">🌌</button>
					<button type="button" class="list-item doEmotion" data-code="🌤">🌤</button>
					<button type="button" class="list-item doEmotion" data-code="🌥">🌥</button>
					<button type="button" class="list-item doEmotion" data-code="🌦">🌦</button>
					<button type="button" class="list-item doEmotion" data-code="🌧">🌧</button>
					<button type="button" class="list-item doEmotion" data-code="🌨">🌨</button>
					<button type="button" class="list-item doEmotion" data-code="🌩">🌩</button>
					<button type="button" class="list-item doEmotion" data-code="🌪">🌪</button>
					<button type="button" class="list-item doEmotion" data-code="🌫">🌫</button>
					<button type="button" class="list-item doEmotion" data-code="🌬">🌬</button>
					<button type="button" class="list-item doEmotion" data-code="🌀">🌀</button>
					<button type="button" class="list-item doEmotion" data-code="🌈">🌈</button>
					<button type="button" class="list-item doEmotion" data-code="🌂">🌂</button>
					<button type="button" class="list-item doEmotion" data-code="🔥">🔥</button>
					<button type="button" class="list-item doEmotion" data-code="💧">💧</button>
					<button type="button" class="list-item doEmotion" data-code="🌊">🌊</button>
				</div>
			</div>
			<div class="emoticons-list-wrap">
				<p class="emoticons-title">Food</p>
				<div class="emoticons-list" id="emoticon-food">
					<button type="button" class="list-item doEmotion" data-code="🍇">🍇</button>
					<button type="button" class="list-item doEmotion" data-code="🍈">🍈</button>
					<button type="button" class="list-item doEmotion" data-code="🍉">🍉</button>
					<button type="button" class="list-item doEmotion" data-code="🍊">🍊</button>
					<button type="button" class="list-item doEmotion" data-code="🍋">🍋</button>
					<button type="button" class="list-item doEmotion" data-code="🍌">🍌</button>
					<button type="button" class="list-item doEmotion" data-code="🍍">🍍</button>
					<button type="button" class="list-item doEmotion" data-code="🥭">🥭</button>
					<button type="button" class="list-item doEmotion" data-code="🍎">🍎</button>
					<button type="button" class="list-item doEmotion" data-code="🍏">🍏</button>
					<button type="button" class="list-item doEmotion" data-code="🍐">🍐</button>
					<button type="button" class="list-item doEmotion" data-code="🍑">🍑</button>
					<button type="button" class="list-item doEmotion" data-code="🍒">🍒</button>
					<button type="button" class="list-item doEmotion" data-code="🍓">🍓</button>
					<button type="button" class="list-item doEmotion" data-code="🥝">🥝</button>
					<button type="button" class="list-item doEmotion" data-code="🍅">🍅</button>
					<button type="button" class="list-item doEmotion" data-code="🥥">🥥</button>
					<button type="button" class="list-item doEmotion" data-code="🥑">🥑</button>
					<button type="button" class="list-item doEmotion" data-code="🍆">🍆</button>
					<button type="button" class="list-item doEmotion" data-code="🥔">🥔</button>
					<button type="button" class="list-item doEmotion" data-code="🥕">🥕</button>
					<button type="button" class="list-item doEmotion" data-code="🌽">🌽</button>
					<button type="button" class="list-item doEmotion" data-code="🌶">🌶</button>
					<button type="button" class="list-item doEmotion" data-code="🥒">🥒</button>
					<button type="button" class="list-item doEmotion" data-code="🥬">🥬</button>
					<button type="button" class="list-item doEmotion" data-code="🥦">🥦</button>
					<button type="button" class="list-item doEmotion" data-code="🧄">🧄</button>
					<button type="button" class="list-item doEmotion" data-code="🧅">🧅</button>
					<button type="button" class="list-item doEmotion" data-code="🍄">🍄</button>
					<button type="button" class="list-item doEmotion" data-code="🥜">🥜</button>
					<button type="button" class="list-item doEmotion" data-code="🌰">🌰</button>
					<button type="button" class="list-item doEmotion" data-code="🍞">🍞</button>
					<button type="button" class="list-item doEmotion" data-code="🥐">🥐</button>
					<button type="button" class="list-item doEmotion" data-code="🥖">🥖</button>
					<button type="button" class="list-item doEmotion" data-code="🥨">🥨</button>
					<button type="button" class="list-item doEmotion" data-code="🥯">🥯</button>
					<button type="button" class="list-item doEmotion" data-code="🥞">🥞</button>
					<button type="button" class="list-item doEmotion" data-code="🧇">🧇</button>
					<button type="button" class="list-item doEmotion" data-code="🧀">🧀</button>
					<button type="button" class="list-item doEmotion" data-code="🍖">🍖</button>
					<button type="button" class="list-item doEmotion" data-code="🍗">🍗</button>
					<button type="button" class="list-item doEmotion" data-code="🥩">🥩</button>
					<button type="button" class="list-item doEmotion" data-code="🥓">🥓</button>
					<button type="button" class="list-item doEmotion" data-code="🍔">🍔</button>
					<button type="button" class="list-item doEmotion" data-code="🍟">🍟</button>
					<button type="button" class="list-item doEmotion" data-code="🍕">🍕</button>
					<button type="button" class="list-item doEmotion" data-code="🌭">🌭</button>
					<button type="button" class="list-item doEmotion" data-code="🥪">🥪</button>
					<button type="button" class="list-item doEmotion" data-code="🌮">🌮</button>
					<button type="button" class="list-item doEmotion" data-code="🌯">🌯</button>
					<button type="button" class="list-item doEmotion" data-code="🥙">🥙</button>
					<button type="button" class="list-item doEmotion" data-code="🧆">🧆</button>
					<button type="button" class="list-item doEmotion" data-code="🥚">🥚</button>
					<button type="button" class="list-item doEmotion" data-code="🍳">🍳</button>
					<button type="button" class="list-item doEmotion" data-code="🥘">🥘</button>
					<button type="button" class="list-item doEmotion" data-code="🍲">🍲</button>
					<button type="button" class="list-item doEmotion" data-code="🥣">🥣</button>
					<button type="button" class="list-item doEmotion" data-code="🥗">🥗</button>
					<button type="button" class="list-item doEmotion" data-code="🍿">🍿</button>
					<button type="button" class="list-item doEmotion" data-code="🧈">🧈</button>
					<button type="button" class="list-item doEmotion" data-code="🧂">🧂</button>
					<button type="button" class="list-item doEmotion" data-code="🥫">🥫</button>
					<button type="button" class="list-item doEmotion" data-code="🍱">🍱</button>
					<button type="button" class="list-item doEmotion" data-code="🍘">🍘</button>
					<button type="button" class="list-item doEmotion" data-code="🍙">🍙</button>
					<button type="button" class="list-item doEmotion" data-code="🍚">🍚</button>
					<button type="button" class="list-item doEmotion" data-code="🍛">🍛</button>
					<button type="button" class="list-item doEmotion" data-code="🍜">🍜</button>
					<button type="button" class="list-item doEmotion" data-code="🍝">🍝</button>
					<button type="button" class="list-item doEmotion" data-code="🍠">🍠</button>
					<button type="button" class="list-item doEmotion" data-code="🍢">🍢</button>
					<button type="button" class="list-item doEmotion" data-code="🍣">🍣</button>
					<button type="button" class="list-item doEmotion" data-code="🍤">🍤</button>
					<button type="button" class="list-item doEmotion" data-code="🍥">🍥</button>
					<button type="button" class="list-item doEmotion" data-code="🥮">🥮</button>
					<button type="button" class="list-item doEmotion" data-code="🍡">🍡</button>
					<button type="button" class="list-item doEmotion" data-code="🥟">🥟</button>
					<button type="button" class="list-item doEmotion" data-code="🥠">🥠</button>
					<button type="button" class="list-item doEmotion" data-code="🥡">🥡</button>
					<button type="button" class="list-item doEmotion" data-code="🦀">🦀</button>
					<button type="button" class="list-item doEmotion" data-code="🦞">🦞</button>
					<button type="button" class="list-item doEmotion" data-code="🦐">🦐</button>
					<button type="button" class="list-item doEmotion" data-code="🦑">🦑</button>
					<button type="button" class="list-item doEmotion" data-code="🦪">🦪</button>
					<button type="button" class="list-item doEmotion" data-code="🍦">🍦</button>
					<button type="button" class="list-item doEmotion" data-code="🍧">🍧</button>
					<button type="button" class="list-item doEmotion" data-code="🍨">🍨</button>
					<button type="button" class="list-item doEmotion" data-code="🍩">🍩</button>
					<button type="button" class="list-item doEmotion" data-code="🍪">🍪</button>
					<button type="button" class="list-item doEmotion" data-code="🎂">🎂</button>
					<button type="button" class="list-item doEmotion" data-code="🍰">🍰</button>
					<button type="button" class="list-item doEmotion" data-code="🧁">🧁</button>
					<button type="button" class="list-item doEmotion" data-code="🥧">🥧</button>
					<button type="button" class="list-item doEmotion" data-code="🍫">🍫</button>
					<button type="button" class="list-item doEmotion" data-code="🍬">🍬</button>
					<button type="button" class="list-item doEmotion" data-code="🍭">🍭</button>
					<button type="button" class="list-item doEmotion" data-code="🍮">🍮</button>
					<button type="button" class="list-item doEmotion" data-code="🍯">🍯</button>
					<button type="button" class="list-item doEmotion" data-code="🍼">🍼</button>
					<button type="button" class="list-item doEmotion" data-code="🥛">🥛</button>
					<button type="button" class="list-item doEmotion" data-code="☕">☕</button>
					<button type="button" class="list-item doEmotion" data-code="🍵">🍵</button>
					<button type="button" class="list-item doEmotion" data-code="🍶">🍶</button>
					<button type="button" class="list-item doEmotion" data-code="🍾">🍾</button>
					<button type="button" class="list-item doEmotion" data-code="🍷">🍷</button>
					<button type="button" class="list-item doEmotion" data-code="🍸">🍸</button>
					<button type="button" class="list-item doEmotion" data-code="🍹">🍹</button>
					<button type="button" class="list-item doEmotion" data-code="🍺">🍺</button>
					<button type="button" class="list-item doEmotion" data-code="🍻">🍻</button>
					<button type="button" class="list-item doEmotion" data-code="🥂">🥂</button>
					<button type="button" class="list-item doEmotion" data-code="🥃">🥃</button>
					<button type="button" class="list-item doEmotion" data-code="🥤">🥤</button>
					<button type="button" class="list-item doEmotion" data-code="🧃">🧃</button>
					<button type="button" class="list-item doEmotion" data-code="🧉">🧉</button>
					<button type="button" class="list-item doEmotion" data-code="🧊">🧊</button>
					<button type="button" class="list-item doEmotion" data-code="🥢">🥢</button>
					<button type="button" class="list-item doEmotion" data-code="🍽">🍽</button>
					<button type="button" class="list-item doEmotion" data-code="🍴">🍴</button>
					<button type="button" class="list-item doEmotion" data-code="🥄">🥄</button>
					<button type="button" class="list-item doEmotion" data-code="🔪">🔪</button>
					<button type="button" class="list-item doEmotion" data-code="🏺">🏺</button>
				</div>
			</div>
			<div class="emoticons-list-wrap">
				<p class="emoticons-title">Sport</p>
				<div class="emoticons-list" id="emoticon-sport">
					<button type="button" class="list-item doEmotion" data-code="🥎">🥎</button>
					<button type="button" class="list-item doEmotion" data-code="🏀">🏀</button>
					<button type="button" class="list-item doEmotion" data-code="🏐">🏐</button>
					<button type="button" class="list-item doEmotion" data-code="🏈">🏈</button>
					<button type="button" class="list-item doEmotion" data-code="🏉">🏉</button>
					<button type="button" class="list-item doEmotion" data-code="🎾">🎾</button>
					<button type="button" class="list-item doEmotion" data-code="🥏">🥏</button>
					<button type="button" class="list-item doEmotion" data-code="🎳">🎳</button>
					<button type="button" class="list-item doEmotion" data-code="🏏">🏏</button>
					<button type="button" class="list-item doEmotion" data-code="🏑">🏑</button>
					<button type="button" class="list-item doEmotion" data-code="🏒">🏒</button>
					<button type="button" class="list-item doEmotion" data-code="🥍">🥍</button>
					<button type="button" class="list-item doEmotion" data-code="🏓">🏓</button>
					<button type="button" class="list-item doEmotion" data-code="🏸">🏸</button>
					<button type="button" class="list-item doEmotion" data-code="🥊">🥊</button>
					<button type="button" class="list-item doEmotion" data-code="🥋">🥋</button>
					<button type="button" class="list-item doEmotion" data-code="🥅">🥅</button>
					<button type="button" class="list-item doEmotion" data-code="🎣">🎣</button>
					<button type="button" class="list-item doEmotion" data-code="🤿">🤿</button>
					<button type="button" class="list-item doEmotion" data-code="🎽">🎽</button>
					<button type="button" class="list-item doEmotion" data-code="🎿">🎿</button>
					<button type="button" class="list-item doEmotion" data-code="🛷">🛷</button>
					<button type="button" class="list-item doEmotion" data-code="🥌">🥌</button>
					<button type="button" class="list-item doEmotion" data-code="🎖">🎖</button>
					<button type="button" class="list-item doEmotion" data-code="🏆">🏆</button>
					<button type="button" class="list-item doEmotion" data-code="🏅">🏅</button>
					<button type="button" class="list-item doEmotion" data-code="🥇">🥇</button>
					<button type="button" class="list-item doEmotion" data-code="🥈">🥈</button>
					<button type="button" class="list-item doEmotion" data-code="🥉">🥉</button>
				</div>
			</div>
			<div class="emoticons-list-wrap">
				<p class="emoticons-title">Crafts</p>
				<div class="emoticons-list" id="emoticon-crafts">
					<button type="button" class="list-item doEmotion" data-code="🎃">🎃</button>
					<button type="button" class="list-item doEmotion" data-code="🎄">🎄</button>
					<button type="button" class="list-item doEmotion" data-code="🎆">🎆</button>
					<button type="button" class="list-item doEmotion" data-code="🎇">🎇</button>
					<button type="button" class="list-item doEmotion" data-code="🧨">🧨</button>
					<button type="button" class="list-item doEmotion" data-code="🎈">🎈</button>
					<button type="button" class="list-item doEmotion" data-code="🎉">🎉</button>
					<button type="button" class="list-item doEmotion" data-code="🎊">🎊</button>
					<button type="button" class="list-item doEmotion" data-code="🎋">🎋</button>
					<button type="button" class="list-item doEmotion" data-code="🎍">🎍</button>
					<button type="button" class="list-item doEmotion" data-code="🎎">🎎</button>
					<button type="button" class="list-item doEmotion" data-code="🎏">🎏</button>
					<button type="button" class="list-item doEmotion" data-code="🎐">🎐</button>
					<button type="button" class="list-item doEmotion" data-code="🎑">🎑</button>
					<button type="button" class="list-item doEmotion" data-code="🧧">🧧</button>
					<button type="button" class="list-item doEmotion" data-code="🎀">🎀</button>
					<button type="button" class="list-item doEmotion" data-code="🎁">🎁</button>
					<button type="button" class="list-item doEmotion" data-code="🎗">🎗</button>
					<button type="button" class="list-item doEmotion" data-code="🎟">🎟</button>
					<button type="button" class="list-item doEmotion" data-code="🎫">🎫</button>
					<button type="button" class="list-item doEmotion" data-code="🎯">🎯</button>
					<button type="button" class="list-item doEmotion" data-code="🪀">🪀</button>
					<button type="button" class="list-item doEmotion" data-code="🪁">🪁</button>
					<button type="button" class="list-item doEmotion" data-code="🎱">🎱</button>
					<button type="button" class="list-item doEmotion" data-code="🔮">🔮</button>
					<button type="button" class="list-item doEmotion" data-code="🧿">🧿</button>
					<button type="button" class="list-item doEmotion" data-code="🎮">🎮</button>
					<button type="button" class="list-item doEmotion" data-code="🕹">🕹</button>
					<button type="button" class="list-item doEmotion" data-code="🎰">🎰</button>
					<button type="button" class="list-item doEmotion" data-code="🎲">🎲</button>
					<button type="button" class="list-item doEmotion" data-code="🧩">🧩</button>
					<button type="button" class="list-item doEmotion" data-code="🧸">🧸</button>
					<button type="button" class="list-item doEmotion" data-code="🃏">🃏</button>
					<button type="button" class="list-item doEmotion" data-code="🀄">🀄</button>
					<button type="button" class="list-item doEmotion" data-code="🎴">🎴</button>
					<button type="button" class="list-item doEmotion" data-code="🎭">🎭</button>
					<button type="button" class="list-item doEmotion" data-code="🖼">🖼</button>
					<button type="button" class="list-item doEmotion" data-code="🎨">🎨</button>
					<button type="button" class="list-item doEmotion" data-code="🧵">🧵</button>
					<button type="button" class="list-item doEmotion" data-code="🧶">🧶</button>
					<button type="button" class="list-item doEmotion" data-code="👓">👓</button>
					<button type="button" class="list-item doEmotion" data-code="🕶">🕶</button>
					<button type="button" class="list-item doEmotion" data-code="🥽">🥽</button>
					<button type="button" class="list-item doEmotion" data-code="🥼">🥼</button>
					<button type="button" class="list-item doEmotion" data-code="🦺">🦺</button>
					<button type="button" class="list-item doEmotion" data-code="👔">👔</button>
					<button type="button" class="list-item doEmotion" data-code="👕">👕</button>
					<button type="button" class="list-item doEmotion" data-code="👖">👖</button>
					<button type="button" class="list-item doEmotion" data-code="🧣">🧣</button>
					<button type="button" class="list-item doEmotion" data-code="🧤">🧤</button>
					<button type="button" class="list-item doEmotion" data-code="🧥">🧥</button>
					<button type="button" class="list-item doEmotion" data-code="🧦">🧦</button>
					<button type="button" class="list-item doEmotion" data-code="👗">👗</button>
					<button type="button" class="list-item doEmotion" data-code="👘">👘</button>
					<button type="button" class="list-item doEmotion" data-code="🥻">🥻</button>
					<button type="button" class="list-item doEmotion" data-code="🩱">🩱</button>
					<button type="button" class="list-item doEmotion" data-code="🩲">🩲</button>
					<button type="button" class="list-item doEmotion" data-code="🩳">🩳</button>
					<button type="button" class="list-item doEmotion" data-code="👙">👙</button>
					<button type="button" class="list-item doEmotion" data-code="👚">👚</button>
					<button type="button" class="list-item doEmotion" data-code="👛">👛</button>
					<button type="button" class="list-item doEmotion" data-code="👜">👜</button>
					<button type="button" class="list-item doEmotion" data-code="👝">👝</button>
					<button type="button" class="list-item doEmotion" data-code="🛍">🛍</button>
					<button type="button" class="list-item doEmotion" data-code="🎒">🎒</button>
					<button type="button" class="list-item doEmotion" data-code="👞">👞</button>
					<button type="button" class="list-item doEmotion" data-code="👟">👟</button>
					<button type="button" class="list-item doEmotion" data-code="🥾">🥾</button>
					<button type="button" class="list-item doEmotion" data-code="🥿">🥿</button>
					<button type="button" class="list-item doEmotion" data-code="👠">👠</button>
					<button type="button" class="list-item doEmotion" data-code="👡">👡</button>
					<button type="button" class="list-item doEmotion" data-code="🩰">🩰</button>
					<button type="button" class="list-item doEmotion" data-code="👢">👢</button>
					<button type="button" class="list-item doEmotion" data-code="👑">👑</button>
					<button type="button" class="list-item doEmotion" data-code="👒">👒</button>
					<button type="button" class="list-item doEmotion" data-code="🎩">🎩</button>
					<button type="button" class="list-item doEmotion" data-code="🎓">🎓</button>
					<button type="button" class="list-item doEmotion" data-code="🧢">🧢</button>
					<button type="button" class="list-item doEmotion" data-code="📿">📿</button>
					<button type="button" class="list-item doEmotion" data-code="💄">💄</button>
					<button type="button" class="list-item doEmotion" data-code="💍">💍</button>
					<button type="button" class="list-item doEmotion" data-code="💎">💎</button>
					<button type="button" class="list-item doEmotion" data-code="📱">📱</button>
					<button type="button" class="list-item doEmotion" data-code="📲">📲</button>
					<button type="button" class="list-item doEmotion" data-code="📞">📞</button>
					<button type="button" class="list-item doEmotion" data-code="📟">📟</button>
					<button type="button" class="list-item doEmotion" data-code="📠">📠</button>
					<button type="button" class="list-item doEmotion" data-code="🔋">🔋</button>
					<button type="button" class="list-item doEmotion" data-code="🔌">🔌</button>
					<button type="button" class="list-item doEmotion" data-code="💻">💻</button>
					<button type="button" class="list-item doEmotion" data-code="🖥">🖥</button>
					<button type="button" class="list-item doEmotion" data-code="🖨">🖨</button>
					<button type="button" class="list-item doEmotion" data-code="🖱">🖱</button>
					<button type="button" class="list-item doEmotion" data-code="🖲">🖲</button>
					<button type="button" class="list-item doEmotion" data-code="💽">💽</button>
					<button type="button" class="list-item doEmotion" data-code="💾">💾</button>
					<button type="button" class="list-item doEmotion" data-code="💿">💿</button>
					<button type="button" class="list-item doEmotion" data-code="📀">📀</button>
					<button type="button" class="list-item doEmotion" data-code="🧮">🧮</button>
					<button type="button" class="list-item doEmotion" data-code="🎥">🎥</button>
					<button type="button" class="list-item doEmotion" data-code="🎞">🎞</button>
					<button type="button" class="list-item doEmotion" data-code="📽">📽</button>
					<button type="button" class="list-item doEmotion" data-code="🎬">🎬</button>
					<button type="button" class="list-item doEmotion" data-code="📺">📺</button>
					<button type="button" class="list-item doEmotion" data-code="📷">📷</button>
					<button type="button" class="list-item doEmotion" data-code="📸">📸</button>
					<button type="button" class="list-item doEmotion" data-code="📹">📹</button>
					<button type="button" class="list-item doEmotion" data-code="📼">📼</button>
					<button type="button" class="list-item doEmotion" data-code="🔍">🔍</button>
					<button type="button" class="list-item doEmotion" data-code="🔎">🔎</button>
					<button type="button" class="list-item doEmotion" data-code="🕯">🕯</button>
					<button type="button" class="list-item doEmotion" data-code="💡">💡</button>
					<button type="button" class="list-item doEmotion" data-code="🔦">🔦</button>
					<button type="button" class="list-item doEmotion" data-code="🏮">🏮</button>
					<button type="button" class="list-item doEmotion" data-code="🪔">🪔</button>
					<button type="button" class="list-item doEmotion" data-code="📔">📔</button>
					<button type="button" class="list-item doEmotion" data-code="📕">📕</button>
					<button type="button" class="list-item doEmotion" data-code="📖">📖</button>
					<button type="button" class="list-item doEmotion" data-code="📗">📗</button>
					<button type="button" class="list-item doEmotion" data-code="📘">📘</button>
					<button type="button" class="list-item doEmotion" data-code="📙">📙</button>
					<button type="button" class="list-item doEmotion" data-code="📚">📚</button>
					<button type="button" class="list-item doEmotion" data-code="📓">📓</button>
					<button type="button" class="list-item doEmotion" data-code="📒">📒</button>
					<button type="button" class="list-item doEmotion" data-code="📃">📃</button>
					<button type="button" class="list-item doEmotion" data-code="📜">📜</button>
					<button type="button" class="list-item doEmotion" data-code="📄">📄</button>
					<button type="button" class="list-item doEmotion" data-code="📰">📰</button>
					<button type="button" class="list-item doEmotion" data-code="🗞">🗞</button>
					<button type="button" class="list-item doEmotion" data-code="📑">📑</button>
					<button type="button" class="list-item doEmotion" data-code="🔖">🔖</button>
					<button type="button" class="list-item doEmotion" data-code="🏷">🏷</button>
					<button type="button" class="list-item doEmotion" data-code="💰">💰</button>
					<button type="button" class="list-item doEmotion" data-code="💴">💴</button>
					<button type="button" class="list-item doEmotion" data-code="💵">💵</button>
					<button type="button" class="list-item doEmotion" data-code="💶">💶</button>
					<button type="button" class="list-item doEmotion" data-code="💷">💷</button>
					<button type="button" class="list-item doEmotion" data-code="💸">💸</button>
					<button type="button" class="list-item doEmotion" data-code="💳">💳</button>
					<button type="button" class="list-item doEmotion" data-code="🧾">🧾</button>
					<button type="button" class="list-item doEmotion" data-code="💹">💹</button>
					<button type="button" class="list-item doEmotion" data-code="💱">💱</button>
					<button type="button" class="list-item doEmotion" data-code="💲">💲</button>
					<button type="button" class="list-item doEmotion" data-code="📧">📧</button>
					<button type="button" class="list-item doEmotion" data-code="📨">📨</button>
					<button type="button" class="list-item doEmotion" data-code="📩">📩</button>
					<button type="button" class="list-item doEmotion" data-code="📤">📤</button>
					<button type="button" class="list-item doEmotion" data-code="📥">📥</button>
					<button type="button" class="list-item doEmotion" data-code="📦">📦</button>
					<button type="button" class="list-item doEmotion" data-code="📫">📫</button>
					<button type="button" class="list-item doEmotion" data-code="📪">📪</button>
					<button type="button" class="list-item doEmotion" data-code="📬">📬</button>
					<button type="button" class="list-item doEmotion" data-code="📭">📭</button>
					<button type="button" class="list-item doEmotion" data-code="📮">📮</button>
					<button type="button" class="list-item doEmotion" data-code="🗳">🗳</button>
					<button type="button" class="list-item doEmotion" data-code="💼">💼</button>
					<button type="button" class="list-item doEmotion" data-code="📁">📁</button>
					<button type="button" class="list-item doEmotion" data-code="📂">📂</button>
					<button type="button" class="list-item doEmotion" data-code="🗂">🗂</button>
					<button type="button" class="list-item doEmotion" data-code="📅">📅</button>
					<button type="button" class="list-item doEmotion" data-code="📆">📆</button>
					<button type="button" class="list-item doEmotion" data-code="🗒">🗒</button>
					<button type="button" class="list-item doEmotion" data-code="🗓">🗓</button>
					<button type="button" class="list-item doEmotion" data-code="📇">📇</button>
					<button type="button" class="list-item doEmotion" data-code="📈">📈</button>
					<button type="button" class="list-item doEmotion" data-code="📉">📉</button>
					<button type="button" class="list-item doEmotion" data-code="📊">📊</button>
					<button type="button" class="list-item doEmotion" data-code="📋">📋</button>
					<button type="button" class="list-item doEmotion" data-code="📌">📌</button>
					<button type="button" class="list-item doEmotion" data-code="📍">📍</button>
					<button type="button" class="list-item doEmotion" data-code="📎">📎</button>
					<button type="button" class="list-item doEmotion" data-code="🖇">🖇</button>
					<button type="button" class="list-item doEmotion" data-code="📏">📏</button>
					<button type="button" class="list-item doEmotion" data-code="📐">📐</button>
					<button type="button" class="list-item doEmotion" data-code="🗃">🗃</button>
					<button type="button" class="list-item doEmotion" data-code="🗄">🗄</button>
					<button type="button" class="list-item doEmotion" data-code="🗑">🗑</button>
					<button type="button" class="list-item doEmotion" data-code="🔒">🔒</button>
					<button type="button" class="list-item doEmotion" data-code="🔓">🔓</button>
					<button type="button" class="list-item doEmotion" data-code="🔏">🔏</button>
					<button type="button" class="list-item doEmotion" data-code="🔐">🔐</button>
					<button type="button" class="list-item doEmotion" data-code="🔑">🔑</button>
					<button type="button" class="list-item doEmotion" data-code="🗝">🗝</button>
					<button type="button" class="list-item doEmotion" data-code="🔨">🔨</button>
					<button type="button" class="list-item doEmotion" data-code="🪓">🪓</button>
					<button type="button" class="list-item doEmotion" data-code="🛠">🛠</button>
					<button type="button" class="list-item doEmotion" data-code="🗡">🗡</button>
					<button type="button" class="list-item doEmotion" data-code="🔫">🔫</button>
					<button type="button" class="list-item doEmotion" data-code="🏹">🏹</button>
					<button type="button" class="list-item doEmotion" data-code="🛡">🛡</button>
					<button type="button" class="list-item doEmotion" data-code="🔧">🔧</button>
					<button type="button" class="list-item doEmotion" data-code="🔩">🔩</button>
					<button type="button" class="list-item doEmotion" data-code="🗜">🗜</button>
					<button type="button" class="list-item doEmotion" data-code="🦯">🦯</button>
					<button type="button" class="list-item doEmotion" data-code="🔗">🔗</button>
					<button type="button" class="list-item doEmotion" data-code="🧰">🧰</button>
					<button type="button" class="list-item doEmotion" data-code="🧲">🧲</button>
					<button type="button" class="list-item doEmotion" data-code="🧪">🧪</button>
					<button type="button" class="list-item doEmotion" data-code="🧫">🧫</button>
					<button type="button" class="list-item doEmotion" data-code="🧬">🧬</button>
					<button type="button" class="list-item doEmotion" data-code="🔬">🔬</button>
					<button type="button" class="list-item doEmotion" data-code="🔭">🔭</button>
					<button type="button" class="list-item doEmotion" data-code="📡">📡</button>
					<button type="button" class="list-item doEmotion" data-code="💉">💉</button>
					<button type="button" class="list-item doEmotion" data-code="🩸">🩸</button>
					<button type="button" class="list-item doEmotion" data-code="💊">💊</button>
					<button type="button" class="list-item doEmotion" data-code="🩹">🩹</button>
					<button type="button" class="list-item doEmotion" data-code="🩺">🩺</button>
					<button type="button" class="list-item doEmotion" data-code="🚪">🚪</button>
					<button type="button" class="list-item doEmotion" data-code="🛏">🛏</button>
					<button type="button" class="list-item doEmotion" data-code="🛋">🛋</button>
					<button type="button" class="list-item doEmotion" data-code="🪑">🪑</button>
					<button type="button" class="list-item doEmotion" data-code="🚽">🚽</button>
					<button type="button" class="list-item doEmotion" data-code="🚿">🚿</button>
					<button type="button" class="list-item doEmotion" data-code="🛁">🛁</button>
					<button type="button" class="list-item doEmotion" data-code="🪒">🪒</button>
					<button type="button" class="list-item doEmotion" data-code="🧴">🧴</button>
					<button type="button" class="list-item doEmotion" data-code="🧷">🧷</button>
					<button type="button" class="list-item doEmotion" data-code="🧹">🧹</button>
					<button type="button" class="list-item doEmotion" data-code="🧺">🧺</button>
					<button type="button" class="list-item doEmotion" data-code="🧻">🧻</button>
					<button type="button" class="list-item doEmotion" data-code="🧼">🧼</button>
					<button type="button" class="list-item doEmotion" data-code="🧽">🧽</button>
					<button type="button" class="list-item doEmotion" data-code="🧯">🧯</button>
					<button type="button" class="list-item doEmotion" data-code="🛒">🛒</button>
					<button type="button" class="list-item doEmotion" data-code="🚬">🚬</button>
					<button type="button" class="list-item doEmotion" data-code="🗿">🗿</button>
				</div>
			</div>
			<div class="emoticons-list-wrap">
				<p class="emoticons-title">Travel &amp; Location</p>
				<div class="emoticons-list" id="emoticon-sport">
					<button type="button" class="list-item doEmotion" data-code="🏟">🏟</button>
					<button type="button" class="list-item doEmotion" data-code="🏛">🏛</button>
					<button type="button" class="list-item doEmotion" data-code="🏗">🏗</button>
					<button type="button" class="list-item doEmotion" data-code="🧱">🧱</button>
					<button type="button" class="list-item doEmotion" data-code="🏘">🏘</button>
					<button type="button" class="list-item doEmotion" data-code="🏚">🏚</button>
					<button type="button" class="list-item doEmotion" data-code="🏠">🏠</button>
					<button type="button" class="list-item doEmotion" data-code="🏡">🏡</button>
					<button type="button" class="list-item doEmotion" data-code="🏢">🏢</button>
					<button type="button" class="list-item doEmotion" data-code="🏣">🏣</button>
					<button type="button" class="list-item doEmotion" data-code="🏤">🏤</button>
					<button type="button" class="list-item doEmotion" data-code="🏥">🏥</button>
					<button type="button" class="list-item doEmotion" data-code="🏦">🏦</button>
					<button type="button" class="list-item doEmotion" data-code="🏨">🏨</button>
					<button type="button" class="list-item doEmotion" data-code="🏩">🏩</button>
					<button type="button" class="list-item doEmotion" data-code="🏪">🏪</button>
					<button type="button" class="list-item doEmotion" data-code="🏫">🏫</button>
					<button type="button" class="list-item doEmotion" data-code="🏬">🏬</button>
					<button type="button" class="list-item doEmotion" data-code="🏭">🏭</button>
					<button type="button" class="list-item doEmotion" data-code="🏯">🏯</button>
					<button type="button" class="list-item doEmotion" data-code="🏰">🏰</button>
					<button type="button" class="list-item doEmotion" data-code="💒">💒</button>
					<button type="button" class="list-item doEmotion" data-code="🗼">🗼</button>
					<button type="button" class="list-item doEmotion" data-code="🗽">🗽</button>
					<button type="button" class="list-item doEmotion" data-code="🕌">🕌</button>
					<button type="button" class="list-item doEmotion" data-code="🛕">🛕</button>
					<button type="button" class="list-item doEmotion" data-code="🕍">🕍</button>
					<button type="button" class="list-item doEmotion" data-code="🕋">🕋</button>
					<button type="button" class="list-item doEmotion" data-code="🌁">🌁</button>
					<button type="button" class="list-item doEmotion" data-code="🌃">🌃</button>
					<button type="button" class="list-item doEmotion" data-code="🏙">🏙</button>
					<button type="button" class="list-item doEmotion" data-code="🌄">🌄</button>
					<button type="button" class="list-item doEmotion" data-code="🌅">🌅</button>
					<button type="button" class="list-item doEmotion" data-code="🌆">🌆</button>
					<button type="button" class="list-item doEmotion" data-code="🌇">🌇</button>
					<button type="button" class="list-item doEmotion" data-code="🌉">🌉</button>
					<button type="button" class="list-item doEmotion" data-code="🎠">🎠</button>
					<button type="button" class="list-item doEmotion" data-code="🎡">🎡</button>
					<button type="button" class="list-item doEmotion" data-code="🎢">🎢</button>
					<button type="button" class="list-item doEmotion" data-code="💈">💈</button>
					<button type="button" class="list-item doEmotion" data-code="🎪">🎪</button>
					<button type="button" class="list-item doEmotion" data-code="🚂">🚂</button>
					<button type="button" class="list-item doEmotion" data-code="🚃">🚃</button>
					<button type="button" class="list-item doEmotion" data-code="🚄">🚄</button>
					<button type="button" class="list-item doEmotion" data-code="🚅">🚅</button>
					<button type="button" class="list-item doEmotion" data-code="🚆">🚆</button>
					<button type="button" class="list-item doEmotion" data-code="🚇">🚇</button>
					<button type="button" class="list-item doEmotion" data-code="🚈">🚈</button>
					<button type="button" class="list-item doEmotion" data-code="🚉">🚉</button>
					<button type="button" class="list-item doEmotion" data-code="🚊">🚊</button>
					<button type="button" class="list-item doEmotion" data-code="🚝">🚝</button>
					<button type="button" class="list-item doEmotion" data-code="🚞">🚞</button>
					<button type="button" class="list-item doEmotion" data-code="🚋">🚋</button>
					<button type="button" class="list-item doEmotion" data-code="🚌">🚌</button>
					<button type="button" class="list-item doEmotion" data-code="🚍">🚍</button>
					<button type="button" class="list-item doEmotion" data-code="🚎">🚎</button>
					<button type="button" class="list-item doEmotion" data-code="🚐">🚐</button>
					<button type="button" class="list-item doEmotion" data-code="🚑">🚑</button>
					<button type="button" class="list-item doEmotion" data-code="🚒">🚒</button>
					<button type="button" class="list-item doEmotion" data-code="🚓">🚓</button>
					<button type="button" class="list-item doEmotion" data-code="🚔">🚔</button>
					<button type="button" class="list-item doEmotion" data-code="🚕">🚕</button>
					<button type="button" class="list-item doEmotion" data-code="🚖">🚖</button>
					<button type="button" class="list-item doEmotion" data-code="🚗">🚗</button>
					<button type="button" class="list-item doEmotion" data-code="🚘">🚘</button>
					<button type="button" class="list-item doEmotion" data-code="🚙">🚙</button>
					<button type="button" class="list-item doEmotion" data-code="🚚">🚚</button>
					<button type="button" class="list-item doEmotion" data-code="🚛">🚛</button>
					<button type="button" class="list-item doEmotion" data-code="🚜">🚜</button>
					<button type="button" class="list-item doEmotion" data-code="🏎">🏎</button>
					<button type="button" class="list-item doEmotion" data-code="🏍">🏍</button>
					<button type="button" class="list-item doEmotion" data-code="🛵">🛵</button>
					<button type="button" class="list-item doEmotion" data-code="🦽">🦽</button>
					<button type="button" class="list-item doEmotion" data-code="🦼">🦼</button>
					<button type="button" class="list-item doEmotion" data-code="🛺">🛺</button>
					<button type="button" class="list-item doEmotion" data-code="🚲">🚲</button>
					<button type="button" class="list-item doEmotion" data-code="🛴">🛴</button>
					<button type="button" class="list-item doEmotion" data-code="🛹">🛹</button>
					<button type="button" class="list-item doEmotion" data-code="🚏">🚏</button>
					<button type="button" class="list-item doEmotion" data-code="🛣">🛣</button>
					<button type="button" class="list-item doEmotion" data-code="🛤">🛤</button>
					<button type="button" class="list-item doEmotion" data-code="🛢">🛢</button>
					<button type="button" class="list-item doEmotion" data-code="🚨">🚨</button>
					<button type="button" class="list-item doEmotion" data-code="🚥">🚥</button>
					<button type="button" class="list-item doEmotion" data-code="🚦">🚦</button>
					<button type="button" class="list-item doEmotion" data-code="🛑">🛑</button>
					<button type="button" class="list-item doEmotion" data-code="🚧">🚧</button>
					<button type="button" class="list-item doEmotion" data-code="🛶">🛶</button>
					<button type="button" class="list-item doEmotion" data-code="🚤">🚤</button>
					<button type="button" class="list-item doEmotion" data-code="🛳">🛳</button>
					<button type="button" class="list-item doEmotion" data-code="🛥">🛥</button>
					<button type="button" class="list-item doEmotion" data-code="🚢">🚢</button>
					<button type="button" class="list-item doEmotion" data-code="🛩">🛩</button>
					<button type="button" class="list-item doEmotion" data-code="🛫">🛫</button>
					<button type="button" class="list-item doEmotion" data-code="🛬">🛬</button>
					<button type="button" class="list-item doEmotion" data-code="🪂">🪂</button>
					<button type="button" class="list-item doEmotion" data-code="💺">💺</button>
					<button type="button" class="list-item doEmotion" data-code="🚁">🚁</button>
					<button type="button" class="list-item doEmotion" data-code="🚟">🚟</button>
					<button type="button" class="list-item doEmotion" data-code="🚠">🚠</button>
					<button type="button" class="list-item doEmotion" data-code="🚡">🚡</button>
					<button type="button" class="list-item doEmotion" data-code="🚀">🚀</button>
					<button type="button" class="list-item doEmotion" data-code="🛸">🛸</button>
					<button type="button" class="list-item doEmotion" data-code="🧳">🧳</button>
				</div>
			</div>
			<div class="emoticons-list-wrap">
				<p class="emoticons-title">Symbol</p>
				<div class="emoticons-list" id="emoticon-sport">
					<button type="button" class="list-item doEmotion" data-code="🏧">🏧</button>
					<button type="button" class="list-item doEmotion" data-code="🚮">🚮</button>
					<button type="button" class="list-item doEmotion" data-code="🚰">🚰</button>
					<button type="button" class="list-item doEmotion" data-code="🚹">🚹</button>
					<button type="button" class="list-item doEmotion" data-code="🚺">🚺</button>
					<button type="button" class="list-item doEmotion" data-code="🚻">🚻</button>
					<button type="button" class="list-item doEmotion" data-code="🚼">🚼</button>
					<button type="button" class="list-item doEmotion" data-code="🚾">🚾</button>
					<button type="button" class="list-item doEmotion" data-code="🛂">🛂</button>
					<button type="button" class="list-item doEmotion" data-code="🛃">🛃</button>
					<button type="button" class="list-item doEmotion" data-code="🛄">🛄</button>
					<button type="button" class="list-item doEmotion" data-code="🛅">🛅</button>
					<button type="button" class="list-item doEmotion" data-code="🚸">🚸</button>
					<button type="button" class="list-item doEmotion" data-code="🚫">🚫</button>
					<button type="button" class="list-item doEmotion" data-code="🚳">🚳</button>
					<button type="button" class="list-item doEmotion" data-code="🚭">🚭</button>
					<button type="button" class="list-item doEmotion" data-code="🚯">🚯</button>
					<button type="button" class="list-item doEmotion" data-code="🚱">🚱</button>
					<button type="button" class="list-item doEmotion" data-code="🚷">🚷</button>
					<button type="button" class="list-item doEmotion" data-code="📵">📵</button>
					<button type="button" class="list-item doEmotion" data-code="🔞">🔞</button>
					<button type="button" class="list-item doEmotion" data-code="🔃">🔃</button>
					<button type="button" class="list-item doEmotion" data-code="🔄">🔄</button>
					<button type="button" class="list-item doEmotion" data-code="🔙">🔙</button>
					<button type="button" class="list-item doEmotion" data-code="🔚">🔚</button>
					<button type="button" class="list-item doEmotion" data-code="🔛">🔛</button>
					<button type="button" class="list-item doEmotion" data-code="🔜">🔜</button>
					<button type="button" class="list-item doEmotion" data-code="🔝">🔝</button>
					<button type="button" class="list-item doEmotion" data-code="🛐">🛐</button>
					<button type="button" class="list-item doEmotion" data-code="🕎">🕎</button>
					<button type="button" class="list-item doEmotion" data-code="🔯">🔯</button>
					<button type="button" class="list-item doEmotion" data-code="🔀">🔀</button>
					<button type="button" class="list-item doEmotion" data-code="🔁">🔁</button>
					<button type="button" class="list-item doEmotion" data-code="🔂">🔂</button>
					<button type="button" class="list-item doEmotion" data-code="🔼">🔼</button>
					<button type="button" class="list-item doEmotion" data-code="🔽">🔽</button>
					<button type="button" class="list-item doEmotion" data-code="🎦">🎦</button>
					<button type="button" class="list-item doEmotion" data-code="🔅">🔅</button>
					<button type="button" class="list-item doEmotion" data-code="🔆">🔆</button>
					<button type="button" class="list-item doEmotion" data-code="📶">📶</button>
					<button type="button" class="list-item doEmotion" data-code="📳">📳</button>
					<button type="button" class="list-item doEmotion" data-code="📴">📴</button>
					<button type="button" class="list-item doEmotion" data-code="🔱">🔱</button>
					<button type="button" class="list-item doEmotion" data-code="📛">📛</button>
					<button type="button" class="list-item doEmotion" data-code="🔰">🔰</button>
					<button type="button" class="list-item doEmotion" data-code="🔠">🔠</button>
					<button type="button" class="list-item doEmotion" data-code="🔡">🔡</button>
					<button type="button" class="list-item doEmotion" data-code="🔢">🔢</button>
					<button type="button" class="list-item doEmotion" data-code="🔣">🔣</button>
					<button type="button" class="list-item doEmotion" data-code="🔤">🔤</button>
					<button type="button" class="list-item doEmotion" data-code="🅰">🅰</button>
					<button type="button" class="list-item doEmotion" data-code="🆎">🆎</button>
					<button type="button" class="list-item doEmotion" data-code="🅱">🅱</button>
					<button type="button" class="list-item doEmotion" data-code="🆑">🆑</button>
					<button type="button" class="list-item doEmotion" data-code="🆒">🆒</button>
					<button type="button" class="list-item doEmotion" data-code="🆓">🆓</button>
					<button type="button" class="list-item doEmotion" data-code="🆔">🆔</button>
					<button type="button" class="list-item doEmotion" data-code="🆕">🆕</button>
					<button type="button" class="list-item doEmotion" data-code="🆖">🆖</button>
					<button type="button" class="list-item doEmotion" data-code="🅾">🅾</button>
					<button type="button" class="list-item doEmotion" data-code="🆗">🆗</button>
					<button type="button" class="list-item doEmotion" data-code="🅿">🅿</button>
					<button type="button" class="list-item doEmotion" data-code="🆘">🆘</button>
					<button type="button" class="list-item doEmotion" data-code="🆙">🆙</button>
					<button type="button" class="list-item doEmotion" data-code="🆚">🆚</button>
					<button type="button" class="list-item doEmotion" data-code="🔴">🔴</button>
					<button type="button" class="list-item doEmotion" data-code="🟠">🟠</button>
					<button type="button" class="list-item doEmotion" data-code="🟡">🟡</button>
					<button type="button" class="list-item doEmotion" data-code="🟢">🟢</button>
					<button type="button" class="list-item doEmotion" data-code="🔵">🔵</button>
					<button type="button" class="list-item doEmotion" data-code="🟣">🟣</button>
					<button type="button" class="list-item doEmotion" data-code="🟤">🟤</button>
					<button type="button" class="list-item doEmotion" data-code="🟥">🟥</button>
					<button type="button" class="list-item doEmotion" data-code="🟧">🟧</button>
					<button type="button" class="list-item doEmotion" data-code="🟨">🟨</button>
					<button type="button" class="list-item doEmotion" data-code="🟩">🟩</button>
					<button type="button" class="list-item doEmotion" data-code="🟦">🟦</button>
					<button type="button" class="list-item doEmotion" data-code="🟪">🟪</button>
					<button type="button" class="list-item doEmotion" data-code="🟫">🟫</button>
					<button type="button" class="list-item doEmotion" data-code="🔶">🔶</button>
					<button type="button" class="list-item doEmotion" data-code="🔷">🔷</button>
					<button type="button" class="list-item doEmotion" data-code="🔸">🔸</button>
					<button type="button" class="list-item doEmotion" data-code="🔹">🔹</button>
					<button type="button" class="list-item doEmotion" data-code="🔺">🔺</button>
					<button type="button" class="list-item doEmotion" data-code="🔻">🔻</button>
					<button type="button" class="list-item doEmotion" data-code="💠">💠</button>
					<button type="button" class="list-item doEmotion" data-code="🔘">🔘</button>
					<button type="button" class="list-item doEmotion" data-code="🔳">🔳</button>
					<button type="button" class="list-item doEmotion" data-code="🔲">🔲</button>
					<button type="button" class="list-item doEmotion" data-code="🔇">🔇</button>
					<button type="button" class="list-item doEmotion" data-code="🔈">🔈</button>
					<button type="button" class="list-item doEmotion" data-code="🔉">🔉</button>
					<button type="button" class="list-item doEmotion" data-code="🔊">🔊</button>
					<button type="button" class="list-item doEmotion" data-code="📢">📢</button>
					<button type="button" class="list-item doEmotion" data-code="📣">📣</button>
					<button type="button" class="list-item doEmotion" data-code="📯">📯</button>
					<button type="button" class="list-item doEmotion" data-code="🔔">🔔</button>
					<button type="button" class="list-item doEmotion" data-code="🔕">🔕</button>
					<button type="button" class="list-item doEmotion" data-code="🎼">🎼</button>
					<button type="button" class="list-item doEmotion" data-code="🎵">🎵</button>
					<button type="button" class="list-item doEmotion" data-code="🎶">🎶</button>
					<button type="button" class="list-item doEmotion" data-code="🎙">🎙</button>
					<button type="button" class="list-item doEmotion" data-code="🎚">🎚</button>
					<button type="button" class="list-item doEmotion" data-code="🎛">🎛</button>
					<button type="button" class="list-item doEmotion" data-code="🎤">🎤</button>
					<button type="button" class="list-item doEmotion" data-code="🎧">🎧</button>
					<button type="button" class="list-item doEmotion" data-code="📻">📻</button>
					<button type="button" class="list-item doEmotion" data-code="🎷">🎷</button>
					<button type="button" class="list-item doEmotion" data-code="🎸">🎸</button>
					<button type="button" class="list-item doEmotion" data-code="🎹">🎹</button>
					<button type="button" class="list-item doEmotion" data-code="🎺">🎺</button>
					<button type="button" class="list-item doEmotion" data-code="🎻">🎻</button>
					<button type="button" class="list-item doEmotion" data-code="🪕">🪕</button>
					<button type="button" class="list-item doEmotion" data-code="🥁">🥁</button>
					<button type="button" class="list-item doEmotion" data-code="🕰">🕰</button>
					<button type="button" class="list-item doEmotion" data-code="🕛">🕛</button>
					<button type="button" class="list-item doEmotion" data-code="🕧">🕧</button>
					<button type="button" class="list-item doEmotion" data-code="🕐">🕐</button>
					<button type="button" class="list-item doEmotion" data-code="🕜">🕜</button>
					<button type="button" class="list-item doEmotion" data-code="🕑">🕑</button>
					<button type="button" class="list-item doEmotion" data-code="🕝">🕝</button>
					<button type="button" class="list-item doEmotion" data-code="🕒">🕒</button>
					<button type="button" class="list-item doEmotion" data-code="🕞">🕞</button>
					<button type="button" class="list-item doEmotion" data-code="🕓">🕓</button>
					<button type="button" class="list-item doEmotion" data-code="🕟">🕟</button>
					<button type="button" class="list-item doEmotion" data-code="🕔">🕔</button>
					<button type="button" class="list-item doEmotion" data-code="🕠">🕠</button>
					<button type="button" class="list-item doEmotion" data-code="🕕">🕕</button>
					<button type="button" class="list-item doEmotion" data-code="🕡">🕡</button>
					<button type="button" class="list-item doEmotion" data-code="🕖">🕖</button>
					<button type="button" class="list-item doEmotion" data-code="🕢">🕢</button>
					<button type="button" class="list-item doEmotion" data-code="🕗">🕗</button>
					<button type="button" class="list-item doEmotion" data-code="🕣">🕣</button>
					<button type="button" class="list-item doEmotion" data-code="🕘">🕘</button>
					<button type="button" class="list-item doEmotion" data-code="🕤">🕤</button>
					<button type="button" class="list-item doEmotion" data-code="🕙">🕙</button>
					<button type="button" class="list-item doEmotion" data-code="🕥">🕥</button>
					<button type="button" class="list-item doEmotion" data-code="🕚">🕚</button>
					<button type="button" class="list-item doEmotion" data-code="🕦">🕦</button>
				</div>
			</div>
		</div>
	</div>
</div><div class="style-box" id="style-box">
						<ul>
							<li>
								<a href="javascript:void(0);" class="btn-ic" id="addBold">
									<img src="./images/chat/bold.svg" alt="bold">
								</a>
							</li>
							<li>
								<a href="javascript:void(0);" class="btn-ic" id="addStrike">
									<img src="./images/chat/strikethrough.svg" alt="strike">
								</a>
							</li>
							<li class="color-box">
								<a href="javascript:void(0);" class="btn-color-black on" id="addColorBlack">
								</a>
							</li>
							<li class="color-box">
								<a href="javascript:void(0);" class="btn-color-blue" id="addColorBlue">
								</a>
							</li>
							<li class="color-box">
								<a href="javascript:void(0);" class="btn-color-red" id="addColorRed">
								</a>
							</li>
						</ul>
					</div><div class="reply-box" id="reply-box">
						<ul class="hide">
							<li>
								<a href="javascript:void(0);" class="btn-ic" id="replyBold">
									<img src="./images/chat/bold.svg" alt="bold">
								</a>
							</li>
							<li>
								<a href="javascript:void(0);" class="btn-ic" id="replyStrike">
									<img src="./images/chat/strikethrough.svg" alt="strike">
								</a>
							</li>
						</ul>
						<div class="reply-box-con">
							<span class="btn-view"></span>
							<p class="chat-msg-quote" id="chat-msg-quote"></p>
							<span class="btn-reply" id="trigger-reply-icon"></span>
						</div>
					</div><div class="editor input-txt thin-scroll" id="editor" contenteditable-limit="1000" contenteditable="true" placeholder="Write message here" onpaste="eventCommon.handlePasteOnEditor(event);"></div>
								<textarea name="text_chat" class="hide" id="text_chat" placeholder="Write message here"></textarea>
								<span class="btn-pen" id="trigger-style-box" data-onclic="changeIconPen()"></span>
								<div class="btn-cancel-area hide" id="btn-cancel-area">
									<a href="javascript:void(0);" class="btn-ic" id="btn_cancel">
										<img src="/user/images/chat/back.svg" alt="cancel" class="ic-cancel">
									</a>
								</div>
							</li>
							<li class="btn-send">
								<a href="javascript:void(0);" class="btn-send" id="text_chat_submit">
									<img src="/user/images/chat/send-icon.svg" alt="send" class="ic-send">
								</a>
							</li>
						</ul>
					</div>
					<!-- / .reply-box -->
					<div class="emoticons-holder">
						
					</div><!-- / .emoticons-box -->
					<!-- / .style-box -->
				</div><!-- end textchat_form_inner -->
			</div>
		</div>
		<!-- chat menu -->
		<div class="dummy_chat_menu_container"></div>
	</div>
</div>

<!-- ▼ hidden trigger modal ▼  -->
<a rel="modal" href="#dialog_lesson_student_ready" id="trigger_modal_lesson_student_ready"></a>
<!-- ▲ hidden trigger modal ▲ -->
<!-- ▼ chat msg countdown ▼ -->
<div class="chat_msg_countdown" id="chat_msg_countdown">
	<p></p>
	<span class="modal_close"></span>
</div>
<!-- ▲ chat msg countdown ▲ -->

<!-- chat quit >>>  -->
<div class="modal_window dialog hide" id="dialog_chat_quit">
	<h3>Quit the lesson</h3>
	<p class="t_center">Are you sure you want to quit this lesson now?</p>
	<div class="btn_wrap btn_center cf">
		<ul>
			<li><a class="btn_style green" id="btn_quit" href="javascript:void(0)">Quit</a></li>
		</ul>
	</div>
</div>
<!-- <<< -->

<div class="modal_window dialog hide" id="dialog_lesson_student_ready">
	<h3>Students Ready</h3>
	<div class="btn_wrap btn_center cf">
		<ul>
			<li><a class="btn_style btn_orange close_modal" id="btn_start_lesson_counter" href="javascript:void(0)">START LESSON</a></li>
		</ul>
	</div>
	<div class="btn_close btn_close--inner" style="display:none;"></div>
</div>

<!-- lesson memo save >>>  -->
<div class="modal_window dialog hide static_overlay" id="dialog_lesson_disconnect">
    <h3>You were disconnected from the lesson.</h3>
	<p class="t_center">Refreshing in 3 seconds...</p>
    <div class="btn_wrap btn_half cf" style="display: none;">
        <ul>
            <li><a class="btn_style gray close_modal click_no" href="javascript:void(0)">No</a></li>
            <li><a class="btn_style orange submit click_yes" href="javascript:void(0)">Yes</a></li>
        </ul>
    </div>
    <div class="btn_close hidden"></div>
</div>
<audio id="lesson_disconnect_sound" preload="auto" loop="">
<source src="/teacher/sound/lesson_disconnect.mp3?ts=1756730221" type="audio/mp3">
<p>音声を再生するには、audioタグをサポートしたブラウザが必要です。</p>
</audio>
<a rel="modal" href="#dialog_lesson_disconnect" id="dialog_lesson_disconnect_open"></a>
<!-- <<< -->

<!-- start of forced lesson reconenct -->
<a rel="modal" href="#dialog_forced_lesson_reconnect" id="trigger_dialog_forced_lesson_reconnect"></a>
<div class="modal_window dialog hide" id="dialog_forced_lesson_reconnect">
	<h3>Disconnection Notice</h3>
	<p class="t_center">You were forcefully disconnected from the lesson!</p>
	<div class="btn_close hidden"></div>
</div>
<!-- end of forced lesson reconnect -->

<!-- start of forced lesson reconenct -->
<a rel="modal" href="#dialog_internet_connection_dead" id="trigger_dialog_internet_connection_dead"></a>
<div class="modal_window dialog hide static_overlay" id="dialog_internet_connection_dead">
	<h3>Disconnection Notice</h3>
	<p class="t_center">Your internet connection has been disconnected!</p>
	<div class="btn_wrap btn_center cf">
		<ul>
			<li><a class="btn_style btn_orange" onclick="closeProtection = false; close_window('/teacher/chat?action=teacherRefresh');" href="javascript:void(0);">REFRESH</a></li>
		</ul>
	</div>
	<div class="btn_close hidden"></div>
</div>
<!-- end of forced lesson reconnect -->

<!-- (connect flg = 0) error -->
<a rel="modal" href="#dialog_connect_flg_error" id="trigger_dialog_connect_flg_error"></a>
<div class="modal_window dialog hide static_overlay" id="dialog_connect_flg_error">
	<h3><u>Communication Error</u></h3>
	<p class="t_center">An error occurred while we were trying to process your request.</p>
	<div class="btn_wrap btn_center cf">
		<ul>
			<li><a class="btn_style btn_orange" onclick="closeProtection = false; close_window('/teacher/chat?action=teacherRefresh');" href="javascript:void(0);">REFRESH</a></li>
		</ul>
	</div>
	<div class="btn_close hidden"></div>
</div>
<!-- end of forced lesson reconnect -->

<!-- (error exceeds to 5) error -->
<a rel="modal" href="#dialog_connect_flg_error_exceeds" id="trigger_dialog_connect_flg_error_exceeds"></a>
<div class="modal_window dialog hide static_overlay" id="dialog_connect_flg_error_exceeds">
	<h3><u>Communication Error</u></h3>
	<p class="t_center">An error occurred while we were trying to process your request.</p>
	<p class="t_center">Please click the <b>'REFRESH'</b> button to reload the page</p>
	<div class="btn_wrap btn_center cf">
		<ul>
			<li><a class="btn_style btn_orange" onclick="closeProtection = false; close_window('/teacher/chat?action=teacherRefresh');" href="javascript:void(0);">REFRESH</a></li>
		</ul>
	</div>
	<div class="btn_close hidden"></div>
</div>
<!-- end of forced lesson reconnect -->

<!-- start lesson sound -->
<audio id="startLessonSound" preload="auto">
	<source src="/teacher/sound/start_lesson.mp3?ts=1756730221">
</audio>
<!-- end of start lesson sound -->

<!-- student joined room -->
<audio id="studentJoinedRoom" preload="auto">
	<source src="/teacher/sound/lesson_sound1_chime.mp3?ts=1756730221">
</audio>
<!-- end of student joined room -->

<!-- student selecting book -->
<audio id="studentSelectingBook" preload="auto" loop="">
	<source src="/teacher/sound/lesson_sound2_calling.mp3?ts=1756730221">
</audio>
<!-- end of student selecting book -->

<!-- student has selected book -->
<audio id="studentSelectedTextbook" preload="auto">
	<source src="/teacher/sound/lesson_sound3_start.mp3?ts=1756730221">
</audio>
<!-- end of student has selected book -->

<!-- Chivox Eiken Result Template -->
<div id="new_eiken_interview_style">
	<style>
		.desc_wrap.chvx_eval_box {
			background: #F4F5F8;
			border-radius: 0.5rem;
		}
		.chvx_box_label {
			font-size: 14px;
			color: #999;
			margin-bottom: 1rem;
			text-align: left;
		}
		.rec-result-chivox .score-result-list {
			margin-bottom: 1.2rem;
		}
		.rec-result-chivox .score-result-list li {
			display: flex;
			align-items: center;
		}
		.rec-result-chivox .score-result-list .desc {
			width: 30% !important;
			text-align: left;
		}
		.rec-result-chivox .score-result-list .progress {
			display: flex;
			width: 55%;
			height: 1.2rem;
			overflow: hidden;
			font-size: 0.75rem;
			background-color: #e1e3e8;
			border-radius: 0.375rem;
			margin: 0 1rem;
		}
		.rec-result-chivox .score-result-list .progress-bar {
			display: flex;
			flex-direction: column;
			justify-content: center;
			overflow: hidden;
			background-color: #f1890e;
			height: 1.2rem;
		}
		.rec-result-chivox .score-result-list .score {
			display: flex;
			justify-content: center;
			align-items: center;
			color: #f1890e;
			font-weight: bold;
			margin-left: 0.5rem;
			width: 15%;
		}
		/* NJ-34147 */
		@media screen
		and (max-width:1200px) {
		/* addt. spec */
		.rec-result-chivox .score-result-list {
			padding: 0;
			width: 100%;
			margin: auto;
		}
		.rec-result-chivox .score-result-list .score {
			width: auto;
			margin: 0;
		}
		.rec-result-chivox .score-result-list .desc {
			width: 20% !important;
		}
		.rec-result-chivox .score-result-list li {
			margin:1rem 0;
		}
		.rec-result-chivox .score-result-list .progress {
			width: 70%;
		}
		}
	</style>
</div>

<div id="new_eiken_interview_overall_result" class="desc_wrap chvx_eval_box" style="display:none;">
	<div class="chvx_box_label">Test Result</div>
	<div class="chvx_box_desc">
		<div class="rec-result-chivox">
			<div class="rec-result-chivox-inner">
				<div class="score-result">
					<div class="score-result-content">
						<ul class="score-result-list">
							<li>
								<div class="desc fs_14">Reading</div>
								<div class="progress">
									<div class="progress-bar" style="width: --score-read--%"></div>
								</div>
								<div class="score fs_18">--score-read--</div>
							</li>
							<li>
								<div class="desc fs_14">Question1</div>
								<div class="progress">
									<div class="progress-bar" style="width: --score-q1--%"></div>
								</div>
								<div class="score fs_18">--score-q1--</div>
							</li>
							<li>
								<div class="desc fs_14">Question2</div>
								<div class="progress">
									<div class="progress-bar" style="width: --score-q2--%"></div>
								</div>
								<div class="score fs_18">--score-q2--</div>
							</li>
							<li>
								<div class="desc fs_14">Question3</div>
								<div class="progress">
									<div class="progress-bar" style="width: --score-q3--%"></div>
								</div>
								<div class="score fs_18">--score-q3--</div>
							</li>
							<li>
								<div class="desc fs_14">Question4</div>
								<div class="progress">
									<div class="progress-bar" style="width: --score-q4--%"></div>
								</div>
								<div class="score fs_18">--score-q4--</div>
							</li>
							<li>
								<div class="desc fs_14">Question5</div>
								<div class="progress">
									<div class="progress-bar" style="width: --score-q5--%"></div>
								</div>
								<div class="score fs_18">--score-q5--</div>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="chvx_box_play">
		<a class="icon-chvx-play funcPlayChivoxRec" href="javascript:void(0)"></a>
	</div>
</div>									<div class="connect_dialog_wrap connect_dialog_wrap--default" id="connect_dialog_wrap--default" style="display: none;">
	<div class="connect_dialog_inner">
		<div class="connect_dialog connect_dialog">
			<!-- <div class="login_account_wrap">
				<div class="col_left">
					< ?php
						$teacherTable = new TeacherTable($teacher['Teacher']);
					?>
					<img class="thumb" src="< ?php echo $teacherTable->getImageUrl(); ?>" alt="< ?php echo h($teacher['Teacher']['name']); ?>" width="50" height="50">
				</div>
				<div class="col_right">
					<p class="greetings">WELCOME!!<br>< ?php echo h($teacher['Teacher']['name']);?>!!</p>
				</div>
			</div> -->
						<p class="desc">Make sure that you are ready for a lesson and choose STANDBY.</p>
						<!-- <div class="display-time_difference" style="display: none;">
	<p id="local-time_container">
		<span class="t_bold">Current time in your timezone: </span><br />
		<span id="local-time"></span>
	</p>
	<p class="m_t_20" id="server-time_container">
		<span class="t_bold">Current time in Japan: </span><br />
		<span class="jpt_label" id="server-time"></span>
	</p>
</div> -->
						<div class="instruction_wrap">
				<i class="fa fa-youtube-play" aria-hidden="true"></i>
				<span class="lh_15">Instruction video : </span>
				<div class="video_item_wrap m_t_5">
					<span>(</span>
					<a href="https://www.youtube.com/watch?v=yM0Plj5YPww" target="_blank" class="t_link" rel="noopener">
						<div class="video_ttl">Sudden lesson</div>
					</a>
					<span> / </span>
					<a href="https://www.youtube.com/watch?v=4kmb20mfHbQ" target="_blank" class="t_link" rel="noopener">
						<div class="video_ttl"><p>Booked lesson</p></div>
					</a>
					<span>)</span>
				</div>
			</div>
					</div>
	</div><!-- // .connect_dialog_inner -->

	<!-- download app banners -->
	<div class="teacher-banners-1 m_t_20">
		<ul class="teacher-banners-list-1">
			<li>
				<a href="javascript:void(0)" ui-sref="home/download_app/beauty">
					<img src="/teacher/images/banner/download-app-beauty.png" alt="Try out the beauty filter">
				</a>
			</li>
			<li>
				<a href="javascript:void(0)" ui-sref="home/download_app/teacher">
					<img src="/teacher/images/banner/download-app-teacher.png" alt="NativeCamp. For Teachers">
				</a>
			</li>
		</ul>
	</div><!-- download app banners END -->
</div><!-- // .connect_dialog_wrap -->								
							</div>
						</div><!-- // .pane_cell  middle_right -->

					</div><!-- // .chat_frame_cell -->
				</div><!-- // .pane_wrap  middle -->
			</div><!-- // .chat_frame_row -->
		</div><!-- // .chat_frame -->
	</div><!-- // .page_inner -->
</div><!-- // .page_wrap -->

<!-- ▼ popup lesson time ▼ -->
<div class="popup_lesson_time" id="popup_lesson_time">
	<div class="lesson_time_box_wrap">
		<div class="lesson_time_box">
			<div class="lesson_time_box_inner"></div>
			<div class="bookmark_notice hide">
				<p>
					<img src="/teacher/images/icon/bookmark_on.svg" class="bookmark-img">
					Don't forget<br><span>to bookmark!</span>
				</p>
			</div>
		</div>
	</div>
	<audio id="popup_lesson_time_audio_1" preload="auto">
		<source type="audio/mp3" src="/teacher/sound/time_to_review.mp3?ts=1756730221">
	</audio>
</div>
<!-- ▲ popup lesson time ▲ -->

<!-- ▼ popup 5mins extended lesson time -->
<!-- static -->
<div class="popup_lesson_time_ext5mins hide" id="popup_lesson_time_ext5mins2">
	<div class="ext5mins_container">
		<h5 class="icon_timeplus_green"><span><b class="fs_26"></b>Changed</span></h5>
	</div>
</div>
<!-- end static -->
<!-- ▲ popup 5mins extended lesson time -->

<!-- ▼ popup live lesson - (first) viewer entered ▼ -->
<div class="popup_live_lesson_someone_entered" id="popup_live_lesson_someone_entered">
	<div class="purple-border-1">
		<div class="purple-border-2">
			<div class="popup-inner">
				<div class="user-icon">
					<p><i class="fa fa-user"></i></p>
				</div>
				<div class="main-text">
					<p>Viewer has entered the room.</p>
				</div>
			</div>
		</div>
	</div>
</div>
<!-- ▲ popup lesson time ▲ -->

<!-- ▼ popup cookie ▼ -->
<div class="popup_cookie" style="display: none;">
	<p>This website uses cookies to ensure you get the best experience on our website.</p>
	<p class="m_b_20"><a href="./privacy-policy" target="_blank">Learn More<i class="fa fa-external-link m_l_5"></i></a></p>
	<button type="button" class="btn_confirm" id="cookie_confirm">Got it!</button>
</div>
<!-- ▲ popup cookie ▲ -->

<!-- Appear modal on OK in Others!-->
<a rel="modal" href="#dialog_others_on_ok" id="trigger_dialog_others_on_ok"></a>
<div class="modal_window dialog static_overlay hide" id="dialog_others_on_ok">
    <h3>Please wait for a bit...</h3>
		<p class="t_center">
			<img src="/teacher/images/common/loader.gif">
		</p>
</div>

<a rel="modal" href="#dialog_unexpected_disconnect" id="dialog_notend_open" ng-click="openDialogNotend"></a>
<!-- disconnect >>>  -->
<div class="modal_window dialog hide" id="dialog_disconnect">
    <h3>Set to NOT STANDBY</h3>
    <p class="t_center">You are currently on "<span class="teacher_current_status">STANDBY</span>".<br>Do you really wish to set your status to "NOT STANDBY"?</p>
    <div class="btn_wrap btn_half cf">
        <ul>
            <li><a class="btn_style gray close_modal" href="javascript:void(0)">Cancel</a></li>
            <li><a class="btn_style green set_status close_modal" data-status-id="5" href="javascript:void(0);">OK</a></li>
        </ul>
    </div>
    <div class="btn_close"></div>
</div>
<!-- <<< -->
<!-- away reason >>> -->
<a class="hide" rel="modal" href="#dialog_away" id="trigger_dialog_away"></a>
<div class="modal-window modal-away hide static_overlay" id="dialog_away">
	<h3 class="modal-title">Comment</h3>
	<div class="modal-content">
		<textarea class="size_max" id="dialog_away_textarea" placeholder="Please write a comment."></textarea>
	</div>
	<label class="err-label"></label>
	<div class="btn-wrap btn-center">
		<a class="nc-t-btn nc-t-btn-orange-o close_modal" href="javascript:void(0)">Cancel</a>
		<a ng-click="setStatus($event, 'other')" class="nc-t-btn nc-t-btn-orange" href="javascript:void(0);" id="othersOkBtn">OK</a>
	</div>
	<div class="btn_close"></div>
</div>
<!-- Lesson message sending modal >>> -->
<a class="hide" rel="modal" href="#lesson_send" id="trigger_lesson_send"></a>
<div class="modal-window hide static_overlay dialog_lesson_msg_send" id="lesson_send">
	<div class="reason_wrap m_t_15">
		<div class="user_data">
			<div class="user_data_prof">
				<div class="thumb">
					<img src="/user/img/no_profile_img.jpg">
				</div>
				<p class="name t_truncate">name</p>
				<p class="warning_messageMdl" align="center">message</p>
			</div>
			<!-- For normal modal >>> -->
			<div class="normalData">
				<p class="bookTitleMdl" align="left">[ Course or Textbook ] <span></span></p>
				<p class="subCategoryNormalLabel" align="left">[ Category ] <span></span></p>
				<p class="bookChapterMdl" align="left">[ Chapter ] <span></span></p>
				<p class="bookPageMdl" align="left">[ Page ] <span></span></p>
				<p class="voc1Mdl" align="left">[ Vocabulary ] <span></span></p>
				<p class="voc2Mdl" align="left">[ Vocabulary 2] <span></span></p>
				<p class="voc3Mdl" align="left">[ Vocabulary 3] <span></span></p>
				<p class="phrase1Mdl" align="left">[ Phrase ] <span></span></p>
				<p class="pronunMdl" align="left">[ Pronunciation ] <span></span></p>
				<p class="grammarMdl" align="left">[ Grammar ] <span></span></p>
				<p class="commentMdl" align="left">[ Comment ] <span class="break-all"></span></p>
			</div>
			<!-- For callan "level check" modal >>> -->
			<div class="callanLevelCheckData">
				<p class="bookTitleMdlCal" align="left">[ Course or Textbook ] <span></span></p>
				<p class="subCategoryCallanLevelLabel" align="left">[ Category ] <span></span></p>
				<p class="bookChapterMdlCal" align="left">[ Chapter ] <span></span></p>
				<p class="callanLevelCheckMdl" align="left">[ Level Check Test ] <span></span></p>
			</div>
			<!-- For callan modal >>> -->
			<div class="callanData">
				<p class="bookTitleMdlCallan" align="left">[ Course or Textbook ] <span></span></p>
				<p class="subCategoryCallanLabel" align="left">[ Category ] <span></span></p>
				<p class="bookChapterMdlCallan" align="left">[ Chapter ] <span></span></p>
				<p class="callanQAndA" align="left">[ Question and Answer ] <span></span></p>
				<p class="callanReading" align="left">[ Reading ] <span></span></p>
			</div>

			<!-- For Counseling modal -->
			<div class="counselingData">
				<p align="left"><b>[ カテゴリ]</b></p>
				<p class="counselingCategory" align="left"></p>
				<br>
				<p align="left"><b>[ おすすめ教材 ]</b></p>
				<div class="counselingRecommendedTxt" align="left"></div>
				<br>
				<p align="left"><b>[ コメント ]</b></p>
				<p class="counselingComment" align="left"></p>
			</div>

		</div>
		<label class="err-label"></label>
		<div class="btn_wrap btn_half cf">
			<div class="normal_lesson_send_btn">
				<ul>
					<li>
						<a ng-click="confirmPop($event,'cancel')" data-selector="" data-selector-btn="" class="btn_cancel_popup btn_style gray close_modal" href="javascript:void(0)">Cancel</a>
					</li>
					<li>
						<button class="btn_style green btn_send_popup" ng-click="confirmPop($event,'send')" data-selector="" data-selector-btn="">Yes</button>
					</li>
				</ul>
			</div>
			<div class="counselor_lesson_send_btn">
				<a ng-click="confirmPop($event,'cancel')" data-selector="" data-selector-btn="" class="btn_cancel_popup nc-t-btn nc-t-btn-orange-o btn_gray close_modal" href="javascript:void(0)">キャンセル</a>
				<button class="nc-t-btn nc-t-btn-orange btn_send_popup close_modal" ng-click="confirmPop($event,'send')" data-selector="" data-selector-btn="">OK</button>
			</div>

		</div>
	</div>
	<div class="btn-close btn_close" style="display:none;"></div>
</div>

<!-- ▼ audio error alert ▼ -->
<a class="hide" id="trigger_modal_audio_error_alert" rel="modal" href="#modal_audio_error_alert"></a>
<div class="modal_window dialog dialog_audio_error_alert hide" id="modal_audio_error_alert">
	<div>
		<p class="fs_18 fw_b t_center">This audio file is broken.</p>
		<p class="fs_18 fw_b t_center m_t_20">Please skip this one and inform the management later.</p>
		<div class="m_t_40">
			<ul class="t_center">
				<li><a class="btn_style btn_orange close_modal">OK</a></li>
			</ul>
		</div>
	</div>
</div>
<!-- ▲ audio error alert ▲ -->

<!-- Preivew Modal -->

<a class="hide" rel="modal" href="#video-preview" id="trigger_show-video"></a>
<div class="modal-window modal-away hide " id="video-preview">
	<div class="modal-content">
		<div class="text-center">
					<div class="video_wrap">
						<video width="100%" controls="" class="modal_video_preview">
							<source src="data:video/mp4;base64,AAAA" type="video/mp4">
							Your browser does not support HTML video.
						</video>
					</div>
				</div>
	</div>
</div>

<a class="hide" rel="modal" href="#image-preview" id="trigger_show-image"></a>
<div class="modal-window modal-away hide " id="image-preview">
	<div class="modal-content">
		<div class="text-center">
			<div class="image_wrap"><img class="modal_image_preview img-responsive"></div>
		</div>
	</div>
</div>

<!-- NJ-29495 Start -->

<div id="avatar_pet_phrases" class="hide ui-draggable" data-avatar-id="0" style="right: 0px; top: 12%;">
	<div class="avatar_cont">
		<img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" alt="avatar image" id="clickable-image">
		<div class="avatar_content" id="hidden-content" style="height:auto">
			<ul class="">
							</ul>
		</div>
	</div>
</div>


<script>
	var allowedToPlayAvatarPhrase = true;

	$(document).ready(function () {
		$("#clickable-image").click(function () {
			$("#hidden-content").toggle();
		});

		$("#avatar_pet_phrases").on('click', '.play_pet_phrase', function () {
			if (!allowedToPlayAvatarPhrase) {
				return false;
			}
			
			let audioUrl = $(this).data('audio_url');
			let phraseId = $(this).data('phrase_id');
			let btnPlayed = $(this).attr('id');
			if(typeof(window.parent.textToSpeech) != 'undefined' && window.parent.textToSpeech('', '', btnPlayed, audioUrl)){
				$.ajax({
					url: '/teacher/api/recordPlayedPhrase',
					type: 'POST',
					data: {'avatar_phase_id': phraseId},
					success: function (res) {
						console.info(res);
					},
					error: function (err) {
						console.warn(err);
					}
				});
			}
		});

		$('#avatar_pet_phrases').draggable({ 
			handle: "img",
			containment: 'body',
		});

		$(window).on("resize", function () {
		// Reset draggable position
			$("#avatar_pet_phrases").css({
				right: "0",
				top: "12%",
			});
		});
	});
</script>
<!-- NJ-29495 End -->

<div class="recommended_textbook_chose_by_counselor"></div>
<div class="recommended_textbook_chose_by_counselor_val"></div>
<audio id="reservation_sound" preload="auto" loop="">
<source src="/teacher/sound/reservation.mp3?ts=1756730221" type="audio/mp3">
<p>音声を再生するには、audioタグをサポートしたブラウザが必要です。</p>
</audio>
<script type="text/javascript">
// Initialization for NG Home controller
var countUnviewedPost = 0;
var chat            = parseInt('0');
var lessonNotice    = 'no_message';
var onCurRes        = '0';
var someoneSeeking  = parseInt('0');
var rem             = parseInt("0");
var lessonNotend    = parseInt('0');
var hasLesson       = parseInt('0');
var teacherRemarks  = parseInt('0');
var textbook        = '0';
var notice 			= parseInt("1");
var show5MinutesLessonAndBelowModal = parseInt('0');
var nativeSpeaker 	= parseInt("0");
var teacherVideo = parseInt('0');
var teacherTarget 	= parseInt('1');
var teacherDashboard = parseInt('1');
var flagvideo = false;
var flagChatClearNormalLesson = false;
var show5minutesLessonAndAboveModal = false;
var lessonOnAirStudentID = 0;
var lessonOnAirCounselorFlag = 0;
var lessonMemoId = 0;
var track;
//NJ-7873 For facial recognitioin
var has_face_req = false;
var testFlg  = parseInt('0');
var avatarFlg  = parseInt('0');
var avatarParentFlg  = parseInt('0');
var counselingFlg  = parseInt('0');
var customerSupportFlg = parseInt('0');

var activeCampaignModals = [];


var deviceType = "";
var deviceInfo = "";
var stealthFlg = parseInt('0');

// - NJ-1452 : Check if the teacher has Invalid Flag set to ON
var inactiveFlg  = parseInt('0');

// cookie modal
var isEuropeanUnion = '0';

//-- push notif(disable) modal show indentifier
var loginCount = parseInt('0');
var isAllCheckedStudentRequestLesson = parseInt('0');
localStorage.setItem('loginCount', loginCount);

// - declare illustration slider
var illustration_slider = false;
</script>
<!-- <<< -->
<script type="text/javascript">
$(function(){
	notStandyModalSync();
	
	/*----------------------------------------------*/
	// globals
	/*----------------------------------------------*/
	var _popwin_textbook; // popup window of textbook
	var _popwin_translate; // popup window of google translate

	/*----------------------------------------------*/
	// notify reservation
	/*----------------------------------------------*/
	$('a[rel*=modal]').leanModal();

	//toggle timezone panel
	$(document).on('click', '.func-toggle-menu_sub_panel', function(e){
		e.preventDefault();
		console.log('clicked');
		var id = $(this).attr('href');
		var top = $(this).offset().top;
		if (id == '#menu_sub_panel-timezone') {
			$(id).css('top', top - 100 + 'px');
		} else {
			$(id).css('top', top + 25 + 'px');
		}

		$(id).toggle();
	});
	$(document).on('click', '.menu_sub_panel .btn_close', function(e){
		e.preventDefault();
		var this_panel = $(this).closest('.menu_sub_panel');
		this_panel.hide();
	});
	/*----------------------------------------------*/
	// message student is ready
	/*----------------------------------------------*/
	function msgStudentReady(){
		$('#trigger_modal_lesson_student_ready').click();
		// set window cover layer
		$('<div id="cover_layer" style="position:fixed;top:0;left:0;width:100%;height:100%;z-index:10001;background:none;"></div>').appendTo('body');
	}


	/*----------------------------------------------*/
	// start lesson
	/*----------------------------------------------*/
	$('#btn_start_lesson_counter').on('click', function(){
		$('#cover_layer').remove();
	});
	
	/*----------------------------------------------*/
	// teacher forbidden actions illustration
	/*----------------------------------------------*/
	illustration_slider = $("#illustration_slider").bxSlider({
		mode: 'fade',
		auto: true,
		stopAutoOnClick: false,
		pause: 10000,
		autoStart: true,
		slideMargin: 400,
		randomStart: true,
		touchEnabled: false,
		autoHover: false,
		pager: false,
		responsive: true,
		onSliderLoad: function() {
			// Set the default href value for the Next button
			$('.bx-next').attr('href', 'javascript:void(0);');
			$('.bx-prev').attr('href', 'javascript:void(0);');
		}
	});
	function layout_illustration_slider(){
		if ($("#teacher_ng_note").length) {
			var chat_w = $("#pane--middle_right").width();
			if (chat_w > 800) {
				$("#teacher_ng_note").addClass("flex-mode");
			} else {
				$("#teacher_ng_note").removeClass("flex-mode");
			}
		}

		// NJ-12087: calcualte top bar fi window resize
		if($.cookie('MenuBarWidth') < 150) {
			hideSidebar();
		}
	}
	window.addEventListener('resize', function(){
		layout_illustration_slider();
	});
	/* add timeout */
	setTimeout(function(){
		/*----------------------------------------------*/
		// contents columun resizable vertical
		/*----------------------------------------------*/
		$('#pane--middle_left').resizable({
			grid:[1,10000],
			handles: 'e',
			resize: function(e, ui){
				$('#others_video_wrap').css({ width: 'auto' });
				var screen_w = $('#screen .screen_inner').width();
				var screen_h = $('#screen .screen_inner').height();
				var paneRightWidth = $('.pane--middle_right').width();
				resizeVideo(screen_w, screen_h);

				if(paneRightWidth <= 200){
					$('.own_video_wrap').hide();
				}else if(paneRightWidth <= 305){
					$('.controls_area_wrap').hide();
					$('.own_video_wrap').show();
				}else{
					$('.controls_area_wrap').show();
				}
				
				if ($('#others_video_wrap').height() <= 300) {
					$('#others_video_wrap').height(300); // set minimum 300
				}

				// change device orientation
				if (
					typeof eventTeacher !== 'undefined' &&
					typeof eventTeacher.deviceDidChangeOrientation !== 'undefined' &&
					$.isFunction(eventTeacher.deviceDidChangeOrientation) &&
					connect.deviceBounds
				) {
					eventTeacher.deviceDidChangeOrientation();
				}
			},
			//reload teacher forbidden actions illustration
			stop: function(e, ui){
				layout_illustration_slider();

				// - check illustration slider variable
				if (illustration_slider != false && typeof illustration_slider.reloadSlider !== "undefined") {
					illustration_slider.reloadSlider();
				}

			}
		});
		// Resizable menu bar
		$("#page_contents_tabs").resizable({
			handles: 'e',
			minWidth: 2,
			maxWidth: 260,
			resize: function(e, ui) {
				// //sidebar width is small, do  its width to 1
				if(ui.size.width <= 150) {
					var MenuBar = $('#page_contents_tabs').width(2);
					$.cookie('MenuBarWidth', $('#page_contents_tabs').width());
					calculateMenuBar();
				}
			}
		});

		/*----------------------------------------------*/
		// screen resizable horizontal
		/*----------------------------------------------*/
		$('#screen').resizable({
			grid:[10000,1],
			handles: 's',
			minHeight: 300,
			resize: function(e, ui){
				var screen_w = ui.size.width;
				var screen_h = ui.size.height;
				resizeVideo(screen_w, screen_h);

				if ($('#others_video_wrap').height() <= 300) {
					$('#others_video_wrap').height(300); // set minimum 300
				}

				// change device orientation
				if (
					typeof eventTeacher.deviceDidChangeOrientation !== 'undefined' &&
					$.isFunction(eventTeacher.deviceDidChangeOrientation) &&
					connect.deviceBounds
				) {
					eventTeacher.deviceDidChangeOrientation();
				}
			}
		});

		if(!$('#new_face_recognition_orange').is(':visible') && !$('#dialog_environment').is(':visible')) {
			triggerCheckCameraModal();
		}
	
	}, 1);

	$("a.disable").click(function(){
		return false;
	});

	if (nowStatus == "7" && nowRemarks == "4") {
		displayLessonModal();
	}

	/// event show sidebar
	$('#page_contents_tabs_icon').click(function() {

		/// set width to default value 155
		$('#page_contents_tabs').width(155);
		$.cookie('MenuBarWidth', 155);

		$('#page_contents_tabs').show();
		calculateMenuBar();
	});

	///NJ-12087 set top sibadrbutton if teacher in stand by mode
	var headbarTop = $('#nc-t-header-wrap').css('top');
	if(typeof headbarTop == 'string' && headbarTop.charAt(0) != '0') {
		// set #page_contents_tabs_icon top same as #nc-t-header-wrap
		$('#page_contents_tabs_icon').css('top', headbarTop);
	}

	if (!avatarFlg && !avatarParentFlg) {
		$("#teacher_sound_effects").css({
			top: "12%",
			right: "18%",
		});
	}

	$('.sound-effects-wrap').hide();

	$('#sound-effects-btn').click(function() {
		$('.sound-effects-wrap').toggle();
	});

	$("#teacher_sound_effects").on('click', '.play_common_effects', function () {
		if (!allowedToPlayAvatarPhrase) {
			return false;
		}
		
		let audioUrl = $(this).data('audio_url');
		let btnPlayed = $(this).attr('id');
		let teacherSoundEffectId = $(this).data("sound_effect_id");

		if(typeof(window.parent.textToSpeech) != 'undefined' && $.isFunction(window.parent.textToSpeech)){
			window.parent.textToSpeech('', '', btnPlayed, audioUrl, teacherSoundEffectId);
		}
	});

	$('#teacher_sound_effects').draggable({ 
		handle: "img",
		containment: 'body',
	});

	// NJ-7873 : Face Recognition Upon Login
	var userAuth = "Array";
	var teacherStatus = "5";
	var setCountRegistered = "0";
	var setCountRecogToday = "0";
	var videoFaceRecognition = document.getElementById("sndVideoFaceRecognition");
	var canvasFaceRecognition = document.getElementById("canvasFaceRecognition");
	var previousDetectImage = null;
	var characterCameraList = null;
	var cameraLabel = null;
	var audio = new Audio('../audio/camera.mp3');

	// Check if the teacher's current status is in array of ff. 1: on going lesson, 2: on standby, 3: standby for reservation
	var teacherStatusInt = parseInt(nowStatus);
	if ([1, 2, 3].indexOf(teacherStatusInt) !== -1) {
		$("#teacher_sound_effects").removeClass("hide");
	}

	//NJ-34164
	var isTeacherFaceRecogExempt = "1";
	var faceRecogStatus = "1";

	// Check if counter value exists in sessionStorage
	let faceRecAttempt = sessionStorage.getItem('faceRecogAttmpt');
	let statusFaceRecog = sessionStorage.getItem('status');

	// If counter value doesn't exist, initialize it to 0
	if (faceRecAttempt === null) {
		faceRecAttempt = 0;
	} else {
		// If counter value exists, parse it to integer
		faceRecAttempt = parseInt(faceRecAttempt);
	}

	if (statusFaceRecog === null) {
        statusFaceRecog = 0;
    }

	navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
		if (
			userAuth &&
			!inactiveFlg && 
			teacherStatus == 5 && 
			!testFlg && 
			!isTeacherFaceRecogExempt && 
			(
				typeof hasOngoingLesson == "undefined" || 
				(typeof hasOngoingLesson != "undefined" && !hasOngoingLesson) || 
				!hasLesson
			) && 
			customer_support_flg != 1
		) {
			if(faceRecogStatus) {
                displayFaceRecognition();
            }
		}

		function displayFaceRecognition() {
			if(!faceRecogStatus) {
                return false;
            }
        if (setCountRecogToday == 0) {
			if(!$('#new_face_recognition_orange').is(':visible')) {
				$('#trigger_new_face_recognition_orange').trigger('click');
			}
			if ('mediaDevices' in navigator && 'getUserMedia' in navigator.mediaDevices) {
				navigator.mediaDevices.getUserMedia({
					video: true
				}).then((stream) => {
					if (typeof $("#sndVideoFaceRecognition")[0] != "undefined" && typeof stream.getTracks()[0] != "undefined"){
						$("#sndVideoFaceRecognition")[0].srcObject = (stream);
						$("#sndVideoFaceRecognition")[0].play();
						cameraLabel = stream.getVideoTracks()[0].label;
						track = stream.getTracks()[0];

						// if avatar check if camera use is not animaze
						if (avatarFlg) {
							checkAvatarCamera(cameraLabel, function(isAnimaze) {
								updateTimer(isAnimaze);
							});
						} else {
							updateTimer(0);
						}
					}
				}).catch((err) => {
					$('#trigger_teacher_face_recog_no_camera').click();
					console.error(`The following error occurred: ${err.name}`);
				})
			} else {
				console.log("getUserMedia not supported");
			}
		} else {
			if (setCountRecogToday == 0){
				$('#trigger_new_face_recognition_orange').trigger('click');

				if ('mediaDevices' in navigator && 'getUserMedia' in navigator.mediaDevices) {
					navigator.mediaDevices.getUserMedia({
						video: true
					}).then((stream) => {
						if (typeof $("#sndVideoFaceRecognition")[0] != "undefined" && typeof stream.getTracks()[0] != "undefined"){
							$("#sndVideoFaceRecognition")[0].srcObject = (stream);
							$("#sndVideoFaceRecognition")[0].play();
							cameraLabel = stream.getVideoTracks()[0].label;
							track = stream.getTracks()[0];

							// if avatar check if camera use is not animaze
							if (avatarFlg) {
								checkAvatarCamera(cameraLabel, function(isAnimaze) {
									updateTimer(isAnimaze);
								});
							} else {
								updateTimer(0);
							}
						}
					}).catch((err) => {
						$('#trigger_teacher_face_recog_no_camera').click();
						console.error(`The following error occurred: ${err.name}`);
					})
				} else {
					console.log("getUserMedia not supported");
				}
			} else {triggerCheckCameraModal()}
		}
		}
		

		function updateTimer(isAnimaze) {
		if (previousDetectImage == null) {
			teacherFaceRecognition(isAnimaze);
		} else {
			$('#nfr_countdown').html(`
				<div id="nfr_countdown_number">5</div>
				<svg>
					<circle id="count_animate" class="animate" r="27" cx="30" cy="30"></circle>
				</svg>
			`);

			let countDown = 4;
			let countdownNumberEl = document.getElementById('nfr_countdown_number');
			let circle = document.querySelector('svg circle');

			let countdownInterval = setInterval(() => {
				if (countDown === 0) {
					clearInterval(countdownInterval);
					circle.style.animation = 'none';
					countdownNumberEl.style.color = 'white';
					teacherFaceRecognition(isAnimaze);
					// Play the audio
					audio.play();
				} else {
					countdownNumberEl.textContent = countDown;
					countdownNumberEl.style.animation = 'zoomIn 1s infinite forwards';
				}
				countDown -= 1;
			}, 1000);
		}
	}

	/** 
	 * Check if camera use is not animaze
	 */
	function checkAvatarCamera(cameraCheck, callback) {
        if (!statusFaceRecog && faceRecAttempt > 3){
            sessionStorage.removeItem('faceRecogAttmpt');
            sessionStorage.removeItem('status');
            location.href = '/teacher/logout';
        } else if (characterCameraList == null) {
            $.ajax({
                url : "/teacher/Api/virtualCameraAllow",
                type: 'POST',
                success: function(res) {
                    faceRecAttempt++;
                    characterCameraList = res;
                    // check if camera use is not animaze
                    callback(characterCameraList.includes(cameraCheck) ? 1 : 0);
                },
                error: function() {
                    faceRecAttempt++;
                    characterCameraList = ["Animaze Virtual Camera"];
                    // check if camera use is not animaze
                    callback(characterCameraList.includes(cameraCheck) ? 1 : 0);
                }
            });
        } else {
            faceRecAttempt++;
            // check if camera use is not animaze
            callback(characterCameraList.includes(cameraCheck) ? 1 : 0);
        }
    }
	
	/**
	 * Face Recognition Upon Login
	 */
	function teacherFaceRecognition(isAnimaze) {
		var ctxCanvas = canvasFaceRecognition.getContext("2d");
		var detectImage = null;
		try {
			var scale = Math.min(canvasFaceRecognition.width / videoFaceRecognition.videoWidth, canvasFaceRecognition.height / videoFaceRecognition.videoHeight);
			var x = (canvasFaceRecognition.width / 2) - (videoFaceRecognition.videoWidth / 2) * scale;
			var y = (canvasFaceRecognition.height / 2) - (videoFaceRecognition.videoHeight / 2) * scale;

			ctxCanvas.drawImage(videoFaceRecognition, x, y, videoFaceRecognition.videoWidth * scale, videoFaceRecognition.videoHeight * scale);
			detectImage = canvasFaceRecognition.toDataURL("image/jpeg");
		} catch(err) {
			console.log(err);
		}
		//- check if image has changes
		if (
			previousDetectImage != null &&
			previousDetectImage !== detectImage &&
			has_face_req == false && 
			detectImage != null
		) {
			$.ajax({
				type: 'POST',
				url: "/teacher/Home/faceReceiver",
				dataType: 'json',
				data: {
					image_capture: detectImage,
					is_animaze: isAnimaze
				},
				success: function(res) {
                    has_face_req = false;
                    statusFaceRecog = res.status;
                    sessionStorage.setItem('status', statusFaceRecog);
                    if (avatarFlg != 1 && !res.status && faceRecAttempt >= 2){
                        sessionStorage.removeItem('faceRecogAttmpt');
                        sessionStorage.removeItem('status');
                        location.href = '/teacher/logout';
                    } else if(res.registered) {
                        detected_face = 0;
                        setTimeout(function(){
                            $('#new_face_recognition_orange .btn-close').trigger('click');
                            track.stop();
                            triggerCheckCameraModal();
                        }, 1000);
                        $('#new_face_recognition_orange .face_wrap').addClass('checked');
                    } else if (!res.registered && res.isFailedRecog && res.faceDetected > 0 && res.status && faceRecAttempt >= 0 && res.faceSaved) {
						detected_face = 0;
                        setTimeout(function(){
                            $('#new_face_recognition_orange .btn-close').trigger('click');
                            track.stop();
                            triggerCheckCameraModal();
                        }, 1000);
                        $('#new_face_recognition_orange .face_wrap').addClass('checked');
                        setTimeout(function(){
                            $('#trigger_new_face_recognition_mismatch').trigger('click');
                            triggerCheckCameraModal();
                        }, 2000);
                    } else if (res.status && !res.isFailedRecog) {
                        detected_face = 0;
                        setTimeout(function(){
                            $('#new_face_recognition_orange .btn-close').trigger('click');
                            track.stop();
                            triggerCheckCameraModal();
                        }, 1000);
                        $('#new_face_recognition_orange .face_wrap').addClass('checked');
                    } else if (res.noFace && !res.status){
                        if(avatarFlg != 1){
                            faceRecAttempt++;
                        }
                        sessionStorage.setItem('faceRecogAttmpt', faceRecAttempt.toString());
                        displayFaceRecognition();
                    }
                },
				error: function (xhr, ajaxOptions, thrownError) {
					has_face_req = false;
					console.warn(xhr.status);
					console.warn(thrownError);
				}
			});
		} else {
			previousDetectImage = detectImage;
			displayFaceRecognition();
		}
	}
});
/**
 * ~ arrange modal according to priority
 **/
function notStandyModalSync() {
	if (localStorage.getItem('show_avatar_use_phrase_modal')){
		angular.element($("body[ng-app='teacherApp']")).scope().showAvatarPhraseModal();
	} else {
		if (!chat && $('#face_recognition_flag').length && !$('#face_recognition_flag').is(':visible')) {
			$('#face_recognition_flag').removeClass('hide');
		}
	}
}

function hideSidebar() {
	// set sidebar width = 1
	$('#page_contents_tabs').width(0);
	// set sidebar hide
	$('#page_contents_tabs').hide();

	/// set cookie save sidebar with to 100, reserve for menubar button
	$.cookie('MenuBarWidth', 100);

	calculateMenuBar();
}

// NJ-12087 function calcutlate MenuBar copy by function $(window).on('load' below
function calculateMenuBar() {
	var MenuBar = $('#page_contents_tabs')
	var PaneMiddleLeft = $('#pane--middle_left');
	var PaneMiddleLeftInnerContent = $('#nc-t-page-content');
	var headerWrap = $("#nc-t-header-wrap");
	var MenuBarWidth = $.cookie('MenuBarWidth');
	var PaneMiddleLeftWidth = $.cookie('PaneMiddleLeftWidth')
	/*====Assign cookie value to script_variable====*/
	if(MenuBarWidth ){
		// if the cookie value already exists
		headerWrap.css("width", "calc(100vw - " + MenuBarWidth + "px)");
		headerWrap.css("left", MenuBarWidth + "px");
		MenuBar.css("width", MenuBarWidth)
		PaneMiddleLeft.css("width", PaneMiddleLeftWidth)
		if ($('#pane--middle_right').css("display") == "none" ){
			//substitute #nc-t-header-wrap's width for #nc-t-page-content's width
			PaneMiddleLeftInnerContent.css("width",headerWrap.css("width")); 
			PaneMiddleLeft.css("width", "")
			//reset cookie value
			$.cookie('PaneMiddleLeftWidth', "")
		} 
	}
}

async function triggerCheckCameraModal() {
	var scope = angular.element($("body[ng-app='teacherApp']")).scope();
	if((avatarFlg || avatarParentFlg) && !testFlg) {
		var cameraForTeacherAvatar = false;
		await getCurrentCameraStream().then(function(cameraCheck) {
			cameraForTeacherAvatar = cameraCheck ? cameraCheck : false;
		});
		if (!cameraForTeacherAvatar) {
			$('#modal_overlay, .close_modal, .btn_close').addClass('not-virtual-camera');
		} else {
			triggerModal();
		}
	} else {
		triggerModal();
	}
}

$(document).on('click', '.not-virtual-camera', function(){
	$('#modal_overlay, .close_modal, .btn_close').removeClass('not-virtual-camera');
	triggerModal();
});

function triggerModal() {
	var scope = angular.element($("body[ng-app='teacherApp']")).scope();

	if (!$.cookie("displayed_stealth_notice") && stealthFlg && !inactiveFlg) {
		scope.deactivate_modal_show = true;
	}

	if(!$.cookie("teacherEnvironmentModal_"+window.teacherId)) {
		environmentCheckModal();
	}
	scope.deactivate_environment_modal_show = true;
	scope.checkTeacherEnvironmentCheck();
}

/*----------------------------------------------*/
// NJ-10076
/*----------------------------------------------*/
function environmentCheckModal() {
	var modal_popup = "";
	var inactive_flg = "";
	var last_login = "";

	console.log('line 723', !$.cookie("teacherEnvironmentModal_"+window.teacherId) );

	if(modal_popup && !inactive_flg && last_login) {
		const envContainer = document.getElementById('environment-check-scripts-container');
		
		if (!envContainer) return;

		const hasChildren = envContainer.hasChildNodes();
		let loadedScripts = 0;

		if (!hasChildren) {
			const scriptUrls = [
				'/teacher/js/webrtcv2/connectEnvModal.js?v=2.16.352',
				'/teacher/js/webrtcv2/util.js?v=2.16.352',
				'/teacher/js/webrtcv2/DetectRTC.js?v=2.16.352',
				'/teacher/js/webrtcv2/event.student.test.js?v=2.16.352',
				'/teacher/js/webrtcv2/sound.meter.js?v=2.16.352',
				'/teacher/js/webrtcv2/webrtc.testing.module.js?v=2.16.352',
			];

			for (let i = 0; i < scriptUrls.length; i++) {
				let s = document.createElement('script');
				s.type = 'text/javascript';
				s.src = scriptUrls[i];
				document.getElementById('environment-check-scripts-container').appendChild(s);

				s.onload = function() {
					loadedScripts++;
					if (loadedScripts === scriptUrls.length) {
						connectEnvModal.processIceServers(iceServers);
						connectEnvModal.isUsingSkyWay = "";
						connectEnvModal.skyWayApiKey = "";
						constant.videoBitRate = "";
						constant.audioBitRate = "";

						connectEnvModal.config = {
							memberType: "teacher-test",
							memberName: "",
							chatHash: "NATIVECAMP_ROOM-TEST",
							teacherID: "",
							userID: "449595",
							userSalt: "TEACHER-" + util.getSalt(8) + '-' + "449595",
							ipAdd: "193.163.187.65"
						};

						connectEnvModal.testing = true;
					}
				};
			}
		}

		$('#trigger_dialog_environment').addClass('trigger_dialog_environment');
		$('#modal_overlay').addClass('dialog-env-popup');

		var no_login_period = "";

		var period = "";
		var lesson_system_trouble = "";
		var total_lessons = "";

		var teacher_last_login_time = "";
		var connection_problem_percentage = "";
		var checkProblemPercentage = "";
		var connection_problem_number = "";
		var checkNumberOfConnectoinProblem = "";

		console.log('');
		console.log('');
		console.log('/*-------Test Environment Result Check----------*/')
		console.log('CONDITION SETTING: ')
		console.log('no_login_period(' + no_login_period + ') <= teacher_last_login_time(' + teacher_last_login_time + ') =', parseInt(no_login_period) <= parseInt(teacher_last_login_time));
		console.log('');
		console.log('CONNECTION PROBLEM: ')
		console.log('Period =', period);
		console.log('Total Lessons in', period +' days ago =', total_lessons);
		console.log('Total Lesson System Trouble in', period +' days ago =', lesson_system_trouble);
		console.log('To Get Problem Percentage = (total_system_trouble / total_lessons) * 100');
		console.log('');
		console.log('(connection_problem_number(' + connection_problem_number + ') <= checkNumberOfConnectoinProblem(' + checkNumberOfConnectoinProblem + ') =', parseInt(connection_problem_number) <= parseInt(checkNumberOfConnectoinProblem), ') && (connection_problem_percentage(' + connection_problem_percentage + ') <= checkProblemPercentage(' + checkProblemPercentage + ') =', parseInt(connection_problem_percentage) <= parseInt(checkProblemPercentage) ,') =', parseInt(connection_problem_percentage) <= parseInt(checkProblemPercentage) && parseInt(connection_problem_number) <= parseInt(checkNumberOfConnectoinProblem));
		console.log('');
		console.log( 'MODAL_POPUP =', (parseInt(no_login_period) <= parseInt(teacher_last_login_time)) || ((parseInt(connection_problem_percentage) <= parseInt(checkProblemPercentage)) && (parseInt(connection_problem_number) <= parseInt(checkNumberOfConnectoinProblem))) );
		console.log('/*----------------------------------------------*/')
		console.log('');
		console.log('');
	} else {

		if(last_login) {
			console.log('');
			console.log('');
			console.log('/*-------Test Environment Result Check----------*/')
			console.log( '----------  Modal Popup = false ----------------' );
			console.log('/*----------------------------------------------*/')
		} else {
			console.log('');
			console.log('');
			console.log('/*-------Test Environment Result Check----------*/')
			console.log( '----------  Modal not popup in a next login within a day ----------------' );
			console.log('/*----------------------------------------------*/')
		}
	}
}

/* NC-9203 : Stealth Flag ON modal */
function actionNoted() {
	var scope = angular.element($("body[ng-app='teacherApp']")).scope();
	// don't allowed to close until click event in dashboard hasn't initialize yet
	if (scope.modal_overlay_evt_init) {
	  $.cookie("displayed_stealth_notice", true);
	  if(!$('#change_timezone_notice').is(':visible')) {
			$("#modal_overlay, #cover_layer").fadeOut(200);
	  }
		$('#modal_overlay:visible').click();
		$('#stealth_flag').css({"display":"none"});
	}
}

function displayLessonModal(){
	/* set lesson message */
	var lessonMsg = "";
	var lessonTitle = "";
	var displayMessage = localStorage.getItem('teacherDisplayMessage');

	/* switch */
	switch (displayMessage) {
		case 'lessonOnairsDeleted':
			lessonTitle = "Lesson Finished";
			lessonMsg = "You were disconnected from your previous lesson.";
			break;
		case constant.disconnect.student.others:
			lessonTitle = "Student Exit";
			lessonMsg = "During your previous lesson, the student <br/> prematurely ended the lesson.";
			break;
		case constant.disconnect.student.timeOut:
			lessonTitle = "Student Timed Out";
			lessonMsg = "During your previous lesson, the student was unable to connect <br/> within the reconnection threshold.";
			break;
		case constant.disconnect.student.forceDisconnect:
			lessonTitle = "Student Force Disconnection";
			lessonMsg = "During your previous lesson, the student forcefully disconnected the lesson.";
			break;
		default:
	}

	// check if can perform 3 minutes break
	if (threeMinOtherBreak) {
		// execute preparte other logic
		if (
			typeof angular.element($("body[ng-app='teacherApp']")).scope().toPrepareOther !== 'undefined' &&
			$.isFunction(angular.element($("body[ng-app='teacherApp']")).scope().toPrepareOther)
		) { angular.element($("body[ng-app='teacherApp']")).scope().toPrepareOther(false, false); }

	} else {
		/* return lesson message */
		if (lessonMsg.length === 0) { return; }

		/* set html */
		$('#dialog_teacher_lesson_notice .lesson_notice').html(lessonMsg);
		$('#dialog_teacher_lesson_notice h3').html(lessonTitle);

		/* open modal */
		setTimeout(function(){
			console.warn("lesson notice -> 1");
			angular.element($("body[ng-app='teacherApp']")).scope().afterLessonModalSync('teacher_lesson_notice');
			setTimeout(function(){ $('#dialog_teacher_lesson_notice .btn_close').click(); }, 5000);
		}, 500);
	}
}

/*----------------------------------------------*/
// cookie
/*----------------------------------------------*/
// if nationality is eu and cookie is not set
if (typeof isEuropeanUnion !== "undefined" && isEuropeanUnion == 1 && ($.cookie('privacy-policy') == 'undefined' || $.cookie('privacy-policy') != 1)) {
	$(".popup_cookie").fadeIn(300); // display modal
} else {
	$(".popup_cookie").fadeOut(300); // hide modal
}

$(document).on('click', '#cookie_confirm', function(){
	$(this).closest('.popup_cookie').fadeOut(300); // hide modal
	$.cookie('privacy-policy', 1, {expires: 3650}); // save cookie, expires in 10 years
});

/*----------------------------------------------*/
// resizeVideo
/*----------------------------------------------*/
function resizeVideo(box_w,box_h){
	if((box_w / box_h) > (4 / 3)){ // adjust for height
		var flash_h = box_h;
		var flash_w = flash_h * 4 / 3;
		// console.log('height : ' + flash_h);
		// console.log('width : ' + flash_w);
	} else{  // adjust for width
		var flash_w = box_w;
		var flash_h = flash_w * 3 / 4;
		// console.log('width : ' + flash_w);
		// console.log('height : ' + flash_h);
	}

	/* if */
	if ($('#btn-swap_video').hasClass('on') === false) {
		$('#others_video_wrap').css({ width: flash_w + 'px', height: flash_h + 'px' });
	} else {
		if (nowStatus == "2" || nowStatus == "3") { return; }
		$('#own_video_wrap').css({ width: flash_w + 'px', height: flash_h + 'px' });
	}

	/* if peer's camera is disabled, show student's avatar */
	if ($('#btn-video_own').hasClass('on') === false) {
		$("#ownVideoCanvas").hide();
		$("#ownVideo").hide();
		
	/* else, show no stream poster */
	} else { 
		if (typeof window.parent.allowSetBG !== "undefined" && window.parent.allowSetBG) {
			$("#ownVideoCanvas").show();
			$("#ownVideo").hide();
		}
		
	}
	
	// - if needs resize
	if (typeof needsBGResize !== "undefined") {
		needsBGResize =  true;
	}
}

/*----------------------------------------------*/
// layout select
/*----------------------------------------------*/
$(document).on("click","#layout_select a",function(e) {
	e.preventDefault();
	if($(this).hasClass('disable')){
		return;
	}
	var layout_id = $(this).attr('data-layout');
	var wrapper = $("#pane_wrap--middle");
	switch(layout_id){
		case '1':
			wrapper.addClass("layout_1");
			wrapper.removeClass("layout_2");
		break;
		case '2':
			wrapper.addClass("layout_2");
			wrapper.removeClass("layout_1");
		break;
		default:
			wrapper.addClass("layout_1");
			wrapper.removeClass("layout_2");
		break;
	}
	$('#layout_select a').removeClass('on');
	$(this).addClass('on');
});
// Check if teacher has a recent canceled lesson(reservation) OR remove lesson cancelation memcached
function disconnectionCancellationMemCached (checkerType = 'check'){
	$.ajax({
		url: '/teacher/api/disconnectionCancellationMemCached',
		data: {checker:checkerType},
		type: 'get',
		success: function(res) {},
	}).always(function(res){
		var resp = $.parseJSON(res);
		if (typeof resp !== 'undefined' && resp !== null && typeof resp.has_lessonCancel !== 'undefined' && resp.has_lessonCancel === true) {
            $('#trigger_modal_disconnection_cancellation').click();
        }
	});
}
// NJ-33115
function updatePageNumberValue(pagenum){
	console.log("Update page value to " + pagenum);
	if (!$('#pageNumberOption option[value="' + pagenum + '"]').length) {
		$('#pageNumberOption').append($('<option>', {
			value: pagenum,
			text: pagenum
		}));
	}
	// Set the newly added option as selected
	$('#pageNumberOption').val(pagenum);
	$('#tb_page_jump_confirm').click();
}
$(document).ready(function(e) {
	setTimeout(function(){
		disconnectionCancellationMemCached();
	}, 3000);
});

	function lowerSnake(str){
		return str.split(' ').join('_').toLowerCase();
	}

	function openAudioErrorModal() {
		$('#trigger_modal_audio_error_alert').click();
	}
	$(window).on('load', function(){
		
		var MenuBar = $('#page_contents_tabs')
		var PaneMiddleLeft = $('#pane--middle_left');
		var PaneMiddleLeftInnerContent = $('#nc-t-page-content');
		var headerWrap = $("#nc-t-header-wrap");
		var MenuBarWidth = $.cookie('MenuBarWidth');
		var PaneMiddleLeftWidth = $.cookie('PaneMiddleLeftWidth')
		/*====Assign cookie value to script_variable====*/
		if(MenuBarWidth ){
			// if the cookie value already exists
			headerWrap.css("width", "calc(100vw - " + MenuBarWidth + "px)");
			headerWrap.css("left", MenuBarWidth + "px");
			MenuBar.css("width", MenuBarWidth)
			PaneMiddleLeft.css("width", PaneMiddleLeftWidth)
			if ($('#pane--middle_right').css("display") == "none" ){
				//substitute #nc-t-header-wrap's width for #nc-t-page-content's width
				PaneMiddleLeftInnerContent.css("width",headerWrap.css("width")); 
				PaneMiddleLeft.css("width", "")
				//reset cookie value
				$.cookie('PaneMiddleLeftWidth', "")
			} 
		}

		// NJ-12087: if sidebar width is small, do hide
		if(MenuBarWidth < 150) {
			hideSidebar();
		}

		setTimeout(function(){
		/*===Adjust maxWidth for menubar,pane-middle====*/
		$('#pane--middle_left,#page_contents_tabs').resize(function() {
			var MenuBarWidth = MenuBar.width();
			var MenuBarWidthDefault = 148;
			var PaneMiddleLeftWidth = PaneMiddleLeft.width();
			var paneMiddleLeftWidthWhenMenuBarWidthMax = 260;
			$('#pane--middle_left').resizable({
				minWidth:150 + MenuBarWidth - MenuBarWidthDefault,
			});
			if(PaneMiddleLeftWidth < 260){
				$('#page_contents_tabs').resizable({
				minWidth: 150,
				maxWidth: 260 - paneMiddleLeftWidthWhenMenuBarWidthMax + PaneMiddleLeftWidth,
				});
			}
			});
		},100);
		/*====save value in cookie===*/
		MenuBar.resizable({
		stop: function (e,ui) {
			//these cookie will be expired when browser is quitted
			var MenuBarWidth = MenuBar.width();
			$.cookie('MenuBarWidth', MenuBarWidth + 2);
			
				//sidebar width is small, do hide it
				if(ui.size.width <= 150) {
					hideSidebar();
				}
			}
		});
		PaneMiddleLeft.resizable({
			stop: function() {
				var PaneMiddleLeftWidth = PaneMiddleLeft.width();
				$.cookie('PaneMiddleLeftWidth', PaneMiddleLeftWidth)
			}
		});

			
	});
</script>

<!-- environment check scripts  -->
<div id="environment-check-scripts-container"></div><!-- test -->
<!-- dialog_opening_slots_limit >>>  -->
<a class="hide" rel="modal" href="#monitor_modal" id="trigger_monitor_modal"></a>
<div class="modal-window dialog hide static_overlay" id="monitor_modal">
	<div class="modal_inner">
		<div class="rating_complete_wrap">
			<p class="c_red fs_25 fw_b t_center m_b_20" style="color: black!important; font-weight: 600;">Are you there?</p>
			<div style="width: 100%;display:flex;margin-bottom:30px;">
				<img src="./images/common/youthere.png" alt="Are you there?" style="margin:0 auto;height:200px;width:200px;">
			</div>
			<p class="m_t_10" style="text-align:center;font-size:14px!important;">Our system has just detected that you are not in front of your <br> PC / Laptop. 
				To avoid any problems with students, your status has<br> changed from "Standby" to "Not Standby".<br><br>
				If you want to go on "Standby" again, click the "I'm here" <br> button below within <span id="countdown-timer">60</span> seconds.
				If you do not press <br>the button, your status will remain "Not Standby"<br> even after this message disappears.
			</p>
			<div class="btn_wrap btn_center m_t_30 cf">
				<ul class="d_table">
					<li class="d_cell"><a class="btn_style btn_gray close_modal" id="monitor-here" style="background-color: #e69138!important;color: #fff!important;text-transform: uppercase;min-width:200px!important;font-size:18px!important;padding:0!important;">I'm Here</a></li>
				</ul>
			</div>
		</div>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<!-- <<< -->

<!-- dialog windows -->
<!-- restart the class if a user is seeking !-->
<div class="modal-window dialog hide" id="dialog_manual_reconnect">
	<h3>There is a student that wants to start a class with you.</h3>
	<p class="t_center">Would you like to start a class again?</p>
	<div class="btn-wrap btn-center m-t-30">
		<a class="nc-t-btn nc-t-btn-orange-o close_modal remove_seeker_2" href="javascript:void(0)">NO</a>
		<a class="nc-t-btn nc-t-btn-orange close_modal submit" href="javascript:void(0)" id="restartCall_2">YES</a>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<a rel="modal" href="#dialog_manual_reconnect" id="trigger_dialog_manual_reconnect"></a>

<!-- re-connect call again >>>  -->
<div class="modal-window dialog hide" id="dialog_reconnecting">
	<h3>Unexpected Disconnection.</h3>
	<p class="t_center">Do you want to start the class again?</p>
	<div class="btn-wrap btn-center m-t-30">
		<a class="nc-t-btn nc-t-btn-orange-o close_modal remove_seeker" href="javascript:void(0)">NO</a>
		<a class="nc-t-btn nc-t-btn-orange close_modal submit" href="javascript:void(0)" id="restartCall">YES</a>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<a rel="modal" href="#dialog_reconnecting" id="trigger_dialog_reconnecting"></a>

<!-- logout >>>  -->
<div class="modal-window dialog hide" id="dialog_logout">
	<h3>LOGOUT</h3>
	<p class="t_center">Are you sure to logout now?</p>
	<div class="not_sent_msg" id="logout_not_sent_msg">
		<p class="t_center" style="color:#f00; font-weight:bold;">You have not sent messages yet.</p>
	</div>
	<div class="btn-wrap btn-center m-t-30">
		<a class="nc-t-btn nc-t-btn-orange-o close_modal" href="javascript:void(0)">NO</a>
		<a class="nc-t-btn nc-t-btn-orange" onclick="closeProtection = false;" id="logout" href="/teacher/logout/?action=modal_logout">YES</a>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<a rel="modal" href="#dialog_logout" id="trigger_dialog_logout"></a>

<!-- Callan message after lesson >>>  -->
<a rel="modal" href="#dialog_callan_message_after_lesson" id="trigger_dialog_callan_message_after_lesson"></a>
<div class="modal-window dialog hide" id="dialog_callan_message_after_lesson">
	<h3>Lesson Message Reminder</h3>
	<p class="t_center" style="word-break: break-word;">
		Please send the message to the student as soon as possible, So that other teachers will have the next lesson without any problem.
	</p>
	<div class="btn-wrap btn-center m-t-30">
		<a class="nc-t-btn nc-t-btn-orange close_modal" id="trigger_dialog_callan_message_after_lesson_ok" href="javascript:void(0)">OK</a>
	</div>
	<div class="btn-close btn_close"></div>
</div>

<div class="modal-window dialog hide" id="dialog_help">
	<h3>Do you want to ask help?</h3>
	<div class="btn_wrap btn_half cf">
		<ul>
			<li><a class="btn_style gray close_modal" href="javascript:void(0)">NO</a></li>
			<li><a class="btn_style red close_modal" href="javascript:void(0)" id="seek_help" ng-click="isAskingHelp()">YES</a></li>
		</ul>
	</div>
	<div class="btn-close btn_close"></div>
</div>

<a rel="modal" href="#select_lessonSchedule_fail" id="trigger_select_lessonSchedule_fail"></a>
<div class="modal-window dialog hide" id="select_lessonSchedule_fail">
	<h3>Schedules can't be change during breaktime.</h3>
	<div class="btn_wrap btn_half cf t_center">
		<a class="btn_style gray close_modal" href="javascript:void(0)">OK</a>
	</div>
</div>
<!-- <<< -->

<a rel="modal" href="#dialog_reservation_on_meal_break" id="trigger_dialog_reservation_on_meal_break"></a>
<div class="modal-window dialog hide" id="dialog_reservation_on_meal_break">
	<h3>NOTICE</h3>
	<div class="t_center">
		<p class="d_i_block t_left">
			You are in one of the situations below.<br>
			Check your schedule before you leave.
		</p>
		<br>
		<p class="d_i_block t_left m-t-20">
			・You have a reservation within 1 hour.<br>
			・You forgot to close your slot within 1 hour.
		</p>
	</div>
	<div class="btn-wrap btn-center">
		<a class="nc-t-btn nc-t-btn-orange close_modal" href="javascript:void(0)">OK</a>
	</div>
	<div ng-click="closeReservationNotice()" class="custom_btn_close"></div>
</div>

<!-- confirm dismiss message -->
<a rel="modal" href="#dialog_confirm_dismiss_message" id="trigger_dialog_confirm_dismiss_message"></a>
<div class="modal-window dialog hide" id="dialog_confirm_dismiss_message">
	<div class="content ls-center">
		<p class="fs_22 fw_b m_b_15">Are you sure that you want to dismiss?</p>
		<div class="btn-wrap btn-center m-t-30">
			<button class="nc-t-btn nc-t-btn-orange-o close_modal">NO</button>
			<button ng-click="disableEnableMessage($event)" class="nc-t-btn nc-t-btn-orange btn--yes close_modal" data-action="2" data-lesson-id="0" data-lesson-disable-flg="0">
				YES
			</button>
		</div>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<!-- dismiss message -->
<a rel="modal" href="#dialog_dismiss_message" id="trigger_dialog_dismiss_message"></a>
<div class="modal-window dialog hide static_overlay" id="dialog_dismiss_message">
	<div class="content ls-center">
		<p class="fs_22 fw_b m_b_15">The message has been dismissed.</p>
		<p class="fs_22 fw_b m_b_15">You can check it from the dismissed Filter.</p>
	</div>
	<div class="btn-close btn_close" ng-click="close_dismiss_completion()"></div>
</div>

<!-- lesson memo save >>>  -->
<a class="hide" id="trigger_dialog_check_user_lesson_note" rel="modal" href="#dialog_check_user_lesson_note"></a>
<div class="modal_window dialog hide static_overlay" id="dialog_check_user_lesson_note">
	<h3 class="cf" style="width: 150px; margin: auto auto;">
		<div class="fl">
			<img src="/teacher/images/common/loader.gif" alt="">
		</div>
		<div class="fr" style="margin-top: 5px;">Loading</div>
	</h3>
	<div class="btn-close btn_close" style="display: none;"></div>
</div>
<!-- /. -->

<!-- check and validate multi slot schedule  -->
<a class="hide" id="trigger_dialog_check_validate_multislot_schedule_loading" rel="modal" href="#dialog_check_validate_multislot_schedule_loading"></a>
<div class="modal_window dialog hide static_overlay" id="dialog_check_validate_multislot_schedule_loading">
	<h3 class="cf" style="width: auto; margin: auto auto;">
		<div class="fl">
			<img src="/teacher/images/common/loader.gif" alt="">
		</div>
	</h3>
	<div class="btn-close btn_close btn_close_check_validate_multislot_schedule_loading" style="display: none;"></div>
</div>
<!-- /. -->

<!-- lesson memo save >>>  -->
<a class="hide" id="trigger_dialog_teacher_lesson_notice" rel="modal" href="#dialog_teacher_lesson_notice"></a>
<div class="modal-window dialog hide" id="dialog_teacher_lesson_notice">
	<h3>Notice</h3><hr>
	<p class="t_center lesson_notice"></p>
	<p class="t_center lesson_notice_seq"></p>
	<div class="btn-close btn_close"></div>
</div>
<!-- /. -->

<!-- NC-4027: 5 minutes and below lesson time modal >>>  -->
<a class="hide" id="trigger_lesson_5_min_and_below_modal" rel="modal" href="#lesson_5_min_and_below_modal"></a>
<div class="modal-window dialog hide" id="lesson_5_min_and_below_modal">
	<h3>Automatic STANDBY</h3><hr>
	<p>
		Since your current lesson was less than 5 minutes, you will NOT have a lesson preparation time.<br>
		The system will IMMEDIATELY redirect you to "STANDBY" mode.
	</p>
	<div class="btn-close btn_close"></div>
</div>
<!-- /. -->


<!-- Forced Logout By Admin >>>  -->
<a class="hide" id="trigger_dialog_force_teacher_disconnection" rel="modal" href="#dialog_force_teacher_disconnection"></a>
<div class="modal-window dialog hide static_overlay" id="dialog_force_teacher_disconnection" style="width: 650px;">
	<div class="btn_close hidden"></div>
	<h3>Forced Logout By Admin</h3><hr>
	<br>
	<!-- description -->
	<p style="font-size: 16px;">
		WT logged out your account forcely by the posibility of the following reasons.<br>
		1. You logged in wrong cubicle. Please check your cubicle number.<br>
		2. You left break or other status after the end of shift (You didn't logout successful).<br>
		If you have a concern about it. Please send your concern in TECH FORUM of skype.<br>

	</p>
	<!-- end of description -->

	<!-- code part -->
	<br><br>
	<p style="margin-top: 5px; padding: 5px; border: 2px dashed #ccc;" id="force_disconnection_msg_container"></p>
	<!-- end of code part -->

	<!-- button group -->
	<br>
	<br>
	<div class="cf t_center">
		<a class="btn_style btn_orange dft_cmn_btn" onclick="closeProtection = false;" id="dialog_force_teacher_dc_button" href="/teacher/logout?action=ng_force_teacher_logout">LOGOUT</a>
	</div>
	<!-- end of button group -->
</div>
<!-- lesson schedule cancellation for home base teacher -->
<a rel="modal" href="#dialog_reservation_cancel" id="trigger_dialog_reservation_cancel"></a>
<div class="modal-window dialog static-overlay hide modal-window-p" id="dialog_reservation_cancel">
	<div class="dialog_reservation_cancel">
		<div class="dialog_contents">
			<h3>Class Cancellation</h3>
			<p class="m-t-30 t-left fs-18">
				Are you sure you want to cancel the lesson? <br>
				If you make a cancellation, you will be penalized<br>
				according to our <a href="/teacher/home?guide=tutors-fee" target="_self" class="t-link c-orange new-tab-r-icon">policy</a><br>
				After you make a cancellation, you will not be able to open the same slot again.
			</p>
			<div class="reason_wrap m-t-20 m-b-40">
				<textarea name="" id="cancellationReasonTxt" class="size_max" oninput="disallowBlank(this)" placeholder="Please type the reason why you're cancelling this lesson..."></textarea>
			</div>
			<div class="btn-wrap btn-half cf m-t-30">
				<ul>
					<li><button class="btn-style btn-orange-border close_modal">NO</button></li>
					<!-- <li><button id="lesson-id-ok" class="btn-style btn-orange close_modal" ng-click="homeTeacherCancelReservation($event)">YES</button></li> -->
					<li><button id="lesson-id-ok" class="btn-style btn-orange close_modal" ng-click="homeTeacherCancelReservationConfirm($event)">YES</button></li>
				</ul>
			</div>
			<div class="btn-close btn_close"></div>
			</div>
			</div>
	</div>

<script>
	function disallowBlank(textarea) {
		if (textarea.value.trim() === "") {
			textarea.value = "";  // Reset the value if it's all blanks
			return;
		}
	}
</script>

<!-- lesson schedule cancel error  -->
<a rel="modal" href="#dialog_reservation_cancel_error" id="trigger_dialog_reservation_cancel_error"></a>
<div class="modal-window dialog static_overlay hide" id="dialog_reservation_cancel_error">
	<h3>Error Message</h3>
	<p style="text-align: center">Cannot cancel reservation.</p>
	<div class="btn-wrap btn-center">
		<ul>
			<li><a href="javascript:void(0)" class="btn_style orange close_modal">OK</a></li>
		</ul>
	</div>
</div>
<!-- /. -->


<!-- (connect flg = 0) error -->
<!-- <a rel="modal" href="#dialog_image_crop" id="trigger_dialog_image_crop"></a>
<div class="modal-window dialog hide static_overlay" id="dialog_image_crop" style="padding: 0px;">
	<div>
		<form name="thumbnail" action="" method="post">
			<div id="instruction_crop">
				<b>To crop your selected image, <br>click and drop a portion within the container</b>
			</div>
			<center>
				<img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" id="thumbnail" alt="Crop Image" />
			</center>
			<input type="hidden" name="x1" value="" id="x1" />
			<input type="hidden" name="y1" value="" id="y1" />
			<input type="hidden" name="x2" value="" id="x2" />
			<input type="hidden" name="y2" value="" id="y2" />
			<input type="hidden" name="w" value="" id="w" />
			<input type="hidden" name="h" value="" id="h" />
			<center>
				<-?php echo $this->Form->button('Upload', array(
						'type' => 'button',
						'id' => 'btn-submit-profile',
						'class' => 'btn_style orange'
					)); ?>
			</center>
		</form>
	</div>
	<div class="btn-close btn_close"></div>
</div> -->
<!-- end of forced lesson reconnect -->

<!-- dialog_photo_tips -->
<a class="hide" rel="modal" href="#dialog_photo_tips" id="trigger_dialog_photo_tips"></a>
<div class="modal-window modal-photo-tips hide" id="dialog_photo_tips">
	<div class="modal-inner">
		<h3 class="modal-title">Photo Tips</h3>
		<div class="title-wrap">
			<p class="text-border">Please upload a photo with the following references.</p>
		</div>
		<div class="words-wrap">
			<p class="text-1">In order to have an adequate profile photo and to attract more students with your professional profile, we are offering the manual for a program that you can use to improve your photo.</p>
			<p class="t-center">
				<a href="https://www.remove.bg/" taget="_blank" class="t-link-orange">https://www.remove.bg/</a>
			</p>

			<p class="text-2">This is only a short guide on how you should improve your photo:</p>
			<div class="ui_notice_list listmark-check t_left m_b_15">
				<ul>
					<li>You should have a white background</li>
					<li>You shouldn't wear white clothes (because of the white background)</li>
					<li>You shouldn't wear a headset or earphones</li>
					<li>You should not use hand gestures</li>
				</ul>
			</div>
			<p class="text-3">*If you have sent a picture which is not suitable for the Profile photo, we won't accept it and you will have to upload new one. Please check the best example profile pictures below:</p>
		</div>
		<div class="ex-wrap">
			<div class="ex ex-good">
				<div class="title-wrap">
					<div class="title title-good">Good Example</div>
				</div>
				<div class="ex-images">
					<div class="item">
						<div class="img-wrap">
							<img src="./images/account/photo-tips/good-1.jpg" alt="teacher thumb">
						</div>
					</div>
					<div class="item">
						<div class="img-wrap">
							<img src="./images/account/photo-tips/good-2.jpg" alt="teacher thumb">
						</div>
					</div>
					<div class="item">
						<div class="img-wrap">
							<img src="./images/account/photo-tips/good-3.jpg" alt="teacher thumb">
						</div>
					</div>
					<div class="item">
						<div class="img-wrap">
							<img src="./images/account/photo-tips/good-4.jpg" alt="teacher thumb">
						</div>
					</div>
				</div>
			</div>
			<div class="ex ex-bad">
				<div class="title-wrap">
					<div class="title title-bad">Bad Example</div>
				</div>
				<div class="ex-images">
					<div class="item">
						<div class="text-wrap">
							Photo should not<br>
							be crooked
							<div class="arrow"></div>
						</div>
						<div class="img-wrap">
							<img src="./images/account/photo-tips/bad-1.jpg" alt="teacher thumb">
						</div>
					</div>
					<div class="item">
						<div class="text-wrap">
							Photo should not<br>
							be black and white
							<div class="arrow"></div>
						</div>
						<div class="img-wrap">
							<img src="./images/account/photo-tips/bad-2.jpg" alt="teacher thumb">
						</div>
					</div>
					<div class="item">
						<div class="text-wrap">
							Photo should not<br>
							contain a hat
							<div class="arrow"></div>
						</div>
						<div class="img-wrap">
							<img src="./images/account/photo-tips/bad-3.jpg" alt="teacher thumb">
						</div>
					</div>
					<div class="item">
						<div class="text-wrap">
							Photo should not<br>
							be a long shot
							<div class="arrow"></div>
						</div>
						<div class="img-wrap">
							<img src="./images/account/photo-tips/bad-4.jpg" alt="teacher thumb">
						</div>
					</div>
				</div>
			</div>
		</div><!-- // .ex-wrap -->
		<div class="btn-wrap">
			<a class="nc-t-btn btn-style btn-border-orange close_modal btn-open-camera" href="javascript:void(0)">OK</a>
		</div>
	</div>
	<div class="btn-close btn_close"></div>
</div>

<!-- dialog_video_tips -->
<a class="hide" rel="modal" href="#dialog_video_tips" id="trigger_dialog_video_tips"></a>
<div class="modal-window modal-photo-tips modal-video-tips hide" id="dialog_video_tips">
	<div class="modal-inner">
		<h3 class="modal-title">Video Tips</h3>
		<div class="title-wrap">
			<p class="text-border">
				Please open video recorder or upload<br>
				pre-recorded video with the following references.
			</p>
		</div>
		<div class="words-wrap">
			<p class="text-2">This is only a short guide on how you should improve your video:</p>
			<div class="ui_notice_list listmark-check t_left m_b_15">
				<ul>
					<li>You should have a landscape format of the video</li>
					<li>You should have a plain background</li>
				</ul>
			</div>

			<p class="text-2">You should NOT mention the following:</p>
			<div class="ui_notice_list listmark-check listmark-x t_left m_b_15">
				<ul>
					<li>How old you are ( it is changeable and video will be old again next year and not correct)</li>
					<li>How long you are teaching (experience is not needed because it is also a changeable fact)</li>
					<li>How long you are teaching (experience is not needed because it is also a changeable fact)</li>
				</ul>
			</div>

			<p class="text-2">You should mention:</p>
			<div class="ui_notice_list listmark-check t_left m_b_15">
				<ul>
					<li>Your tutor's name</li>
					<li>Say a short introductory and invite students to book your class</li>
					<li>Proper use of grammar and pronunciation</li>
					<li>Speak clearly and not too fast or too slow</li>
					<li>English ONLY (EOP)</li>
					<li>Be enthusiastic, be positive!</li>
				</ul>
			</div>
		</div>
		<div class="ex-wrap">
			<div class="ex ex-good">
				<div class="title-wrap">
					<div class="title title-good">Good Example</div>
				</div>
				<div class="ex-images">
					<div class="item">
						<div class="img-wrap">
							<img src="./images/account/video-tips/good-1.jpg" alt="teacher thumb">
						</div>
					</div>
					<div class="item">
						<div class="img-wrap">
							<img src="./images/account/video-tips/good-2.jpg" alt="teacher thumb">
						</div>
					</div>
				</div>
			</div>
			<div class="ex ex-bad">
				<div class="title-wrap">
					<div class="title title-bad">Bad Example</div>
				</div>
				<div class="ex-images">
					<div class="item">
						<div class="img-wrap">
							<img src="./images/account/video-tips/bad-1.jpg" alt="teacher thumb">
						</div>
					</div>
					<div class="item">
						<div class="img-wrap">
							<img src="./images/account/video-tips/bad-2.jpg" alt="teacher thumb">
						</div>
					</div>
				</div>
			</div>
		</div><!-- // .ex-wrap -->
		<div class="btn-wrap">
			<a class="nc-t-btn btn-style btn-border-orange" href="/teacher/guide_popup" target="_blank">OPEN VIDEO RECORDER</a>
			<a class="nc-t-btn btn-style btn-border-black" href="/teacher/guide_popup?action=upload" target="_blank">UPLOAD PRE-RECORDED VIDEO</a>
		</div>
	</div>
	<div class="btn-close btn_close"></div>
</div>

<!-- 1 hour not standby logout >>> 1hour_notstandby_teacher_disconnection -->
<a class="hide" id="trigger_dialog_1hour_notstandby_teacher_disconnection" rel="modal" href="#dialog_1hour_notstandby_teacher_disconnection"></a>
<div class="modal-window dialog hide static_overlay" id="dialog_1hour_notstandby_teacher_disconnection" style="width: 650px;">
	<h3>60 Minutes Not Standby Disconnection</h3><hr>
	<!-- description -->
	<p style="font-size: 16px; word-break: break-word; text-align: center;">
		Since you had not changed your status for 60 minutes, you automatically logged out from the tutor screen. Please log in again.
	</p>
	<br>
	<br>
	<!-- end of description -->
	<!-- button group -->
	<div class="cf t_center">
		<a class="btn_style btn_orange dft_cmn_btn" onclick="closeProtection = false;" href="/teacher/">CLOSE</a>
	</div>
	<!-- end of button group -->
</div>


<a rel="modal" href="#edit_salary" id="trigger_edit_salary"></a>
<div class="modal-window dialog hide" rel="modal" id="edit_salary">
	<div>
		<span id="yearMonthLabel">Date: </span>
		<div>
			<input type="text" id="yearMonth" name="yearMonth" class="monthPicker">
		</div>
	</div>
	<div class="clearfix m_t_15"></div>
	<div id="editCutoffTypes">
		<span id="cutoffLabel">Cutoff Types: </span>
		<div></div>
	</div>
	<div class="btn-wrap btn-center">
		<ul>
			<li><button id="computeSalary" class="btn_style orange close_modal" ng-click="salary($event)">Ok</button></li>
			<li><button class="btn_style orange close_modal">Cancel</button></li>
		</ul>
	</div>
</div>
<a rel="modal" href="#dialog_loader" id="trigger_dialog_loader"></a>
<div class="modal-window dialog static_overlay hide" id="dialog_loader">
	<p class="t_center">
		<img src="/teacher/images/common/loader.gif">
	</p>
	<a class="btn_style btn_t_gray close_modal" href="javascript:void(0)" style="display: none;">Close</a>
</div>
<a class="hide" rel="modal" href="#dialog_note" id="trigger_add_note" style="height:250px;"></a>
<div class="modal-window modal-window--customized dialog hide add_note_modal" id="dialog_note">
	<div class="modal-inner modal-inner--customized">
		<p id="selectForm" style="text-align:center; font-weight:bold;display:none">
			<input type="radio" name="selectForm" id="memoForm" value="form1">
			<label for="memoForm">Memo (メモ)</label>
			<input type="radio" name="selectForm" id="levelCheckForm" value="form2">
			<label for="levelCheckForm">教材</label>
		</p>
		<p id="error"></p>
		<div class="col_form m_t_20" id="form1" style="display:none">
			<label>Date:</label> <input name="date" id="date" class="date date_memo hasDatepicker" type="text"><br><br>
			<label>Memo:</label> <textarea class="size_max" id="memo" name="memo" placeholder="Please write a memo."></textarea><br>
			<button id="buttonMemo" name="chk" class="btn_style size_4 btn_green submit" ng-click="saveLessonMemo()">保存</button>
		</div>
		<div id="form2" style="display:none">
			<div class="col_form col_form--flex m_t_20" style="display:unset">
				<div>
					<label>Date:</label> <input name="date" id="date" class="date date_memo date_levelCheck hasDatepicker" type="text"><br><br>
				</div>
				<div>
					<label>Lesson ID:</label>
					<select id="lesson_id"></select>
				</div>
			</div>
			<ul class="checklist" id="checkList">
			</ul>
			<button id="btn" name="chk" class="btn_style size_4 btn_green m_t_20 submit" ng-click="saveLessonMemo()">保存</button>
		</div>

		<label class="err-label"></label>
		<div class="btn_close btn-close" data-dismiss="modal"></div>
	</div>
</div>
<!-- change timezone notice modal -->
<a class="hide" rel="modal" href="#change_timezone_notice" id="trigger_change_timezone_notice"></a>
<div class="modal-window dialog hide modal_center" id="change_timezone_notice">
	<h3>Notice</h3>
	<p>
		The current time of your computer is <span id="your_local_time"></span>, but your timezone setting is now set for <span id="current_set_time"></span>. <br .="">
		Would you like to change the setting?
	</p>
	<div class="btn_wrap btn_half cf">
		<ul>
			<li><a class="btn_style btn_gray close_modal" href="javascript:void(0)">NO</a></li>
			<li><a id="changeTimezoneSetting" class="btn_style btn_orange close_modal" ng-click="changeTimezoneSetting($event)" href="javascript:void(0)">YES</a></li>
		</ul>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<!-- change timezone notice modal end -->

<!-- timezone not supported modal -->
<a class="hide" rel="modal" href="#timezone_not_supported" id="trigger_timezone_not_supported"></a>
<div class="modal-window dialog hide" id="timezone_not_supported">
	<div class="modal_inner">
		<p>
			The timezone of your computer is not supported on our system and is not same on your registered timezone. <br>
			Would you like to change manually the setting?
		</p>
		<div class="ui_notice_list listmark_1 t_left m_t_15">
			<ul>
				<li>Note: If you click `No` button, your registered timezone will not change.</li>
			</ul>
		</div>
		<div class="btn_wrap btn_half cf">
			<ul>
				<li><a class="btn_style green close_modal remove_seeker" href="javascript:void(0)">NO</a></li>
				<li><a class="btn_style orange close_modal" data-scroll="1000" href="javascript:void(0)" ng-click="selectAccountMenu($event)">YES</a></li>
			</ul>
		</div>
	</div>
</div>
<!-- timezone not supported modal end -->
<style>
	.btn_middle_switch{
		border-radius: initial !important;
		margin-left: 0 !important;
		margin-right: 0 !important;
	}
	.btn_right_switch{
		padding: 0 9px !important;
	}
</style>
<!-- dialog_setting_target_income >>>  -->
<div class="modal-window dialog hide" id="dialog_setting_target_income">
	<h3 class="lh_15 c_green m_b_10">How much is your target income for the period?</h3>

	<p class="fw_b fs_19 t_center" id="modal_cutoff_day">Dec 6 - Dec 20</p>

	<div class="btn_switch m_t_35 m_b_45" id="modal_current_currency">
		<ul id="currency_types_motivation_btns"></ul>
	</div>

	<div class="setting_income select_style">
		<div class="setting_wrap">

			<div class="select_area">
				<div class="set_target">
					<span class="target t_truncate fw_b" id="ex_select">Example</span>
				</div>
			</div>
			<div class="options_area hide">
				<ul>
					<li class="item option" data-income="last">
						<div class="item_inner done">
							<span class="title">Last Income</span>
						</div>
					</li>
					<li class="item option" data-income="max">
						<div class="item_inner">
							<span class="title">Max Income</span>
						</div>
					</li>
				</ul>
			</div>

			<div class="input_area">
				<!-- <input type="number" id="target_income" placeholder="0" value=""><span class="currency" id="currency">USD</span> -->
				<input type="number" id="target_income" placeholder="0"><span class="currency" id="currency">USD</span>
			</div>
		</div>
		<p class="t_right m_t_10">(<span id="ncc_val">0</span> NCC)</p>
	</div>

	<div class="btn_wrap btn_center m_t_20 m_b_40 cf">
		<ul>
			<li><a class="btn_style_grad btn_blue_green close_modal" id="btn_set_target" href="javascript:void(0)" ng-click="setTarget()">Set</a></li>
		</ul>
	</div>

	<div class="notice_area m_t_20">
		<div class="ui_notice_list listmark_1">
			<ul>
				<span class="currency_types_ncc_equivalent_values"></span>
				<!-- <li>1NCC = 1 PHP</li>
				<li>1NCC = 0.02084 USD</li>
				<li>1NCC = 0.01852 EUR</li> -->
				<li>※NCC (Native Camp Coin) is the currency unit of NativeCamp. <a href="/teacher/home?guide=ncc" class="t_link" target="_self">details</a></li>
			</ul>
		</div>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<!-- <<< -->

<!-- cant go on standby >>>  -->
<a class="hide" rel="modal" href="#dialog_cant_standby" id="trigger_cantStandby"></a>
<div class="modal-window dialog hide" id="dialog_cant_standby">
	<h3 class="lh_15">You cannot go on Standby mode yet. <br> Please follow the two points below.</h3>
	<ol>
		<li>If you don’t have any open slots, you cannot go on Standby mode. <br>Please open one or more slots before going on Standby.</li>
		<li>If you already opened one or more slots, you will be able to Standby in 5 minutes before the starting time of the first open slot.</li>
	</ol>

	<div class="link_wrap m_t_20">
		<ul>
			<li class="fs_16"><a ng-click="openSlot()" style="cursor: hand;cursor: pointer;" class="t_link" id="openSlot">&gt;&gt; Open slots (at Schedule page)</a></li>
			<li class="fs_16 m_t_10"><a href="/teacher/home?guide=schedule-overview" target="_self" class="t_link">&gt;&gt; What is a “slot”?</a></li>
		</ul>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<!-- <<< -->

<!--[start] modal : select page -->
<a class="hide" id="trigger_modal_tb_page_jump" rel="modal" href="#dialog_tb_page_jump" style="display: none;"></a>
<div class="modal_window dialog no-border no-radius no-padding dialog_tb_page_jump hide" id="dialog_tb_page_jump" style="display: none;">
	<div class="tb-page-jump-body">
		<div class="preview-area">
			<div class="iframe-wrap">
				<iframe id="iframe_textbook_page" src="about:blank"></iframe>
			</div>
		</div>
		<div class="control-area">
			<div class="fi-page-select"><!-- fi : flex item -->
				<label class="select-label">Page</label>
				<select id="pageNumberOption" class="page-select">
				</select>
			</div>
			<div class="fi-confirm-btn">
				<button class="confirm-btn close_modal" id="tb_page_jump_confirm">Update</button>
			</div>
		</div>
	</div>
	<a href="javascript:void(0)" class="btn-close-2 close_modal"></a>
</div>
<!--[end] modal : select page -->

<!-- No Video Modal >>>  -->
<a class="hide" rel="modal" href="#novideo_modal" id="trigger_novideo_modal"></a>
<div class="modal-window dialog hide" id="novideo_modal">
	<p class="t_center">Self introduction video is not registered</p>
	<p class="t_center">please register your self introduction video now.</p>
	<div class="btn-wrap btn-center">
		<a class="nc-t-btn nc-t-btn-orange close_modal" data-scroll="2000" id="register_video_now" ng-click="selectAccountMenu($event)" ui-sref="account">Register Now</a>
		<a class="nc-t-btn nc-t-btn-orange-o close_modal">Register Later</a>
	</div>
	<div class="btn-close btn_close"></div>
</div>

<script type="text/javascript">
var userId = $('#buttonMemo').val();
var isRecruit = ""
$(document).ready(function(){
    $(".date").datepicker({dateFormat:'yy/mm/dd', minDate: 0}).datepicker('setDate', new Date());
    /*----------------------------------------------*/
    // option either level check or memo
    /*----------------------------------------------*/
    $('#memoForm').click(function(){
        $('#form1').css('display','block');
        $('#form2').css('display','none');
        $('#memo').val('');
        $('#levelCheck').val('');
        $('input[type=checkbox]').attr('checked',false);
        $(".date").datepicker({dateFormat:'yy/mm/dd', minDate: 0}).datepicker('setDate', new Date());
        resetModalPosition();
    });
    $('#levelCheckForm').click(function(){
        $('#form2').css('display','block');
        $('#form1').css('display','none');
        $('#memo').val('');
        $(".date").datepicker({dateFormat:'yy/mm/dd', minDate: 0}).datepicker('setDate', new Date());
        resetModalPosition();
    });
});
</script>

<!-- when getting booked lesson >>>  -->
<a class="hide" id="trigger_modal_get_booked_class" rel="modal" href="#dialog_get_booked_class"></a>
<div class="modal-window dialog hide static_overlay" id="dialog_get_booked_class">
	<h3 class="fs_30 lh_17">Congratulations!<br>A student has booked your class!</h3>
	<div class="m_t_15">
		<p class="desc_ttl fs_24 m_b_15">◆What is a "Booked class" ?</p>
		<p>Booked class is a class reserved on a specific date and time.</p>
		<div class="desc_wrap-imgs">
			<div class="area-desc">
				<p class="desc_num">1.</p>
				<img src="/teacher/asset/guide/images/payment/fee/booked-1.png" alt="opening the schedule">
				<p class="imgs_desc">After opening the schedule on the teaching platform of NativeCamp.</p>
			</div>
			<div class="area-desc">
				<p class="desc_num">2.</p>
				<img src="/teacher/asset/guide/images/payment/fee/booked-2.png" alt="Student see the schedule">
				<p class="imgs_desc">Students can book your class at the time of the slot you have opened.</p>
			</div>
			<div class="area-desc">
				<p class="desc_num">3.</p>
				<img src="/teacher/asset/guide/images/payment/fee/booked-3.png" alt="At least 5 minutes before">
				<p class="imgs_desc">Please be on <span class="fw_b">STANDBY</span> mode at least 5 minutes before the starting time of the booked class.</p>
			</div>
			<div class="area-desc">
				<p class="desc_num">4.</p>
				<img src="/teacher/asset/guide/images/payment/fee/booked-4.png" alt="On going lesson">
				<p class="imgs_desc">Enjoy your class!</p>
			</div>
		</div>
	</div>
	<div class="p_t_50">
		<p class="desc_ttl c_red">【WARNING】</p>
		<div class="desc_area">
			<p class="c_red modal_break-word">If you do not go on <span class="fw_b">“STANDBY”</span> mode by the starting time of the booked class, your reservation will be cancelled automatically and you will be penalized.<br>
			If you make a lot of cancellations, it will lead you to the termination of the contract with Native Camp in line with our rule. <br> Please handle your schedule carefully.</p>
		</div>
	</div>
	<div class="m_t_50">
		<div class="t_center bdr-top">
			<input class="hide" type="checkbox" id="dont_show_again-get_booked_class">
			<label class="custom_check" for="dont_show_again-get_booked_class"><span class="td_u">Do not show this again</span></label>
		</div>
		<div class="btn_wrap btn_center m_t_40 cf">
			<ul>
				<li><a href="javascript:void(0)" class="btn_style btn_orange close_modal" id="dialog_get_booked_class-link">OK</a></li>
			</ul>
		</div>
	</div>
</div>
<!-- <<< -->

<!-- getting booked lesson - again >>>  -->
<a class="hide" id="trigger_modal_get_booked_class-again" rel="modal" href="#dialog_get_booked_class-again"></a>
<div class="modal-window dialog hide static_overlay" id="dialog_get_booked_class-again">
	<h3 class="fs_30 lh_17">You can see it again here:</h3>
	<div class="desc_inner">
		<div class="d_table">
			<div class="d_cell">
				<div class="desc_num">1.</div>
			</div>
			<div class="d_cell">
				<p class="desc_txt">Open Guidelines</p>
			</div>
			<div class="d_cell">
				<img src="/teacher/images/modal/again-1.png" alt="Guidelines">
			</div>
		</div>
		<div class="d_table">
			<div class="d_cell">
				<div class="desc_num">2.</div>
			</div>
			<div class="d_cell">
				<p class="desc_txt">Go to “Payment” section</p>
			</div>
			<div class="d_cell">
				<img src="/teacher/images/modal/again-2.png" alt="Payment">
			</div>
		</div>
		<div class="d_table">
			<div class="d_cell">
				<div class="desc_num">3.</div>
			</div>
			<div class="d_cell">
				<p class="desc_txt">Go to “About Tutor Fee And Incentives” page</p>
			</div>
			<div class="d_cell">
				<img src="/teacher/images/modal/again-3.png" alt="About Tutor Fee And Incentives">
			</div>
		</div>
		<div class="d_table">
			<div class="d_cell">
				<div class="desc_num">4.</div>
			</div>
			<div class="d_cell">
				<p class="desc_txt">You will find the quick reference for Booked class at the bottom of the page</p>
			</div>
			<div class="d_cell">
				<img src="/teacher/images/modal/again-4.png" alt="a image of description page">
			</div>
		</div>
		<div class="btn_wrap btn_center m_t_40 cf">
			<ul>
				<li><a href="javascript:void(0)" class="btn_style btn_orange close_modal" id="notice_complete">Close</a></li>
			</ul>
		</div>
	</div>
</div>
<!-- <<< -->

<!-- confirmation of requests >>>  -->
<a class="hide" id="trigger_modal_requests_cfm" rel="modal" href="#dialog_request_cfm"></a>
<div class="modal-window dialog hide static_overlay dialog_request_cfm dialog_request_lesson_custom" id="dialog_request_cfm" style="display: none; position: fixed; opacity: 1; z-index: 11000; left: 50%; margin-left: -350px; top: 50%; margin-top: -369.5px;">
	<p class="fs_24 t_center fw_b">Student's Request for the Lesson</p>
	<div class="request_detail m_t_30">
		<dl>
			<div class="area-account">
				<div class="user-info-wrap">
					<div class="img-inner">
						<img id="student_profile" src="https://nativecamp-public-web-production.s3-ap-northeast-1.amazonaws.com/teacher/webroot/images/modal/2023_07_27_17235964c2299f84139.jpg" alt="Ken" style="
							margin-right: 2rem;
							width: 51px;
							height: 51px;
							border-radius: 20%;
							overflow: hidden;
							box-shadow: 0 2px 6px rgba(0, 0, 0, .4);
							max-width: 100%;
						">
					</div>
					<div class="info-inner">
						<div class="info-top">
							<p class="username fw_b" id="student_name">Ken</p>
						</div>
						<div class="info-id">
							<p id="lesson_count"><span class="lesson fw_b">Number of lesson with you : </span> 219</p> 
							<p id="last_lesson_date"><span class="lesson fw_b m_l_40">Last time : </span> 2023-3-21</p> 
						</div>
					</div>
				</div>
			</div>
		</dl>
		<dl class="orange-border">
			<label class="orange-checkbox-container">
				<input type="checkbox">
				<span class="checkmark"></span>
			</label>
			<dt>Self-introduction before the lesson</dt>
			<dd><span class="badge_need self-introduction true">Need</span></dd>
		</dl>
		<dl class="orange-border">
			<label class="orange-checkbox-container">
				<input type="checkbox">
				<span class="checkmark"></span>
			</label>
			<dt>Point out errors in grammar and pronunciation</dt>
			<dd><span class="badge_need pointing-mistake true">Need</span></dd>
		</dl>
		<dl class="orange-border">
			<label class="orange-checkbox-container">
				<input type="checkbox">
				<span class="checkmark"></span>
			</label>
			<dt>Other requests</dt>
			<p class="lesson_tutorial_request"></p>
			<dd><p class="request" style="display: block;"></p></dd>
		</dl>
	</div>
	<div class="btn_wrap btn_center m_t_40 cf hide">
		<ul>
			<li><a class="btn_style btn_orange close_modal" id="requests_add" href="javascript:void(0);" ng-click="lessonMessageForcereloadPage()">OK</a></li>
		</ul>
	</div>
</div>
<script>
$(document).ready(function() {
	var chat_hash = "449595-1756730221-c91329";
    var checkboxes = $('.request_detail input[type="checkbox"]');

    function checkCheckboxes() {
        var allChecked = true;
        checkboxes.each(function() {
            if (!$(this).prop('checked')) {
                allChecked = false;
                return false;
            }
        });
        return allChecked;
    }

    checkboxes.change(function() {
        if (checkCheckboxes()) {
            $('#requests_add').removeClass('disabled');
			//TODO NJ-47722: This will click the button automatically
			$('#requests_add').click();

			// N-52159: Set Student Request Lesson Modal
			$.ajax({
				type: 'POST',
				data:  {
					isAllChecked : true,
					chatHash : chat_hash,
				},
				url: '/teacher/Home/setStudentRequestLessonModal',
				success: function(res) {
					console.log("Request Lesson Checkboxes All Checked!");
				}
			});

        } else {
            $('#requests_add').addClass('disabled');
        }
    });

    checkboxes.first().trigger('change');

    $('.orange-checkbox-container input[type="checkbox"]').change(function() {
        var dl = $(this).closest('dl');
        if ($(this).prop('checked')) {
            dl.addClass('orange-border');
        } else {
            dl.removeClass('orange-border');
        }
    });

    $('.request_detail dl').click(function(event) {
        if (event.target.tagName.toLowerCase() !== 'input') {
            var checkbox = $(this).find('input[type="checkbox"]');
            checkbox.prop('checked', !checkbox.prop('checked')).trigger('change');
        }
    });
});
</script>

<a class="hide" id="trigger_modal_lesson_length_cfm" rel="modal" href="#dialog_lesson_length_cfm"></a>
<div class="modal-window dialog hide static_overlay dialog_request_cfm" id="dialog_lesson_length_cfm" style="display: none; position: fixed; opacity: 1; z-index: 11000; left: 50%; margin-left: -350px; top: 50%; margin-top: -235px;">
	<p class="fs_24 t_center fw_b">Lesson Time</p>	
	<div class="lesson_length_detail m_t_30">
		<div class="img_1">
			<img src="./images/common/clock.png" alt="Clock Icon">
		</div>
		<p class="length_text m_t_20"><span class="minutes_number">10</span> Minutes</p>
	</div>
	<div class="btn_wrap btn_center m_t_40 cf">
		<ul>
			<li><a class="btn_style btn_orange close_modal" href="javascript:void(0);">OK</a></li>
		</ul>
	</div>
</div>
<!-- dialog lesson message template select modal >>>  -->
<a class="hide" rel="modal" href="#dialog_message_template" id="trigger_dialog_message_template"></a>
<div class="modal-window dialog hide dialog_message_template p_b_40" id="dialog_message_template">
	<div class="modal_inner">
		<div class="message_template_alert_strip" style="display : none;">
			<p class="message_template_success_alert"></p>
		</div>
		<h3 class="modal_ttl">Message Template</h3>
		<div class="modal_text_wrap">
			<p class="modal_text t-center">You can omit the time of composing a message by using fixed format below.</p>
		</div>
		<div class="select_area" style="display: flex; flex-direction: column; gap: 1em; align-items: center;">
			<select class="select_template default_select_template" id="select_message_template_to_student">
				<option value="default" selected="selected" disabled="" id="dmt_default_tmp">Select Template</option>
				<!-- ngRepeat: messageTmpl in messageTemplateList -->
			</select>
			<select name="" id="select_custom_template" class="select_template custom_select_template select_custom_template_to_student select2-hidden-accessible" style="width: 55%;" data-select2-id="select_custom_template" tabindex="-1" aria-hidden="true">
				<option value="default" selected="selected" disabled="" id="custom_dmt_default_tmp" data-select2-id="custom_dmt_default_tmp">Custom Template</option>
			</select><span class="select2 select2-container select2-container--default" dir="ltr" data-select2-id="1" style="width: 35rem; margin-top: 2rem;"><span class="selection"><span class="select2-selection select2-selection--single" role="combobox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-labelledby="select2-select_custom_template-container"><span class="select2-selection__rendered" id="select2-select_custom_template-container" role="textbox" aria-readonly="true" title="Custom Template">Custom Template</span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span></span></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>
		</div>

		<div class="preview_area modal_scroll" style="display: none;">
			<p class="preview_text" id="preview_message_template_to_student">Please select a message template.</p>
		</div>
		<div class="custom_preview_area" style="display:none;"><!---->
			<div>
				<input type="text" class="form-control custom-input" placeholder="Title" id="preview_custom_template_title_student">
			</div>
			<div>
				<textarea class="form-control custom-textarea" placeholder="Your text" id="preview_custom_template_message_student" maxlength="1000"></textarea>
			</div>
		</div><!---->
		<div class="invalid_input_div">
			<p style="color: red; font-weight: bold;" class="custom_message_error_text"></p>
		</div>
		<div class="btn_area" style="display: none;">
			<div class="btn_wrap t_center">
				<a class="btn_style btn_orange btn_save_custom_template" id="confirm_save_message_template_to_student" style="display: none;">Save</a>
				<a class="btn_style btn_orange " id="confirm_insert_message_template_to_student" href="javascript:void(0)">Insert</a>
			</div>
		</div>
	</div>
	<div class="btn-close btn_close"></div>

	<script>
		$(document).ready(function(){
			const custom_dropdown = $('#select_custom_template')

			if (typeof $.fn.select2 === 'function') {
				initializeSelect2(custom_dropdown);
			} else {
				// Dynamically load Select2 script
				loadSelect2Script(function() {
					// Initialize Select2 once the script is loaded
					initializeSelect2(custom_dropdown);
				});
			}

			// Function to initialize Select2 on the dropdown
			function initializeSelect2(custom_dropdown) {
				$(custom_dropdown).select2({
					width: '35rem',
					minimumResultsForSearch: -1
				}).next().closest('.select2').css('margin-top', '2rem');

				$(custom_dropdown).change(function() {
					$('.preview_cont').show();
					$('.preview_template').text($(this).find(':selected').text());
				});
			}

			// Function to dynamically load the Select2 script
			function loadSelect2Script(callback) {
			    // Check if the script is already loaded
				if ($('#select2-script').length > 0) {
					// If the script is already loaded, directly call the callback
					callback();
					return;
				}

				var script = document.createElement('script');
				script.type = 'text/javascript';
				script.id = 'select2-script';
				script.src = '/teacher/js/select2.min.js?v=2.14.03';

				// Execute the callback once the script is loaded
				script.onload = callback;

				// Append the script to the document head or body
				document.head.appendChild(script);
			}
		})
	</script>
</div>
<!-- <<< -->

<!-- dialog lesson message template select modal >>>  -->
<a class="hide" rel="modal" href="#dialog_message_template_counselor" id="trigger_dialog_message_template_counselor"></a>
<div class="modal-window dialog hide dialog_message_template p_b_40" id="dialog_message_template_counselor">
	<div class="modal_inner">
		<h3 class="modal_ttl">メッセージテンプレート</h3>
		<div class="modal_text_wrap">
			<p class="modal_text t_center">会員様へのメッセージを下記からお選びください</p>
		</div>
		<div class="select_area">
			<select class="select_template" id="select_message_template_to_student_counselor">
				<option value="default" selected="selected" disabled="">テンプレートを選ぶ</option>
				<!-- ngRepeat: messageTmpl in messageTemplateList -->
			</select>
		</div>
		<div class="preview_area modal_scroll" style="display: none;">
			<p class="preview_text" id="preview_message_template_to_student_counselor">Please select a message template.</p>
		</div>
		<div class="btn_area" style="display: none;">
			<div class="btn_wrap t_center">
				<a class="btn_style btn_orange close_modal" id="confirm_insert_message_template_to_student_counselor" href="javascript:void(0)">挿入する</a>
			</div>
		</div>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<!-- <<< -->

<!-- New registration incentives >>>  -->
<a class="hide" id="trigger_modal_new_registration_incentives" rel="modal" href="#dialog_new_registration_incentives"></a>
<div class="modal-window dialog hide static_overlay" id="dialog_new_registration_incentives">
	<h3 class="lh_15">New Registration Incentive</h3>
	<div class="main_text_wrap t_center">
		<p class="d_i_block t_left fs_16">If you complete more than 100 slots of lessons within 2 weeks after your account has been activated, 2200 NCC will be given to you as incentive.</p>
	</div>
	<p class="m_t_25 fw_b t_center fs_22">Remaining days: 14</p>
	<p class="m_t_10 m_b_20 fw_b t_center fs_22">Number of completed lessons: 12 / 100</p>

	<div class="btn_wrap btn_center m_t_40 cf">
		<ul>
			<li><a href="javascript:void(0)"><button type="submit" class="btn_style btn_orange close_modal" id="notice_complete">OK</button></a></li>
		</ul>
	</div>
</div>
<!-- <<< -->

<!-- Student’s Late Cancellation >>>  -->
<a class="hide" id="trigger_modal_students_late_cancellation" rel="modal" href="#dialog_students_late_cancellation"></a>
<div class="modal-window dialog hide static_overlay" id="dialog_students_late_cancellation">
	<h3 class="lh_15">Student’s Late Cancellation</h3>
	<div class="main_text_wrap t_center">
		<p class="d_i_block t_left fs_16">The lesson has automatically been cancelled, since the student did not enter the room for more than 5 minutes after the starting time of reserved lesson.</p>
	</div>
	<p class="m_t_20 m_b_20 fw_b t_center fs_26">20 NCC</p>

	<div class="btn_wrap btn_center m_t_40 cf">
		<ul>
			<li><a href="javascript:void(0)"><button type="submit" class="btn_style btn_orange close_modal" id="notice_complete">OK</button></a></li>
		</ul>
	</div>
</div>
<!-- <<< -->

<!--pop up modal >>>  -->
<a class="hide" rel="modal" href="#lesson_popup_modal" id="trigger_lesson_popup_modal"></a>
<div class="modal-window dialog hide" id="lesson_popup_modal">
	<p class="t_center lesson_popup_content"></p>
	<div class="btn-close btn_close"></div>
</div>

<!-- rating >>>  -->
<a class="hide" rel="modal" href="#dialog_reply_message" id="trigger_modal_dialog_reply_message"></a>
<div class="modal-window dialog dialog_reply_message dialog_rating static_overlay hide" id="dialog_reply_message">
	<div class="modal_inner">
		<p class="c_gray fs_25 fw_b t_center m_b_20">Message from Admin Staff</p>
		<div class="reply_message_wrap" style="height: auto;max-height: 400px;overflow-y: auto;">
			<p id="inquiryMessage" data-id="" data-inquiryparentid="" data-adminid="">
				<!-- 【NC-5134】 Display reply contents from the admin staff. -->
			</p>
		</div>
		<div class="btn_wrap btn_center m_t_30 cf">
			<ul>
				<li><a id="messageInquiryAction" class="btn_style btn_orange click_delay close_modal" href="#trigger_modal_dialog_rating_staff">OK</a></li>
			</ul>
		</div>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<!-- <<< -->

<!-- rating staff >>>  -->
<!-- rating staff >>>  -->
<a class="hide" rel="modal" href="#dialog_rating_staff" id="trigger_modal_dialog_rating_staff"></a>
<div class="modal-window dialog dialog_rating static_overlay hide" id="dialog_rating_staff">
	<div class="modal_inner t_center">
		<p class="c_gray m_b_20">How was the service from our staff?</p>
		<div class="rating_data_form_wrap">
			<div class="rating_data_inner">
				<!-- <p class="review_cancel t_right"><a class="close_modal click_delay" href="#trigger_modal_about_system_trouble">通信トラブルのため評価しない</a></p> -->
				<form method="post" id="evaluationForm" class="ng-pristine ng-valid">
					<div class="rating_data cf">
						<div class="rating t_center">
							<input type="radio" id="rating_rate5" data-text="Very Good!" value="5" name="rate">
							<span class="wrap">
								<label for="rating_rate5" class="star rating_rate5" onclick=""><span class="star_txt">Very Good!</span></label>
								<input type="radio" id="rating_rate4" data-text="わずかに難あり" value="4" name="rate">
								<span class="wrap">
									<label for="rating_rate4" class="star rating_rate4" onclick=""><span class="star_txt">Good</span></label>
									<input type="radio" id="rating_rate3" data-text="やや難あり" value="3" name="rate">
									<span class="wrap">
										<label for="rating_rate3" class="star rating_rate3" onclick=""><span class="star_txt">Average</span></label>
										<input type="radio" id="rating_rate2" data-text="難あり" value="2" name="rate">
										<span class="wrap">
											<label for="rating_rate2" class="star rating_rate2" onclick=""><span class="star_txt">Poor</span></label>
											<input type="radio" id="rating_rate1" data-text="改善が必要" value="1" name="rate">
											<span class="wrap">
												<label for="rating_rate1" class="star rating_rate1" onclick=""><span class="star_txt">Very poor</span></label>
											</span>
										</span>
									</span>
								</span>
							</span>
						</div>
					</div>
					<p class="display_good d_i_block t_left m_t_20">If you had any problems with our service, please let us have your honest opinion.<br>
						Your comments will be used to further improve the quality of our support.</p>
					<div class="comment_box comment_box_bad display_bad t_left m_t_20">
						<p class="c_required">
							Please accept our sincere apologies for the inconvenience you may have experienced.。<br>
							We would appreciate your feedback regarding our service. <br>
							We would like to use your comments in order to improve the quality of our services. <br>
							Thank you for your cooperation! </p>
						<div class="m_t_20">
							<p class="m_b_15">
								<span style="background:#f0295d;color:#fff;padding: 3px 15px;border-radius: 0;font-size: 1.6rem">Required</span>
							</p>
						</div>
						<div class=" ui-count_form">
							<textarea id="user_comment" class="size_max ui-count_input m_b_5" minlength="1" maxlength="500" placeholder="Please enter your comment"></textarea>
							<p><span class="ui-count_length-current char_count">0</span>/500 characters</p>
						</div>
					</div>
					<div class="comment_box comment_box_normal display_good">
						<div class="btn_wrap btn_comment_wrap t_center m_t_30">
							<ul>
								<li><a class="btn_comment t_link fs_16 fw_b" href="javascript:void(0)">Leave us a comment</a></li>
							</ul>
						</div>
						<div class="comment_box_normal_inner hide t_left">
							<div>
								<p class="m_b_10">
									<span style="background:#555;color:#fff;padding: 3px 15px;border-radius: 0;font-size: 1.6rem">Optional</span>
									<span>Less than 500 characters</span>
								</p>
							</div>
							<div class=" ui-count_form">
								<textarea id="user_comment2" class="size_max ui-count_input m_b_5" maxlength="500" placeholder=""></textarea>
								<p>Currently<span class="ui-count_length-current"> 0 </span>letters</p>
							</div>
						</div>
					</div>
					<div class="btn_wrap btn_center m_t_30 cf">
						<ul>
							<li><a class="btn_style btn_green submit_rating click_delay close_modal disabled" id="rating_submit" href="javascript:void(0)" ng-click="submitEvaluation()">Send</a></li>
						</ul>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>
<script type="text/javascript">
// $(function(){
	/*-----------------------------------------------------*/
	// rating funstions
	/*-----------------------------------------------------*/
	// select star
	$('#dialog_rating_staff .rating [name=rate]').on('click',function(){
		var scope = $('#dialog_rating_staff');
		var ratingNum = $(this).attr('id');
		if(ratingNum <= 'rating_rate2'){
			$(".display_good", scope).css({'cssText':'display: none !important;'});
			$(".display_bad", scope).fadeIn(200);
			$('#user_comment2').val('');
			checkCommentCount($(".comment_box_bad", scope));
			$('.btn_comment').hide();
		}else{
			$(".display_bad", scope).hide();
			$(".display_good", scope).fadeIn(200);
			$('#rating_submit', scope).removeClass('disabled');
			$('#user_comment').val('');
			$('.btn_comment').show();
		}
		/* $('.review_notice_wrap', scope).hide(); */
		resetModalPosition();
	});

	// toggle comment
	$('#dialog_rating_staff .btn_comment').on('click',function(){
		var scope = $('#dialog_rating_staff');
		var target = $('.comment_box_normal_inner', scope);
		if(target.is(':visible')){
			$(this).removeClass('on');
			target.hide();
		}else{
			$(this).addClass('on');
			target.show();
		}
		resetModalPosition();
	});

	// textarea length counter
	$("#dialog_rating_staff .ui-count_form .ui-count_input").on("click keydown keyup keypress change", function(){
		var scope = $(this).closest(".ui-count_form");
		var commentBox = $(this).closest(".comment_box");
		var textLength = parseInt($(this).val().length);
		$(".ui-count_length-current",scope).html(" "+textLength+" ");
		$(".ui-count_length-current.char_count",scope).html(textLength);

		// Restrict the number of characters.
		if(commentBox.hasClass('comment_box_bad')){
			checkCommentCount(scope);
		}
	});

	// click_delay
	$('.click_delay').click(function() {
		var target = $(this).attr("href");
		setTimeout(function() { $(target).click(); }, 500);
	});

	// Check Comment Count
	function checkCommentCount(scope){
		var textarea = $('.ui-count_input', scope);
		var textLength = parseInt(textarea.val().length);
		if(textLength >= 5){
			$('#dialog_rating_staff #rating_submit').removeClass('disabled');
		}else{
			$('#dialog_rating_staff #rating_submit').addClass('disabled');
		}
	}

	function resetModalPosition(){
		var modal = $('#dialog_rating_staff:visible');
		if(!modal.length > 0){
		return;
		}

		var modal_height = parseInt(modal.outerHeight());
		var modal_width = parseInt(modal.outerWidth());
		var win_height = parseInt($(window).height());
		var scroll_top = parseInt($(window).scrollTop());
		if(modal_height > win_height){
			modal.css({
				"position":"absolute",
				"left":50+"%",
				"margin-left":-(modal_width/2)+"px",
				"top": (scroll_top + 30) +"px",
				"margin-top": "auto",
				"margin-bottom": "30px"
			});
		}else{
			modal.css({
				"position":"fixed",
				"left":50+"%",
				"margin-left":-(modal_width/2)+"px",
				"top":45+"%",
				"margin-top":-(modal_height/2)+"px",
				"margin-bottom": "auto",
				"height" : "auto",
				"max-height" : 600+"px"
			});
		}
	}

	function submitEvaluation(e) {
		const inquiry_id = (e.hasAttribute('data-inquiry')) ? $(e).data('inquiry') : '';
		var comment = '';
		var rate = $('input[name="rate"]:checked').val();
		var evaluation_category = $('#evaluationForm').data("category");
		var chatHash = "449595-1756730221-c91329";
		var admin_id = "";

		// For Inquiry
		let inquiry_admin = '';
		let parent_id = '';

		if(e.hasAttribute('data-admin') && e.hasAttribute('data-inquiry')){
			inquiry_admin = $(e).data('admin');
		}

		if(e.hasAttribute('data-parent') && e.hasAttribute('data-inquiry')){
			parent_id = $(e).data('parent');
		}

		if (rate == 1) {
			comment = $('#user_comment').val();
			if (comment.length == 0) {
				$('#dialog_rating').hide();
				return false;
			}
		} else {
			comment = $('#user_comment2').val();
		}

		$.ajax({
			type: 'POST',
			data:  {
				rate: rate , 
				comment : comment,
				evaluation_category : evaluation_category,
				chatHash : chatHash,
				adminId : admin_id,
				inquiryId : inquiry_id,
				inqurtyAdmin : inquiry_admin
			},
			url: '/teacher/RecruitTeacherExam/saveAdminStaffEvaluation',
			success: function(res) {
				var result = JSON.parse(res);
				if (result.success == 1) {
					if(result.fromInquiry){
						var angularAppInquiry = angular.element($("body[ng-app='teacherApp']"));
						angularAppInquiry.scope().reloadTheDetail(parent_id);
					}

					setTimeout(function() { 
						$('#trigger_modal_recruit_rating_staff_complete').click(); 
					}, 500);
				}
			}
		});
	}
// });
</script>
<!-- <<< -->

<!-- dialog_rating_staff_complete >>>  -->
<a class="hide" rel="modal" href="#dialog_rating_staff_complete" id="trigger_modal_rating_staff_complete"></a>
<div class="modal-window dialog dialog_rating_staff_complete hide static_overlay" id="dialog_rating_staff_complete">
	<div class="modal_inner">
		<div class="rating_complete_wrap">
			<p class="fs_25 m_b_20 t_center">Thank you for your time.</p>
			<p>From your feedback, we constantly strive to go an extra step in order to provide you with the best possible service.
				We would appreciate your continued cooperation.
			</p>
			<div class="btn_wrap btn_center m_t_30 m_b_30 cf">
				<ul class="d_table">
					<li class="d_cell"><a class="btn_style btn_gray close_modal" href="javascript:void(0)">Close</a></li>
				</ul>
			</div>
		</div>
	</div>
</div>

<!-- hb payslip detail >>>  -->
<a class="hide" rel="modal" href="#dialog_hb_payslip_detail" id="trigger_hb_payslip_detail"></a>
<div class="modal-window dialog hide dialog-payment-history" id="dialog_hb_payslip_detail">
	<div class="container modal-inner modal-scroll p-b-40"></div>
	<div class="btn-close btn_close" id="hb_payslip_detail_close_btn"></div>
</div>
<!-- <<< -->

<style>
	#teacher_announcement .btn_style{
		min-width: 240px!important;
		font-size: 14px!important;
		height: 40px!important;
		margin: 0 5px;
		line-height: 40px!important;
	}
	
	#teacher_announcement #ann_content img{
		width: auto;
		height: auto;
		max-width: 100%;
		margin: 10px 0;
	}
	#teacher_announcement .center{
	   text-align: center;
	   margin-top: 20px;
	}
	.modal_wrapper{
		top: 0!important;
	    bottom: 0;
	    left: 0!important;
	    right: 0!important;
	    margin: 0px auto!important;
	    background: transparent;
	    padding: 0!important;
	    box-shadow: none;
	    border: none;
	}
	.modal_content_wrapper{
		display: flex;
		flex-wrap: wrap;
		min-height: calc(100% - (1.75rem * 2));
		align-items: center;
	}
	.modal_content_body{
		width: 800px!important;
		padding: 30px;
	    background: #fff;
	    border: solid 4px #555;
	    border-radius: 10px;
	    max-width: 960px;
	    box-shadow: 0 0 10px 0 rgb(0 0 0 / 20%);
	}
	.take_ept_now_p p{
		font-size: 2.0rem !important;
		font-weight: bold;
	}
	#ann_title{
		word-break: break-all;
	}
	.ept_btn_close{
		position: absolute;
		top: -18px;
		right: -18px;
		display: block;
		width: 46px;
		height: 46px;
		background: url(../images/icon/modal_close.png) no-repeat 0 0;
		cursor: pointer;
	}
	.ann_attachment{
		margin: 10px 0;
	}
	.ann_attachment h4{
		font-size: 20px;
	}
	.attachment_link{
		font-size: 16px;
		display: block;
		padding: 8px 0;
	}
	.no_file_attach{
		font-size: 14px;
    	padding: 10px 0;
	}
</style>
<!-- teacher announcement >>>  -->
<a class="hide" rel="modal" href="#teacher_announcement" id="trigger_teacher_announcement" data-toggle="modal" data-backdrop="static" data-keyboard="false"></a>
<div class="modal-window hide modal-teacher-announcement modal_center" id="teacher_announcement" style="display: none; position: fixed; opacity: 1; z-index: 11000; left: 0%; margin-left: 0px; top: 0%; margin-top: 0px; transform: translate(calc(-50% + 50vw), calc(-50% + 50vh));">
	<div class="modal-inner modal-scroll" id="announcement_notif">

	<div>
							    <div class="announcement_item" id="announcement_item_0" style="display: none;">
							        <h3 class="lh_15" id="ann_title_0">Students should not change the Study Sapuri material</h3>
							        <p class="ann_content" id="ann_content_0"><center> <img src="https://nativecamp-public-web-production.s3-ap-northeast-1.amazonaws.com/1719841419_6682b28b0f30d.png" width="100%" height="100%"></center><br>
Dear teachers,<br>
<br>
Please be advised that students who choose Study Sapuri materials are not allowed to change the material once they enter your lesson. You need to proceed with the Study Sapuri materials only.<br>
<br>
It has been reported that some students request to do free conversation lessons instead of using the Study Sapuri material. If you encounter such students, inform them that it is not allowed and that the lesson must follow the Study Sapuri materials' instructions.<br>
<br>
If the student refuses to listen to you, please report or notify us so that a warning can be issued to the student.<br>
<br>
Thank you for your cooperation.<br>
<br>
Best regards,<br>
Native Camp</p>
							        <div class="attachment_wrapper"></div>
							        <div class="center">
							            <button class="btn_style btn_orange bthn_notif_teacher closeBtn" data-key="0">Close</button>
							            <button class="btn_style btn_red btnRead" id="doNot" data-key="0" data-id="9947">Do not display this dialog again</button>
							        </div>
							    </div>
							</div><div>
							    <div class="announcement_item" id="announcement_item_1" style="display: none;">
							        <h3 class="lh_15" id="ann_title_1">Ranking of teachers who set the reservation coins to more than 100</h3>
							        <p class="ann_content" id="ann_content_1"><div style="text-align:center;"><img src="https://nativecamp-public-web-production.s3-ap-northeast-1.amazonaws.com/1715344917_663e1615d386b.png" width="900" height="300"></div><br>
<br>
Dear teacher, <br>
<br>
When your teacher rank is 9 or above, you will be able to set the reservation coins to more than 100 coins. The more coins you set, the higher the amount you will receive.<br>
<br>
This time, we would like to pick up and share the top 10 teachers who received the highest number of reservations with more than 100 coins in the period from 08/16 to 08/31.<br>
<br>
If your teacher rank is already 9 or higher, why not consider increasing the number of reservation coins?<br>
<br>
<b>Number of reservations Compensation amount</b><br>
<br>
1. 96208		Mai		218 times	27,904 NCC<br>
2. 164007	Suren	200 times	25,600 NCC<br>
3. 143020	Aysun	175 times	20,300 NCC<br>
4. 175581	Leonita	166 times	19,256 NCC<br>
5. 40766		Iva		166 times	21,248 NCC<br>
6. 50099		Jeff		157 times	18,212 NCC<br>
7. 19158		Aime	147 times	17,052 NCC<br>
8. 93091		Rose	135 times	17,280 NCC<br>
9. 137241	Andrew	133 times	16,492 NCC<br>
10. 28283	Coleen	129 times	16,512 NCC<br>
<br>
Best wishes,<br>
Native Camp</p>
							        <div class="attachment_wrapper"></div>
							        <div class="center">
							            <button class="btn_style btn_orange bthn_notif_teacher closeBtn" data-key="1">Close</button>
							            <button class="btn_style btn_red btnRead" id="doNot" data-key="1" data-id="9940">Do not display this dialog again</button>
							        </div>
							    </div>
							</div><div>
							    <div class="announcement_item" id="announcement_item_2" style="display: none;">
							        <h3 class="lh_15" id="ann_title_2">Announcement of Addition of Category to "Kids - Picture Book : Advanced"</h3>
							        <p class="ann_content" id="ann_content_2">We hope that all of you are doing well.<br>
<br>
We are going to release the Advanced Category to "Kids - Picture Book" on Wednesday, September 3rd.<br>
<br>
This series is ...<br>
- the well-known characters from Native Camp are in picture books<br>
- learning English by using original Teddy's stories<br>
- especially for kids students<br>
<br>
■Features of the Material<br>
The story is structured as a long-form narrative that concludes in five chapters, allowing students to enjoy learning English while immersing themselves in the world of the story.<br>
In addition to reading the story, students will also engage in “Discussion” activities where they share their reasoning and impressions, making the material enjoyable not only for children but also for adults.<br>
<br>
Thank you and have a nice day!<br>
<br>
Editing Department</p>
							        <div class="attachment_wrapper"></div>
							        <div class="center">
							            <button class="btn_style btn_orange bthn_notif_teacher closeBtn" data-key="2">Close</button>
							            <button class="btn_style btn_red btnRead" id="doNot" data-key="2" data-id="9930">Do not display this dialog again</button>
							        </div>
							    </div>
							</div></div>
</div>
<!-- <<< -->


<!-- NC-6064 -->
<a class="hide" id="trigger_editIntroModal" rel="modal" href="#editIntroModal"></a>
<div class="modal-window modal-edit-intro hide" id="editIntroModal" data-backdrop="static" data-keyboard="false">
	<h3 class="intro-modal-title">Edit Self-Introduction</h3>
	<div class="intro_modal_content">
		<p class="error-text"></p>
		<textarea name="field" id="editfield" class="size_max" cols="30" rows="6" required="required" ng-keyup="limitText($event)"></textarea>
		<input type="hidden" value="" name="request" id="editRequest">
		<!-- <div class="m_t_5 grammar_check clear">
			<div class="center first">
			<div class="pull-right"> 
				<button type="button" class="btn_grammar_check_style btn_style" id="btn_open_grammar_check" disabled="disabled">GRAMMAR CHECK</button>			</div>
			</div>
		</div> -->
		<div class="btn-wrap btn-center">
			<button id="btnSaveIntro" class="nc-t-btn nc-t-btn-orange" ng-click="saveIntro($event)" data-id="normal">SAVE</button>
			<button id="btnSaveIntro" class="nc-t-btn nc-t-btn-orange-o" ng-click="cancelIntro($event)">CANCEL</button>
		</div>
	</div>

	<div class="btn_close" style="display:none"></div>
	<a class="hide" id="trigger_modal_grammar_check" rel="modal" href="#modal_grammar_check"></a>
	<div id="modal_overlay_grammar_check"></div>
	<div class="modal-window dialog hide static_overlay modal_grammar_check_style" id="modal_grammar_check">
		<div class="modal_inner t_center">
			<p class="fs_30 m_b_10 t_left">Text Copied</p>
			<div class="m_b_20">
				<textarea class="textarea_grammar_popup" rows="20" cols="30" maxlength="1000" id="self_introduction_text_copy" readonly=""></textarea>
			</div>
			<a href="https://grammarchecker.io/" target="”_blank”" class="btn_goto_grammar_check_style btn_style" onclick="close_modal_grammar_check()">Go To GRAMMAR CHECK</a>
		</div>
		<div class="btn_close" style="display:none;"></div>
		<div class="btn_close_grammar" onclick="close_modal_grammar_check()" id="closeGrammarCheck"></div>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<!-- /NC-6064 -->

<a class="hide" id="trigger_modal_grammar_check_spotlight" rel="modal" href="#modal_grammar_check_spotlight"></a>
<div class="modal-window dialog hide static_overlay modal_grammar_check_style" id="modal_grammar_check_spotlight">
    <div class="modal_inner t_center">
        <p class="fs_30 m_b_10 t_left">Text Copied</p>
        <div class="m_b_20">
          <textarea class="textarea_grammar_popup" rows="20" cols="30" maxlength="1000" id="spotlight_text_copy" readonly=""></textarea>
        </div>
        <a href="https://grammarchecker.io/" target="”_blank”" class="btn_goto_grammar_check_style btn_style" onclick="close_modal_grammar_check()">Go To GRAMMAR CHECK</a>
    </div>
    <div class="btn-close btn_close"></div>
</div>

<!-- cant go uncheck badge >>>  -->
<a class="hide" rel="modal" href="#dialog_unselect_notice" id="trigger_modal_tb_select_notice"></a>
<div class="modal-window dialog hide" id="dialog_unselect_notice">
	<h3 class="lh_15" id="badgeErrorTitle">You have a reservation with this material</h3>
	<p class="t_center" id="badgeErrorContent">You can not hide this material because you have a reservation with this material</p>
	<div class="btn_wrap btn_center m_t_30 m_b_30 cf">
		<ul class="d_table">
			<li class="d_cell"><a class="btn_style btn_gray close_modal" href="javascript:void(0)">Close</a></li>
		</ul>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<!-- <<< -->

<!-- dialog payment history july >>>  -->
<a class="hide" rel="modal" href="#dialog_payment_history-july" id="trigger_modal_payment_history-july"></a>
<div class="modal-window dialog hide dialog_payment_history-july" style="height:85%;" id="dialog_payment_history-july">
	<div class="container" style="width: 850px; height:100%; overflow-x: hidden;"></div>
	<div class="btn_close close_july_payment_modal"></div>
	<script>
		$(function(){
			// - when close july modal is clicked
			$(".close_july_payment_modal").click(function(){
				// - if dialog can't be seen, do nothing!
				if ($("#dialog_payment_history-july:visible").length == 0) {
					return false;
				}

				// - get header angular element scope
				var angHeader = angular.element($("body[ng-app='teacherApp']")).scope();

				// - check if header angular element exists.
				if (typeof angHeader == "undefined") {
					return false;
				}

				// - click close modal payslip
				angHeader.closePayslipModalOfJuly();

			});
		});
	</script>
</div>
<!-- dialog chat msg - delete >>>  -->
<a class="hide" rel="modal" href="#dialog_chat_msg-delete" id="trigger_modal_chat_msg-delete"></a>
<div class="modal_window dialog hide dialog_chat_msg-delete p_b_40 static_overlay" id="dialog_chat_msg-delete">
	<h3>Delete message</h3>

	<p class="t_center m_t_20">Are you sure you want to delete this message?<br>
		This cannot be undone.</p>

	<div class="chat_msg_wrap m_t_20">
		<p class="chat_msg">Teacher wrote.</p>
	</div>

	<div class="btn_wrap btn_half cf m_t_30">
		<ul>
			<li><a class="btn_style btn_gray close_modal" href="javascript:void(0)">Cancel</a></li>
			<li><a class="btn_style btn_red" href="javascript:void(0);" id="deleteMessageButton" data-chatid="">Delete</a></li>
		</ul>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<!-- dialog block student >>>  -->
<a class="hide" rel="modal" href="#dialog_block_student" id="trigger_modal_block_student"></a>
<div class="modal-window dialog hide dialog_block_student p_b_40" id="dialog_block_student">
	<div class="modal_inner">
		<h3 class="fs_24 fw_b studentName ng-binding">Blocked person : </h3>

		<div class="block_reason_wrap m_t_20">
			<p class="fs_20 fw_b m_b_10">Block reason:</p>
			<p class="m_b_10">Write the reason within <span class="fw_b">100</span> to <span class="fw_b">1000</span> characters</p>
			<p class="m_b_10 ng-binding" data-id="blockwarningMessage" style="font-weight:600;color:red;"></p>
			<div class="ui-count_form increment">
				<textarea id="block_reason" class="size_max ui-count_input m_b_5 ng-pristine ng-untouched ng-valid ng-empty ng-valid-maxlength" maxlength="1000" placeholder="EX)
I have encountered the unpleasant experience at my class on June 21, 2019. I am really
disappointed with his attitude. He insulted me without any reason." ng-model="block_reason"></textarea>
				<p class="fr"><span class="ui-count_length-current" id="block_reason-count">0</span>/1000</p>
			</div>
		</div>

	</div>
	<div class="btn_wrap btn_half m_t_50">
		<ul>
			<li>
				<a href="javascript:void(0);" class="btn_style btn_gray close_modal">Cancel</a>
			</li>
			<li>
				<a href="javascript:void(0);" class="btn_style btn_red disabled" id="btn_block_student-submit" ng-click="btn_block_student_submit()">OK</a>
			</li>
		</ul>
	</div>
</div>
<script>
$(function(){
	$("#block_reason").on("keyup", function(){
		var reasonLength = $(this).val().length;
		if(reasonLength < 100){
			$("#btn_block_student-submit").addClass('disabled');
		}else{
			$("#btn_block_student-submit").removeClass('disabled');
		}
		if(reasonLength > 1000){
			$(this).val($(this).val().substring(0, 999));
		}
		$('span#block_reason-count').text(reasonLength);
	});
});
</script>
<!-- <<< -->

<!-- dialog block student - confirm >>>  -->
<a class="hide" rel="modal" href="#dialog_block_student-confirm" id="trigger_modal_block_student-confirm"></a>
<div class="modal-window dialog hide dialog_block_student-confirm p_b_40" id="dialog_block_student-confirm">
	<h3 id="messageBlockConfirm" class="ng-binding">Are you sure you want to block  ?</h3>
	<div class="btn_wrap btn_half cf m_t_40">
		<ul>
			<li><a class="btn_style btn_gray close_modal" href="javascript:void(0);">Cancel</a></li>
			<li><a class="btn_style btn_red close_modal" href="javascript:void(0);" id="confirmBlockrequest" data-stnd="" ng-click="confirmBlockrequest()">Block</a></li>
		</ul>
	</div>
</div>
<!-- <<< -->

<!-- dialog block student - complete >>>  -->
<a class="hide" rel="modal" href="#dialog_block_student-complete" id="trigger_modal_block_student-complete"></a>
<div class="modal-window dialog hide dialog_block_student-complete p_b_40" id="dialog_block_student-complete">
	<h3>Block request has been sent.</h3>

	<p class="t_center m_t_20">Your block request has been sent to the admin staff.<br>
		Please wait while until the admin staff will approve it.</p>

	<div class="btn_wrap btn_center cf m_t_30">
		<ul>
			<li><a class="btn_style btn_gray close_modal" href="javascript: void(0)" ng-click="studentInfoIndexpage()">OK</a></li>
		</ul>
	</div>
</div>
<!-- <<< -->

<!-- dialog block student - denied >>>  -->
<a class="hide" rel="modal" href="#dialog_block_student-denied" id="trigger_modal_block_student-denied"></a>
<div class="modal-window dialog hide dialog_block_student-denied p_b_40" id="dialog_block_student-denied">
	<h3>Block request denied</h3>

	<p class="t_center m_t_20">You cannot block the student who has already booked a lesson with you.<br>
		You can block the student only after finishing the booked lesson.</p>

	<div class="btn_wrap btn_center m_t_30 cf">
		<ul>
			<li><a class="btn_style btn_gray close_modal" href="javascript:void(0);">OK</a></li>
		</ul>
	</div>
</div>
<!-- <<< -->

<!-- dialog block student - denied >>>  -->
<a class="hide" rel="modal" href="#dialog_block_student-denied-request" id="trigger_modal_block_student-denied-request"></a>
<div class="modal-window dialog hide dialog_block_student-denied p_b_40" id="dialog_block_student-denied-request">
	<h3>Block request denied</h3>

	<p class="t_center m_t_20">You cannot block the student who has already requested a lesson with you.<br>
		You can block the student only after cancel the requested lesson.</p>

	<div class="btn_wrap btn_center m_t_30 cf">
		<ul>
			<li><a class="btn_style btn_gray close_modal" href="javascript:void(0);">OK</a></li>
		</ul>
	</div>
</div>
<!-- <<< -->

<!-- dialog unblock student - confirm >>>  -->
<a class="hide" rel="modal" href="#dialog_unblock_student-confirm" id="trigger_modal_unblock_student-confirm"></a>
<div class="modal-window dialog hide dialog_unblock_student-confirm p_b_40" id="dialog_unblock_student-confirm">
	<h3 class="ng-binding">Are you sure you want to unblock  ?</h3>
	<div class="btn_wrap btn_half cf m_t_40">
		<ul>
			<li><a class="btn_style btn_gray close_modal" href="javascript:void(0);">Cancel</a></li>
			<li><a class="btn_style btn_red close_modal" href="javascript:void(0);" ng-click="dialog_unblock_student_confirm()">Unblock</a></li>
		</ul>
	</div>
</div>
<!-- <<< -->

<!-- dialog unblock student - complete >>>  -->
<a class="hide" rel="modal" href="#dialog_unblock_student-complete" id="trigger_modal_unblock_student-complete"></a>
<div class="modal-window dialog hide dialog_unblock_student-complete p_b_40" id="dialog_unblock_student-complete">
	<h3>Unblocked the student</h3>


    <p class="t_center m_t_20">You have unblocked the student.<br>
        The student will now be able to find you on the website.</p>

	<div class="btn_wrap btn_center cf m_t_30">
		<ul>
			<li><a class="btn_style btn_gray" href="javascript: void(0)" ng-click="studentInfoIndexpage()">OK</a></li>
		</ul>
		<a class="btn_style btn_gray close_modal" href="javascript:void(0);" style="display: none;"></a>
	</div>
</div>
<!-- <<< -->
<!-- >>> -->
<a class="hide" rel="modal" href="#dialog_block_student-denied-couselor" id="trigger_modal_block_student-denied-couselor"></a>
<div class="modal-window dialog hide dialog_block_student-denied p_b_40" id="dialog_block_student-denied-couselor">
	<h3>Block request denied</h3>
	<p class="t_center m_t_20">Teacher who have an active counselor type cannot block a student</p>
	<div class="btn_wrap btn_center m_t_30 cf">
		<ul>
			<li><a class="btn_style btn_gray close_modal" href="javascript:void(0);">OK</a></li>
		</ul>
	</div>
</div>
<!-- <<< -->
<!-- dialog block student - confirm >>>  -->
<a class="hide" rel="modal" href="#dialog_block_above_max_limit" id="trigger_modal_block_above_max_limit"></a>
<div class="modal-window dialog hide dialog_block_student-denied p_b_40" id="dialog_block_above_max_limit">
	<h3>Block request denied</h3>
	<p class="t_center m_t_20">Can't apply for block, please contact management</p>
	<div class="btn_wrap btn_center m_t_30 cf">
		<ul>
			<li><a class="btn_style btn_gray close_modal" href="javascript:void(0);">OK</a></li>
		</ul>
	</div>
</div>
<!-- <<< -->

<!-- dialog ~ confirm take EPT >>>  -->
<a class="hide" rel="modal" href="#ept_confirm" id="trigger_ept_confirm"></a>
<div class="modal-window dialog hide" id="ept_confirm">
	<div class="modal_inner">
		<div class="contents_inner desc_area t_center">
			<div class="test_format m_b_30">
				<p class="fs_20 side_bar">Test Content</p>
				<ul>
					<li class="fs_20">· Multiple choice questions</li>
					<!-- <li>· 20 to 30 questions</li> -->
					<li class="fs_20">· 40 questions</li>
					<!-- <li>· Time limit ○ minute</li> -->
					<li class="fs_20">· Time limit 20 minute</li>
				</ul>
			</div>
			<div class="ept_modal_phrases">
				<p class="fs_20 m_b_20">Once you click the Test Start button, you cannot pause the EPT <br> nor go back to the previous page.</p>
				<p class="fs_20 m_b_20">If you are ready, please click on “Test Start” button below.</p>
			</div>
		</div>
	</div>
	<div class="fs_25 m_b_20 t_center">
		<button class="btn_style btn_orange close_modal" ng-click="eptStartTest('/teacher/EPT')">Test Start</button>
		<button class="btn_style btn_gray close_modal">Later</button>
		<button class="hide reload_ept_page" ng-click="reloadEptPage()"></button>
	</div>
</div>
<!-- <<< -->

<!-- dialog ~ confirm take EPT >>>  -->
<a class="hide" rel="eptModal" href="#ept_take_now" id="trigger_ept_take_now"></a>
<div class="modal-window dialog hide" id="ept_take_now">
	<div class="ept_btn_close close_modal"></div>
	<div id="close_all_modal" class="close_modal"></div>
	<div class="modal_inner">
		<div class="contents_inner desc_area t_center take_ept_now_p">
			<p class="">You have not taken a new English proficiency test(EPT) yet.</p>
			<p class="">Your promotion is dependent on how much score you can get on it.</p>
			<p class="">Please take the EPT right away!</p>
		</div>
	</div>
	 <div class="btn_wrap btn_half cf">
		<ul>
			<li><button class="btn_style btn_orange ept_take" ui-sref="HomeBasedEpt">Take the EPT Now</button></li>
			<li><a class="btn_style btn_gray ept_btn" href="javascript:void(0)">Later</a></li>
		</ul>
	</div>
</div>

<script>
	$(function(){

		$('a[rel*=eptModal]').leanModal({ top : 200, overlay:0.40, closeButton: ".ept_btn_close"});

		 // close ept modal
		$(".ept_btn").click(function(){
			var btn = $(this).closest('#ept_take_now').find('.ept_btn_close');
			btn.click();
		});

		// close ept modal ~ take ept
		$(".ept_take").click(function(){
			var angScope = angular.element($("body[ng-app='teacherApp']")).scope();
			angScope.takEptNowRedirect = true;
			angScope.fixedModalOverlay(false);

			$('#close_all_modal').click();
		});

		// trigger checkTimezone upon closing take ept modal
		$('.ept_btn_close').on('click', function(){
			setTimeout(function(){
				var angScope = angular.element($("body[ng-app='teacherApp']")).scope();
				angScope.triggerCheckTimezone();
				angScope.fixedModalOverlay(false);
			});
		});

		$('#closeNotice').on('click', function(){
			setTimeout(function(){
				var angScope = angular.element($("body[ng-app='teacherApp']")).scope();
				angScope.closeNotice();
				angScope.fixedModalOverlay(false);
			});
		});


	});
</script>


<!-- dialog ~ current teacher rank >>>  -->
<a class="hide" rel="modal" href="#current_teacher_rank_modal" id="trigger_current_teacher_rank_modal"></a>
<div class="modal-window dialog hide dialog-tutor-rank" id="current_teacher_rank_modal">
	<div class="modal-inner modal-scroll p-b-40 p_b_40">

		<!----content----->
	</div>

</div>

<!-- block_request_denied >>>  -->
<a class="hide" rel="modal" href="#dialog_block_request_denied" id="trigger_modal_block_request_denied"></a>
<div class="modal-window dialog hide dialog_block_request_denied static_overlay p_b_40" id="dialog_block_request_denied">
	<h3>Block request denied</h3>

	<p class="m_t_30">You have reached the limit for blocking your students. Please note that you can<br>
		block only 15 students in total. Thank you for your understanding.</p>

	<div class="btn_wrap btn_center cf m_t_30">
		<ul>
			<li><button class="btn_style btn_gray close_modal">OK</button></li>
		</ul>
	</div>
</div>
<!-- <<< -->

<!-- expedite modal  -->
<style>
	.btn_expedite_close{
		background: #cc0000;
		border-color:#cc0000;
		font-weight:500 !important;
	}
	.btn_expedite_close:hover{
		background: #dc0101;
	}
	.btn_expedite_green{
		background: #6aa84f;
		border-color:#6aa84f;
		font-weight:500 !important;
	}
	.link_to_payment_guide{
		color: #1194dc !important;
		text-decoration: underline !important;
	}
	.expedite_text_red{
		color: #980000 !important;
	}
	.expedite_text_emp{
		font-weight: bolder;
		color: #000000 !important;
	}
	.expedite_row{
		margin-bottom: 40px;
	}
	.expedite_row p{
		font-size: 1.8rem !important;
		color: #000000;
	}
	.expedite_h3{
		color: #000000;
	}
	.btn_half_expedite{
		width: 750px !important;
	}
	.btn_expedite:disabled{
		background: #ffffff !important;
	}
</style>

<a class="hide" rel="modal" href="#expedite_payment_modal" id="trigger_expedite_payment_modal"></a>
<div class="modal-window dialog hide" id="expedite_payment_modal">
	<div class="close_expedite_modal close_modal"></div>
	<div class="expedite_modal_content">
		<!---->

		<!---->
	</div>
</div>

<a class="hide" rel="modal" href="#expedite_payment_cancel_modal" id="trigger_expedite_payment_cancel_modal"></a>
<div class="modal-window dialog hide" id="expedite_payment_cancel_modal">
	<div class="close_expedite_modal close_modal"></div>
	<div class="modal_inner">
		<div class="t_center">
			<h3 class="expedite_h3">Cancel expedited payment?</h3>
		</div>
	</div>
	 <div class="btn_wrap btn_half cf">
		<ul>
			<li><button class="btn_style btn_expedite_cancel btn_orange close_modal" data-curr-expediteflg="1" ng-click="setExpeditedPayment($event)">Yes</button></li>
			<li><a class="btn_style btn_expedite_close close_modal" href="javascript:void(0)">Cancel</a></li>
		</ul>
	</div>
</div>

<a class="hide" rel="modal" href="#expedite_payment_unavailable_modal" id="trigger_expedite_payment_unavailable_modal"></a>
<div class="modal-window dialog hide" id="expedite_payment_unavailable_modal">
	<div class="modal_inner">
		<div class="t_center">
			<h3 class="expedite_h3">Expedited payment is unavailable</h3>
		</div>
	</div>
	<div class="btn_wrap btn_half cf t_center">
		<a class="btn_style btn_expedite_close close_modal" href="javascript:void(0)">Close this window</a>
	</div>
</div>
<!-- end of expedite modal -->
<!-- update_workshift_denied  -->
<a class="hide" rel="modal" href="#dialog_update_workshift_denied" id="trigger_modal_update_workshift_denied"></a>
<div class="modal-window dialog hide dialog_update_workshift_denied static_overlay p_b_40" id="dialog_update_workshift_denied">
	<h3>Unable to Update Work Status</h3>

	<p class="m_t_30">You cannot update work status 5 minutes before the lesson time.</p>

	<div class="btn_wrap btn_center cf m_t_30">
		<ul>
			<li><button class="btn_style btn_gray close_modal">OK</button></li>
		</ul>
	</div>
</div>
<!-- <<< -->

<!-- dialog_opening_slots_limit >>>  -->
<a class="hide" rel="modal" href="#dialog_opening_slots_limit" id="trigger_modal_opening_slots_limit"></a>
<div class="modal-window dialog dialog_opening_slots_limit hide static_overlay small-modal" id="dialog_opening_slots_limit">
	<div class="modal_inner">
		<div class="rating_complete_wrap">
			<p class="c_red fs_25 fw_b t_center m_b_20">You have reached a limit for opening slots</p>
			<p class="t_center">Only 24 Available slots can be opened.</p>
			<p class="m_t_10 t_center">We appreciate your hard work, but please open slots on another day.</p>
			<div class="btn_wrap btn_center m_t_30 cf">
				<ul class="d_table">
					<li class="d_cell"><a class="btn_style btn_gray close_modal" href="javascript:void(0)">Close</a></li>
				</ul>
			</div>
		</div>
	</div>
</div>
<!-- <<< -->
		
<!-- dialog_opening_meal_break_multi_slots_limit >>>  -->
<a class="hide" rel="modal" href="#dialog_opening_meal_break_multi_slots_limit" id="trigger_modal_opening_meal_break_multi_slots_limit"></a>
<div class="modal-window dialog dialog_opening_meal_break_multi_slots_limit hide static_overlay small-modal" id="dialog_opening_meal_break_multi_slots_limit">
	<div class="modal_inner">
		<div class="rating_complete_wrap">
			<p class="c_red fs_25 fw_b t_center m_b_20">You have reached a limit for opening slots</p>
			<p class="t_center">Exceeds slots for meal break. You can only open <span id="meal_break_multi_slots_limit_left"></span> slots for meal break.</p>
			<!-- <p class="m_t_10">We appreciate your hard work, but please open slots on another day.</p> -->
			<div class="btn_wrap btn_center m_t_30 cf">
				<ul class="d_table">
					<li class="d_cell"><a class="btn_style btn_gray close_modal" href="javascript:void(0)">Close</a></li>
				</ul>
			</div>
		</div>
	</div>
</div>
<!-- <<< -->

<!-- dialog_opening_live_multi_slots_limit >>>  -->
<a class="hide" rel="modal" href="#dialog_opening_live_multi_slots_limit" id="trigger_modal_opening_live_multi_slots_limit"></a>
<div class="modal-window dialog dialog_opening_live_multi_slots_limit hide static_overlay" id="dialog_opening_live_multi_slots_limit">
	<div class="modal_inner">
		<div class="rating_complete_wrap">
			<p class="c_red fs_25 fw_b t_center m_b_20">You have reached a limit for opening slots</p>
			<p>Exceeds open slot limit for live lessons. You can open <span id="live_multi_slots_limit_left"></span> slots left for Live lessons.</p>
			<!-- <p class="m_t_10">We appreciate your hard work, but please open slots on another day.</p> -->
			<div class="btn_wrap btn_center m_t_30 cf">
				<ul class="d_table">
					<li class="d_cell"><a class="btn_style btn_gray close_modal" href="javascript:void(0)">Close</a></li>
				</ul>
			</div>
		</div>
	</div>
</div>
<!-- <<< -->

<!-- dialog_selected_slots_limit >>>  -->
<a class="hide" rel="modal" href="#dialog_selected_slots_limit" id="trigger_dialog_selected_slots_limit"></a>
<div class="modal-window dialog dialog_selected_slots_limit hide static_overlay" id="dialog_selected_slots_limit">
	<div class="modal_inner">
		<div class="rating_complete_wrap">
			<p class="c_red fs_25 fw_b t_center m_b_20">You have reached a limit for opening slots</p>
			<p>Teachers cannot choose more than 24 slots.</p>
			<div class="btn_wrap btn_center m_t_30 cf">
				<ul class="d_table">
					<li class="d_cell"><a class="btn_style btn_gray close_modal" href="javascript:void(0)">Close</a></li>
				</ul>
			</div>
		</div>
	</div>
</div>
<!-- <<< -->
		
<!-- dialog_opening_meal_break_multi_slots_limit >>>  -->
<a class="hide" rel="modal" href="#dialog_opening_meal_break_multi_slots_limit" id="trigger_modal_opening_meal_break_multi_slots_limit"></a>
<div class="modal-window dialog dialog_opening_meal_break_multi_slots_limit hide static_overlay" id="dialog_opening_meal_break_multi_slots_limit">
	<div class="modal_inner">
		<div class="rating_complete_wrap">
			<p class="c_red fs_25 fw_b t_center m_b_20">You have reached a limit for opening slots</p>
			<p>Exceeds slots for meal break. You can open <span id="meal_break_multi_slots_limit_left"></span> slots left for meal break.</p>
			<!-- <p class="m_t_10">We appreciate your hard work, but please open slots on another day.</p> -->
			<div class="btn_wrap btn_center m_t_30 cf">
				<ul class="d_table">
					<li class="d_cell"><a class="btn_style btn_gray close_modal" href="javascript:void(0)">Close</a></li>
				</ul>
			</div>
		</div>
	</div>
</div>
<!-- <<< -->

<!-- dialog_opening_live_multi_slots_limit >>>  -->
<a class="hide" rel="modal" href="#dialog_opening_live_multi_slots_limit" id="trigger_modal_opening_live_multi_slots_limit"></a>
<div class="modal-window dialog dialog_opening_live_multi_slots_limit hide static_overlay" id="dialog_opening_live_multi_slots_limit">
	<div class="modal_inner">
		<div class="rating_complete_wrap">
			<p class="c_red fs_25 fw_b t_center m_b_20">You have reached a limit for opening slots</p>
			<p>Exceeds open slot limit for live lessons. You can open <span id="live_multi_slots_limit_left"></span> slots left for Live lessons.</p>
			<!-- <p class="m_t_10">We appreciate your hard work, but please open slots on another day.</p> -->
			<div class="btn_wrap btn_center m_t_30 cf">
				<ul class="d_table">
					<li class="d_cell"><a class="btn_style btn_gray close_modal" href="javascript:void(0)">Close</a></li>
				</ul>
			</div>
		</div>
	</div>
</div>
<!-- <<< -->

<!-- cannot update_workshift if reserved  -->
<a class="hide" rel="modal" href="#dialog_update_workshift_withReservation" id="trigger_modal_update_workshift_withReservation"></a>
<div class="modal-window dialog hide dialog_update_workshift_withReservation static_overlay p_b_40" id="dialog_update_workshift_withReservation">
	<h3>Unable to Update Work Status</h3>

	<p class="m_t_30">A student has booked this slot! Please refresh this page in order to see your updated schedule.</p>

	<div class="btn_wrap btn_center cf m_t_30">
		<ul>
			<li><button class="btn_style btn_gray close_modal">OK</button></li>
		</ul>
	</div>
</div>
<!-- <<< -->
<!-- reservation is already cancelled -->
<a rel="modal" href="#dialog_already_cancelled" id="trigger_dialog_already_cancelled"></a>
<div class="modal-window dialog static_overlay hide" id="dialog_already_cancelled">
	<h3>Reservation is Already Cancelled</h3>
	<p style="text-align: center">This reservation has already been cancelled! Please refresh this screen in order to update your current schedule!</p>
	<div class="btn-wrap btn-center">
		<ul>
			<li><a href="javascript:void(0)" class="btn_style orange close_modal">OK</a></li>
		</ul>
	</div>
</div>
<!-- <<< -->

<!-- modal virtual bg setting complete >>>  -->
<a class="hide" id="trigger_modal_virtual_bg_setting_complete" rel="modal" href="#dialog_virtual_bg_setting_complete"></a>
<div class="modal-window dialog hide static_overlay dialog_virtual_bg_setting_complete" id="dialog_virtual_bg_setting_complete">
	<h3 class="page_ttl m_b_30 fs_22">Virtual background settings are complete.</h3>
	<div class="btn_wrap btn_center m_t_40 cf">
		<ul>
			<li><a class="btn_style btn_green close_modal" href="javascript:void(0)">OK</a></li>
		</ul>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<!-- <<< -->

<!-- cannot update_workshift if reserved  -->
<a class="hide" rel="modal" href="#dialog_synchronize_accounting_error" id="trigger_dialog_synchronize_accounting_error"></a>
<div class="modal-window dialog hide dialog_synchronize_accounting_error static_overlay p_b_40" id="dialog_synchronize_accounting_error">
	<h3>SHIFT SYNCHRONIZE ERROR</h3>

	<!-- warning part -->
	<p class="m_t_30">An error occurred while we were trying to synchronize the shift. Please retry the shift synch.</p>

	<!-- code part -->
	<br><br>
	<p style="margin-top: 5px; padding: 5px; border: 2px dashed #ccc;" id="synchronize_shift_error_container"></p>
	<!-- end of code part -->

	<!-- button -->
	<div class="btn_wrap btn_center cf m_t_30">
		<ul>
			<li><button class="btn_style btn_gray close_modal">OK</button></li>
		</ul>
	</div>
</div>
<!-- <<< -->

<!-- cannot update_workshift if reserved  -->
<a class="hide" rel="modal" href="#dialog_shift_accounting_error" id="trigger_dialog_shift_accounting_error"></a>
<div class="modal-window dialog hide dialog_shift_accounting_error static_overlay p_b_40" id="dialog_shift_accounting_error">
	<h3>SHIFT SYNCHRONIZE ERROR</h3>

	<!-- warning part -->
	<p class="m_t_30">Please ensure that your account has valid shifts.</p>

	<!-- code part -->
	<br><br>
	<p style="margin-top: 5px; padding: 5px; border: 2px dashed #ccc;" id="trigger_dialog_shift_accounting_error_container"></p>
	<!-- end of code part -->

	<!-- button -->
	<div class="btn_wrap btn_center cf m_t_30">
		<ul>
			<li><button class="btn_style btn_gray close_modal">OK</button></li>
		</ul>
	</div>
</div>
<!-- <<< -->

<!-- cannot synch if shift status is being updated  -->
<a class="hide" rel="modal" href="#dialog_shift_synch_ongoing" id="trigger_dialog_shift_synch_ongoing"></a>
<div class="modal-window dialog hide dialog_shift_synch_ongoing static_overlay p_b_40" id="dialog_shift_synch_ongoing">
	<h3>SHIFT SYNCHRONIZE ERROR</h3>
	
	<!-- warning part -->
	<p class="m_t_30">An active shift is being processed. Please wait until said process is done.</p>
	
	<!-- button -->
	<div class="btn_wrap btn_center cf m_t_30">
		<ul>
			<li><button class="btn_style btn_gray close_modal">OK</button></li>
		</ul>
	</div>
</div>
<!-- <<< -->
<!-- modal canceled reserve lesson notification >>>  -->
<a class="hide" id="trigger_modal_canceled_lesson_notification" rel="modal" href="#dialog_canceled_lesson_notification"></a>
<div class="modal-window dialog hide static_overlay dialog_canceled_lesson_notification" id="dialog_canceled_lesson_notification">
	<p class="t_color_orange fs_32 m_t_20 m_b_20 t_center">Disconnection Cancellation has occurred</p>
	<p class="fs_18 t_left t_color_gray pd_10r">
		Unfortunately, the system was unable to confirm the connection from the teacher's side for more than 2 minutes. As a result, the lesson was cancelled by the student.<br>
		<br>
		In this case, the lesson is considered a “Disconnection Cancellation” and no any incentives will be charged. <br>
		
		<br>
		However, no penalties will be deducted.<br> We recommend that you check the status of your connection to avoid this situation in the future.
	</p>
	<div class="btn_wrap btn_center m_t_40 cf">
		<ul>
			<li><a class="btn_style btn_orange close_modal" onclick="disconnectionCancellationMemCached('delete')" href="javascript:void(0)">OK</a></li>
		</ul>
	</div>
	<div class="btn_close hidden"></div>
</div>

<!-- dialog_timezone_slots_limit >>>  -->
<a class="hide" rel="modal" href="#dialog_timezone_slots_limit" id="trigger_modal_timezone_slots_limit"></a>
<div class="modal-window dialog dialog_timezone_slots_limit hide static_overlay" id="dialog_timezone_slots_limit">
	<div class="modal_inner">
		<div class="rating_complete_wrap">
			<h3 class="c_red">Unable to Update Timezone</h3>
			<p class="m_t_30 t_center">The time zone you are trying to change will cause your daily slot count to exceed 24.<br><br>
			The maximum number of slots is limited to 24 slots a day. Please adjust your current number of slots before changing the time zone.</p>
			<!-- <p class="m_t_10"></p> -->
			<div class="btn_wrap btn_center m_t_30 cf">
				<ul class="d_table">
					<li class="d_cell"><a class="btn_style btn_gray close_modal" href="javascript:void(0)">Close</a></li>
				</ul>
			</div>
		</div>
	</div>
</div>

<!-- file selected is/are invalid-->
<a rel="modal" href="#dialog_invalid_files" id="trigger_dialog_invalid_files"></a>
<div class="modal-window dialog hide" id="dialog_invalid_files">
	<div class="upload-error error-file-type">
		<h3>The file format is not supported.</h3>
		<p>Supported format:</p><br>
		<p>Images: <b>JPG, JPEG, PNG, GIF</b></p>
		<p>Videos: <b>MP4, MOV</b></p>
		<p>Audios: <b>MP3, M4A</b></p>
		<p>Others: <b>PDF, XLS, XLSX, TXT, DOC, DOTX, DOCX, PPT, PPTX, HEIC</b></p>
	</div>
	<div class="upload-error error-upload-size">
		<h3>The file is too large.</h3>
		<p class="t_center">Max file size: 5 MB</p>
	</div>
	<div class="upload-error error-upload-count">
		<h3>Too many files.</h3>
		<p class="t_center">Max file number: 10</p>
	</div>
	<div class="btn_wrap btn_center m_t_40 cf">
		<ul>
			<li><a class="btn_style btn_green close_modal" href="javascript:void(0)">OK</a></li>
		</ul>
	</div>
	<div class="btn_close hidden"></div>
</div>
<!-- end of file selected is/are invalid-->
<!-- <<< -->
<a id="trigger_view_upload_image" class="hide" rel="modal" href="#dialog_view_upload_image"></a>
<div class="modal-window dialog hide dialog_view_upload_image" id="dialog_view_upload_image">
	<div class="modal_inner">
        <div id="imageSpinner" style="display: none; text-align: center">
            <img src="/user/images/icon/loader.gif" width="40">
        </div>
        <div id="forImageSpinner" style="display: none;">
			<h3></h3>
			<div class="dl-icon-box">
				<a class="download-target" href="javascript:void(0)" target="_blank"><img src="/teacher/images/chat/ic_download.png" alt="Download"></a>
			</div>
			<div class="img-box" style="text-align: center">
				<img class="img-target hide" src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=">
				<video class="video-target hide" src="data:video/mp4;base64,AAAA" controls="" style="width:100%;"></video>
			</div>
        </div>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<!-- <<< -->
<!-- <<< -->
<a id="trigger_file_expired" class="hide" rel="modal" href="#dialog_file_expired"></a>
<div class="modal-window dialog hide static_overlay" id="dialog_file_expired">
	<h3>Expired</h3>
	<p class="t_center">Uploaded files are saved on the server for 7 days.</p>
	<div class="btn_wrap btn_center m_t_40 cf">
		<ul>
			<li><a class="btn_style btn_green close_modal" href="javascript:void(0)">OK</a></li>
		</ul>
	</div>
	<div class="btn_close hidden"></div>
</div>
<!-- <<< -->
<!-- <<< -->
<a id="trigger_max_time_uplpoad" class="hide" rel="modal" href="#dialog_max_time_uplpoad"></a>
<div class="modal-window dialog hide static_overlay" id="dialog_max_time_uplpoad">
	<h3>The upload is taking longer than usual. Please try again. If you are uploading multiple files at once, please try again by uploading one file at a time.</h3>
	<div class="btn_wrap btn_center m_t_40 cf">
		<ul>
			<li><a class="btn_style btn_green close_modal" href="javascript:void(0)">OK</a></li>
		</ul>
	</div>
	<div class="btn_close hidden"></div>
</div>
<!-- <<< -->

<!-- modal notice occupation >>>  -->
<a class="hide" id="trigger_modal_notice_occupation" rel="modal" href="#dialog_notice_occupation"></a>
<div class="modal-window dialog hide static_overlay dialog_notice_occupation" id="dialog_notice_occupation">
	<h3 class="page_ttl m_b_30 fs_22">Notice</h3>

	<p class="c_red fs_18">Please fill out the registration form of your personal<br>
		information and select your job history from the<br>
		occupation listed below</p>

	<div class="btn_wrap btn_center m_t_30 cf">
		<ul>
			<li><button class="btn_style btn_green close_modal" id="show_account">Account</button></li>
		</ul>
	</div>
</div>
<!-- <<< --> 

<!-- NC-9203 : model notice Stealth Flag ON  >>> -->
<a class="hide" rel="modal" href="#stealth_flag" id="trigger_stealth_flag"></a>
<div class="modal-window dialog hide static_overlay stealth_flag_style modal-teacher-announcement modal_center" id="stealth_flag">
	<div class="modal-inner modal-scroll">
		<div class="stealth-flg-container">
			<div class="t_center">
				<h3 class="m_b_10 fw_b t_center unviewed_link">Deactivated your account</h3>
				<br>
				<div class="m_b_10 fw_b t_left">
					<p>Your tutor account is deactivated.</p>
					<br>
					<p>There are several reasons for this.</p>
					<br>
					<p>- If you have received several complaints / low evaluations</p>
					<p>- If you haven't finished setting up your profile</p>
					<p>- When there have been frequent problems with your connection</p>
					<p>- Others</p>
					<br>
					<p>If your tutor account remains deactivated, you won't be able to go on standby and have lessons.</p>
					<p>Please check our message and take appropriate action according to the content.</p>
					<br>
				</div>
				<button class="btn_style btn_noted btn_orange" onclick="actionNoted()">Noted</button>
			</div>
		</div>
	</div>
</div>
<style>
	#stealth_flag.modal-window.dialog p {
		word-break: break-word !important;
	}
	#stealth_flag.modal-window .modal-scroll {
		overflow-y: hidden !important;
	}
	#stealth_flag.modal-window {
		min-width: 1000px !important;
		max-width: 1000px !important;
	}
	#stealth_flag.modal-teacher-announcement .modal-scroll {
    	height: 80vh !important;
	}
	#stealth_flag .stealth-flg-container {
		display: flex;
		justify-items: center;
		height: 100%;
		align-items: center;
	}
</style>

<!-- <<< --> 

<!-- modal correction >>>  -->
<a class="hide" id="trigger_modal_correction" rel="modal" href="#dialog_correction"></a>
<div class="modal_window dialog hide static_overlay dialog_correction" id="dialog_correction">
	<h3 class="page_ttl">Correction</h3>

	<div class="dialog_correction-inner">
		<div class="top-text-wrap">
			<div class="icon-wrap">
				<img src="./images/chat/ic-balloon.svg" alt="balloon">
			</div>
			<div class="text-1">Correct sentences so that they're more natural!</div>
		</div>

		<div class="text-wrap">
			<div class="title">Original sentences</div>
			<div class="contents">
				<textarea name="modal-original-msg-name" class="original-sentences" id="modal-original-msg" onpaste="handlePasteOnCorrModal(event)" placeholder="Write message here" readonly=""></textarea>
				<div class="img-wrap">
					<a href="javascript:void(0);" id="original-msg-copy-btn" class="btn-copy">
						<img src="/teacher/images/chat/ic-copy.svg" alt="ic copy">
					</a>
				</div>
			</div>
		</div>

		<div class="text-wrap correct-wrap">
			<div class="title">Correct the sentence from here</div>
			<div class="contents">
				<textarea name="modal-correction-msg-name" id="modal-correction-msg" onpaste="handlePasteOnCorrModal(event)" placeholder="When the copy button is pressed, student's original sentences will be copied here automatically. Please correct the sentences here."></textarea>
			</div>
		</div>

		<div class="text-wrap comments-wrap">
			<div class="title">Comments</div>
			<div class="contents">
				<textarea name="modal-comment-msg-name" id="modal-comment-msg" onpaste="handlePasteOnCorrModal(event)" placeholder="Write your comments..."></textarea>
			</div>
		</div>

		<div class="btn_wrap btn_half cf m_t_30">
			<ul>
				<li><a class="btn_style btn_gray close_modal" href="javascript:void(0)" id="modal-correction-cancel-btn">CANCEL</a></li>
				<li><a class="btn_style btn_orange" href="javascript:void(0)" id="modal-correction-submit-btn">SUBMIT</a></li>
			</ul>
		</div>
	</div>
</div>
<!-- <<< -->

<!-- modal failed to load >>>  -->
<a class="hide" id="trigger_modal_failed_to_load" rel="modal" href="#dialog_failed_to_load"></a>
<div class="modal-window dialog hide static_overlay dialog-callan-training dialog-failed-to-load" id="dialog_failed_to_load">
	<h3 class="modal-ttl m_b_30">Failed to load</h3>

	<p class="modal-txt">Data could not be properly retrieved.</p>

	<div class="btn-wrap">
		<a href="javascript:void(0);" class="btn btn-gray close_modal callan-exit">End</a>
	</div>
</div>
<!-- <<< --> 

<!-- modal failed to block >>>  -->
<a class="hide" id="trigger_modal_failed_to_block" rel="modal" href="#dialog_failed_to_block"></a>
<div class="modal-window dialog hide static_overlay dialog-callan-training dialog-failed-to-load" id="dialog_failed_to_block">
	<h3 class="modal-ttl m_b_30">Failed to block user</h3>

	<p class="modal-txt">An error occurred when attempting to block this user.</p>
	<p class="modal-txt">Error Message : </p>
	<p class="modal-txt" id="block-user-fail-text"></p>
	<div class="btn-wrap">
		<a href="javascript:void(0);" class="btn btn-gray close_modal callan-exit">Close</a>
	</div>
</div>
<!-- <<< --> 

<!-- modal quit the training >>>  -->
<a class="hide" id="trigger_modal_quit" rel="modal" href="#dialog-quit"></a>
<div class="modal-window dialog hide static_overlay dialog-callan-training dialog-quit" id="dialog-quit">
	<h3 class="modal-ttl">Quit the training</h3>

	<div class="btn-wrap m_t_40">
		<a href="javascript:void(0);" class="btn btn-border-gray close_modal">Cancel</a>
		<a href="javascript:void(0);" class="btn btn-gray close_modal callan-exit">Quit</a>
	</div>
</div>
<!-- <<< --> 

<!-- modal setting for Booked Lesson Fee >>>  -->
<a class="hide" id="trigger_modal_setting_fee" rel="modal" href="#dialog-setting-fee"></a>
<div class="modal_window dialog hide static_overlay dialog-setting-fee" id="dialog-setting-fee">
	<span class="btn_close"></span>
	<h3 class="modal-ttl">Setting for Booked Lesson Fee</h3>
	<div class="fee-list-wrap">
		<div id="dialog-setting-fee-option-list" class="fee-list">
		</div>
		<div class="desc-wrap">
			<div class="text">
				<p>Booking possibility</p>
				<div class="booking_info_display_area">
					<div class="img_info"><img src="/teacher/images/icon/info.png"></div>
					<div class="info_booking_possibility_wrap">
						<div class="touchable_area"></div>
						<div class="info_tip_inner">
							<p class="m_b_5">
								・Higher booked lesson fees increase students’ payments which may result in a lower chance of getting reservations.
							</p>
							<p class="m_b_5">
								・Lower booked lesson fees decrease students’ payments which may result in a higher chance of getting reservations.
							</p>
						</div>
					</div>
				</div>
			</div>
			<div class="range-area">
				<div class="range-wrap">
					<div class="range">
						<div class="range-circle"></div>
						<img src="/teacher/images/modal/normal.png" alt="normal" class="range-img range-img-normal active">
						<img src="/teacher/images/modal/low.png" alt="low" class="range-img range-img-low">
						<img src="/teacher/images/modal/high.png" alt="high" class="range-img range-img-high">
						<img src="/teacher/images/modal/quite-low.png" alt="quite-low" class="range-img range-img-quite-low">
						<img src="/teacher/images/modal/slightly-low.png" alt="slightly-low" class="range-img range-img-slightly-low">
						<img src="/teacher/images/modal/slightly-high.png" alt="slightly-high" class="range-img range-img-slightly-high">
						<img src="/teacher/images/modal/quite-high.png" alt="quite-high" class="range-img range-img-quite-high">
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="fee-tooltip"></div>
</div>
<script>
$(function() {
	$(document).on('mouseenter', '.fee.locked .lock-icon', function(){
		let tooltipText = 'From Tutor Rank ' + $(this).data('rank');
		let posOffset = $(this).offset();
		let tooltip = $('.fee-tooltip');
		var modalPosition = $("#dialog-setting-fee").offset();

		tooltip.text(tooltipText);
		tooltip.css({
			'top': (posOffset.top - 60) - modalPosition.top
		});
		tooltip.addClass('active');
	}).on('mouseleave', '.fee.locked .lock-icon', function(){
		$('.fee-tooltip').removeClass('active');
	});
});
</script>
<!-- <<< --> 

<!-- modal setting for Booked Lesson Fee err >>>  -->
<a class="hide" rel="modal" href="#dialog_modal_setting_fee_err" id="trigger_modal_setting_fee_err"></a>
<div class="modal_window dialog dialog-setting-fee hide static_overlay" id="dialog_modal_setting_fee_err">
	<div class="modal_inner">
		<div class="rating_complete_wrap">
			<h3 class="c_red">Setting for Booked Lesson Fee</h3>
			<p class="m_t_30 t_center" id="dialog_modal_setting_fee_err_text"></p>
			<!-- <p class="m_t_10"></p> -->
			<div class="btn_wrap btn_center m_t_30 cf">
				<ul class="d_table">
					<li class="d_cell"><a class="btn_style btn_gray close_modal" href="javascript:void(0)">Close</a></li>
				</ul>
			</div>
		</div>
	</div>
</div>

<!-- office accounting renewal modals -->

<script type="text/javascript">
	$(function(){

		$('.shift-change-date').datepicker({
			dateFormat:'M d, yy (D)',
			minDate: 1,
			beforeShowDay: function(date) {
			    return [date.getDay() === 0 || date.getDay() === 6,''];
			}
		});

		$('.office-close-proof-recorder').on('click', function(){
			$('#dialog_change_rd_proof_recorder').hide();

			var angScope = angular.element($("body[ng-app='teacherApp']")).scope();
			angScope.resetRecorderModal();
		});

		// $('.office-shift-change-btn').on('click', function(){
		// 	var angScope = angular.element($("body[ng-app='teacherApp']")).scope();
		// 	angScope.fixedModalOverlay(false);

		// 	$('#dialog_new_request').hide();
		// });

	});
	
</script>

<script type="text/javascript">
	const targetNode = document.getElementById('dialog-setting-fee');
	const config = { attributes: true, childList: false, subtree: false };
	
	const rangeCircle = $('.range-circle');
	const rangeImageNormal = $('.range-img.range-img-normal');
	const rangeImageHigh = $('.range-img.range-img-high');
	const rangeImageLow = $('.range-img.range-img-low');
	const rangeImageQuiteLow = $('.range-img.range-img-quite-low');
	const rangeImageSlightlyLow = $('.range-img.range-img-slightly-low');
	const rangeImageSlightlyHigh = $('.range-img.range-img-slightly-high');
	const rangeImageQuiteHigh = $('.range-img.range-img-quite-high');
	
	var latestTarget = null; 

	const callback = function(mutationsList, observer) {

		for(var mutation of mutationsList) {
			if (mutation.type == 'attributes' && mutation.attributeName == 'style') {
				if(targetNode.style.display == 'block') {
					var currentText = $('.fee.ng-scope:first').text();
					if (!currentText.includes('Lesson Fees')) {
						$('.fee.ng-scope:first').append('Lesson Fees');
					}

					$(".dialog-setting-fee .fee-list-wrap .fee-list .locked input[type='radio']").prop('disabled', true);
					
					// unlocked lesson fees
					$('.fee.ng-scope label').click(function() {
						let target = $(this);
						if (!target.siblings('input').is(':disabled')) {
							adjustBookingPossiblity(target);
							latestTarget = target;
						}
					});

					// allow hover for locked lesson fees
					$(document).on('mouseenter', '.fee.locked .lock-icon', function() {
						let target = $(this);
							if (target.parent().hasClass('locked')) {
								adjustBookingPossiblity(target);
							}
					}).on('mouseleave', '.fee.locked .lock-icon', function() {
						if (latestTarget) {
							let target = $(this);
							if (target.parent().hasClass('locked')) {
								adjustBookingPossiblity(latestTarget);
							}
						}
					});
				}
			}
		}
	};

	var observer = new MutationObserver(callback);
	observer.observe(targetNode, config);

	function resetRangeClasses(rangeCircle, rangeImageNormal, rangeImageHigh, rangeImageLow, rangeImageQuiteLow, rangeImageSlightlyLow, rangeImageSlightlyHigh, rangeImageQuiteHigh) {
		rangeCircle.empty();
		rangeCircle.removeAttr('style');
		rangeImageNormal.removeAttr('style');

		rangeCircle.removeClass('range-circle-high range-circle-low range-circle-quite-low range-circle-slightly-low range-circle-slightly-high range-circle-quite-high');
		rangeImageHigh.add(rangeImageLow).add(rangeImageQuiteLow).add(rangeImageSlightlyLow).add(rangeImageSlightlyHigh).add(rangeImageQuiteHigh).add(rangeImageNormal).removeClass('active');
	}

	function adjustBookingPossiblity(target) {
		// reset before updating
		resetRangeClasses(rangeCircle, rangeImageNormal, rangeImageHigh, rangeImageLow, rangeImageQuiteLow, rangeImageSlightlyLow, rangeImageSlightlyHigh, rangeImageQuiteHigh);
		if (target.parent().siblings().length == 0) {
			const feeList = $('.fee.ng-scope label');
			const currentReserveCoinId = $(".current_reserve_coin_id").val();

			feeList.each((i, fee) => {
				let feeId = $(fee).attr('id');

				// find saved lesson fee and adjust range
				if (feeId == currentReserveCoinId) {
					target = $(fee);
				}
			})
		}

		const feeIndex = target.parent().index('.fee.ng-scope');
		const rangeHeight = $(".range-wrap").height();
		const totalFeesLength = $('.fee.ng-scope').length - 1;	
		const circlePosition = ((feeIndex - 1) / totalFeesLength) * rangeHeight;

		const circleTop = `${circlePosition + 21}px`;
		const imageTop = `${circlePosition + 11}px`;

		if (feeIndex === 1 && totalFeesLength !== 1) {
			rangeCircle.addClass('range-circle-low');
			rangeCircle.text('LOW');
			rangeImageLow.addClass('active');		
		} else if (feeIndex === totalFeesLength && totalFeesLength !== 1) {
			rangeCircle.addClass('range-circle-high');
			rangeCircle.text('HIGH');
			rangeImageHigh.addClass('active');
		} else if (feeIndex === 2 && totalFeesLength === 3) {
			rangeCircle.css('top', circleTop);
			rangeImageNormal.css('top', imageTop);
			rangeImageNormal.addClass('active');
		} else {
			// dynamically adjust range circle based on computed range
			const computedRange = (feeIndex - 1) / totalFeesLength;
			if (computedRange > 0.01 && computedRange <= 0.2) {
				rangeCircle.css('top', circleTop);
				rangeCircle.addClass('range-circle-quite-low');
				rangeImageQuiteLow.css('top', imageTop);
				rangeImageQuiteLow.addClass('active');
			} else if (computedRange > 0.2 && computedRange < 0.35) {
				rangeCircle.css('top', circleTop);
				rangeCircle.addClass('range-circle-slightly-low');
				rangeImageSlightlyLow.css('top', imageTop);
				rangeImageSlightlyLow.addClass('active');
			} else if (computedRange > 0.55 && computedRange <= 0.7) {
				rangeCircle.css('top', circleTop);
				rangeCircle.addClass('range-circle-slightly-high');
				rangeImageSlightlyHigh.css('top', imageTop);
				rangeImageSlightlyHigh.addClass('active');
			} else if (computedRange > 0.7 && computedRange < 0.99) {
				rangeCircle.css('top', circleTop);
				rangeCircle.addClass('range-circle-quite-high');
				rangeImageQuiteHigh.css('top', imageTop);
				rangeImageQuiteHigh.addClass('active');
			} else {
				rangeCircle.css('top', circleTop);
				rangeImageNormal.css('top', imageTop);
				rangeImageNormal.addClass('active');
			}
		}
		
	}
</script>

<!-- save shift schedule -->
<a class="hide" rel="modal" href="#dialog_save_schedule" id="trigger_save_schedule"></a>
<div class="modal-window dialog schedule_modal-window  hide static_overlay" id="dialog_save_schedule">
	<h3>Save Schedule</h3>
	<p class="schedule-modal-text-wrap">Once you click "Save" button below, your schedule will be fixed and sent to the management.</p><br>
	<p class="schedule-modal-text-wrap" style="color:red;">Please be noted that you will not be able to change your schedule after clicking the button.</p><br><br>

	<div class="btn_wrap btn_center cf">
		<button id="modalSaveSched" class="btn schedule-modal-btn btn-modal-primary ">Save</button>
		<button id="saveSchedCancel" class="schedule-modal-btn schedule-modal-btn-danger close_modal">Cancel</button>
	</div>
</div>

<!-- save shift schedule  error rest day modal-->
<a class="hide" rel="modal" href="#dialog_rest_day_error" id="trigger_rest_day_error"></a>
<div class="modal-window dialog schedule_modal-window  hide static_overlay" id="dialog_rest_day_error">
	<h3>Please set a correct number of rest days</h3>
	<p id="rdmodalMessage" class="schedule-modal-text-wrap"></p><br><br>

	<div class="btn_wrap btn_center cf">
		<button id="setRDBtn" class="schedule-modal-btn schedule-modal-btn-danger close_modal">Set Rest Days</button>
	</div>
</div>

<!-- save shift schedule error modal -->
<a class="hide" rel="modal" href="#dialog_save_sched_error" id="trigger_save_sched_error"></a>
<div class="modal-window dialog schedule_modal-window  hide static_overlay" id="dialog_save_sched_error">
	<h3>Shift Schedule</h3>
		<p id="errModalMessage" style="text-align: center;"></p><br><br>
		<div class="btn_wrap btn_center cf">
			<button id="mdSetShift" class="schedule-modal-btn schedule-modal-btn-danger close_modal">Set Shift Schedule</button>
		</div>
</div>

<!-- shift change new request modal  -->
<a class="hide" rel="modal" href="#dialog_new_request" id="trigger_new_request"></a>
<div class="modal-window dialog office-shift-change-modal new-office-shift-modal-window static_overlay hide" id="dialog_new_request">
	<div class="office-modal-content new-office-shift">
		<form method="post" ng-submit="selectShiftChangeRequest()" class="ng-pristine ng-valid">
			<div class="shift-new_request">
				<p class="ng-binding">Please choose a type of shift change <br> </p>
				<ul>
					
					<li class="shift-change-request-option-li">
						<input ng-model="newShiftChangeRequest.type" type="radio" id="rest-day-work" name="office-shift" value="RDW" ng-disabled="!newShiftChangeRequest.rdot_flg" class="ng-pristine ng-untouched ng-valid ng-empty" disabled="disabled">
						<label for="rest-day-work" ng-class="!newShiftChangeRequest.rdot_flg ? 'disabled-option' : ''" class="disabled-option">	
						<!-- <label for="rest-day-work" ng-disabled="!officeRdOtAllowedFlg">	 -->
							Rest Day Work
						</label>
						<br>
					</li>
					<!-- ngIf: newShiftChangeRequest.shift_change_flg -->
					<li class="shift-change-request-option-li">
						<input ng-model="newShiftChangeRequest.type" type="radio" id="change-rest-day" name="office-shift" value="CRD" ng-disabled="!newShiftChangeRequest.change_rd_flg" class="ng-pristine ng-untouched ng-valid ng-empty" disabled="disabled">
						<label for="change-rest-day" ng-class="!newShiftChangeRequest.change_rd_flg ? 'disabled-option' : ''" class="disabled-option">	
							Change Rest Day <span class="ng-binding">(Deadline: )</span>
						</label>
						<br>
					</li>
					<!-- ngIf: officeAdditionalRd -->
					<li class="shift-change-request-option-li">
						<input ng-model="newShiftChangeRequest.type" type="radio" id="sil-request" name="office-shift" value="SIL" ng-disabled="!newShiftChangeRequest.sil_flg" class="ng-pristine ng-untouched ng-valid ng-empty" disabled="disabled">
						<label for="sil-request" ng-class="!newShiftChangeRequest.sil_flg ? 'disabled-option' : ''" class="disabled-option">
							Service Incentive Leave <span class="ng-binding">You have  Service Incentive Leave days that you can take.</span>
						</label>
					</li>
				</ul>
			</div>
			<div class="new-office_link">
				<!-- ngIf: newShiftChangeRequest.disabled_option_details -->
			</div>
			<div class="office-row t_center m_t_20">
				<button type="button" class="cancel-sendRequest-btn close_modal">Cancel</button>
				<button type="submit" class="sendRequest-btn" ng-disabled="!newShiftChangeRequest.type" disabled="disabled">Send a request</button>
			</div>
		</form>
	</div>
	<!-- <div class="btn-close btn_close"></div> -->
	<script>
    $(document).ready(function() {
      $(document).on('click', 'input[name="office-shift"]', function() {
        $('li').removeClass('selected');
        $(this).closest('li').addClass('selected');
      });
    });
  </script>
</div>

<!-- NJ-29414 start -->
<!-- Absence Warning modal -->
<a class="hide" rel="modal" href="#dialog_modal_absence_warning" id="trigger_modal_absence_warning"></a>
<div class="modal-window dialog absence-warning-modal-window static_overlay hide" id="dialog_modal_absence_warning">
	<div class="office-modal-content absence-warning">	
		
			<h2>Caution</h2>
			<p>If you are absent during this cut-off period, the rest day work that you are currently <br>applying for will be a regular day and will no longer be rest day work</p>
			<div class="tacbox">
				<input ng-model="newShiftChangeRequest.swap_calculation_notice_flg" id="checkbox" type="checkbox" value="1" class="ng-pristine ng-untouched ng-valid ng-empty">
				<label for="checkbox">I agree to the terms and conditions</label>
			</div>
			<div class="office-row t_center m_t_20">
				<button type="button" class="close_modal" ng-click="returnToRequestOptions()">Cancel</button>
				<button type="button" ng-disabled="!newShiftChangeRequest.swap_calculation_notice_flg" ng-click="selectShiftChangeRequest()" class="swap_confirm" disabled="disabled">OK</button>
			</div>
		
	</div>
</div>

<!-- Request Fail modal -->
<a class="hide" rel="modal" href="#dialog_modal_request_fail" id="trigger_modal_request_fail"></a>
<div class="modal-window dialog request-fail-modal-window static_overlay hide" id="dialog_modal_request_fail">
	<div class="office-modal-content request-fail">	
	<ul class="bullet">
		<!-- ngIf: shiftChangeDisabledExplanation.rdot -->
		<!-- ngIf: shiftChangeDisabledExplanation.shift_change -->
		<!-- ngIf: shiftChangeDisabledExplanation.change_rd -->
		<!-- ngIf: shiftChangeDisabledExplanation.addtl_rd -->
		<!-- ngIf: shiftChangeDisabledExplanation.sil -->
	</ul>
	<div class="office-row t_center m_t_50">
			<button type="button" class="close_modal" ng-click="returnToRequestOptions()">OK</button>
		</div>
	</div>
</div>
<!-- NJ-29414 end -->

<!-- shift change new request rd ot modal  -->
<a class="hide" rel="modal" href="#dialog_request_rd_ot" id="trigger_request_rd_ot"></a>
<div class="modal-window dialog office-shift-change-modal hide static_overlay" id="dialog_request_rd_ot">
	<div class="office-modal-content">
		<span class="close_modal office-close-modal"><i class="fa fa-times-circle-o"></i></span>
		<div class="office-row office-top-m-20">
			<p class="t_center m_t_20">RDOT</p>
			<div class="m_t_20"></div>
		</div>
		<form method="post" id="changeShiftRdot" ng-submit="sendRequestRdot()" class="ng-pristine ng-valid">
			<div class="office-row">
				<p class="m_t_20">Choose the date for RDOT:</p>
			</div>
			<div class="office-row">
				<div class="input select required">
					<select name="daily_shift_id" ng-model="shiftChangeData.daily_shift_id" class="office-shift-rd-list rdot-disable-submit ng-pristine ng-untouched ng-valid ng-empty" id="officeTeacherRdShifts"><option value="? undefined:undefined ?"></option></select>
				</div>
			</div>
			<div class="office-row">
				<p class="office-red-notice office-text-s office-notice-text ng-binding"></p>
			</div>
			<!-- ngIf: !enableSendRequest --><div class="office-row m_t_20 ng-scope" ng-if="!enableSendRequest">
				<p class="office-red-notice office-text-s">You do not have rest days on Saturdays and Sundays</p>
			</div><!-- end ngIf: !enableSendRequest -->
			<div class="office-row t_center m_t_20">
				<!-- ngIf: enableSendRequest -->
				<!-- ngIf: !enableSendRequest --><button type="button" class="office-btn-red close_modal ng-scope" ng-if="!enableSendRequest">Close</button><!-- end ngIf: !enableSendRequest -->
			</div>
		</form>
	</div>
</div>

<!-- shift change new request shift change modal  -->
<a class="hide" rel="modal" href="#dialog_request_shift_change" id="trigger_request_shift_change"></a>
<div class="modal-window dialog office-shift-change-modal hide static_overlay" id="dialog_request_shift_change">
	<div class="office-modal-content">
		<span class="close_modal office-close-modal"><i class="fa fa-times-circle-o"></i></span>
		<div class="office-row office-top-m-20">
			<p class="t_center m_t_20">Shift Change</p>
			<div class="m_t_20"></div>
		</div>
		<form method="post" ng-submit="sendRequestShiftChange()" enctype="multipart/form-data" class="ng-pristine ng-invalid ng-invalid-required">
			<input type="hidden" name="shift_date" ng-model="shiftChangeData.shift_date" id="sc_shift_date" class="ng-pristine ng-untouched ng-valid ng-empty">
			<!-- absent date -->
			<div class="office-row">
				<p class="m_t_20">Choose the Absent date:</p>
			</div>
			<div class="office-row">
				<div class="input select required">
					<select name="absent_id" id="sc_absent_options" ng-model="shiftChangeData.sc_absent_id" class="office-shift-rd-list sc-disable-submit ng-pristine ng-untouched ng-empty ng-invalid ng-invalid-required" required="">
						<option value="">-</option>
					</select>
				</div>
			</div>

			<!-- rest day date -->
			<div class="office-row">
				<p class="m_t_20">Choose the Rest Day date:</p>
			</div>
			<div class="office-row">
				<div class="input select required">
					<select name="rd_id" id="sc_rd_options" ng-model="shiftChangeData.sc_rd_id" class="office-shift-rd-list sc-disable-submit ng-pristine ng-untouched ng-empty ng-invalid ng-invalid-required" required="">
						<option value="">-</option>
					</select>
				</div>
			</div>
			
			<div class="office-row t_center m_t_20">
				<button type="submit" class="office-send-request-btn sc-disable-submit">Send a request</button>
			</div>
		</form>
	</div>
</div>

<!-- shift change new request change rd modal >>>  -->
<a class="hide" rel="modal" href="#dialog_request_change_rd" id="trigger_request_change_rd"></a>
<div class="modal-window dialog office-shift-change-modal hide static_overlay" id="dialog_request_change_rd">
	<div class="office-modal-content">
		<span class="close_modal office-close-modal"><i class="fa fa-times-circle-o"></i></span>
		<div class="office-row office-top-m-20">
			<p class="t_center m_t_20">Change Rest Day</p>
			<div class="m_t_20"></div>
		</div>
		<form method="post" ng-submit="sendRequestChangeRd()" enctype="multipart/form-data" class="ng-pristine ng-invalid ng-invalid-required">
			<!-- before date -->
			<div class="office-row">
				<p class="m_t_20">Choose the rest day date:</p>
			</div>
			<div class="office-row">
				<div class="input select required">
					<select name="rd_id" id="rd_options" ng-model="shiftChangeData.rd_id" class="office-shift-rd-list crd-disable-submit ng-pristine ng-untouched ng-empty ng-invalid ng-invalid-required" required="">
						<option value="">-</option>
					</select>
				</div>
			</div>
			<!-- after date -->
			<div class="office-row">
				<p class="m_t_20">Choose the working day date:</p>
			</div>
			<div class="office-row">
				<div class="input select required">
					<select name="wd_id" id="wd_options" ng-model="shiftChangeData.wd_id" class="office-shift-rd-list crd-disable-submit ng-pristine ng-untouched ng-empty ng-invalid ng-invalid-required" required="">
						<option value="">-</option>
					</select>
				</div>
			</div>
			<!-- reason for change -->
			<div class="office-row">
				<p class="m_t_20">Reason for the change:</p>
			</div>
			<div class="office-row">
				<div class="input select required">
					<textarea class="office-shift-change-textarea crd-disable-submit ng-pristine ng-untouched ng-empty ng-invalid ng-invalid-required" ng-model="shiftChangeData.change_reason" rows="2" name="change_reason" required=""></textarea>
				</div>
			</div>
			<!-- proof area -->
			<div class="office-row">
				<p class="m_t_20">Take a picture of the proof:</p>
			</div>
			<div class="office-row">
				<div class="office-camera-icon-div">
					<i class="fa fa-camera office-camera-icon crd-disable-submit" ng-click="changeRdProofRecorder()"></i>
				</div>
				<div class="office-proof-preview">
					<video id="office-proof-preview"></video>
				</div>
			</div>

			<!-- ngIf: officeShiftChangeVideoProofReq -->
			
			<div class="office-row t_center m_t_20">
				<button type="submit" class="office-send-request-btn crd-disable-submit">Send a request</button>
			</div>
		</form>
	</div>
</div>

<!-- shift change new request change rd modal >>>  -->
<a class="hide" rel="modal" href="#dialog_request_additional_rd" id="trigger_request_additional_rd"></a>
<div class="modal-window dialog office-shift-change-modal hide static_overlay" id="dialog_request_additional_rd">
	<div class="office-modal-content">
		<span class="close_modal office-close-modal"><i class="fa fa-times-circle-o"></i></span>
		<div class="office-row office-top-m-20">
			<p class="t_center m_t_20">Additional Rest Day</p>
			<div class="m_t_20"></div>
		</div>
		<form method="post" ng-submit="sendRequestAdditionalRd()" enctype="multipart/form-data" class="ng-pristine ng-invalid ng-invalid-required">
			<!-- before date -->
			<div class="office-row">
				<p class="m_t_20">Choose the date which you want to take an additional RD:</p>
			</div>
			<div class="office-row">
				<div class="input select required">
					<select name="daily_shift_id" id="addtl_rd_options" ng-model="shiftChangeData.daily_shift_id" class="office-shift-rd-list addtl-disable-submit ng-pristine ng-untouched ng-empty ng-invalid ng-invalid-required" required="">
						<option value="">-</option>
					</select>
				</div>
			</div>
			<!-- reason for change -->
			<div class="office-row">
				<p class="m_t_20">Reason for the change:</p>
			</div>
			<div class="office-row">
				<div class="input select required">
					<textarea class="office-shift-change-textarea addtl-disable-submit ng-pristine ng-untouched ng-empty ng-invalid ng-invalid-required" ng-model="shiftChangeData.change_reason" rows="2" name="change_reason" required=""></textarea>
				</div>
			</div>
			<!-- proof area -->
			<div class="office-row">
				<p class="m_t_20">Take a picture of the proof:</p>
			</div>
			<div class="office-row">
				<div class="office-camera-icon-div">
					<i class="fa fa-camera office-camera-icon addtl-disable-submit" ng-click="changeRdProofRecorder(true)"></i>
				</div>
				<div class="office-addtl-proof-preview">
					<video id="office-addtl-proof-preview"></video>
				</div>
			</div>

			<!-- ngIf: officeShiftChangeVideoProofReq -->
			
			<div class="office-row t_center m_t_20">
				<button type="submit" class="office-send-request-btn addtl-disable-submit">Send a request</button>
			</div>
		</form>
	</div>
</div>

<!-- shift change request result modal -->
<a class="hide" rel="modal" href="#dialog_change_rd_proof_recorder" id="trigger_change_rd_proof_recorder"></a>
<div class="modal-window dialog office-change-rd-modal-content hide static_overlay" id="dialog_change_rd_proof_recorder">
	<div class="office-modal-content">
		<span class="office-close-modal office-close-proof-recorder"><i class="fa fa-times-circle-o" ng-click="resetRecorderModal"></i></span>
		<div class="office-row office-top-m-20 office-proof-recorder-div">
			<!--Recorder-->

			<div class="btn_wrap btn_center m_b_30">
				<ul>
					<li>
						<button class="btn_style btn_orange btn_allow fw_n office-btn-round" ng-lick="initCamera()" id="office-init-camera">
						<i class="fa fa-video-camera" aria-hidden="true"></i> Allow Camera</button>
					</li>
				</ul>
			</div>

			<div class="office-local-video-wrap">
				<img src="/user/images/common/video.png" alt="" id="cant_connect_camera_preview" style="display: none;">
				<div class="hide" id="office-screen-overlay">
					<button class="btn_style office-btn-retake" id="reset" ng-click="resetRecordProof()"><i class="fa fa-repeat p_r_10" aria-hidden="true"></i>Retake</button>
				</div>
				<video muted="true" class="proof_recorder" id="proof_recorder" autoplay="" style="display: none;"></video>
				<div class="office-proof-recorder-ctrl hide">
					<div class="office-rec-btn-wrap">
						<div class="office-ctrl-btn-circle">
							<div class="btn_circle_inner">
								<!-- ngIf: !recordingProof --><button class="office-ctrl-rec-btn ng-scope" id="office-ctrl-rec-btn" ng-if="!recordingProof" ng-click="proofRecordStart()"></button><!-- end ngIf: !recordingProof -->
								<!-- ngIf: recordingProof -->
							</div>
						</div>
						<div class="office-ctrl-count-area">
							<div class="office-ctrl-timer" id="timer">00:00:00</div>
						</div>
					</div>
				</div>
			</div>

			<div class="bottom_area" style="visibility: hidden;">
				<div class="d_table">
					<div class="recorded_video_wrap d_cell">
						<div class="recorded_video" id="recorded_video" style="border: 0px;">
							<video id="recorded_proof" style="width: 190px; position: absolute; left: 0px; top: 0px; z-index: 9;"></video>
						</div>
					</div>

					<div class="btn_wrap btn_center d_cell v_top t_right">
						<ul>
							<li>
								<button class="btn_style btn_orange fw_n office-btn-round" id="office-btn-save-vproof" ng-click="saveProofRecord()">Save</button>
							</li>
							<!-- ngIf: videoProofInvalid -->
						</ul>
					</div>
				</div>
			</div>

			<!--Recorder-->

		</div>
	</div>
</div>

<!-- shift change new request rd ot modal  -->
<a class="hide" rel="modal" href="#dialog_request_sil" id="trigger_request_sil"></a>
<div class="modal-window dialog office-shift-change-modal hide static_overlay" id="dialog_request_sil">
	<div class="office-modal-content">
		<span class="close_modal office-close-modal"><i class="fa fa-times-circle-o"></i></span>
		<div class="office-row office-top-m-20">
			<p class="t_center m_t_20">Service Incetive Leave</p>
			<div class="m_t_20"></div>
		</div>
		<form method="post" ng-submit="sendRequestSIL()" class="ng-pristine ng-invalid ng-invalid-required">
			<div class="office-row">
				<p class="office-red-notice office-text-s t_center"><b>You have <span id="office-sil-available"></span> Service Incentive Leave days that you can take.</b></p>
			</div>
			<div class="office-row">
				<p class="m_t_20">Choose the date that you would like to take Service Incentive Leave for:</p>
			</div>
			<div class="office-row">
				<div class="input select required">
					<input name="sil_date_range" ng-model="shiftChangeData.sil_date_range" class="sil-disable-submit office-shift-input ng-pristine ng-untouched ng-empty ng-invalid ng-invalid-required" id="officeTeacherSilDate" readonly="readonly" required="">
				</div>
			</div>
			<div class="office-row">
				<p class="office-red-notice office-text-s office-notice-text office-req-date ng-binding"></p>
			</div>
			<div class="office-row t_center m_t_20">
				<button type="submit" class="office-send-request-btn sil-disable-submit">Send a request</button>
			</div>
		</form>
	</div>
</div>

<!-- shift change request result modal -->
<a class="hide" rel="modal" href="#dialog_change_request_result" id="trigger_change_request_result"></a>
<div class="modal-window dialog office-shift-change-modal hide static_overlay" id="dialog_change_request_result">
	<div class="office-modal-content">
		<span class="close_modal office-close-modal"><i class="fa fa-times-circle-o"></i></span>
		<div class="office-row office-top-m-20">
			<p class="t_center m_t_20 office-req-result-title"></p>
		</div>
			<div class="office-row">
				<p class="t_center m_t_20 office-req-result"></p>
			</div>
			<div class="office-row t_center m_t_20">
				<button type="button" class="office-btn-red close_modal">Close</button>
			</div>	
	</div>
</div>

<a class="hide" rel="modal" href="#dialog_office_teacher_video_preview" id="trigger_office_teacher_video_preview"></a>
<div class="modal-window dialog office-video-preview-content hide static_overlay" id="dialog_office_teacher_video_preview">
	<div class="office-modal-content">
		<span class="office-close-modal close_modal" ng-click="initOfficeTeacherVideoFrame()"><i class="fa fa-times-circle-o"></i></span>
		<div class="office-row office-proof-recorder-div">
			<!--video preview-->
			<div class="office-local-video-wrap">
				<video width="640" height="360" style="display:block;" muted="true" id="officeTeacherVideoPreview" autoplay=""></video>
			</div>
		</div>
	</div>
</div>

<!-- endof office accounting renewal modals -->

<!-- appreciation see more >>>  -->
<a class="hide" id="trigger_modal_appreciation_detail" rel="modal" href="#dialog_appreciation_detail"></a>
<div class="modal_window dialog hide dialog_appreciation_detail static_overlay" id="dialog_appreciation_detail">
	<div class="appreciation_container">

	</div>
<div class="btn-close btn_close"></div>
</div>

<!-- this is live lesson [START] -->
<a class="hide" id="trigger_modal_this_is_live_lesson" rel="modal" href="#dialog_this_is_live_lesson"></a>
<div class="modal_window dialog hide dialog_this_is_live_lesson" id="dialog_this_is_live_lesson">
	<div class="modal-inner">
		<p class="fs_22 fw_b t_center">This lesson is a LIVE lesson.</p>
		<div class="m_t_30">
			<p class="fs_16 lh_16"><b>Multiple students will watch this lesson.</b></p>
			<p class="fs_16 lh_16 m_t_10"><b>Be aware of what you say and write in the chat box.</b></p>
			<!--p class="fs_16 lh_16 m_t_10"><b>Be careful about what you say and write in the chat box.</b></p>
			<p class="fs_16 lh_16 m_t_20">・Do not expose personal information of students or third parties</p>
			<p class="fs_16 lh_16 m_t_10">・Do not have an illegal purpose, or act or make a statement that promotes illegal activities.</p>
			<p class="fs_16 lh_16 m_t_10">・Do not make statements or acts that make others uncomfortable, such as violence or sexuality.</p-->
		</div>
		<div class="t_center m_t_30">
			<a class="btn_style btn_orange live_lesson_confirmation close_modal" href="javascript:void(0)">OK</a>
		</div>
	</div>
	<div class="live_lesson_confirmation btn_close"></div>
</div>
<!-- this is live lesson [END] -->

<!-- live lesson student left [START] -->
<a class="hide" id="trigger_modal_live_lesson_student_left" rel="modal" href="#dialog_live_lesson_student_left"></a>
<div class="modal_window dialog hide dialog_live_lesson_student_left" id="dialog_live_lesson_student_left">
	<div class="modal-inner">
		<p class="fs_22 fw_b t_center">Student has left the room.</p>
		<div class="m_t_30">
			<p class="fs_16 lh_16"><b>If there are viewers, please have a speech until the student returns.</b></p>
			<p class="fs_16 lh_16 m_t_20">・Self introduction</p>
			<p class="fs_16 lh_16 m_t_10">・Interests and hobbies</p>
			<p class="fs_16 lh_16 m_t_10">・How do you spend your day-offs</p>
			<p class="fs_16 lh_16 m_t_10">・About your normal lesson</p>
			<p class="fs_16 lh_16 m_t_10">・About your country</p>
			<p class="fs_16 lh_16 m_t_10">・About the latest news</p>
		</div>
		<div class="t_center m_t_30">
			<a class="btn_style btn_orange close_modal" href="javascript:void(0)">OK</a>
		</div>
	</div>
	<div class="btn_close"></div>
</div>
<!-- live lesson student left [END] -->

<!-- speaking ratio alert [START] -->
<a class="hide" id="trigger_modal_speaking_ratio_alert" rel="modal" href="#dialog_speaking_ratio_alert"></a>
<div class="modal_window dialog hide dialog_speaking_ratio_alert" id="dialog_speaking_ratio_alert">
	<div class="modal-inner p_t_100 p_r_100">
		<p class="fs_22 fw_b c_red t_center">Please be careful not to speak one-sidedly.</p>
		<div class="t_center m_t_30">
			<a class="btn_style btn_orange size_3 close_modal" href="javascript:void(0)">OK</a>
		</div>
	</div>
</div>
<!-- speaking ratio alert [END] -->

<!-- rec traffic error  -->
<a rel="modal" href="#dialog_rec_traffic_error" id="trigger_dialog_rec_traffic_error"></a>
<div class="modal_window modal-window dialog static_overlay hide" id="dialog_rec_traffic_error">
	<div class="modal-inner">
		<h3>AI system is busy</h3>
		<p class="t_center m_t_30">There are too many simultaneous users right now.<br>
		Please let the student try again in a short while.</p>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<!-- /. rec_traffic_error -->

<!-- dialog_control_multiple_slots [START] -->
	<a class="hide" id="trigger_dialog_control_multiple_slots" rel="modal" href="#dialog_control_multiple_slots"></a>
	<div class="modal_window dialog hide dialog_control_multiple_slots static_overlay" id="dialog_control_multiple_slots">
		<div class="btn_wrap btn_center cf">
			<ul id="dialog_control_multiple_slots_option">
				<li class="m_t_30" id="control_multiple_btn_pink">
					<button type="button" class="btn_style btn_pink" onclick="updateMultipleSlotWorkShift('Live')">Available</button>
				</li>
				<li class="m_t_30" id="control_multiple_btn_green">
					<button type="button" class="btn_style btn_green" onclick="updateMultipleSlotWorkShift('Meal Break')">Meal Break</button>
				</li>
				<li class="m_t_30" id="control_multiple_btn_blue">
					<button type="button" class="btn_style btn_blue" onclick="updateMultipleSlotWorkShift('Available')">Available</button>
				</li>
				<li class="m_t_30" id="control_multiple_btn_gray">
					<button type="button" class="btn_style btn_gray" onclick="updateMultipleSlotWorkShift('Off')">Off</button>
				</li>
			</ul>
		</div>
		<div class="btn_close" id="dialog_control_multiple_slots_btn_close"></div>
	</div>
<!-- dialog_control_multiple_slots [END] -->

<!-- NJ-1452 : Check if the teacher has Invalid Flag set to ON -->
<!-- NJ-19705 -->
<a class="hide" id="trigger_modal_inactive_flag" rel="modal" href="#dialog_inactive_flag"></a>
<div class="modal-window dialog hide static_overlay dialog_notice_occupation dialog_announcement_warning" id="dialog_inactive_flag">
  <h3 class="page_ttl m_b_30 fs_20">Your tutor account has been deactivated</h3>
  <p class="m_b_20 fs_20">
		Your tutor account has been deactivated
	</p>
  <br>
  <p class="m_b_20 fs_20">
		Your account has been deactivated for one of the following reasons.<br>
		1. You have not taken a lesson for 90 days.<br>
		If you would like to reactivate your account, please contact us via Inquiry.
	</p>
  <br>
  <p class="m_b_20 fs_20">
		2. You violated the Warning And Suspension section of our guidelines.<br>
		For more information and for reactivating your account, please visit the<br>
		Warning Page and submit an Improvement Plan.
	</p>
  <div class="t_center m_t_30">
    <a class="btn_style btn_orange close_modal announcement_warning" href="javascript:void(0)">Noted</a>
  </div>
</div>
<!-- <<< --> 

<!-- apply sudden classes alert [START] -->
<a class="hide" id="trigger_modal_apply_sudden_classes_alert" rel="modal" href="#dialog_apply_sudden_classes_alert"></a>
<div class="modal_window dialog hide dialog_apply_sudden_classes_alert" id="dialog_apply_sudden_classes_alert">
	<div class="modal-inner">
		<p class="fs_30 fw_b t_center m_b_20 t_color_orange">Currently, you can conduct only booked classes</p>
		<p class="fs_24 t_center catch m_b_20">We have two types of classes at Native Camp.</p>
		<div class="d_flex">
			<table>
				<tbody><tr>
					<th class="bg_dark_blue t_color_white fs_18">Booked class</th>
				</tr>
				<tr>
					<td class="fs_16">A class where students reserve a specific date and time in advance</td>
				</tr>
				<tr>
					<td class="fs_16 fw_b">Remuneration</td>
				</tr>
				<tr>
					<td class="fs_16">430NCC / class (≒ 9USD)</td>
				</tr>
			</tbody></table>
			<table>
				<tbody><tr>
					<th class="bg_dark_blue t_color_white fs_18">Sudden class (not mandatory)</th>
				</tr>
				<tr>
					<td class="fs_16">A class where students can enter anytime</td>
				</tr>
				<tr>
					<td class="fs_16 fw_b">Remuneration</td>
				</tr>
				<tr>
					<td class="fs_16">192NCC / 25min (≒ 4USD)</td>
				</tr>
			</tbody></table>
		</div>
		<p class="fs_24 t_center catch m_t_20 m_b_20">Advantages of a sudden class</p>
		<div class="d_flex">
			<img class="advantages_img m_t_10" src="./images/icon/icon_class.png">
			<div>
				<p class="fs_18 fw_b m_t_10">1.You can take more classes</p>
				<p class="fs_18 m_t_10 m_l_20">Most students enter sudden classes because they can take unlimited classes for a monthly subscription. On the other hand, they must pay an additional fee in addition to the monthly fee to have booked classes, so fewer students mainly take booked classes. Since around 80% of all classes offered at Native Camp are sudden classes, you will have more classes with students if you conduct sudden classes.</p>
			</div>
		</div>
		<div class="d_flex">
			<img class="advantages_img m_t_10" src="./images/icon/icon_booked.png">
			<div>
				<p class="fs_18 fw_b m_t_10">2.Conducting sudden classes helps increase the possibility of getting booked classes</p>
				<p class="fs_18 m_t_10 m_l_20">Because sudden classes cannot be reserved in advance, students need to compete with each other to enter the class. However, students can pay an additional fee to book a class with their favorite teachers to ensure that they will have a lesson with them. Through the sudden classes you offer, you will increase the possibility that more students will like your lesson and book classes in the future.</p>
			</div>
		</div>
		<div class="d_flex">
			<img class="advantages_img m_t_10" src="./images/icon/icon_working.png">
			<div>
				<p class="fs_18 fw_b m_t_10">3.You can work whenever you feel like working</p>
				<p class="fs_18 m_t_10 m_l_20">In booked classes, you must decide when you want to work in advance because you need to open slots. This means that you cannot make other plans, so if you have urgent matters, you cannot prioritize them. However, with sudden classes, you can work whenever you want, so there is no need to think about your future schedule, and you can work more flexibly than with booked classes.</p>
			</div>
		</div>
		<p class="fs_18 t_center m_b_20 t_color_orange m_t_10">Click "Apply for Sudden Class" after reading the above</p>
		<div class="t_center m_t_30">
			<a class="btn_style btn_orange close_modal" rel="modal" href="#dialog_confirm_action">Apply for Sudden class</a>
		</div>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<!-- apply sudden classes alert [END] -->

<!-- confirm action modal [START] -->
<a class="hide" id="trigger_modal_confirm_action" rel="modal" href="#dialog_confirm_action"></a>
<div class="modal_window dialog hide dialog_confirm_action" id="dialog_confirm_action">
	<div class="modal-inner">
		<p class="fs_22 fw_b t_center m_b_25">Confirm Action</p>
		<p class="fs_16 t_center">Are you sure you want to enable this option?</p>
		<div class="btn_wrap t_center m_t_30">
			<a class="btn_style btn_orange close_modal cancel" href="javascript:void(0)">Cancel</a>
			<a class="btn_style btn_orange close_modal confirm" href="javascript:void(0)" ng-click="confirmSuddenLesson($event)">Confirm</a>
		</div>
	</div>
</div>
<!-- confirm action modal [END] -->

<!-- notice confirm process [START] -->
<a class="hide" id="trigger_modal_notice_confirm_process" rel="modal" href="#dialog_notice_confirm_process"></a>
<div class="modal_window dialog hide dialog_notice_confirm_process" id="dialog_notice_confirm_process">
	<div class="modal-inner">
		<p class="fs_22 fw_b t_center m_b_25">Now you can conduct sudden classes!</p>
		<p class="fs_16 t_center c-red">You are logged out now.</p>
		<p class="fs_16 t_center c-red">Please log in to the platform again.</p>
		<div class="btn_wrap t_center m_t_30">
			<a class="btn_style btn_orange confirm" href="/teacher/logout/?action=modal_logout">OK</a>
		</div>
	</div>
</div>
<!-- notice confirm process [END] -->

<!-- apply sudden lesson error message [START] -->
<a class="hide" id="trigger_modal_notice_error_msg" rel="modal" href="#dialog_notice_error_msg"></a>
<div class="modal_window dialog hide dialog_notice_error_msg" id="dialog_notice_error_msg">
	<div class="modal-inner">
		<p class="fs_22 fw_b t_center m_b_25">Error!</p>
		<p class="fs_16 t_center c-red">Application failed.</p>
		<p class="fs_16 t_center c-red">Please contact us from Inquiry</p>
		<div class="btn_wrap t_center m_t_30">
			<a class="btn_style btn_orange close_modal" href="javascript:void(0)">OK</a>
		</div>
	</div>
</div>
<!-- apply sudden lesson error message [END] -->

<!-- NJ-7873 講師に対する顔認証機能の導入（なりすまし防止のため） -->
<!-- NJ-31074-Start -->
<!-- <<< --> 

<!-- 11935 dialog_delete_open_space >>>  -->
<a class="hide delete_open_space_modal" rel="modal" href="#dialog_delete_open_space"></a>
<div class="modal-window hide" id="dialog_delete_open_space">
	<div class="modal-inner">
		<div class="title-wrap">
			<h3 class="modal-title">Are you sure that you want to delete the post?</h3>
		</div>
		<div class="open-space-author-box">
			<hr>
			<div class="q-title">
				<p>title</p>
			</div>
			<div class="open-space-profile">
				<div class="user-img">
					<img ng-src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" width="50" height="50" src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=">
				</div>
				<div class="profile-text">
					<p class="user-name">teacher_name</p>
					<p class="post-time">created</p>
				</div>
			</div>
			<div class="q-detail">
				<p>message</p>
			</div>
			<div class="d-flex space-between align-items-center" style="padding-bottom: 1rem">
				<div class="nc-t-thumbs-up">
					<a class="thumb">&nbsp;</a>
					<span class="value">votes</span>
				</div>
				<div class="nc-t-tag-group t-right">
					<a class="nc-t-tag">category</a>
				</div>
			</div>
			<hr>
		</div>
		<div class="btn-wrap">
			<a class="nc-t-btn btn-cancel close_modal" href="javascript:void(0)">NO</a>
			<a class="nc-t-btn btn-yes close_modal" ng-click="delete_open_space()" href="javascript:void(0)">YES</a>
		</div>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<!-- <<< -->
<!-- 11935 dialog_delete_open_space_success >>>  -->
<a class="hide delete_open_space_success_modal" rel="modal" href="#dialog_delete_open_space_success"></a>
<div class="modal-window hide" style="min-width:500px;padding: 7rem 30px;" id="dialog_delete_open_space_success">
	<h3 class="modal-title">Your post has been deleted</h3>
	<div class="btn-close btn_close"></div>
</div>
<!-- <<< -->
<!-- 11935 dialog_post_restrict_open_space >>>  -->
<a class="hide post_restrict_open_space_modal" rel="modal" href="#dialog_post_restrict_open_space"></a>
<div class="modal-window hide" id="dialog_post_restrict_open_space">
	<div class="modal-inner">
		<h3 class="modal-title m_b_20">Restricted Posting</h3>
		<div class="title-wrap">
			<p>Unfortunately, you have been restricted from posting on this forum because your posts violated the OpenSpace rules.</p>
			<p>※Please contact the Native Camp Teacher Support Center via the inquiry section for any details about the posting restriction.</p>
		</div>
		<div class="t_center m_t_30">
			<a class="nc-t-btn btn-yes close_modal" href="javascript:void(0);">CLOSE</a>
		</div>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<!-- <<< -->

<!-- NJ-16601 newgrammar modal -->
<a class="hide" rel="modal" href="#campaign_newgrammar_live" id="trigger_modal_campaign_newgrammar_live"></a>
<div class="modal_window dialog dialog_campaign_newgrammar_afterlesson hide modal_center" id="campaign_newgrammar_live">
	<div class="modal_inner">
			<div class="sec">
				<!--?php if(!$this->Session->read('Auth.User')): ?-->
				<div class="detail">
                    <div class="stamp_basket_wrap">
						<!-- fetch stamps via ajax -->
						<div class="stamp-div"></div>
                    </div>
                </div>
                <div class="sec_text m_t_20" style="text-align: center">
                	<input type="checkbox" class="do_not_show_again_modal_campaign" value="newgrammar_live"><span>Don't display next time</span>
                </div>
            </div>
        </div>
	<div class="btn-close btn_close"></div>
</div>
<script>
		// for clickable flag on stamps
		$(document).ready(function() {
			$('.list-stamped img').each(function() {
				$('<div class="flag-tooltip" style="display:none"><span>' + $(this).attr('alt') + '</span></div>').insertAfter($(this));
			})
			$('.list-stamped, .list-stamped img').click(function(e) {
				if (e.target.parentElement.className == 'flag-tooltip') {
					e.preventDefault;
				} else {
					$(this).find('.flag-tooltip').toggle();
				}
			});

			$('.do_not_show_again_modal_campaign').click(function(e){
				let el = e.target;
				let campaign = el.value + '';
				if (typeof $.cookie(campaign) === 'undefined') {
					var inDate = new Date();
					inDate.setTime(inDate.getTime() + (1440 * 60 * 1000));
					$.cookie(campaign, true, {
						expires: inDate
					});
				}
			});
		});

</script>
<!-- NJ-16601 newgrammar modal END -->

<!-- NJ-17285 teacher away modal START -->
<a class="hide" rel="modal" href="#teacher_away" id="trigger_modal_teacher_away"></a>
<div class="modal_window dialog no-border hide dialog_teacher_away" id="teacher_away">
	<div class="modal-inner">
		<p class="modal-title">Are you there?</p>
		<p class="t_center m_t_30">
			<img src="/teacher/images/modal/away.png" alt="">
		</p></div>
		<div class="t_center m_t_30">
			<p>Our system has detected that you haven’t done any action on your<br>device in several minutes.</p>
			<p class="m_t_20">Please confirm your presence within:</p>
			<p class="timer">2:00</p>
			<p class="m_t_10">If you do not take any action, your status will automatically return to <br>“NOT STANDBY”</p>
		</div>
		<div class="btn_wrap t_center">
			<a class="btn_style btn_gray" href="javascript:void(0)" onclick="updateStandbyStatus(0);">NOT STANDBY</a>
			<a class="btn_style btn_orange" href="javascript:void(0)" onclick="updateStandbyStatus(1)">I'M HERE</a>
		</div>
		<div class="hide btn_close btn-close" style="display: none"></div>
	</div>

<!-- NJ-17285 teacher away modal END -->

<!-- NJ-17285 teacher away modal CONFIRMATION START -->
<a class="hide" rel="modal" href="#teacher_away_confirm" id="trigger_modal_teacher_away_confirm"></a>
<div class="modal_window dialog no-border hide dialog_teacher_away" id="teacher_away_confirm">
	<div class="modal-inner">
		<table>
			<tbody><tr class="t_center">
				<td><span class="dot"></span></td>
				<td><p class="modal-title">Your status has been changed to “NOT STANDBY”</p></td>
			</tr>
		</tbody></table>
		<div class="m_t_50 m_b_50">
			<p>Since the system couldn’t confirm any activity from your device within 2 minutes, your status has<br> been changed to “NOT STANDBY”.</p>
		</div>
	</div>
	<div class="btn_close btn-close"></div>
</div>
<!-- NJ-17285 teacher away modal CONFIRMATION END -->

<!-- NJ-17285 teacher away modal NOTIF START -->
<a class="hide" rel="modal" href="#teacher_away_notif" id="trigger_modal_teacher_away_notif"></a>
<div class="modal_window dialog no-border hide dialog_teacher_away" id="teacher_away_notif">
	<div class="modal-inner">
		<table>
			<tbody><tr>
				<td><img src="/teacher/images/common/nc_logo.png" alt=""></td>
				<td><p>スタンバイモードが解除されました</p></td>
			</tr>
		</tbody></table>
	</div>
</div>
<!-- NJ-17285 teacher away modal NOTIF END -->

<!-- NJ-17285 teacher modal NOTIF START -->
<a class="hide" rel="modal" href="#teacher_platform_notif" id="trigger_modal_teacher_platform_notif"></a>
<div class="modal_window dialog no-border hide dialog_teacher_away" id="teacher_platform_notif">
	<div class="modal-inner">
		<table>
			<tbody><tr>
				<td><img src="/teacher/images/common/nc_logo.png" alt=""></td>
				<td><p>プラットフォームに<br>お知らせが表示されました</p></td>
			</tr>
		</tbody></table>
	</div>
</div>
<!-- NJ-17285 teacher modal NOTIF END -->

<!-- NJ-17285 teacher away modal START -->
<a class="hide" rel="modal" href="#disabled_web_push_notif" id="trigger_modal_disabled_web_push_notif"></a>
<div class="modal_window dialog no-border hide disabled_web_push_notif" id="disabled_web_push_notif">
	<div class="modal-inner">
		<div class="t_center m_t_30">
			<p>You won't receive any notification as the browser permission is disabled.</p>
		</div>
		<div class="btn_wrap t_center">
			<a class="btn_style btn_gray close_modal" href="javascript:void(0)">OK</a>
		</div>
		<div class="hide btn_close btn-close" style="display: none"></div>
	</div>
</div>
<!-- NJ-17285 teacher away modal END -->

<!-- NJ-20254 New badge -->
<a class="hide" rel="modal" href="#modal_new_badge" id="trigger_modal_new_badge"></a>
<div class="modal_window dialog no-border hide dialog_new_badge" id="modal_new_badge">
	<div class="modal-inner new-badge-modal-inner">
		<div class="new-badge-title-container">
			<img src="/teacher/images/modal/new-badge/teddy_phd.png" alt="Teddy bear">
				<p class="new-badge-title">Congratulations!</p>
				<p>You have earned the following badges.</p>
		</div>
		<div class="new-badge-list-container">
			<div class="new-badge-list">
				<div class="new-badge">
					<div class="new-badge-content">
						<img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" alt="badge" width="64" class="new-badge-img">
						<span class="new-badge-name"></span>
					</div>
				</div>
				<!-- ROW END -->
			</div>
		</div>
		<div class="btn_wrap new_badge_btn_wrap t_center">
			<a class="btn_style btn_orange new-badge-btn close_modal" href="javascript:void(0)">Noted</a>
		</div>
		<div class="hide btn_close btn-close" style="display: none"></div>
	</div>
</div>
<!-- NJ-20254 New badge END-->

<!-- NJ-10076 : dialog_environment -->
<a class="hide" id="trigger_dialog_environment" rel="modal" data-toggle="modal" href="#dialog_environment"></a>
<div class="modal_window dialog hide" id="dialog_environment">
	<button type="button" class="btn btn_restart" id="reset_modal_btn" rel="modal">Restart</button>
	<p class="environment_title fs_32 c_orange t_center">
		Environment Check
	</p>
	<p class="env_subtitle m_t_15 fs_24 t_center">
		Check if lessons are available.
	</p>
	<div class="testing_area" id="testing_area">
		<!-- check item - recommended browser -->
		<div class="check_item environment_item">
			<div class="environment_item_header">
				<p class="fs_18"><span class="c_orange p_r_15">1.</span>Are you using the recommended browser?</p>
				<div class="btn btn_style check_modal_btn" id="btn_check_modal-system_browser">
					<span class="label label-processing hide"><i class="fa fa-spinner fa-spin fa-fw m_r_2"></i></span>
					<span class="">Check</span>
				</div>
				<div class="check-ok check_success p_r_15 ">
					<img src="/teacher/images/icon/check-circle.svg" alt="">
				</div>
			</div>
			<div class="check_result environment_item_container">
				<div class="environment_check_fail">
					<div class="fail_message">
						<span>
							<img src="/teacher/images/icon/x-circle.svg" alt="">
						</span>
						You have an issue with your environment or settings
					</div><a href="javascript:void(0)" data-guideline-url="how-to-deal-with-communication-problems" ng-click="menuChange($event)" data-ui-sref-opts="{reload: true}" ui-sref="home/guideline({type: 'subcategory', value:'how-to-deal-with-communication-problems'})" class="header_menu env-hyper-link">
                        Please click here 
                    </a>
				</div>
			</div>
		</div>

		<!-- check item - check speedtest -->
		<div class="check_item environment_item">
			<div class="environment_item_header">
				<p class="fs_18"><span class="c_orange p_r_15">2.</span>Please check your internet speed.</p>
				<div class="btn btn_check btn_modal-check-manual btn_style check_modal_btn disabled" id="btn_check_modal-speed_test">
					<span class="label label-processing hide"><i class="fa fa-spinner fa-spin fa-fw m_r_2"></i></span>
					<span class="">Check</span>
				</div>
				<div class="check-ok check_success p_r_15 ">
					<img src="/teacher/images/icon/check-circle.svg" alt="">
				</div>
			</div>
			<div class="user_modal_manual_check environment_item_container">
				<div class="environment_item_content">
					<p class="fs_16 t_center m_b_10">Checking your Internet speed</p>
					<p class="fs_16 t_center m_b_20">For checking your Internet speed, please use the following link: <a href="https://www.speedtest.net/" class="c_orange" target="_blank">speedtest.net<i class="fa fa-external-link p_l_5 v_middle"></i></a></p>
					<div class="environment_speedtest m_b_40">
						<img src="/teacher/images/common/speed_test_modal.png" alt="">
					</div>
					<p class="fs_16 t_center m_b_10">Does your Internet speed exceed the following?</p>
					<div class="environment_speed_request m_b_20">
						<div class="download_speed">
							<p class="fs_16">Preferable download speed</p>
							<p class="fs_16">: At least more than 5Mbps</p>
						</div>
						<div class="upload_speed">
							<p class="fs_16">Preferable upload speed</p>
							<p class="fs_16">: At least more than 1Mbp</p>
						</div>
					</div>
					<div class="radio_select t_center m_b_30">
						<input autocomplete="off" type="radio" name="radio_modal_testing_speed_test" value="1" class="hide" id="radio_modal_testing_speed_test_1"><label class="custom_radio green" for="radio_modal_testing_speed_test_1">Yes</label>
						<input autocomplete="off" type="radio" name="radio_modal_testing_speed_test" value="0" class="hide" id="radio_modal_testing_speed_test_0"><label class="custom_radio green" for="radio_modal_testing_speed_test_0">No</label>
					</div>
				</div>

				<div class="check_result environment_item_container">
					<div class="environment_check_fail">
						<div class="fail_message">
							<span>
								<img src="/teacher/images/icon/x-circle.svg" alt="">
							</span>
							You have an issue with your environment or settings
						</div>
						<a href="javascript:void(0)" data-guideline-url="how-to-deal-with-communication-problems" ng-click="menuChange($event)" data-ui-sref-opts="{reload: true}" ui-sref="home/guideline({type: 'subcategory', value:'how-to-deal-with-communication-problems'})" class="header_menu env-hyper-link">
							Please click here 
						</a>
					</div>
				</div>
			</div>
		</div>

		<!-- check item - camera -->
		<div class="check_item environment_item">
			<div class="environment_item_header">
				<p class="fs_18"><span class="c_orange p_r_15">3.</span>Is your camera working properly?</p>
				<div class="btn btn_check btn_style check_modal_btn disabled" id="btn_check_modal-device_camera">
					<span class="label label-processing hide"><i class="fa fa-spinner fa-spin fa-fw m_r_2"></i></span>
					<span class="">Check</span>
				</div>
				<div class="check-ok check_success p_r_15 ">
					<img src="/teacher/images/icon/check-circle.svg" alt="">
				</div>
			</div>
			<div class="check_result environment_item_container">
				<div class="environment_check_fail">
					<div class="fail_message">
						<span>
							<img src="/teacher/images/icon/x-circle.svg" alt="">
						</span>
						You have an issue with your environment or settings
					</div>
					<a href="javascript:void(0)" data-guideline-url="how-to-deal-with-communication-problems" ng-click="menuChange($event)" data-ui-sref-opts="{reload: true}" ui-sref="home/guideline({type: 'subcategory', value:'how-to-deal-with-communication-problems'})" class="header_menu env-hyper-link">
                        Please click here 
                    </a>
				</div>
			</div>
		</div>

		<!-- check item - check if microphone works -->
		<div class="check_item environment_item">
			<div class="check_heading environment_item_header">
				<p class="fs_18"><span class="c_orange p_r_15">4.</span>Can you hear your own voice?</p>
				<div class="btn btn_modal-check-manual btn_check btn_style check_modal_btn disabled" id="btn_check_modal-manual_mic">
					<span class="label label-processing hide"><i class="fa fa-spinner fa-spin fa-fw m_r_2"></i></span>
					<span class="">Check</span>
				</div>
				<div class="check-ok check_success p_r_15 ">
					<img src="/teacher/images/icon/check-circle.svg" alt="">
				</div>
			</div>
			<div class="user_modal_manual_check environment_item_container">
				<div class="environment_item_content">
					<p class="fs_16 t_center m_b_20">
						Please speak into the microphone.<br>
						Can you hear yourself clearly?
					</p>
					<div class="radio_select t_center m_b_30">
						<input autocomplete="off" type="radio" name="radio_modal_testing_mic" value="1" class="hide" id="radio_modal_testing_mic_1"><label class="custom_radio green" for="radio_modal_testing_mic_1">Yes</label>
						<input autocomplete="off" type="radio" name="radio_modal_testing_mic" value="0" class="hide" id="radio_testing_mic_0"><label class="custom_radio green" for="radio_testing_mic_0">No</label>
					</div>
					<div class="volume_wrap environment_voice">
						<div class="volume_level cf">
							<div class="volume_level_box">
								<div class="cell" id="volume_cvs_cell">
									<ul class="cf env_check_modal" id="volumeModalCvs">
										<li></li>
										<li></li>
										<li></li>
										<li></li>
										<li></li>
										<li></li>
										<li></li>
										<li></li>
										<li class="on"></li>
										<li class="on"></li>
									</ul>
								</div>
							</div>
						</div><!-- // .volume_level -->
					</div>
				</div>

				<div class="check_result environment_item_container">
					<div class="environment_check_fail">
						<div class="fail_message">
							<span>
								<img src="/teacher/images/icon/x-circle.svg" alt="">
							</span>
							You have an issue with your environment or settings
						</div>
						<a href="javascript:void(0)" data-guideline-url="how-to-deal-with-communication-problems" ng-click="menuChange($event)" data-ui-sref-opts="{reload: true}" ui-sref="home/guideline({type: 'subcategory', value:'how-to-deal-with-communication-problems'})" class="header_menu env-hyper-link">
							Please click here 
						</a>
					</div>
				</div>	
			</div>
		</div>

		<!-- check item - check if camera exists -->
		<div class="check_item environment_item">
			<div class="environment_item_header">
				<p class="fs_18"><span class="c_orange p_r_15">5.</span>Can you see your own video?</p>
				<div class="btn btn_check btn_modal-check-manual btn_style check_modal_btn disabled" id="btn_check_modal-manual_video">
					<span class="label label-processing hide"><i class="fa fa-spinner fa-spin fa-fw m_r_2"></i></span>
					<span class="">Check</span>
				</div>
				<div class="check-ok check_success p_r_15 ">
					<img src="/teacher/images/icon/check-circle.svg" alt="">
				</div>
			</div>
			<div class="user_modal_manual_check environment_item_container">
				<div class="environment_item_content">
					<p class="fs_16 t_center m_b_20">Is your video displayed correctly?</p>
					<div class="radio_select t_center m_b_30">
						<input autocomplete="off" type="radio" name="radio_modal_testing_video" value="1" class="hide" id="radio_modal_testing_video_1"><label class="custom_radio green" for="radio_modal_testing_video_1">Yes</label>
						<input autocomplete="off" type="radio" name="radio_modal_testing_video" value="0" class="hide" id="radio_modal_testing_video_0"><label class="custom_radio green" for="radio_modal_testing_video_0">No</label>
					</div>
					<div class="video_wrap environment_video">
						<video class="ownVideo-test" id="ownVideo-test" poster="/teacher/images/class/video_no_stream.png" src="data:video/mp4;base64,AAAA" muted=""></video>
					</div>
				</div>
				<div class="check_result environment_item_container">
					<div class="environment_check_fail">
						<div class="fail_message">
							<span>
								<img src="/teacher/images/icon/x-circle.svg" alt="">
							</span>
							You have an issue with your environment or settings
						</div>
						<a href="javascript:void(0)" data-guideline-url="how-to-deal-with-communication-problems" ng-click="menuChange($event)" data-ui-sref-opts="{reload: true}" ui-sref="home/guideline({type: 'subcategory', value:'how-to-deal-with-communication-problems'})" class="header_menu env-hyper-link">
							Please click here 
						</a>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="environment-modal-check-all-done hide" style="text-align: center;">
		<p class="">When everything is 
			<span>
				<img src="/teacher/images/icon/check-circle.svg" alt="">
			</span>, you are ready!
		</p>
		<p class="">Please close the screen by clicking the "Close" button and enjoy the lesson.</p>

		<button type="button" id="closeEnvModal" class="btn btn-default close_modal" data-dismiss="modal">Close</button>
	</div>
</div>

<!-- NJ-16808 modal vocabulary book selection image [DAILY NEWS] >>>  -->
<a class="hide" id="trigger_modal_sentence_image" rel="modal" href="#dialog_sentence_image"></a>
<div class="modal_window dialog hide static_overlay dialog_sentence_image" id="dialog_sentence_image">
	<figure>
		<img src="/images/teacher/sentence-modal-img.png">
	</figure>
	<div class="btn_close"></div>
</div>
<!-- <<< -->

<!-- membership cancellation (lateness) modal -->
<a class="hide" rel="modal" href="#reserved_lesson_special" id="trigger_modal_reserved_lesson_special"></a>
<div class="modal_window dialog no-border hide dialog_reserved_lesson_special" id="reserved_lesson_special">
	<div class="modal-inner m_b_20">
		<div class="t_center m_t_30 m_b_30">
			<h2 class="m_b_30 fs_22"><strong>This reserved lesson is special.</strong></h2>
			<p>If the student does not enter the lesson for more than 5 minutes, the lesson will still not be counted as a Student’s Cancellation (Late).</p>
			<p>For this lesson, the student can enter at any time during the reserved lesson time (25 minutes) and you are expected to stay available until the end of the lesson.</p>
			<p>If the student does not show up at all, which is unlikely, you will still be paid in full for your reservation.</p>
		</div>

		<div class="btn_wrap t_center">
			<a class="btn_style btn_orange close_modal" href="javascript:void(0)">OK</a>
		</div>
		<div class="hide btn_close btn-close" style="display: none"></div>
	</div>
</div>

<!-- NJ-24697 start -->

<a class="hide" id="trigger_modal_requests_cfm_counselor_trigger_fetching" href="javascript:void(0);" ng-click="dynamiModalTrigger()"></a>
<a class="hide" id="trigger_modal_requests_cfm_counselor" rel="modal" href="#dialog_modal_requests_cfm_counselor"></a>
<div class="modal_window dialog hide dialog_modal_requests_cfm_counselor" id="dialog_modal_requests_cfm_counselor" style="margin-left: -350px!important; margin-top: -202px!important; min-width: 700px!important;">
	<div class="modal-inner">

		<!-- Trial member (new registration ) -->

		<h2 class="m_b_20 ng-binding"></h2>

		<div class="m_b_50">
			<p class="fs_16 lh_16 ng-binding" id="sub_text"></p>
		</div>

		<div class="modal-middle-text m_b_50">
			<p class="m_b_10 fs_15 text-gray">会員種別</p>
			<p class="m_b_20 fs_18 ng-binding"></p>

			<p class="m_b_10 fs_15 text-gray">総レッスン回数</p>
			<p class="m_b_20 fs_18 ng-binding">0回</p>

			<!-- ngIf: dynamicModalData.showTrial -->
			<!-- ngIf: dynamicModalData.showTrial -->
		</div>

		<div class="t_center">
			<a class="btn_style btn_orange close_modal" href="javascript:void(0);" ng-click="lessonMessageForcereloadPage()">OK</a>
		</div>

	</div>
</div>

<!-- NJ-24697 end -->

<!-- request approval -->
<a class="hide" rel="modal" href="#dialog_request_approval" id="trigger_request_approval"></a>
<div class="modal-window dialog request_approval_modal hide static_overlay t_center modal_request_approval" id="dialog_request_approval">
	<div class="modal-inner">
		<h3>Accept Request</h3>
		<p class="schedule-modal-text-wrap t_left m_t_20 q_text">Do you want to approve the request?</p>
		<div class="btn_wrap btn_half cf m_t_30">
			<ul>
				<li><a class="btn_style btn_border_orange close_modal" href="javascript:void(0)">No</a></li>
				<li><a class="btn_style btn_orange confirm_lesson_request close_modal">Yes</a></li>
			</ul>
		</div>
		<div class="schedule-modal-text-wrap t_left m_t_40">
			For more information on lesson requests, please see the link below.<br>
			<a class="t_link" href="home?guide=lesson-request" rel="nofollow">https://nativecamp.net/teacher/home?guide=lesson-request</a>	
		</div>
	</div>
</div>

<!-- request cancel -->
<a class="hide" rel="modal" href="#dialog_request_cancel" id="trigger_request_cancel"></a>
<div class="modal-window dialog request_approval_modal hide static_overlay t_center modal_request_cancel" id="dialog_request_cancel">
	<div class="modal-inner">
		<h3>Cancel Request</h3>
		<p class="schedule-modal-text-wrap t_left m_t_20">Do you want to cancel the request?</p>
		<div class="btn_wrap btn_half cf m_t_30">
			<ul>
				<li><a class="btn_style btn_border_orange close_modal" href="javascript:void(0)">No</a></li>
				<li><a class="btn_style btn_orange cancel_lesson_request close_modal">Yes</a></li>
			</ul>
		</div>

		<p class="schedule-modal-text-wrap t_left m_t_30">
			If you cancel the request, this slot will not be available
			<br>for requests anymore. Also, it will not be possible to open
			<br>it for lessons reservations.
		</p>

		<div class="t_left m_t_40">
			For more information on please see the link below.<br>
			<a class="t_link" href="home?guide=lesson-request">https://nativecamp.net/teacher/home?guide=lesson-request</a>
		</div>
	</div>
</div>

<script>
// set ice servers from PHP
var iceServers = $.parseJSON('');
var iceServerRemotePeerStream = null;
var iceServerResultTimeOut = null;
var micTestAudioOuput = new Audio();

// process ice servers
if (typeof connectEnvModal !== 'undefined') {
	connectEnvModal.processIceServers(iceServers);

	// console.log('testloghere - ', );

	// signaling server switch logic
	connectEnvModal.isUsingSkyWay = "";
	connectEnvModal.skyWayApiKey = "";
	constant.videoBitRate = "";
	constant.audioBitRate = "";

	// set config
	connectEnvModal.config = {
		memberType: "teacher-test",
		memberName: "",
		chatHash: "NATIVECAMP_ROOM-TEST",
		teacherID: "",
		userID: "449595",
		userSalt: "TEACHER-" + util.getSalt(8) + '-' + "449595",
		ipAdd: "193.163.187.65"
	};

	/* set testing */
	connectEnvModal.testing = true;
}
</script>

<script>
var timeoutStreamChecker = false;
var streamCheckerCallHandler = false;
var micCheckDone = false;
var connectionFailed = false;
var camCheckDone = false;

var browserCheck = false;

var doneTestAll = false;

//Save
var user_agent = 0, media = 0, myOS = 0, 
	peerConnection = 0, browser = 0, internet_speed = 0,
 	camera = 0, microphone = 0, screen_test = 0, ipAdd = 0;

$(function(){
	/*----------------------------------------------*/
	// notify reservation
	/*----------------------------------------------*/
	$('a[rel*=modal]').leanModal();

	/*------------------------------------*/
	/* btn check system browser
	/*------------------------------------*/
	$('#btn_check_modal-system_browser').on('click', function(e){
		e.preventDefault();

		/* spinner */
		$('#btn_check_modal-system_browser .label-processing').show();
		
		/* set scope */
		var scope = $(this).closest('.check_item');
		var btn_check = $(this);
		var device = '1';
		var error = {browser: false, device: false};
		
		if (device != 1) { error.device = true; }

		util.detectBrowser(
			/* if browser is supported */
			function(){
				console.log('line 136');
				browserAndDeviceError(btn_check, scope, error);
			},
			
			/* if browser is not supported */
			function(){
				console.log('line 141');
				error.browser = (device != 1) ? false : true;
				browserAndDeviceError(btn_check, scope, error);
			}
		);
	});

	/*------------------------------------*/
	/* btn check device camera
	/*------------------------------------*/
	$('#btn_check_modal-device_camera').on('click', function(e){
		e.preventDefault();

		/* check if the button was disabled */
		if($(this).hasClass('disable') || $(this).hasClass('disabled') || $(this).prop('disabled')){
			console.log('line 276');
			return;
		}

		camCheckDone = true;
		$('.check_modal_btn').addClass('disabled');
		$('.check_modal_btn').css('pointer-events', 'none');
		/* spinner show*/
		$('#btn_check_modal-device_camera .label-processing').show();


		
		/* set scope */
		var scope = $(this).closest('.check_item');
		var btn_check = $(this);
		
		// set camera constraints
		// check only the audio
		connectEnvModal.cameraConstraints = {
			audio : true,
			video : true
		};
		
		/** check camera **/
		connectEnvModal.initializeCamera(
			/** on success **/
			function(){
				console.log('onSuccess')
				setTimeout(function(){
					var localMediaStream = connectEnvModal.cameraStream;
					eventStudentTest
						.media
						.camera = 1;

					if(!camCheckDone) {
						return;
					}

					$('#btn_check_modal-device_camera .label-processing ').hide();
					$('.check-ok', scope).show();
					btn_check.hide();

					// enable next button
					$('.btn_check', scope.next()).css('pointer-events', 'auto');
					$('.btn_check', scope.next()).removeClass('disabled');

					camCheckDone = false;
					camera = 1;
					
					// saveModalResult();
				}, 500);
			},
			/* or error */
			function(){
				console.log('im here error')
				setTimeout(function(){
					/** failed to connect to camera **/
					eventStudentTest
						.media
						.camera = 0;

					showError(scope, ['media_connection']);
					
					// saveModalResult();
				}, 500);
			}
		);
	});

	/*------------------------------------*/
	/* btn check manual
	/*------------------------------------*/
	$('#dialog_environment .btn_modal-check-manual').on('click', function(e){
		e.preventDefault();

		var btn_check 		= $(this);
		var scope 			= btn_check.closest('.check_item');
		let isSpeedTestButton = ($(this).attr('id') == 'btn_check_modal-speed_test');
		let enabledModalCamera 	= (typeof eventStudentTest.media.camera != 'undefined' && eventStudentTest.media.camera == 1);
		let isModalMicTestButton = ($(this).attr('id') == 'btn_check_modal-manual_mic' && typeof iceServerRemotePeerStream != 'undefined' && iceServerRemotePeerStream === null);

		

		if(btn_check.hasClass('disable') || btn_check.hasClass('disabled') || btn_check.prop('disabled')){
			return;
		}

		// - clear stream timeout
		clearTimeout(timeoutStreamChecker);

		// - clear sound meter
		if ( typeof (SoundMeterModal) !== 'undefined' ) {
			SoundMeterModal.stop();
		}

		if ( isSpeedTestButton ) {
			btn_check.addClass('disabled');
			btn_check.css('pointer-events', 'none');

			$('.user_modal_manual_check', scope).fadeIn(200);

			
			
		}  else if ( isModalMicTestButton ) {
			var $env_check_modal = $('.cf.env_check_modal[id]');
			micCheckDone = true;

			if($env_check_modal.length == 0) {
				$('.cf.env_check_modal').attr('id', 'volumeModalCvs');
			}
			$('.cf.env_check').removeAttr('id');

			/* spinner show*/
			$('#btn_check_modal-manual_mic .label-processing').show();
			btn_check.addClass('disabled');
			btn_check.css('pointer-events', 'none');

			micModalButtonProp();
			if ( enabledModalCamera ) {
				initializeWebRtcTestConnection('envModal');
			} else {
				connectEnvModal.cameraConstraints = {
					audio : true,
					video : false
				};
				connectEnvModal.initializeCamera(
					function(){initializeWebRtcTestConnection()},
					function(){ micModalButtonProp(2) }
				);
			}

			return;
			
		} else if (
			$(this).attr('id') == 'btn_check_modal-manual_video'
			&& typeof iceServerRemotePeerStream != 'undefined'
			&& iceServerRemotePeerStream !== null
		) {
			let video = $('#ownVideo-test')[0];
			video.srcObject = (iceServerRemotePeerStream);
			video.play();
			console.warn("[" + (new Date().toLocaleString()) + "] CAMERA/VIDEO TEST - START");

			// - start timeout
			triggerStreamTimeout();
		}

		console.log('line 419');

		btn_check.addClass('disabled');
		btn_check.css('pointer-events', 'none');
		$('.user_modal_manual_check', scope).fadeIn(200);
		return;		
	});
		
	/*------------------------------------*/
	/* user manual check
	/*------------------------------------*/
	$('.user_modal_manual_check :radio').on('change', function(e){
		e.preventDefault();
		var scope = $(this).closest('.check_item');

		if($(this).val() == 1){
			console.log('linehere442')
			// case check success
			$('.btn_check', scope).hide();
			$('.check_result', scope).fadeOut(200);
			$('.user_modal_manual_check', scope).slideUp(600, function(){
				$('.check-ok', scope).fadeIn(200);
			});
			// enable next button
			$('.btn_check', scope.next()).css('pointer-events', 'auto');
			$('.btn_check', scope.next()).removeClass('disabled');
			
			//-- save connection test
			// if ( $(this).attr('id') == "radio_modal_testing_video_1" ) {
			// 	saveModalResult();
			// }
		}else{
			// case check error
			$('.btn_check', scope).fadeIn(200);
			$('.check-ok', scope).hide();
			$('.check_result', scope).fadeIn(200);
		}

		//-- stop active audio/s
		if (
			$(this).attr('name') == "radio_modal_testing_mic"
			&& $(this).attr('id') == "radio_modal_testing_mic_1"
			&& typeof micTestAudioOuput.readyState != 'undefined'
			&& typeof (SoundMeterModal) !== 'undefined'
		) {
			micTestAudioOuput.pause();
			SoundMeterModal.stop();
			console.warn("[" + (new Date().toLocaleString()) + "] AUDIO TEST - STOP");
		}
	});
	
	/*------------------------------------*/
	/* btn test video
	/*------------------------------------*/
	$('#btn_test_video').on('click', function(e){
		e.preventDefault();
		if($(this).hasClass('on')){
			pauseTestVideo();
		}else{
			playTestVideo();
		}
	});

	$('#othersVideo-test').on('ended', function(){
		resetTestVideo();
	});
});

function browserAndDeviceError(btn_check, scope, error) {
	// case check error
	if (error.browser || error.device) {
		btn_check.addClass('disabled');
		btn_check.css('pointer-events', 'none');
		$('.label', scope).hide();
		$('.label-default', scope).show();
		$('.check_result', scope).show();
		$('.check_result', scope).find('.browser_error').css('display', (error.browser)?'block':'none');
		$('.check_result', scope).find('.device_error').css('display', (error.device)?'block':'none')
		// saveModalResult();
	} else {
		// case check success
		btn_check.hide();
		$('.check-ok', scope).fadeIn(200);
		
		// enable next button
		$('.btn_check', scope.next()).css('pointer-events', 'auto');
		$('.btn_check', scope.next()).removeClass('disabled');
		// saveModalResult();
	}
	browserCheck = true;
}

//-- actType:
//-- 0 - default 1 min. force save result
//-- 1 - webrtc connection success
//-- 2 - webrtc connection fail
function micModalButtonProp(actType = 0) {
	let btnCheck = $('#btn_check_modal-manual_mic');
	let scope = btnCheck.closest('.check_item');
	clearTimeout(iceServerResultTimeOut);

	console.log('micModalButtonProp' + actType)

	if ( actType == 0 ) {
		//-- force save result if connection failed
		iceServerResultTimeOut = setTimeout(function(){
			micModalButtonProp(1);
			connectionFailed = true;
			console.log('imForceTosave')

			return;
		}, 15000); //-- 15 sec max waiting time 

	} else if ( actType === 1) {
		console.log('testsetset - ', scope);

		if(!micCheckDone) {
			turnOffModalCameraAndAudio();

			return;
		}
		$('.user_modal_manual_check', scope).fadeIn(200);
		$('.btn_check .label', scope).hide();
		$('.btn_check .label-default', scope).show();
		/* spinner hide*/
		$('#btn_check_modal-manual_mic .label-processing').hide();

		micCheckDone = false;
		
		if (
			typeof iceServerRemotePeerStream != 'undefined'
			&& iceServerRemotePeerStream !== null
		) {
			connectionFailed = false;
			/* get audio tracks */
			var audioTracks = iceServerRemotePeerStream.getAudioTracks();
			if (typeof (SoundMeterModal) !== 'undefined' && audioTracks.length > 0) {
				SoundMeterModal.play(iceServerRemotePeerStream);
				eventStudentTest.media.microphone = 1;

				//-- Play audio
				if ( typeof micTestAudioOuput != 'undefined') {
					micTestAudioOuput.srcObject = iceServerRemotePeerStream;
					micTestAudioOuput.volume = 1;
					micTestAudioOuput.play();
					console.warn("[" + (new Date().toLocaleString()) + "] AUDIO TEST - START");
				}

				// - start timeout
				triggerStreamTimeout();
			}
		}
		
	} else if ( actType === 2 ) {
		$('.user_modal_manual_check', scope).fadeIn(200);
		$('.btn_check .label', scope).hide();
		$('.btn_check .label-default', scope).show();
		showError(scope, ['media_connection']);
	}
}

/*------------------------------------*/
/* Check radio button
/*------------------------------------*/
$("#dialog_environment input[type=radio]").click(function(){
	console.log('inputWasClicked')
	$($(this)).each(function () {
		// sList += "(" + $(this).val() + "-" + (this.checked ? "checked" : "not checked") + ")";		
		var name = $(this)[0].name;

		// console.log(name);
		if(name == 'radio_modal_testing_speed_test' && $(this).val() == 1) {
			internet_speed = 1;
		}
		if(name == 'radio_modal_testing_mic' && $(this).val() == 1) {
			microphone = 1;
		}
		if(name == 'radio_modal_testing_video' && $(this).val() == 1) {
			screen_test = 1;
			saveModalResult('saveResults');

			doneTestAll = true;
		}
	});
	// saveModalResult();
});

/*------------------------------------*/
/* show error messages
/*------------------------------------*/
function showError(scope, srcs){
	$('.label', scope).hide();
	$('.label-default', scope).show();
	$('.check_result', scope).show();
	$('.btn_check', scope).addClass('disabled');
	$('.btn_check', scope).css('pointer-events', 'none');
	
	/* check if array is empty */
	if (typeof srcs === 'undefined') { return; }
	
	/* loop through array and show */
	for(var src in srcs){
		$("." + srcs[src] + "_error").fadeIn();
	}

	/* end timeouts and intervals */
	clearTimeout(eventStudentTest.timeout);
}

/*------------------------------------*/
/* Reset Environment Check
/*------------------------------------*/
function resetModalEnvironemntCheck(event){
	$('#dialog_environment .check-ok').hide();
	$('#dialog_environment .user_modal_manual_check').hide();
	$('#dialog_environment .check_result').hide();
	$('#dialog_environment .check_modal_btn').show();
	$('#dialog_environment .check_modal_btn').addClass('disabled');
	$('#dialog_environment .check_modal_btn').css('pointer-events', 'none');
	$('#dialog_environment .environment-modal-check-all-done').addClass('hide');
	$('#btn_check_modal-system_browser').css('pointer-events', 'auto');
	$('#btn_check_modal-system_browser').removeClass('disabled');

	//reset radio buttons
	$('input[name="radio_modal_testing_speed_test"]').attr('checked', false);
	$('input[name="radio_modal_testing_mic"]').attr('checked', false);
	$('input[name="radio_modal_testing_video"]').attr('checked', false);

	$('#dialog_environment .environment_item .label-processing').hide();

	if(camCheckDone) {
		camCheckDone = false;
		setTimeout(() => {
			console.log('cam check done true!')
			turnOffModalCameraAndAudio();
		}, 1000);
	} else if(micCheckDone) {
		micCheckDone = false;
		console.log('cam check done else if!')
	} else {
		console.log('check done false!')
		turnOffModalCameraAndAudio();
	}

	console.log('event: ', event);
	console.log('event: ', browserCheck);
	console.log('event: ', doneTestAll);

	if(event == 'triggerBtn') {
		doneTestAll = false;
	}

	if(browserCheck){
		browserCheck = false;
		saveModalResult();
	} else if(event == 'closeModal' && event != 'triggerBtn' && !browserCheck && !doneTestAll){
		doneTestAll = false;
		// browserCheck = false;
		saveModalResult('closeWithoutTest');
	} 

	console.log('Modal rest waas click');
}

function turnOffModalCameraAndAudio(){
	// set ice servers from PHP
	iceServerRemotePeerStream = null;
	iceServerResultTimeOut = null;

	// -- turn off for skyway
	micTestAudioOuput.pause();
	SoundMeterModal.stop();

	// // -- turn off audio and camera stream
	connectEnvModal.turnOFFCamera();
	
	setTimeout(function(){
		// - clear the stream source
		$(".ownVideo-test").attr("src", "");

		// - clear timeout
		clearTimeout(timeoutStreamChecker);	
	}, 1000);
}

/**
this method will be triggered after 30 seconds
*/
function triggerStreamTimeout () {
	timeoutStreamChecker = setTimeout(function(){
		// - reset call handler
		if (streamCheckerCallHandler == false) {
			return;
		}

		// - close active stream
		streamCheckerCallHandler.close();

		// - clear the stream source
		$(".ownVideo-test").attr("src", "");

		// - clear timeout
		clearTimeout(timeoutStreamChecker);
	}, 30000);
}


/*------------------------------------*/
/* play test video
/*------------------------------------*/
function playTestVideo(){
	$('#othersVideo-test')[0].play();
	$('#btn_test_video').addClass('on');
}

/*------------------------------------*/
/* pause test video
/*------------------------------------*/
function pauseTestVideo(){
	$('#othersVideo-test')[0].pause();
	$('#btn_test_video').removeClass('on');
}

/*------------------------------------*/
/* reset test video
/*------------------------------------*/
function resetTestVideo(){
	$('#othersVideo-test')[0].pause();
	$('#othersVideo-test')[0].currentTime = 0
	$('#btn_test_video').removeClass('on');
}


/*------------------------------------*/
/* save to connect testing logs
/*------------------------------------*/
function saveModalResult(event){
	console.log('This is save modal');

	media = eventStudentTest.media;
	browser = eventStudentTest.supportedBrowser(navigator.userAgent);
	microphone = media.microphone ? microphone : 0;
	
	websocket = 1;
	peerConnection = typeof connectEnvModal.isConnected !== 'undefined' ? connectEnvModal.isConnected : 0;
	myOS = eventStudentTest.getClientOS();
	user_agent = navigator.userAgent;
	ipAdd = connectEnvModal.config.ipAdd;

	console.log('line3817: ', event);

	if(event == 'closeWithoutTest') {
		browser = 2;
		internet_speed = 2;
		camera = 2;
		microphone = 2;
		screen_test = 2;
		websocket = 2;
		peerConnection = 2;

		event = '';
	}

	console.log('browser: ', browser);
	console.log('internet_speed: ', internet_speed);
	console.log('camera: ', camera);
	console.log('microphone: ', microphone);
	console.log('screen: ', screen_test);
	console.log('websocket: ', websocket);
	console.log('peerConnection: ', peerConnection);

	var data = {
		'userID' : connectEnvModal.config.userID,
		'browser' : browser,
		'internet_speed' : internet_speed,
		'camera' : camera,
		'microphone' : microphone,
		'screen' : screen_test,
		'websocket' : websocket,
		'peer' : peerConnection,
		'os' : myOS,
		'user_agent' : user_agent,
		'ipAdd' : ipAdd
	}

	console.log('data: ', data)

	$.post('/teacher/device-settings/register-connect', data);

	if(screen_test) {
		$('.environment-modal-check-all-done').removeClass('hide');
		turnOffModalCameraAndAudio();
	}

	user_agent = 0, media = 0, myOS = 0, 
	peerConnection = 0, browser = 0, internet_speed = 0,
	camera = 0, microphone = 0, screen_test = 0, ipAdd = 0, browserCheck = false, doneTestAll = false;
}

</script>

<!-- completed all steps -->
<a class="hide" rel="modal" href="#dialog_completed_steps" id="trigger_modal_completed_steps"></a>
<div class="modal_window dialog dialog_completed_steps hide static_overlay" id="dialog_completed_steps" style="max-width: 800px">
	<div class="modal_inner sec complete">
		<div class="content">
			<div class="word">
				<p class="ttl">All steps have been completed</p>
				<p class="desc">You are almost there to be one of our tutors and can start to have lessons.</p>
			</div>
			<div class="sec t_left m_b_30">
				<p>All steps have been completed. <br> Admin staff is currently reviewing your profile. <br> It may take up to 48 hours to verify your profile. <br> We will inform you about the completion of your profile verification on this page. <br> While your profile is being reviewed, please start studying on the “Self-Study” page.</p>
			</div>
			<hr>
			<div class="action m_t_30">
				<button type="submit" class="button p_l_50 p_r_50" ng-click="completeContractProceed()">OK</button>
			</div>
			<div class="ui_notice_list listmark_2 bg_gray">
				<ul>
					<li>A message will be sent to the email address you have registered once your profile has been approved by the admin staff.</li>
				</ul>
			</div>
		</div>
		<div class="btn-close btn_close" style="display: none"></div>
	</div>
</div>

<!-- recruit congratulation modal -->
<a class="hide" rel="modal" href="#dialog_recruit_complete" id="trigger_modal_recruit_complete"></a>
<div class="modal_window dialog dialog_recruit_complete hide static_overlay no-border" id="dialog_recruit_complete" style="max-width: 800px">
	<div class="modal_inner sec complete">
		<div class="content">
			<div class="word">
				<p class="ttl">Congratulations!</p>
			</div>
			<div class="sec t_left m_b_30">
				<p class="desc m_b_15">You have just become a part of the Native Camp Community! <br> We would like to welcome you and show you the details of your account.</p>
				<p class="desc">Please open the slots and take a first lesson!</p>
				<img src="/teacher/recruits/images/common/congrats.svg" class="m_b_30 m_t_30">
			</div>
			<div class="action m_t_30 t_center">
				<button type="submit" class="button p_t_10 p_b_10" ng-click="reserveSlots()">Open your slots</button>
			</div>
		</div>
		<div class="btn-close btn_close" style="display: none"></div>
	</div>
</div>

<!-- recruit book slot -->
<a class="hide" rel="modal" href="#dialog_book_slot" id="trigger_modal_book_slot"></a>
<div class="modal_window dialog dialog_book_slot hide static_overlay no-border" id="dialog_book_slot" style="max-width: 800px">
	<div class="modal_inner sec">
		<div class="content t_center">
			<div class="word">
				<p class="ttl fs_22 m_b_30"><strong>Students can now book your slots!</strong></p>
				<p class="desc">Let’s do the environment check now.</p>
			</div>
			<div class="action m_t_30 t_center">
				<button class="button p_l_20 p_r_20" ng-click="bookSlot()">Go through the environment check</button>
			</div>
		</div>
		<div class="btn-close btn_close" style="display: none"></div>
	</div>
</div>

<!-- recruit book slot complete -->
<a class="hide" rel="modal" href="#dialog_book_complete" id="trigger_modal_book_complete"></a>
<div class="modal_window dialog dialog_book_complete hide static_overlay no-border" id="dialog_book_complete" style="max-width: 800px">
	<div class="modal_inner sec">
		<div class="content t_center">
			<div class="word">
				<p class="ttl fs_22 m_b_30"><strong>Your lesson is booked!</strong></p>
				<p class="desc">Let’s Standby and wait for your student to enter the room.</p>
			</div>
			<div class="action m_t_30 t_center">
				<button class="button p_l_20 p_r_20" ng-click="bookComplete()">Go on Standby</button>
			</div>
		</div>
		<div class="btn-close btn_close" style="display: none"></div>
	</div>
</div>

<!-- Recruit Take a photo Modal : START -->
<a class="hide" rel="modal" href="#dialog_photo_tips_modal2" id="trigger_dialog_photo_tips_modal2"></a>
<div class="modal_window dialog modal_account_info_tips hide allow-scroll" id="dialog_photo_tips_modal2">
	<div class="modal_inner">
		<div class="word">
			<p class="ttl">Photo Tips</p>
			<p class="desc">Please upload a photo with the following references.</p>
			<div class="text">
				<p>In order to have an adequate profile photo and to attract more <br>
				students with your professional profile, we are offering the manual for <br>
				a program that you can use to improve your photo.</p>
				<p><span>*</span>Having a good profile picture is very important since it’s one of the <br>
				reasons students decide to take your lessons by the picture as well as <br>
				your Self-introduction video.</p>
			</div>
		</div>
		<div class="tips">
			<div class="method">
				<div class="ttl">Remove your background:</div>
				<div class="link"><a href="https://www.remove.bg/" target="_blank">https://www.remove.bg/</a></div>
				<div class="image"><img src="https://nativecamp.net/assets/recruit/images/account_info/tips.png" alt=""></div>
			</div>
		</div>
		<div class="guide">
			<div class="ttl">This is a short guide on how you should improve your photo:</div>
			<ul class="guide_list">
				<li class="list-item check">Look at the camera directly</li>
				<li class="list-item check">Posture should be similar to the one you submit for the ID document</li>
				<li class="list-item check">Have a white background (download White background from the link above)</li>
				<li class="list-item check">Please wear appropriate and plain colored clothes</li>
				<li class="list-item check">Smile and be positive</li>
				<li class="list-item ng">Do not wear white clothes</li>
				<li class="list-item ng">Do not wear any accessories on your head or above your neck</li>
				<li class="list-item ng">Do not wear a headset or earphones</li>
				<li class="list-item ng">No hand gestures</li>
			</ul>
			<div class="text">
				<p><strong>Note: </strong>If you have sent a picture that is not suitable for the Profile <br> 
					photo, we won't accept it and you will have to upload a new one. <br> 
					Please check the best example profile pictures below:</p>
			</div>
		</div>
		<div class="ex_wrap">
			<div class="image"><img src="/assets/recruit/images/account_info/example.png" alt=""></div>
		</div>
		<div class="action">
			<label class="button m_r_20" for="post_teacher_img">
			<div class="input file"><input type="file" name="data[image]" id="post_teacher_img" style="opacity:0;"></div>Upload</label>
			<label for="take_photo_record" class="button">Take a photo</label>
		</div>
	</div>
	<div class="btn_close" id="closePopupUploadImage"></div>
</div>
<!-- Recruit Take a photo Modal : END -->

<!-- Recruit Take a video Modal : START -->
<a class="hide" rel="modal" href="#dialog_movie_tips" id="trigger_dialog_movie_tips"></a>
<div class="modal_window dialog modal_account_info_tips hide allow-scroll" id="dialog_movie_tips">
	<div class="modal_inner has-custom-li">
		<div class="word_wrap">
			<p class="main_word c_green m_b_40 fs_30 font-700">Let's take a introduction video</p>
			<p class="t_left lh_17 fs_18 m_auto">Introduction videos are probably the most important part of a tutor's profile page. Appeal to your students using your personality, skills and professionalism. We recommend that you create a video with a message that is straight to the point, clear, and brief instead of being elaborate.</p>
		</div>
		
		<div class="video_wrap t_center m_t_50 m_b_35">
			<p class="c_green m_b_15 lh_10 fs_25 fw_b">Good Examples</p>
			<iframe width="600" height="338" name="demo_lesson" src="https://www.youtube.com/embed/NETf4mpOMNQ?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen=""></iframe>
		</div>
		
		<div class="sub_sec sub_sec_2 t_left">
			<div class="word_wrap m_t_30 m_b_20">
				<p class="main_word c_green m_b_25 fs_25">Recommended format</p>
			</div>
			<p class="desc_ttl fs_25">Length</p>
			<div class="desc_inner">
				<ul>
					<li>20 - 60 seconds.</li>
				</ul>
			</div>
			
			<p class="desc_ttl fs_25">Style</p>
			<div class="desc_inner">
				<ul>
					<li>Keep it <span class="c_red">simple</span>, <span class="c_red">concise</span>, and <span class="c_red">personal</span>.</li>
				</ul>
			</div>
			
			<p class="desc_ttl fs_25">Setting</p>
			<div class="desc_inner">
				<ul>
					<li>Make sure you have <span class="c_red">excellent lighting</span> for your video. Avoid dark rooms and shadowy areas.</li>
					<li>Use a room with a nice, comfortable environment (e.g., no dirty laundry in the background). If possible, record before a solid-colored wall or background. The fewer sources of distractions you have in the background, the better the student can focus on you.</li>
				</ul>
			</div>
			
			<p class="desc_ttl fs_25">Smile</p>
			<div class="desc_inner">
				<ul>
					<li>Show a <span class="c_red">happy</span>, lively attitude and <span class="c_red">smile</span> when you film your video.</li>
				</ul>
			</div>
			
			<p class="desc_ttl fs_25">Quality</p>
			<div class="desc_inner">
				<ul>
					<li>
						Make sure both <span class="c_red">audio</span> and <span class="c_red">video</span> are of <span class="c_red">high quality</span>. If you don't have a good webcam/microphone, buy them (there are very affordable ones online). You'll need them for your teaching sessions in any case.
					</li>
				</ul>
			</div>
			<div class="btn_wrap btn_center m_b_40">
				<ul class="not-included-li">
					<li class="recordVideo">
						<a class="btn_style btn_orange btn_bigger" id="recordedVideo" href="javascript:void(0);">Upload Video</a>
					</li>
					<li>
						<a class="btn_style btn_green btn_bigger" id="close-modal">Close</a>
					</li>
				</ul>
			</div>
		</div>
	</div>
	<div class="btn_close" id="closePopupUploadImage"></div>
</div>
<!-- Recruit Take a video Modal : END -->

<!-- Recruit Take a video Photo (Image Crop) : START -->
<a rel="modal" href="#dialog_image_crop" id="trigger_dialog_image_crop"></a>
<div class="modal_window dialog modal_account_info_tips hide allow-scroll" id="dialog_image_crop">
	<div class="modal_inner">
		<form name="thumbnail" action="" method="post" class="ng-pristine ng-valid">
			<div class="word" id="instruction_crop">
				<div class="ttl">To crop your selected image, <br>
				click and drop a portion within the container</div>
			</div>
			<center>
				<img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" id="profile_img" alt="Crop Image">
			</center>
			<input type="hidden" name="x1" value="" id="x1">
			<input type="hidden" name="y1" value="" id="y1">
			<input type="hidden" name="x2" value="" id="x2">
			<input type="hidden" name="y2" value="" id="y2">
			<input type="hidden" name="w" value="" id="w">
			<input type="hidden" name="h" value="" id="h">
			<div class="action">
				<button type="button" id="btn-submit-profile" class="button">Upload</button>			</div>
		</form>
	</div>
	<div class="btn_close" id="button_close" style="background: url('/user/images/icon/modal_close.png');"></div>
</div>
<!-- Recruit Take a video Photo (Image Crop) : END -->
<!-- NJ-16417 START -->
<a class="hide" rel="modal" href="#dialog_tutor_incentives" id="trigger_modal_tutor_incentives"></a>
<div class="modal-window dialog hide static_overlay dialog_tutor_incentives" id="dialog_tutor_incentives">
	<div class="dialog_tutor_incentives_inner">
		<div class="modal_inner">
			<p>※1 Unit: NCC</p>
			<table id="dialog_tutor_incentives-table"></table>
		</div>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<!-- NJ-16417 END -->

<!-- NJ-24899 open slot notice modal START -->
<a class="hide" rel="modal" href="#open_slot_notice" id="trigger_open_slot_notice"></a>
<div class="modal_window dialog no-border hide dialog_open_slot_notice" id="open_slot_notice">
	<div class="modal-inner">
		<p class="modal-title">About slots after system maintenance</p>
	</div>
		<div class="t_center m_t_15 m_b_15">
			<p class="fs_16 m_b_10">To prevent cancellations, the 3 slots after system maintenance will be <br> automatically closed if there are no booked lessons.</p>
			<div class="slot-img-holder">
				<img src="/teacher/images/modal/slots-img.png" alt="">
				<div class="red-box"></div>
			</div>
			<p class="fs_12">*System maintenance will take place on Mondays from 2:00 AM to 6:00 AM, Japan Standard Time (UTC+9)</p>
			<p class="m_t_10 fs_16">If you would like to conduct lessons during the specified time, please go to the schedule page and reopen the slot.</p>
		</div>
		<div class="btn_wrap t_center">
			<a class="btn_style btn_orange" ng-click="closeNotice()" style="cursor: hand;cursor: pointer;" id="closeNotice">Open schedule page</a>
		</div>
		<div class="hide btn_close btn-close" style="display: none"></div>
	</div>

<!-- NJ-24899 open slot notice modal END -->
<!-- NJ-20902 enable face recognition for Avatar Teachers modal START -->
<a class="hide" rel="modal" href="#enable_face_recognition" id="trigger_enable_face_recognition"></a>
<div class="modal_window dialog no-border hide dialog_enable_face_recognition" id="enable_face_recognition">
		<div>
			<p>Is your Animaze virtual camera turned off？<br> Please return to your camera setting to Animaze. </p>
			<p class="m_t_30">You can confirm the setting at the following path.<br> chrome://settings/content/camera</p>
		</div>
		<p class="t_center m_t_30">
			<img src="/teacher/images/modal/chrome_cam_setting.png" alt="">
		</p>
	<div class="btn-close btn_close"></div>
</div>
<!-- NJ-20902 enable face recognition for Avatar Teachers modal END -->

<!-- NJ-29495 Start -->
<!-- NJ-29495 End -->

<!-- NJ-27808 -->
<a class="hide" rel="modal" href="#modal_req_off_virtualbg_teacher" id="trigger_modal_req_off_virtualbg_teacher"></a>
<div class="modal-backdrop" id="modal-backdrop" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1000; display: none;"></div>
<div class="modal_window dialog no-border hide dialog_req_off_virtualbg_teacher" id="modal_req_off_virtualbg_teacher">
	<div class="modal-inner new-badge-modal-inner">
		<div class="new-badge-title-container">
				<p class="fs_22 m_b_30 t_color_orange">Detected High Load on Your Machine</p>
				<p class="fs_20 t_color_gray">Disabling virtual background may help to improve this.</p>
		</div>
		<div class="btn_wrap new_badge_btn_wrap t_center">
			<a class="btn_style btn_orange new-badge-btn close_modal m_t_10" href="javascript:void(0)" id="disable-vbg">Disable</a>
		</div>
		<a class="btn_close_simple" href="javascript:void(0)"></a>
	</div>
</div>
<!-- <<< -->
<!-- NJ-31002 start -->
<a class="hide" rel="modal" href="#request_setting_modal" id="trigger_modal_request_setting"></a>
<div class="modal-window dialog hide" id="request_setting_modal">
	<strong class="t_center">On the day or weekly request settings</strong>
	<p class="t_center question">On the day or every Friday for one day can be set.</p>
	<div class="btn-wrap btn-center request_setting_btn">
		<a class="nc-t-btn nc-t-btn-light-blue-o close_modal select-day-only">Only on the day</a>
		<a class="nc-t-btn nc-t-btn-light-blue ml_20 close_modal select-weekly">Every Friday</a>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<!-- NJ-31002 end -->
<!-- NJ-29015 topic generation error START -->
<a class="hide" rel="modal" href="#topic_generation_error" id="trigger_topic_generation_error"></a>
<div class="modal_window dialog no-border hide dialog_topic_generation_error" id="topic_generation_error">
		<div>
			<p>An exception has occurred.</p>
			<p>Generate again.</p>
			<a href="javascript:void(0)" class="close_modal">OK</a>
		</div>
</div>
<!-- NJ-29015 topic generation error modal END -->

<!-- update_workshift_denied  -->
<a class="hide" rel="modal" href="#textbook_callan_failed" id="trigger_textbook_callan_failed"></a>
<div class="modal-window dialog hide textbook_callan_failed static_overlay p_b_40" id="textbook_callan_failed">
	<h3>Unable to load Textbook!</h3>
	<p class="m_t_30 t_center">Please refresh the page.</p>
	<div class="btn_wrap btn_center cf m_t_30">
		<ul>
			<li><button class="btn_style btn_gray" onclick="window.location.reload();">REFRESH PAGE</button></li>
		</ul>
	</div>
</div>
<!-- <<< -->

<!-- NJ-15261 google calendar unlink modal START -->
<a class="hide" rel="modal" href="#disabled_google_calendar_synch" id="trigger_modal_disabled_google_calendar_synch"></a>
<div class="modal_window dialog no-border hide disabled_google_calendar_synch static_overlay" id="disabled_google_calendar_synch">
	<div class="modal-inner">
		<div class="t_center">
			<img src="/user/images/loader.gif" alt="">
		</div>
		<div class="hide btn_close btn-close" style="display: none"></div>
	</div>
</div>
<!-- NJ-15261 google calendar unlink modal END -->

<!-- modal lesson completed >>>  -->
<!-- <a class="hide" id="trigger_modal_lesson_completed" rel="modal" href="#dialog_lesson_completed"></a>
<div class="modal-window dialog hide static_overlay dialog_lesson_completed" id="dialog_lesson_completed">
	<h3 class="lh_15 fs_22">Lesson Completed</h3>
	<img src="/teacher/images/modal/lesson_completed/modal_lesson_completed.png" alt="teddy" style="width: 100px;">
	<div class="main_text_wrap t_center">
		<p class="d_i_block t_left fs_20">The lesson has been completed.</p>
	</div>
	<div class="btn_wrap btn_center m_t_40 cf">
		<ul>
			<li><a href="javascript:void(0)"><button type="submit" class="btn_style btn_orange close_modal" id="notice_complete">OK</button></a></li>
		</ul>
	</div>
</div> -->
<!-- <<< -->

<!-- NJ-20590 START -->
<a class="hide" rel="modal" href="#dialog_beauty_camera_tips" id="trigger_beauty_camera_tips"></a>
<div class="modal_window dialog modal_beauty_camera_tips hide" id="dialog_beauty_camera_tips">
	<div class="modal_inner">
		<p class="modal-ttl">When taking your photo and video<br>
			please use the NC Beauty Camera.</p>
		<div class="tips">
			<div class="tips-ttl">
				<div class="num">1</div>
				<div class="text">Download</div>
			</div>
			<div class="cont">
				<p>Download the NC Beauty Camera by clicking the download button below.</p>
				<div class="btn-wrap">
					<a href="javascript:void(0);" class="btn-dl">Download</a>
				</div>
			</div>
		</div>
		<div class="tips">
			<div class="tips-ttl">
				<div class="num">2</div>
				<div class="text">Install</div>
			</div>
			<div class="cont">
				<p>When the NC Beauty Camera is downloaded and the file is executed the message <b>“Windows protected your PC”</b> will appear.</p>
				<p>Select <b>“More info”</b></p>
				<p>Click <b>“Run anyway”</b></p>
				<p>Wait for <b>“Select Destination Location”</b> to appear, then click <b>“Next”</b></p>
				<p>After <b>“Select Additional Tasks”</b> appears, check the box next to <b>“Create a Desktop shortcut”</b> and click <b>“Next”</b></p>
				<p>When <b>“Ready to Install”</b> appears, click <b>“Install”</b></p>
				<p>When the message <b>“Completing the NC Beauty Camera Setup Wizard”</b> shows, click the <b>“Finish”</b> button</p>
				<p>Click <b>“OK”</b> when the notice <b>“Virtual Camera Installation”</b> appears (Check <b>“Launch NC Beauty Camera”</b>)</p>
			</div>
		</div>
		<div class="tips">
			<div class="tips-ttl">
				<div class="num">3</div>
				<div class="text">Start up</div>
			</div>
			<div class="cont">
				<p>When you launch the downloaded file, a pop-up window will appear.</p>
				<p>Put in your Native Camp login information <b>(email and password)</b>.</p>
				<p>Click on the “Sign in” button.</p>
				<p>Now you can set your preferable filters and application sensitivity.</p>
				<p>Close other apps that might be using your camera, then restart NC Beauty Camera.</p>
			</div>
		</div>
		<div class="tips">
			<div class="tips-ttl">
				<div class="num">4</div>
				<div class="text">Set up</div>
			</div>
			<div class="cont">
				<p>Go to the browser Settings</p>
				<p>Click on the option Privacy and security</p>
				<p>Click on the option Site Settings</p>
				<p>Click on the section Camera</p>
				<p>Change the camera in the dropdown menu to NC Video Capture</p>
			</div>
		</div>
		<div class="btm-btn-wrap">
			<a href="javascript:void(0);" class="btn-next btn-for-videos" id="btn-beauty-camera-tips">to the next</a>
			<a href="javascript:void(0);" class="close_modal hidden" id="beauty_tips_close">close</a>
		</div>
	</div>
	<div class="btn_close"></div>
</div>
<!-- NJ-20590 END -->


<!-- NJ-15759 start -->
<a rel="modal" href="#dialog_modal_member_withdraw" id="trigger_modal_member_withdraw"></a>
<div class="modal-window dialog dialog_modal_member_withdraw hide" id="dialog_modal_member_withdraw">
	<h3>※退会ページから遷移された会員様です※</h3>
	<p class="t_center">時間がない、忙しい、続かないことへのアドバイスや<br>退会検討理由をお伺いして、サポートをお願いします。</p>
	<div class="modal_sec_center">
		<p class="fs_15 m_t_15 c_dgray">会員種別</p>
		<p class="fs_18">プレミアムプラン ( 有料 )</p>
		<p class="fs_15 m_t_15 c_dgray">総レッスン回数</p>
		<p class="fs_18">15回</p>
	</div>
	<div class="btn-wrap btn-center m-t-30">
		<a class="nc-t-btn nc-t-btn-orange close_modal" href="javascript:void(0)">OK</a>
	</div>
</div>
<!-- NJ-15759 end -->

<!-- NJ-44869 -->
 <!-- disconnection_occured -->
 <a class="hide" rel="modal" href="#disconnection_occured" id="trigger_modal_disconnection_occured"></a>
<div class="modal_window dialog hide dialog_disconnection_occured static_overlay" id="disconnection_occured">
	<h3 class="fs_24 m_b_0">A disconnection has occured</h3>
	<img src="/teacher/images/class/disconnection_occured_teddy.svg?v=" alt="Disconnection Occured" class="disconnection_occured_img m_t_30">
	<p class="m_t_30 t_center fs_16">You lost your network connection.</p>
	<div class="btn_wrap btn_center cf m_t_25">
		<ul>
			<li><button class="btn_style btn_green disconnection_occured_btn close_modal">OK</button></li>
		</ul>
	</div>
	<div class="btn_close"></div>
</div>


<!-- disconnection_cancellation -->
<a class="hide" rel="modal" href="#disconnection_cancellation" id="trigger_modal_disconnection_cancellation"></a>
<div class="modal_window dialog hide dialog_disconnection_cancellation static_overlay" id="disconnection_cancellation">
	<h3 class="fs_24 m_b_0">Disconnection Cancellation</h3>
	<img src="/teacher/images/class/disconnection_cancellation_teddy.svg?v=" alt="Disconnection Cancellation" class="disconnection_cancellation_img m_t_30">
	<p class="m_t_30 t_center fs_16">The system was unable to confirm the connection from<br>your side for more than 2 minutes, resulting in the student<br>cancelling the lesson.</p>
	<p class="m_t_30 t_center fs_16">This is a “Disconnection Cancellation” and no incentives will<br>be charged. However, the penalties will not be deducted.</p>
	<p class="m_t_30 t_center fs_16">Please check your connection.</p>
	<div class="btn_wrap btn_center cf m_t_25">
		<ul>
			<li><button class="btn_style btn_green disconnection_cancellation_btn close_modal" onclick="disconnectionCancellationMemCached('delete')">OK</button></li>
		</ul>
	</div>
	<div class="btn_close"></div>
</div>

<!-- lesson_completed >>>  -->
<a class="hide" id="trigger_modal_lesson_completed" rel="modal" href="#dialog_lesson_completed"></a>
<div class="modal_window dialog dialog_lesson_completed hide" id="dialog_lesson_completed">
	<div>
		<p class="fs_24 fw_b">Lesson Completed</p>
		<img src="/teacher/images/class/lesson_completed_teddy.svg?v=" alt="teddy" loading="lazy" class="lesson_completed_img m_t_30">
		<p class="fs_16 m_t_30">The lesson has been completed.</p>
		<div class="m_t_25">
			<button class="btn_style btn_green lesson_completed_btn fs_20 fw_b" data-reload-url="/teacher/chat">OK</button>
		</div>
	</div>
	<div class="btn_close"></div>
</div>
<!-- <<< -->
 <!-- student_left -->
<a class="hide" rel="modal" href="#student_left" id="trigger_modal_student_left"></a>
<div class="modal_window dialog hide dialog_student_left static_overlay" id="student_left">
	<h3 class="fs_24 m_b_0">The student has left</h3>
	<img src="/teacher/images/class/student_left_teddy.svg?v=" alt="Student Left" class="student_left_img m_t_30">
	<p class="m_t_30 t_center fs_16">Please wait for the student</p>
	<div class="btn_wrap btn_center cf m_t_25">
		<ul>
			<li><button class="btn_style btn_green student_left_btn close_modal">OK</button></li>
		</ul>
	</div>
	<div class="btn_close"></div>
</div>
<!-- <<< -->

<!-- NJ-31459 start -->
<a class="hide" rel="modal" href="#apply_perks_for_teachers" id="trigger_apply_perks_for_teachers">Sample Button</a>
<div class="modal-window dialog hide apply_perks_for_teachers p_t_40 p_b_40 t_left" id="apply_perks_for_teachers" style="max-width: 744px; width: 100%;">
	<h3>Apply Perks for teachers</h3>
	<div class="apply_perks_for_teachers-top">
		<p class="m_b_20">Please sign in to your student account and go to User Settings, where you can fill in your email address, ID, and name.</p>
		<p class="m_b_20">Use the link below to access your tutor account : <a href="https://nativecamp.net/login">https://nativecamp.net/login</a></p>
		<p class="m_b_20">Go to User Settings : <a href="https://gyazo.com/0449bc31c21ad8907c8bb12559b7f36e">https://gyazo.com/0449bc31c21ad8907c8bb12559b7f36e</a></p>
		<p>Check your email address, ID, and name.<br><a href="https://gyazo.com/109aff6dcff0e8b2e79088ae3393597f">https://gyazo.com/109aff6dcff0e8b2e79088ae3393597f</a></p>
	</div>
	<div class="m_t_30">
		<label for="apply_perks_acount" class="fs_18 fw_b m_b_15 d_block">What is the email address associated with your member’s account?<span class="m_r_5 m_l_5" style="color: #D93025;">*</span></label>
		<input type="e-mail" id="apply_perks_acount" name="apply_perks_acount" class="fs_18" value="test@nc.jp">
	</div>
	<div class="m_t_30">
		<label for="apply_perks_student_password" class="fs_18 fw_b m_b_15 d_block">What is your member`s account password?</label>
		<input type="password" id="apply_perks_student_password" name="apply_perks_student_password" placeholder="enter text" class="" value="">
	</div>

	<!-- vaildation_1 -->
	<p class="m_t_20 fs_16 mail" style="color: #D93025; display:none;">We cannot find your e-mail address or password. Please check again.</p>

	<!-- validation_2 -->
	<p class="m_t_20 fs_16 password" style="color: #D93025; display:none; word-break: break-word;">The corresponding student account does not meet the required requirements.<br>Please read the explanation of the guidelines and double check your student account information.</p>

	<p class="m_t_20 fs_16 err_msg" style="color: #D93025; display: none; word-break: break-word;"></p>
	<div class="btn_wrap btn_center cf m_t_30">
		<ul>
			<li><button class="btn_style fs_14" id="apply_perks_for_teachers_button">SAVE</button></li>
		</ul>
	</div>
</div>
<script>
	
	$(document).on('click', '#btn_trigger_modal_teacher_perks', function(){
		$("#trigger_apply_perks_for_teachers").click();
	})

	// temporary function for validation
	$(document).ready(function() {
  		$('#apply_perks_for_teachers_button').click(function() {
    		var user_email = $('#apply_perks_acount').val();
    		var user_password = $('#apply_perks_student_password').val();
    		var save_btn = $('#apply_perks_for_teachers_button');

    		if (user_email === '') {
      			$('.apply_perks_for_teachers .mail').css('display', 'block');
    		} else {
      			$('.apply_perks_for_teachers .mail').css('display', 'none');
    		}

    		if (user_password === '') {
      			$('.apply_perks_for_teachers .password').css('display', 'block');
    		} else {
      			$('.apply_perks_for_teachers .password').css('display', 'none');
    		}

    		if(user_email && user_password){
    			$(save_btn).addClass('disabled')
    			$.ajax({
					type: 'POST',
					data:  {
						teacher_id : '',
						user_password : user_password,
						user_email : user_email,
					},
					url: '/teacher/home/applyTeacherPerks',
					success: function(res) {
						var result = JSON.parse(res);
						if(result.error){
							$(save_btn).removeClass('disabled')
							$('.apply_perks_for_teachers .err_msg').css('display', 'block');
							$('.apply_perks_for_teachers .err_msg').text(result.err_msg);

						} else {
							$('.apply_perks_for_teachers .err_msg').css('display', 'none');
							$('.apply_perks_for_teachers .err_msg').text('');
						}
					}
				});
    		}
  		});

		$('#dialog_reason_for_cancellation__translate').click(function() {
			var text = $('#dialog_reason_for_cancellation .dialog-content').html()
			console.log('text', text)
			$(this).hide();
			$.ajax({
				type: 'POST',
				data: {text: text, language: 'en'},
				url: '/teacher/Api/translateText',
				success: function(res){
					if (res !== '') {
						$('#dialog_reason_for_cancellation .dialog-content').html(res);
					} else {
						$(this).show();
					}
				},
				error: function(res) {
					$(this).show();
				}
			});
		});
	});
</script>
<!-- NJ-31459 end -->

<!-- NJ-39316 end -->

<!-- confirm cancel the lesson  -->
<a rel="modal" href="#dialog_confirm_lesson_cancellation" id="trigger_dialog_confirm_lesson_cancellation"></a>
<div class="modal-window dialog static-overlay hide dialog_confirm_lesson_cancellation" id="dialog_confirm_lesson_cancellation">
	<div class="dialog_contents">
		<h3 class="fs-20 fw-b">Are you sure you want to cancel the lesson?</h3>
		<div class="contents_table m_b_40">
			<table>
				<tbody><tr>
					<td>STUDENT</td>
					<td>:</td>
					<td class="student-name-txt-js">Taro Yamada</td>
				</tr>
				<tr>
					<td>LESSON ID</td>
					<td>:</td>
					<td class="lesson-id-txt-js">215X-ROWZ-35I35T_4SJTD</td>
				</tr>
				<tr>
					<td>RESERVATION TIME</td>
					<td>:</td>
					<td class="revervation-time-txt-js">May 07, 2024 (Tue) 12:00 PM - 12:26 PM</td>
				</tr>
				<tr>
					<td>TEXTBOOK CATEGORY</td>
					<td>:</td>
					<td class="textbook-category-txt-js">TOEIC®︎ L&amp;R TEST Score 600 (new version)</td>
				</tr>
				<tr>
					<td>CANCEL REASON</td>
					<td>:</td>
					<td class="cancellation-reason-txt-js">
						<p class="cancellation-reason-txt">Text</p>
					</td>
				</tr>
			</tbody></table>
		</div>
		<div class="btn-wrap btn-half cf" style="margin-top:0">
			<ul>
				<li><button class="btn-style btn-orange-border close_modal">CANCEL</button></li>
				<li><button class="btn-style btn-orange close_modal" id="lesson-id-confirm-ok" ng-click="homeTeacherCancelReservation($event)">YES</button></li>
			</ul>
		</div>
		<div class="btn-close btn_close"></div>
	</div>
</div>

<!-- successful lesson cancellation  -->
<a rel="modal" href="#dialog_successful_lesson_cancellation" id="trigger_dialog_successful_lesson_cancellation"></a>
<div class="modal-window dialog static-overlay hide dialog_successful_lesson_cancellation" id="dialog_successful_lesson_cancellation">
	<div class="dialog_contents">
		<h3 class="fs-20 fw-b">Class Cancellation</h3>
		<p class="fs-16 t-center m-t-30 m-b-20">Class cancellation was successful.</p>
		<div class="btn-wrap btn-half cf m-t-30">
			<ul>
				<li><button id="" class="btn-style btn-orange close_modal">OK</button></li>
			</ul>
		</div>
		<div class="btn-close btn_close"></div>
	</div>
</div>

<!-- cancellation reason modal  -->
<a rel="modal" href="#dialog_reason_for_cancellation" id="trigger_modal_cancellation_reason"></a>
<div class="modal-window dialog static-overlay hide dialog_reason_for_cancellation" id="dialog_reason_for_cancellation">
	<div class="dialog_contents">
		<h3 class="fs-20 fw-b">Cancellation Reason</h3>
		<p class="fs-16 t-left m-t-30 m-b-20 dialog-content"></p>
		<a href="javascript:void(0);" class="t_link d_block t-right" id="dialog_reason_for_cancellation__translate">Translate</a>
		<div class="btn-wrap btn-half cf m-t-30">
			<ul>
				<li><button id="" class="btn-style btn-orange close_modal">CLOSE</button></li>
			</ul>
		</div>
		<!-- <div class="btn-close btn_close"></div> -->
	</div>
</div>

<!-- NJ-39316 end -->

<!-- report textbook NJ-41280 >>>  -->
<a class="hide" id="trigger_modal_report_tb" rel="modal" href="#dialog_report_tb"></a>
<div class="modal_window dialog hide static_overlay dialog_report_teacher dialog_report_tb" id="dialog_report_tb">
	<h3 class="page_ttl m_b_20">Textbook error report</h3>
	<div class="page_ttl_sub">
		<p class="t_left d_i_block">Please provide details of the error with regard to this textbook.</p>
	</div>
	<br>
	<div class="form_item">
		<p class="content_ttl lh_15"> <span id="report_tb_cat"></span> <br>
			<span id="report_tb_chapter"></span>
		</p>
	</div>
	<br><br>
	<div class="form_item">
		<p class="content_ttl">Details of the report (required)</p>
		<div class="ui-count_form increment">
			<textarea name="" id="report_tb_detail" class="ui-count_input" maxlength="1000"></textarea>
			<p class="m_t_10 ui-counter"><span class="ui-count_length-current">0</span>/1000</p>
		</div>
	</div>
	<div class="btn_wrap btn_half m_t_20 m_b_15 cf">
		<ul>
			<li><a class="btn_style btn_gray close_modal" href="javascript:void(0);">Cancel</a></li>
			<li><a class="btn_style btn_report btn_report_tb disabled" href="javascript:void(0);" ng-click="textbookReport($event)">Report</a></li>
		</ul>
	</div>
</div>
<script type="text/javascript">
	$(function() {
		var $textarea = $('#report_tb_detail');
		var lineHeight = parseInt($textarea.css('lineHeight'));
		$textarea.on('input', function(e) {
			var lines = ($(this).val() + '\n').match(/\n/g).length;
			$(this).height(lineHeight * lines);
			if ($(this).val().length >= 1) {
				$('#dialog_report_tb .btn_report_tb').addClass('close_report_tb_modal');
				$('#dialog_report_tb .btn_report_tb').removeClass('disabled');
			} else {
				$('#dialog_report_tb .btn_report_tb').addClass('disabled');
				$('#dialog_report_tb .btn_report_tb').removeClass('close_report_tb_modal');
			}
		});

		const ro = new ResizeObserver(entries => {
			resetModalPosition();
		});
		ro.observe(document.querySelector('#report_tb_detail'));

		$(document).on('click', '.close_report_tb_modal', function() {
			$('#dialog_report_tb').css({"display":"none"});
			$("#modal_overlay, #cover_layer").fadeOut(200);
    	});
	});
</script>

<!-- report teacher complete >>>  -->
<a class="hide" id="trigger_modal_report_tb_complete" rel="modal" href="#dialog_report_tb_complete"></a>
<div class="modal_window dialog hide static_overlay dialog_report_tb dialog_report_tb_complete" id="dialog_report_tb_complete">
	<h3 class="page_ttl m_b_40">Textbook error has been reported.</h3>
	<p class="t_center fs_18 m_b_40">Thank you very much for your valuable feedback.</p>
	<div class="btn_wrap btn_center m_t_25 cf">
		<ul>
			<li><a class="btn_style btn_gray close_modal" href="javascript:void(0)">Close</a></li>
		</ul>
	</div>
</div>
<!-- <<< -->

<!-- Speech To Text >>>  -->
<a class="hide" rel="modal" href="#dialog_speech_to_text" id="trigger_modal_speech_to_text"></a>
<div class="modal-window dialog hide" id="dialog_speech_to_text">
	<div data-total-seconds="30" id="timer-progress-bar"></div>
	<div class="speech-recognition-modal speech_recognition_progress"><!-- 'disabled' class = disabled chivox button -->
		<div class="t_center">
			<p class="fs_32 fw_b m_b_30">Interpretation</p>
			<div class="speech_select_lang_wrap">
				<select id="menu-language">
					<option value="en" selected="">English</option>
					<option value="ja" disabled="">Japanese</option>
					<option value="zh-tw">Chinese (Traditional)</option>
					<option value="ko">Korean</option>
					<option value="vi">Vietnamese</option>
					<option value="pt-br">Portuguese</option>
				</select>
				<img src="/teacher/images/class/icon_right_arrow.svg" alt="right arrow">
				<select id="menu-translate-to-lang">
					<option value="en" disabled="">English</option>
					<option value="ja" selected="">Japanese</option>
					<option value="zh-tw">Chinese (Traditional)</option>
					<option value="ko">Korean</option>
					<option value="vi">Vietnamese</option>
					<option value="pt-br">Portuguese</option>
				</select>
			</div>
		</div>
		<div class="box-inner">
			<div class="body-area">
				<div class="status-area">
					<div class="area-inner">
						<div class="box-icon">
							<ul class="icon-recording">
																	<li></li>
																	<li></li>
																	<li></li>
																	<li></li>
																	<li></li>
																	<li></li>
																	<li></li>
																	<li></li>
																	<li></li>
																	<li></li>
																	<li></li>
																	<li></li>
																	<li></li>
																	<li></li>
															</ul>
						</div>
					</div>
				</div>
				<div class="processing-area">
					<div class="processing-icon">
						<img src="/teacher/images/class/loader_v2.gif" aria-hidden="true">
					</div>
				</div>
			</div>
			<div class="btn-area">
				<button id="btn-record-speech-modal" class="btn-record-speech-modal" data-status="1">
					<span class="recording-hide">START</span>
					<span class="default-hide">STOP</span>
				</button>
				<svg class="speech-circular-progress" width="78" height="78" viewBox="0 0 250 250">
					<circle class="bg"></circle>
					<circle class="fg"></circle>
				</svg>
			</div>
		</div>
	</div>
	<div class="btn-close btn_close" id="btn_close_speech_to_text_modal"></div>
</div>
<!-- <<< -->

<script src="/user/js/recorder.chivox.js?v=9.22.606"></script>
<script src="/user/js/custom_speech.recorder.js?v=9.22.606"></script>
<script type="text/javascript">
	var playing = false;
	var time_total = $("#timer-progress-bar").attr("data-total-seconds");
	var time_left = time_total;
	var modal_id;
	$(window).load(function() {
		var lang = '';
		if (lang.length != 0) {
			$('.'+lang).show();
		}else{
			$('.ja').show();
		}
	});

	//recording functions
	$(function(){
		var varSetTimeout;
		var speech_recognition_modal;
		var modal_id;

		$(document).on("click", "#btn-record-speech-modal", function(e){
			e.preventDefault();
			modal_id = $(this).closest('.modal-window.dialog').attr('id');
			var status = $(this).attr("data-status");
			// console.log('Status when open model: '+status);
			//1 : default - click to start
			//2 : recording - click to stop

			speech_recognition_modal = $(this).closest(".speech-recognition-modal");
			let speechLanguage = $(`#${modal_id} #menu-translate-to-lang`).find(":selected").val();
			let speechLanguageFrom = $(`#${modal_id} #menu-language`).find(":selected").val();
			if (status == "1") {
				//start recording
				$(this).attr("data-status", "2");
				//start counting down
				varSetTimeout = setTimeout(readingCountDown, 1000);
				// start audio recording
				setTimeout(function () {
					window.parent.eventTeacher.toggleRecordSoundTranslateTeacher({btnType: false, chatHash: connect.config.chatHash,speaker: 'teacher', language: speechLanguage, languageFrom: speechLanguageFrom});
					speechRecognitionStart();
				},300);
				//Disable select speech language when speech
				$(`#${modal_id} #menu-language, #${modal_id} #menu-translate-to-lang`).prop("disabled",true);
			} else if(status == "2") {
				//stop counting down
				timerStop();
			}
		});

		$(document).on("click", "#btn_close_speech_to_text_modal, #btn_close_speech_to_text_input_modal", function(e){
			e.preventDefault();
			var status = $(`#${modal_id} #btn-record-speech-modal`).attr("data-status");
			// console.log('Status when close model: '+status);
			//1 : default - click to start
			//2 : recording - click to stop

			speech_recognition_modal = $(this).closest(".speech-recognition-modal");

			if(status == "2") {
				// console.log('btn_close_speech_to_text: '+status);
				//stop counting down
				timerStop();
			} else {
				$('#btn_speech_to_text_open_modal').addClass("on");
				$('#btn_speech_to_text_open_modal').removeClass("disabled");
			}
		});


		function readingCountDown() {
			--time_left;
			// console.log(time_left);
			if (time_left > 0) {
				varSetTimeout = setTimeout(readingCountDown, 1000);
			} else {
				// console.log("Time Up.");
				timerStop();
			}
		}

		function timerStop() {
			let speechLanguage = $(`#${modal_id} #menu-translate-to-lang`).find(":selected").val();
			let speechLanguageFrom = $(`#${modal_id} #menu-language`).find(":selected").val();
			clearTimeout(varSetTimeout);

			//finish recording
			speechRecognitionStop();
			window.parent.eventTeacher.toggleRecordSoundTranslateTeacher({btnType: true, chatHash: connect.config.chatHash,speaker: 'teacher', language: speechLanguage, languageFrom: speechLanguageFrom});
			
		}

		function speechRecognitionStart() {
			$(`#${modal_id}`).find('.btn-record-speech-modal').addClass("on");
			speech_recognition_modal = $(`#${modal_id} .speech-recognition-modal`);
			speech_recognition_modal.addClass("on");
			$(".status-area", speech_recognition_modal).slideDown();
			$('.speech_to_text_send').removeClass('hide');
			$('.btn_speech_text_send').removeClass('on').addClass('off');
			$('#speech_to_text_input').prop('disabled', true);
		}

		function speechRecognitionStop() {
			$(`#${modal_id}`).find('#btn-record-speech-modal').attr("data-status", "3");
			$(`#${modal_id}`).find('.btn-record-speech-modal').removeClass("on");
			speech_recognition_modal.addClass("processing");
			$(".status-area", speech_recognition_modal).hide();
			$(".processing-area", speech_recognition_modal).show();
			$('#speech_to_text_input').prop('disabled', false);
		}

		function updateDisabledOptions() {
			var selectedLang = $('#menu-language').val();
			var selectedTranslateToLang = $('#menu-translate-to-lang').val();

			// Enable all options first
			$('#menu-language option').prop('disabled', false);
			$('#menu-translate-to-lang option').prop('disabled', false);

			// Disable the selected option in the opposite dropdown
			$('#menu-translate-to-lang option[value="' + selectedLang + '"]').prop('disabled', true);
			$('#menu-language option[value="' + selectedTranslateToLang + '"]').prop('disabled', true);
		}

		// Trigger validation on change
		$('#menu-language').change(updateDisabledOptions);
		$('#menu-translate-to-lang').change(updateDisabledOptions);

		// Initial call to set the default disabled options
		updateDisabledOptions();

		
	});

	//open popup modal speech to text
	$(document).on('click', '#btn_speech_to_text_open_modal', function(e){
		e.preventDefault();
		//prevent open popup if menu button disable
		if ($('#btn_speech_to_text_open_modal').hasClass('disabled')){
			return false;
		}
		modal_id = 'dialog_speech_to_text';
		//init popup
		speechRecognitionInit();
		//trigger open popup
		$('#trigger_modal_speech_to_text').click();
	});

	//click menu select language speech
	$(document).on('change', '#menu-language', function(e){
		if( $('#btn-record-speech-modal').attr("data-status") == 1 ){
			$('#dialog_speech_to_text .language-text').hide();
			//show text by language
			var lang = $(this).find(":selected").val();
			$('.'+lang).show();
		}
	});

	function speechRecognitionInit() {
		time_left = time_total;
		$('#btn_speech_to_text_open_modal').removeClass("on");
		$('#btn_speech_to_text_open_modal').addClass("disabled");
		$(`#${modal_id} #btn-record-speech-modal`).attr("data-status", "1");
		speech_recognition_modal = $(`#${modal_id} .speech-recognition-modal`) ;
		$(".btn-record-speech-modal", speech_recognition_modal).removeClass("on");
		$(".status-area", speech_recognition_modal).hide();
		$(".processing-area", speech_recognition_modal).hide();	
		speech_recognition_modal.removeClass("on");
		speech_recognition_modal.removeClass("processing");
		$(`#${modal_id} #menu-language, #${modal_id} #menu-translate-to-lang`).removeAttr('disabled');
		$('#speech_to_text_input').prop('disabled', false);
	}

	/*--------------------------------------*/
	// Text to Speech Function
	/*--------------------------------------*/
	$(document).on('click', '.btn_text_to_speech_chat', function(e){
		e.preventDefault();
		//-prevent viewer trigger
		if (connect.config.memberType == 'viewer') { return; }

		var target = $(this).closest('.chat_txt');
		var text = $('.speech-sentence', target).text();
		var lang = $(this).attr('data-lang');
		var btn = $(this).find('i.fa.fa-microphone');
		var btn_loading = $(this).find('i.fa.fa-spinner');
		// output audio with using text to speech API
		if(text!=''){
			textToSpeech2(text, lang , btn, btn_loading);
		}
	});

	function textToSpeech2(text, lang, btn, btn_loading){				
		text = text.replace(/\([^)]+\)/, "");
		text = text.replace(/\s/g, "_");
		text = text.replace("'", "");
		text = text.replace("’", "");
		text = text.replace("’", "");
		text = text.replace("é", "ei");
		text = text.replace("~", "");
		text = text.replace("…", "");

		var parentPlaying = false;
		if (playing === true) {
			return false;
		}

		if (typeof window.parent.playing != 'undefined' && window.parent.playing && !playing) { 
			parentPlaying = true; 
		}

		if (!playing && !parentPlaying) {
			btn.hide();
			btn_loading.show();
			// disable other's sound
			playTextbookAudio2(true, 0);

			playing = true;
			// clickedBtn = btn;
			var audioUrl = "/textbook/getSpeech/"+lang+"?text=" + text;
			var originalVolume = (typeof aite_volume !== 'undefined') ? aite_volume : 100;
			var sound = new Audio(audioUrl);
			sound.oncanplay = function() {
				// play the sound
				sound.play();
				console.log('play');
			};
			
			// when the sound file has ended
			sound.onended = function() {
				playing = false;
				// disable other's sound
				playTextbookAudio2(false, window.parent.volume_others);
				doneBtn2(btn, btn_loading);
			};
			
			// when an error was encountered
			sound.onerror = function() {
				playing = false;
				// disable other's sound
				playTextbookAudio2(false, window.parent.volume_others);
				doneBtn2(btn, btn_loading);
			};

			// - load sound object
			sound.load();
		} else {
			// clickedBtn = btn;
			doneBtn2(btn, btn_loading);
			return false;
		}
	}

	function doneBtn2(btn, btn_loading) {
		btn.show();
		btn_loading.hide();
	}

	function playTextbookAudio2(bool, soundOthers) {
		if (
			typeof window.parent.eventCommon !== 'undefined' &&
			typeof window.parent.eventCommon.playTextbookAudio !== 'undefined' && 
			$.isFunction(window.parent.eventCommon.playTextbookAudio)
		) { window.parent.setPlayingAudio(bool); window.parent.setSoundOthers(soundOthers); }
	}
</script>
<!-- NJ-41281 START -->
<a class="hide" rel="modal" href="#set_target_earning_modal" id="trigger_modal_set_target_earning"></a>
<div class="modal-window dialog set_target_earning_modal hide static_overlay" id="set_target_earning_modal">
	<form method="post" id="teacherRewardModal" ng-submit="upsertTeacherRewardGoal()" class="ng-pristine ng-valid">
	<p class="t_center m_b_20 fs_17 fw_b">Setting of Targets</p>
	<div class="m_b_20 set_target_form_area">
		<input type="text" class="hb-teacher-reward-goal-amount ng-pristine ng-untouched ng-valid ng-empty" name="target_amount" ng-model="hbRewardGoal.target_amount" id="set_target_earning_input" value="" placeholder="-">
		<span class="hb-reward-goal-currency ng-binding"></span>
	</div>
	<p class="set_target_earning_error fs_16 hide">The target has to be higher than the current earnings.</p>
	<div class="btn-wrap btn-center">
		<button type="submit" class="nc-btn hb-reward-goal-save">Save</button>
	</div>
	<div class="hb-reward-goal-btn-close btn-close btn_close"></div>
</form></div>

<script>
$(document).ready(function() {
	$('#set_target_earning_input').on('input', function() {
		//
		$(this).val($(this).val().replace(/[^0-9]/g, ''));
	});
});
</script>
<!-- NJ-41281 END -->

<!-- NJ-1957 -->



<a class="hide" rel="modal" href="#modal_group_delete_post" id="trigger_modal_group_delete_post"></a>
<div class="modal_window dialog no-border hide modal_group_create static_overlay" id="modal_group_delete_post" style="width: 580px; height:258px">
       <div class="t_center">
            <h1>Delete post?</h1>
            <div class="btn-close btn_close"></div>
        </div>
		
		<div class="delete-post">
			<p>Are you sure you want to delete this post?</p>
			<div class="buttons-holder">
				<a href="#" class="btn-cancel btn_cancel">Cancel</a>
				<a href="#" class="btn-del btn_del">Delete</a>
			</div>
		</div>
</div>
<a class="hide" rel="modal" href="#modal_group_delete_comment" id="trigger_modal_group_delete_comment"></a>
<div class="modal_window dialog no-border hide modal_group_create static_overlay" id="modal_group_delete_comment" style="width: 580px; height:258px">
       <div class="t_center">
            <h1>Delete comment?</h1>
            <div class="btn-close btn_close"></div>
        </div>
		
		<div class="delete-post">
			<p>Are you sure you want to delete this comment?</p>
			<div class="buttons-holder">
				<a href="#" class="btn-cancel btn_cancel">Cancel</a>
				<a href="#" class="btn-del btn_del">Delete</a>
			</div>
		</div>
</div>
<a class="hide" rel="modal" href="#modal_group_invite_admin" id="trigger_modal_group_invite_admin"></a>
<div class="modal_window dialog no-border hide modal_group_create static_overlay" id="modal_group_invite_admin" style="width: 580px;">
       <div class="t_center">
            <h1>Invite new admin</h1>
            <div class="btn-close btn_close"></div>
        </div>
		<div class="con-invite">
			<p class="fw-b">Invite new admin</p>
			<p> You are the last admin of <span class="groupname"></span>. Invite new admins to maintain this group after you leave.</p>
			<div class="search-container">
				<input type="text" class="search-bar" placeholder="Choose new admins">
				<button type="submit" class="search-button">
					<img src="/teacher/images/icon/icon_search-grey.png" alt="Search">
				</button>
		    </div>
				<div class="members-profile">
					
				</div>

		</div>
</div>
<a class="hide" rel="modal" href="#modal_group_remove_admin" id="trigger_modal_group_remove_admin"></a>
<div class="modal_window dialog no-border hide modal_group_create static_overlay" id="modal_group_remove_admin" style="width: 580px; height:258px">
       <div class="t_center">
            <h1>Are you sure?</h1>
            <div class="btn-close btn_close"></div>
        </div>
		
		<div class="delete-post">
			<p>Are you sure you want to remove as admin from <span class="groupname"></span>?</p>
			<div class="buttons-holder">
				<button href="#" class="btn-cancel btn_cancel">Cancel</button>
				<button class="btn-del btn_del">Remove as admin</button>
			</div>
		</div>
</div>
<a class="hide" rel="modal" href="#modal_group_remove_member" id="trigger_modal_group_remove_member"></a>
<div class="modal_window dialog no-border hide modal_group_create static_overlay" id="modal_group_remove_member" style="width: 580px; height:auto">
       <div class="t_center">
			<div class="mem-profile">
				<img src="https://placehold.jp/60x60.png" alt="testing-profile">
			</div>
	       <p><span class="memname"></span></p>
            <div class="btn-close btn_close"></div>
        </div>
		
		<div class="delete-member">
			<p>You’re removing <span class="memname"></span> from <span class="groupname"></span>.</p>
			<div class="buttons-holder">
				<a href="#" class="btn-cancel btn_cancel">Cancel</a>
				<a class="btn-del btn_del">Confirm</a>
			</div>
		</div>
</div>

<a class="hide" rel="modal" href="#modal_group_leave_confirm" id="trigger_modal_group_leave_confirm"></a>
<div class="modal_window dialog no-border hide modal_group_create static_overlay" id="modal_group_leave_confirm" style="width: 580px; height:258px">
       <div class="t_center">
            <h1>Are you sure?</h1>
            <div class="btn-close btn_close"></div>
        </div>
		
		<div class="delete-post">
			<p>Are you sure you want to leave <span class="groupname"></span>?</p>
			<div class="buttons-holder">
				<a href="#" class="btn-cancel btn_cancel">Cancel</a>
				<a href="javascript:;" class="btn-del btn_del" id="leave_grp_modal">Leave Group</a>
			</div>
		</div>
</div>
<a class="hide" rel="modal" href="#modal_group_leave_delete" id="trigger_modal_group_leave_delete"></a>
<div class="modal_window dialog no-border hide modal_group_create static_overlay" id="modal_group_leave_delete" style="width: 580px; height:258px">
       <div class="t_center">
            <h1>Delete group by leaving?</h1>
            <div class="btn-close btn_close"></div>
        </div>
		
		<div class="delete-post">
			<p>Are you sure you want to leave <span class="groupname"></span>? <br> Since you’re the last member, leaving now will also delete this group.</p>
			<div class="buttons-holder">
				<a href="#" class="btn-cancel btn_cancel">Cancel</a>
				<a href="javascript:;" class="btn-del btn_del">Delete Group</a>
			</div>
		</div>
</div>

<div class="modal_window dialog no-border hide modal_group_create static_overlay" id="modal_group_invalid_file_type_size">
	<div class="t_center p_b_20">
		<h1 class="error-header"></h1>
		<div class="btn-close btn_close"></div>
	</div>
	<p class="m_t_20 error-body"></p>
	<a href="javascript:;" class="btn_close">Close</a>
</div>

<div class="toast-modal"><p class="toast-msg"></p> <a class="btn-cancel"></a></div>
<div class="toast-notif"></div>

<!-- NJ-64751 START -->
<a class="hide" rel="modal" href="#modal_unable_lesson_start_camera_access" id="trigger_modal_unable_lesson_start_camera_access"></a>
<div class="modal_window dialog no-border hide modal_unable_lesson_start static_overlay" id="modal_unable_lesson_start_camera_access">
	<h3 class="page_ttl fs_24 fw_b t_center">Unable to start a lesson</h3>
    <div class="image_blick">
		<img src="https://nativecamp-public-web-production.s3.ap-northeast-1.amazonaws.com/user/webroot/images/modal/teddy-lesson-cancel.webp?v=" alt="teddy" width="115" height="165">
    </div>
	<p class="fs_18 t_center page_txt">Please go to the Settings on your Web Browser <br> to give access to the camera</p>
</div>
<!-- NJ-64751 END -->
 <!-- https://nativecamp-public-web-staging.s3-ap-northeast-1.amazonaws.com/user/webroot/images/modal/teddy-lesson-cancel.webp -->

<!-- NJ-55190 -->
<a class="hide" rel="modal" href="#shift_progress_modal" id="trigger_shift_progress"></a>
<div class="modal-window dialog hide static_overlay small-modal" id="shift_progress_modal">
	<div class="modal_inner">
		<div class="rating_complete_wrap">
			<p class="c_red fs_25 fw_b t_center m_b_20">Opening shift in progress</p>
			<p class="t_center">Please wait a moment.</p>
			<p class="t_center">Slots open automatically every 10 minutes (at 00, 10, 20, etc.).</p>
			<p class="t_center m_b_20">Manual opening is not possible during this process.</p>
			<p class="t_center"><em>Example: Login at 12:01 → slots open at 12:10.</em></p>
			<div class="btn_wrap btn_center m_t_30 cf">
				<ul class="d_table">
					<li class="d_cell"><a class="btn_style btn_gray close_modal" href="javascript:void(0)">Close</a></li>
				</ul>
			</div>
		</div>
	</div>
</div>
<!-- NJ-55190 End -->
 <!-- NJ-67452  -->
<a class="hide" rel="modal" href="#dialog_groups_post_restrictions" id="trigger_modal_groups_restrict_post"></a>
<div class="modal-window groups_post_restrictions hide" id="dialog_groups_post_restrictions">
	<div class="modal-inner">
		<h3 class="modal-title m_b_20">Restricted Posting</h3>
		<div class="title-wrap">
			<p>Unfortunately, you have been restricted from posting on this forum because your posts violated the Groups rules.</p>
			<p>※Please contact the Native Camp Teacher Support Center via the inquiry section for any details about the posting restriction.</p>
		</div>
		<div class="t_center m_t_30">
			<a class="btn-yes close_modal" href="javascript:void(0);">CLOSE</a>
		</div>
	</div>
	<div class="btn-close btn_close"></div>
</div>
<!-- <<< -->

<!-- NJ-66652 Start -->
<a class="hide" id="trigger_modal_fee_update" rel="modal" href="#dialog-fee-update"></a>
<div class="modal_window dialog hide static_overlay dialog-fee-update" id="dialog-fee-update">
	<h3 class="modal-ttl">Booked Lesson Fee Update</h3>
	<div class="desc-wrap">
		<p>Please review the details and click 'Confirm' to proceed.</p>
		<p>New Booked Lesson Fee : <span class="fee-amount"></span></p> <!-- dummyPrice to be change by backend  -->
		<ul>
			<li><a href="#" class="btn_style btn_gray close_modal btn_nolink" ng-click="cancelFee()">Cancel</a></li>
			<li><a href="#" class="btn_style btn_orange close_modal btn_confirm btn_nolink" ng-click="updateBookedLessonFeeSetting()">Confirm</a></li>
		</ul>
	</div>
	<div class="fee-update-note">
		<p>Once you click Confirm and update the booked lesson fee, it cannot be changed again for 7 days.</p>
	</div>
</div>

<a class="hide" id="trigger_modal_fee_update_success" rel="modal" href="#dialog-fee-update-success"></a>
<div class="modal_window dialog hide static_overlay dialog-fee-update-success" id="dialog-fee-update-success">
	<h3 class="modal-ttl">Update Successfully</h3>
	<a href="#" class="btn_style btn_orange close_modal btn_nolink">OK</a>
</div>

<a class="hide" id="trigger_modal_fee_change" rel="modal" href="#dialog-fee-change"></a>
<div class="modal_window dialog hide static_overlay dialog-fee-change" id="dialog-fee-change">
	<h3 class="modal-ttl">Booked Lesson Fee Change</h3>
	<div class="desc-wrap">
		<p>Your booked lesson fee was updated within the past 7 days. A new update will be possible after the following date and time:</p>
		<p class="fee-date-time"><span class="fee-change-date"></span><span class="fee-change-time"></span></p> <!-- dummyDate and dummyTime to be change by backend  -->
		<a href="#" class="btn_style btn_gray close_modal btn_nolink">Close</a>
	</div>
</div>

<!-- NJ-66652 End -->
<audio id="chivoxRecAudioTag" src="data:audio/mp3;base64" style="position: absolute; visibility: hidden;"></audio>
<a rel="modal" href="#dialog_unexpected_disconnect" id="dialog_notend_open"></a>
<a class="hide" id="trigger_dialog_chat_quit" rel="modal" href="#dialog_chat_quit"></a>
<!-- <<< -->

<!-- webrtc -->
<script type="text/javascript" src="/user/js/webrtcv2/socket.io.js?v=2.16.352"></script>
<script type="text/javascript" src="https://cdn.webrtc.ecl.ntt.com/skyway-latest.js?v=2.16.352"></script>
<script type="text/javascript" src="https://cdn.webrtc.ecl.ntt.com/skyway-recorder-latest.js?v=2.16.352"></script>
<script type="text/javascript" src="/user/js/webrtcv2/util.js?v=2.16.352"></script>
<script type="text/javascript" src="/user/js/webrtcv2/event.teacher.js?v=2.16.352"></script>
<script type="text/javascript" src="/user/js/webrtcv2/audio.acquisition.js?v=2.16.352"></script>
<script type="text/javascript" src="/user/js/webrtcv2/audio.acquisition.student.js?v=2.16.352"></script>
<script type="text/javascript" src="/user/js/webrtcv2/getStats.js?v=2.16.352"></script>
<!-- end of webrtc -->

<!-- start of recorder.js -->
<script src="/teacher/js/recorder.chivox.js?v=2.16.352"></script>
<script src="/teacher/js/custom_sound.recorder.js?v=2.16.352"></script>
<script src="/teacher/js/WebAudioRecorder.js?v=2.16.352"></script>
<!-- end of recorder.js -->

<!-- tensor flow -->
<script type="text/javascript" src="/user/js/googlemeet-segmentation-worker.min.js?v=2.16.352"></script>
<script type="text/javascript" src="/user/js/custom-virtual-background.js?v=2.16.352"></script>
<!-- end of tensor flow -->

<!-- start of media mixer -->
<script src="/teacher/js/MultiStreamsMixer.js?v=2.16.352"></script>


<!-- idle screen config -->
<script type="text/javascript" src="/teacher/js/teacher-fcm-notif-config.js?v=2.16.352"></script>
<script type="text/javascript" src="/teacher/js/custom-live-lesson-stream.js?v=2.16.352"></script>

<script type="text/javascript">
/* initialization */
var lesson_id,
	t_user_id,
	s_user_id,
	input_text,
	volume_own,
	volume_others,
	font_class,
	textbook_category_type,
	textbook_data,
	font_color;

var getStudId = 0;
var info = null;
var errorCount = 0;

var displayModal = false;

//NJ-7439
var teacherAudioData = "0"; 
var teacherAudioInterval = "0"; 

//NJ-10508
var studentAudioData = "0"; 
var studentAudioInterval = "0"; 

var currentTeacherAudioData = 0;

var currentStudentAudioData = 0;

var audioAcquisitionFlag = isNaN(parseInt("")) ? 2 : parseInt("");

var audioTimer = null;

/* 10 seconds notice */
var noticeTimer_10_secs = false;

/* determine if the lesson is ongoing */
var studentConnected = false;

/* current lesson status */
var lessonStatus = "";

/* current lesson type */
var lessonType = isNaN(parseInt("")) ? 1 : parseInt("");

/* initialize angular app element */
var angularApp = angular.element($("body[ng-app='teacherApp']"));

/* initialize the camera checker interval */
var cameraCheckerInterval = false;

/* set ice servers from PHP */
var iceServers = $.parseJSON('');

/* get the student's and teacher's avatar */
var studentAvatar = "";
var teacherAvatar = "";
var studentNickname = "";

/* initialize the start chat time interval */
var startChatTimeInterval = false;

var startCheckingMaintenanceInterval = false;

var startCheckOngoingMaintenanceInterval = false;

/* btn timeout disabler */
var btnDisableTimeout = false;

/* check if has ongoing lesson */
var hasOngoingLesson = false;

// set lessonId
var lessonId = "";

// set next teacher's status
var nextStatus = 5;
var nextRemarks1 = '';
var nextRemarks2 = '';
var homeFlag = 1;
var counselingFlag = 0;
var editMessage = '';

// - NC-TEACHER-AJAX-UA
var _debugStudentUA = "";

var chat_hash = "449595-1756730221-c91329";

// - control for socket
var useNewSocket = ("0");
useNewSocket = parseInt(useNewSocket);
useNewSocket = isNaN(useNewSocket) ? 0 : useNewSocket;

// set variables for modal
var student_Image = ''
var student_Name = '';
var studentTeacherLastLessonDate = '';
var studentTeacherCurrentTotalNumberOfLessons = '';
var studentTeacherNewTotalNumberOfLesson = '';

var strgRequestLessonTime = {
	'requestLessonTimeMin' : 25,
	'requestLessonTimeSec' : 1500
};

var maxRequestLessonTime = 1560;
var requestLessonTimeVisible = false;
var retryCounter = 0;
var globalTextBookIds = {}; // global textbook IDs container
var reloadWhenNotConnected = false;
var isRecordingSpeech = false; // Student speech recording
var convertedSpeechText = ''; // Student converted speech
// determine if virtual background was set
var hasVirtualBackground = "0"; 

/* initialize the start connection speed interval */
var startConnectionSpeedInterval = false;

/* set connection speed interval value in milliseconds */
var connectionSpeedInterval = 30000;

/* set user connection speed unsave data to array */
var connectionSpeedUnsaveData = [];

/* set user connection speed queued data to array */
var connectionSpeedQueuedData = [];

/* set user connection speed data to array */
var connectionSpeedData = [];

/* set download speed in kbs to 0 */
var downloadSpeedKbs = 0;

/* set run connection speed flag */
var runConnectionSpeedIntervalFlg = false;

/* set lesson end time */
var lessonEndtime = '';

/* set lesson current time */
var lessonCurrentTime = '';

// chatbox file upload (attachedFilesLink, maxUploadsize, maxFileCount, uploadFileAjaxRequest, tempFileContainer, allowFiles)
var attachedFilesLink = [];
var maxUploadsize = 5;
var maxFileCount = 10;
var uploadFileAjaxRequest = null;
var tempFileContainer = [];
var allowFiles = ["jpg","jpeg","png","gif","pdf","xls","xlsx","txt","doc","dotx","docx","ppt","pptx","asf","avi","f4v","flv","hevc","m2ts","m2v","mjpeg","mkv","mov","mpeg","mpg","mts","mxf","ogv","rm","swf","ts","vob","webm","wmv","wma","wtb","mov","f4a","f4b","ogg","oga","ogv","ogx","mp4","m4a","m4v","m4b","m4r","3gp","3gp2","3g2","3gpp","3gpp2","mp3","heic"];
var isFilesDoc = ["pdf","xls","xlsx","txt","doc","dotx","docx","ppt","pptx","heic"];
var isFilesVid = ["asf","avi","f4v","flv","hevc","m2ts","m2v","mjpeg","mkv","mov","mpeg","mpg","mts","mxf","rm","swf","ts","vob","wmv","wma","wtb","mov","f4a","f4b"];
var isFilesAud = ["mp3","m4a"];
var supportedFilesVid = ["ogg","oga","ogv","ogx","mp4","m4v","m4b","m4r","3gp","3gp2","3g2","3gpp","3gpp2","webm"];
var maxTimeUpload = null;
var enableFileUpload = true;

/* NEW P2P Textbook Audio Player */
var enableNewAudioCrontrol = true;
var newAudioAppTimeout = 10;
var newAudioButtontStatus = 0;
var newAudioButtonTimer = null;
var enableNewAudioNotif = true;
var pauseTempOwnMic = false;
var allowAudioMix = false;

/* skyway recorder */
var skywayRecorderHandler = null;

// camera toggle default valu
var studentCameraToggleFlag = 0;
var teacherCameraToggleFag = 0;
var lessonDisableCameraToggle = true;

/* live checker */
var isLive = parseInt("");
var numViewers = parseInt("");

/* Chatbox audio recording */ 
var chatboxAudMixFlag = false;
var chatboxActiveAudRecord = null;
var chatboxActiveAudMix = -1;
var chatboxActiveAudRecordSrc = null;
var chatboxAudExec = "1";

/* chivox paste function */
var chivoxReadingCount = 0

var speechTranslationAudUrl = "nativecamp://audio?url=https://nativecamp.net/textbook/getSpeech/en-US?text=";

//NJ-10508
$('#speaking-ratio').hide();
$('.rec_icon').hide();

// NJ-279: new chat functionalities
var spanTagEdited = '<span class="mark-edited"> (edited)</span>';

// NJ-16457
var isLessonTutorial = false;
var canLessonTutorial = false;
	canLessonTutorial = true;

//-- NJ-22758
var drawingToolFlag = 0;
var drawingToolMinVersionIOS = "4.5.7";
var drawingToolMinVersionAndroid = "4.9.8"

var isAllCheckedStudentRequestLesson = parseInt('0');

// check if allow drop file upload
var corporateIdsDisabledFileUpload = parseInt("0");

// NJ-50996
var errorsEncounteredList = [];

// NJ-38256
var iosNewDesignSupported = "5.6.0";
var androidNewDesignSupported = "5.6.0";


/* document ready */
$(function(){
	/**
	 * NJ-50996: Collect error encountered and when stream is affected using obj.streamChecker, 
	 * 			 it will send the error through slack.
	 */
	function logErrorToVariable(type, message, source, lineno, colno, error) {
		errorsEncounteredList.push({
			type,
			message,
			source,
			lineno,
			colno,
			stack: error?.stack || null,
			timestamp: new Date().toISOString(),
		});
	}

	// capture unhandled promise rejections
	window.onunhandledrejection = function (event) {
		logErrorToVariable(
			'Unhandled Promise Rejection',
			event.reason?.message || event.reason || 'Unknown reason',
			null,
			null,
			null,
			event.reason
		);
	};

	// capture general JS errors
	window.onerror = function (message, source, lineno, colno, error) {
		logErrorToVariable('Error', message, source, lineno, colno, error);
		return false;
	};

	showAvatarPhraseModal();
	// NC-3185 : ok button
	$("#trigger_dialog_callan_message_after_lesson_ok").on('click', function(){
		// display three minute break
		if (threeMinOtherBreak) {
			show5minutesLessonAndAboveModal = true;
			angular.element($("body[ng-app='teacherApp']")).scope().afterLessonModalSync('teacher_lesson_notice');
		}
	});

	/* check if there is reservation and lessStatus must not equal to 3 : lesson */
	if (Number(lessonStatus) != 3) {
		angularApp.scope().cancelReservation();
	}

	/* set avatar */
	$('.ownVideoAvatar').attr("poster", teacherAvatar);

	// hide specific menus during lesson
	angularApp.scope().lessonHideMenus(lessonStatus);

	/* show loader */
	if (canLessonTutorial == false) {
		$("#trigger_dialog_check_user_lesson_note").click();
	}
	$('#modal_overlay').off('click');

	/* set my volume */
	if($.cookie('my_volume') > 0){
		volume_own = $.cookie('my_volume');
	} else {
		volume_own = 50;
	}

	/* set other's volume */
	if($.cookie('aite_volume') > 0){
		volume_others = $.cookie('aite_volume');
	} else {
		volume_others = 50;
	}

	// modal window
	$('a[rel*=modal]').leanModal();

	var sc = null;
	var sentence = null;
	var temp_id = null;

	// NJ-279: Delete message menu is clicked
	$(document).on('click','.chat_menu-delete', function(){
		$("#text_chat").blur();
		sc = $(this).closest('.t_txt');
		var msg_temp_id = $('.cnt-sentence', sc).attr('id');
		var comment_temp_id = $('p.contents', sc).attr('id');
		var msg_text = $('.cnt-sentence', sc).text();
		var comment_text = $('p.contents', sc).text();

		// check values
		temp_id = (typeof comment_temp_id !== 'undefined') ? comment_temp_id : msg_temp_id;
		sentence = (typeof comment_text !== 'undefined' && comment_text !== '') ? comment_text : msg_text;

		if($('.cnt-sentence .file-item-chat', sc).length == 0) {
			// don't show the msg to delete
			// $('.chat_msg').text(sentence);
		} else {
			sentence = 'Temporary_message_for_file_upload';
		}

		$('.chat_msg').hide();
		$('#deleteMessageButton').attr('data-chatid', temp_id);
		$("#trigger_modal_chat_msg-delete").click();
	});

	// NJ-279: Delete btn is clicked on the Delete message modal
	$(document).on('click','#deleteMessageButton', function(){
		temp_id = $(this).attr('data-chatid');
		chat_hash = "449595-1756730221-c91329"
		$.ajax({
			url: "/teacher/chat-delete",
			type: 'post',
			data: {
				temp_id : temp_id,
				chat_hash : chat_hash
			},
			beforeSend: function() {
				processing = true;
			},
			success: function(res) {
				if (res) {
					editMessage = '';
					$('#deleteMessageButton').removeAttr('data-chatid');
					$('#dialog_chat_msg-delete .close_modal').click();
					$('.btn-cancel-area #btn_cancel').click();
					sendMessage(sentence, false, temp_id, true);
				}
			},
			complete: function() {
				processing = false;
			}
		});
	});

	// NJ-279: cancel or X button on the Delete message modal is clicked
	$(document).on('click', '#dialog_chat_msg-delete .btn_gray.close_modal, #dialog_chat_msg-delete div.btn_close', function(e) {
		e.preventDefault();
		editMessage = '';
		$('#deleteMessageButton').removeAttr('data-chatid');
		$('.btn-cancel-area #btn_cancel').click();
	});

	/*----------------------------------------------*/
	// btn video others
	/*----------------------------------------------*/
	$(document).on('click','#btn-video_others', function(e){
		e.preventDefault();
		if($(this).hasClass('disabled') || $(this).hasClass('disable') || $(this).prop('disabled')|| $(this).hasClass("on") === false || studentCameraToggleFlag){
			return;
		}
		if($(this).hasClass('on')){
			// turn off others video
			swichVideoOthers(0);
		}else{
			// turn on others video
			connect.cameraEnableSoftReconnect = true;
			swichVideoOthers(1);
		}
	});

	/*----------------------------------------------*/
	// btn video own
	/*----------------------------------------------*/
	$(document).on('click','#btn-video_own', function(e){
		e.preventDefault();
		if($(this).hasClass('disabled') || $(this).hasClass('disable') || $(this).prop('disabled') || teacherCameraToggleFag){
			return;
		}
		if($(this).hasClass('on')){
			if (window.confirm('Please always ask your students if you want to turn off your camera.\nIf you turn off your camera without students\' permission, you might get bad ratings from your students.')){
				// turn off own video
				swichVideoOwn(0);
			}
		}else{
			connect.cameraEnableSoftReconnect = true;
			// turn on own video
			swichVideoOwn(1);
		}
	});

	/*----------------------------------------------*/
	// close video own
	/*----------------------------------------------*/
	$('#own_video_wrap .ic_close').on('click', function(){
		// turn off own video
		swichVideoOwn(0);
		$('#own_video_wrap').removeClass('on');
	});

	/*----------------------------------------------*/
	// btn sound others
	/*----------------------------------------------*/
	$(document).on('click','#btn-sound_others', function(e){
		e.preventDefault();
		if($(this).hasClass('disabled') || $(this).hasClass('disable') || $(this).prop('disabled')){
			return;
		}
		if($(this).hasClass('on')){
			// turn off others sound
			setSoundOthers(0);
		}else{
			setSoundOthers(volume_others);
		}
	});

	/*----------------------------------------------*/
	// btn sound own
	/*----------------------------------------------*/
	$(document).on('click','#btn-sound_own', function(e){
		e.preventDefault();
		if($(this).hasClass('disabled') || $(this).hasClass('disable') || $(this).prop('disabled')){
			return;
		}
		if($(this).hasClass('on')){
			// turn off own sound
			setSoundOwn(0);
		}else{
			setSoundOwn(volume_own);
		}
	});

	/*----------------------------------------------*/
	// volume slider others
	/*----------------------------------------------*/
	$('#volume_slider-others').slider({
		orientation: 'vertical',
		range: 'min',
		min: 1,
		value: 50,
		stop: function(event, ui){ setSoundOthers(ui.value); }
	});

	/*----------------------------------------------*/
	// countdown msg close
	/*----------------------------------------------*/
	$(document).on('click', '#chat_msg_countdown .modal_close', function(e){
		$(this).closest('#chat_msg_countdown').hide();
	});

	/*----------------------------------------------*/
	// close all modal
	/*----------------------------------------------*/
	$('#volume_slider-own').slider({
		orientation: 'vertical',
		range: 'min',
		min: 0,
		max: 100,
		value: 50,
		stop: function(event, ui){ setSoundOwn(ui.value); }
	});

	/*----------------------------------------------*/
	// btn swap video
	/*----------------------------------------------*/
	$(document).on('click','#btn-swap_video', function(e){
		e.preventDefault();
		if($(this).hasClass('disabled') || $(this).hasClass('disable') || $(this).prop('disabled')){
			return;
		}

		if ($(this).hasClass('on')) {
			$(this).removeClass('on');
			var ownVideo_w = $('#own_video_wrap').width();
			var ownVideo_h = $('#own_video_wrap').height();

			if (typeof resizeDimesionsSegmentationParams != 'undefined' && $.isFunction(resizeDimesionsSegmentationParams)) {
				resizeDimesionsSegmentationParams(100, 75);
			}

			/* normal behavior */
			$('#others_video_wrap')
			.removeClass('own_video_wrap')
			.addClass('others_video_wrap')
			.css({'z-index':1, 'width': ownVideo_w + 'px', 'height': ownVideo_h + 'px'});

			$('#own_video_wrap')
			.removeClass('others_video_wrap')
			.addClass('own_video_wrap')
			.addClass('on')
			.css({'z-index':2, 'height': '75px', 'width': '100px'});
		} else {
			$(this).addClass('on');
			var othersVideo_w = $('#others_video_wrap').width();
			var othersVideo_h = $('#others_video_wrap').height();

			if (typeof resizeDimesionsSegmentationParams != 'undefined' && $.isFunction(resizeDimesionsSegmentationParams)) {
				resizeDimesionsSegmentationParams(othersVideo_w, othersVideo_h);
			}

			/* reverse */
			$('#others_video_wrap')
			.removeClass('others_video_wrap')
			.addClass('own_video_wrap')
			.addClass('on')
			.css({'z-index':2, 'height': '75px', 'width': '100px'});

			$('#own_video_wrap')
			.removeClass('own_video_wrap')
			.addClass('others_video_wrap')
			.css({'z-index':1, 'width': othersVideo_w + 'px', 'height': othersVideo_h + 'px'});
		}

		// change device orientation
		if (
			typeof eventTeacher.deviceDidChangeOrientation !== 'undefined' &&
			$.isFunction(eventTeacher.deviceDidChangeOrientation) &&
			connect.deviceBounds
		) {
			eventTeacher.deviceDidChangeOrientation();
		}
	});

	/*----------------------------------------------*/
	// btn refresh peerJS
	/*----------------------------------------------*/
	$(document).on('click','#btn-refresh', function(e){
		/* if has disabled, don't proceed */
		if ($(this).hasClass('disabled')) { return false; }
		if (btnDisableTimeout !== false) { clearTimeout(btnDisableTimeout); }

		/* disable button */
		$(this).addClass('disabled');

		/* reset peer server connection */
		connect.didReconnect = true;
		eventTeacher.refreshPeerJS();

		// NJ-16457 - show reconnecting message
		if (typeof isLessonTutorial != 'undefined' && isLessonTutorial == true) {
			$('.video_overlay_msg.lesson_connecting').show();
			setTimeout(() => {
				$('.video_overlay_msg.lesson_connecting').hide();
				$('#webrtc_controls div.btn').removeClass('disabled');
				$('#webrtc_controls div.btn').not("#btn-video_own, #btn-video_others, #btn-swap_video, #btn-sound_others, #btn-sound_own").addClass('on');
			}, 5000);
			return false;
		}

		/* automatically enable after 5 seconds */
		btnDisableTimeout = setTimeout(function(){
			$('#btn-refresh, #btn-sound_own, #btn-video_own').removeClass('disabled');
			btnDisableTimeout = false;

		}, 15000);
	});

	/*----------------------------------------------*/
	// hard btn refresh peerJS
	/*----------------------------------------------*/
	$('.btn-hard-refresh').on('click', function(){
		/* if has disabled, don't proceed */
		if ($(this).hasClass('disabled')) { return false; }

		/* disable link */
		$(this).addClass('disabled');

		/* add close protection */
		closeProtection = false;

		/* redirect */
		setTimeout(function(){ close_window("/teacher/chat?action=teacherHardReconnect"); }, 1000);
	});

	// NJ-279: if the chatbox area or submit button is clicked
	$(document).on('click','#editor, #text_chat_submit', function (event) {
		// Hide emoticons when typing text
		$('#emoticons-box').hide();

		var editorVal = $('#editor').text();
		var isEmptyEditor = eventCommon.isMsgEmptyOrSpacesOrNewlines(editorVal);
		var hasActiveStyling = eventCommon.hasActiveTextStyling();

		// if editor is not empty or has no active text styling
		if (isEmptyEditor === false || hasActiveStyling === false) { 
			// handle the mouse clicking of texts inside the editor
			if (this.tagName === "DIV" && event.currentTarget.id == "editor") {
				eventCommon.handleTextSelection();
			}
		} else {
			// if editor's empty, always apply active text styles after focus out event
			eventCommon.handleActiveStylesOnRefocus();
		}
	});

	var isDeleteModalHidden = false;
	autosize($('#editor'));
	// NJ-279: chatbox editor keypress events
	$(document).on('keypress','#editor', function (event) {
		// check on KEYPRESS if delete msg modal is hiddden
		isDeleteModalHidden = $("#dialog_chat_msg-delete:visible").length == 0 ? true : false;
		if (!isDeleteModalHidden) {
			// if delete modal is shown disable keyboard keys 
			event.preventDefault();
			return false;
		} else {
			if (event.keyCode == 13 && !event.shiftKey) { 
				$('#text_chat_submit').click(); 
				event.preventDefault(); // fix automatic nextline
			}
		}
	});

	// NJ-279: chatbox editor keyup events
	$(document).on('keyup','#editor', function(e){
		var CTRL_KEYCODE = 17,
			MAC_CMD_LEFT_KEYCODE = 91,
			MAC_CMD_RIGHT_KEYCODE = 93,
			BACKSPACE_KEYCODE = 8,
			DELETE_KEYCODE = 46,
			LETTER_B_KEYCODE = 66;

		// check on keyup if delete msg modal is hidden
		isDeleteModalHidden = $("#dialog_chat_msg-delete:visible").length == 0 ? true : false;
		if (!isDeleteModalHidden) {
			// if delete modal is shown disable keyboard keys
			e.preventDefault();
			return false;
		}

		// if #editor contenteditable is empty
		if ($(this).text() == '') { 
			// arrow up key is clicked
			if (e.which == 38) {
				e.preventDefault();
				// NJ-3125 - get the last msg of teacher
				if ($("#textchat_area > .t_txt :last").length !== 0) {

					// if msg was a correction, trigger editing of correction modal
					if (
						typeof $("#textchat_area > .t_txt :last .cnt-sentence .correct") !== "undefined"
						&& $("#textchat_area > .t_txt :last .cnt-sentence .correct").text() !== ""
					) {
						$("#textchat_area > .t_txt :last .chat_menu-edit-correction").click();
					
					// else msg was a normal or commented msg, trigger editing msg
					} else {
						$("#textchat_area > .t_txt :last .chat_menu-edit").click();
					}
				}

			} else if (e.keyCode == BACKSPACE_KEYCODE || e.keyCode == DELETE_KEYCODE) {
				// make sure to set it empty
				$(this)[0].innerText = '';

				// NOTE: DO NOT REMOVE THIS LINE, this is used for the queryCommandState to function correctly
				document.execCommand('insertHTML', false, $(this).text().replace(/\n/gi, ''));

				// unset strikethrough
				if (document.queryCommandState('strikeThrough')) {
					$('#addStrike').click();
				}

				// unset bold
				if (document.queryCommandState('bold')) {
					$('#addBold').click();
				}
				
				// reset active text formatting buttons
				$('#addBold, #addStrike, #replyBold, #replyStrike, .btn-color').removeClass('on');
				eventCommon.setClassOn('#addColorBlack'); 
			
			// pressed shortcut key for bold (Ctrl/Command + B)
			} else if (e.keyCode == CTRL_KEYCODE || e.keyCode == MAC_CMD_LEFT_KEYCODE || e.keyCode == MAC_CMD_RIGHT_KEYCODE || e.keyCode == LETTER_B_KEYCODE) {
				eventCommon.boldIconIndicator();
			}

		} else {
			// if using arrow keys or backspace/delete key
			if (e.keyCode >= 37 && e.keyCode <= 40 || e.keyCode == BACKSPACE_KEYCODE || e.keyCode == DELETE_KEYCODE) {
				eventCommon.handleTextSelection(); 

			// pressed shortcut key for bold (Ctrl/Command + B)
			} else if (e.keyCode == CTRL_KEYCODE || e.keyCode == MAC_CMD_LEFT_KEYCODE || e.keyCode == MAC_CMD_RIGHT_KEYCODE || e.keyCode == LETTER_B_KEYCODE) {
				eventCommon.boldIconIndicator();
			}
		}

		// don't allow italic and underline shortcut keys
		if (
			((e.keyCode == CTRL_KEYCODE || e.keyCode == MAC_CMD_LEFT_KEYCODE || e.keyCode == MAC_CMD_RIGHT_KEYCODE) || e.keyCode == 73) // (Ctrl/Command + I)
			|| ((e.keyCode == CTRL_KEYCODE || e.keyCode == MAC_CMD_LEFT_KEYCODE || e.keyCode == MAC_CMD_RIGHT_KEYCODE) || e.keyCode == 85) // (Ctrl/Command + U)
		) {
			eventCommon.dontAllowItalicAndUnderline();
		}

		autosize.update(this);
		onChangeText();
	});

	/* catch when the chat_submit is clicked */
	// NJ-279: send the message event
	$(document).on('click','#text_chat_submit', function(){
		/* check if disabled */
		if ($(this).hasClass('disabled')) { return; }

		// if has n chivox reading result
		if (chivoxReadingCount  >= 1 && $('.reading_chivox_preview').length >= 1) {
			sendChivoxReadingResult();
		}

		// if has a chivox question result
		sendChivoxQuestionResult();

		// if has an attached file
		if (tempFileContainer.length  >= 1) {
			uploadAttachFile(0);
		}
		
		// if text_chat's value is not a textbook selection (JSON), get the chatbox value
		if (!eventCommon.isJSON($('#text_chat').val())) {
			$('#text_chat').val($('#editor').html());
		}

		var input_text = $('#text_chat').val(); // hidden textarea
		var msg_chat_id = $(this).attr('data-chatid');
		var comment_chat_id = $(this).attr('data-commentChatId');
		var isEditingMsgComment = $(this).attr('data-editingMsgComment');
		var modified_chat = null, comment = null, correctChat = null, modified_chat_id = null;
		temp_id = moment().valueOf();
		isEditingMsgComment	 = (typeof isEditingMsgComment !== 'undefined' && isEditingMsgComment === 'true') ? true : false;
 		
 		// disallow sending of empty msg
 		if (input_text.length === 0 && editMessage == '') { 
			return false;
		// not empty (new msg/comment msg)
		} else {
			// filter msg
			input_text = eventCommon.filterNextLineOfMsg(input_text);
		}

		// for commenting of messages
		if (typeof comment_chat_id != "undefined" && comment_chat_id && !isEditingMsgComment) {
			var target = $(this).closest('.textchat_form_inner');
			var quote = $('#chat-msg-quote', target).html();
			var isEdited = $('#chat-msg-quote', target).attr('data-is-edited');
			quote = eventCommon.removeSpanTagEdited(quote);
			
			temp_id = comment_chat_id;
			modified_chat = isEdited;
			comment = input_text;
			input_text = quote;
			correctChat = null;

			// disallow sending of empty comments 
			if (eventCommon.isMsgEmptyOrSpacesOrNewlines(comment) === true){
				return false;
			}
			
			// if comment is not from choosing textbook
			if (!eventCommon.isJSON(comment) && comment.length > 0) {
				// if comment message length is more than 1000
				if (comment.length > 1000) {
					alert('Please check the following contents. \n\n The message exceeds 1,000 characters including HTML tags. \nPlease shorten your message.');
					return false;
				}
			}

		// for creating or editing a normal or commented msg
		} else {
			if (editMessage !== '') {
				modified_chat_id = msg_chat_id;
				
				// if editing a message with comment
				if (isEditingMsgComment) {
					modified_chat_id = comment_chat_id;
					input_text = eventCommon.convertCommentColorToBlackOrWhite(input_text, false);
				} 

				if (editMessage === input_text) {
					modified_chat = false;
					$('#editor').focus();
					return false;

				// when edited message is totally erased
				} else if (input_text == false) { 
					// check if red x button for editing is present on the chatbox
					if ($('.btn-cancel-area #btn_cancel').length == 1) {
						// show delete modal for the deleting of edited msg
						setTimeout(function() {
							$('#deleteMessageButton').attr('data-chatid', modified_chat_id);
							$("#text_chat").blur();
							$('.chat_msg').hide();
							$("#trigger_modal_chat_msg-delete").click();
						}, 300);
					}
				} else {
					modified_chat = true;
				}
				temp_id = modified_chat_id;
				editMessage = '';
			}

			/* disallow sending of unedited or empty msg*/
			if (modified_chat === false || eventCommon.isMsgEmptyOrSpacesOrNewlines(input_text) === true){
				return false;
			}

			// if not from teacher chose a textbook
			if (!eventCommon.isJSON(input_text)) {
				// if character length is greater than 1000
				if (input_text.length > 1000) {
					alert('Please check the following contents. \n\nThe message exceeds 1,000 characters including HTML tags. \nPlease shorten your message.');
					return false;
				}
			}
		}

		// NJ-16457
		if (typeof isLessonTutorial != "undefined" && isLessonTutorial == true) {
			var t_txt_chat = 	'<div class="chat_txt t_txt t_side">';
			t_txt_chat +=			'<span class="cnt-sentence">'+input_text+'</span>';
			t_txt_chat += 		'</div>';

			addIM(t_txt_chat, true);
		} else {
			sendMessage(input_text, modified_chat, temp_id, false, comment, correctChat, isEditingMsgComment, false);
		}
		
		setTimeout(function() { 
			autosize.update($('#editor'));
		}, 1);

		eventCommon.resetEditorToDefault();

		// perform toggle only if commenting and after editor reset
		if (typeof comment_chat_id != "undefined" && comment_chat_id && !isEditingMsgComment) {
			toggleChivoxResultCopyButton();
		}

		// reset fields and button default state
		if (tempFileContainer.length  <= 0) {
			onChangeText();
		}

		resetReplyBtn();
		closeOtherBox(this);
	});

	// NJ-279: Editing of a selected message 
	$(document).on('click', '.chat_menu-edit', function () {
		// clear and hide chat menu dropdown
		$('.chat_menu_wrap').hide();
		eventCommon.resetEditorToDefault();

		var sc = $(this).closest('.t_txt');
		msg = $('.cnt-sentence', sc).html();
		msg_temp_id = $('.cnt-sentence', sc).attr('id');
		comment = $('.contents', sc).html();
		comment_temp_id = $('.contents', sc).attr('id');

		// enable coloring buttons if currently disabled
		$('.btn-add-color').removeClass('disable');

		// check if editing is for a comment or normal msg
		if (typeof comment_temp_id !== 'undefined') {
			// NJ-3065 - disable coloring buttons if editing a commented msg
			$('.btn-add-color').addClass('disable');

			comment = eventCommon.convertCommentColorToBlackOrWhite(comment, true);
			text = comment;
			$('#text_chat_submit').attr('data-editingMsgComment', true);
			$('#text_chat_submit').attr('data-commentChatId', comment_temp_id);
		} else {
			text = msg;
			$('#text_chat_submit').attr('data-chatid', msg_temp_id);
		}

		text = eventCommon.removeSpanTagEdited(text);

		// if user used style formatting functions and did'nt manually typed HTML tags on his msg
		if (text.match("/&amp;|&lt;|&gt;|&quot;|&#039;|&nbsp;/gi") == null) {
			// show original msg of user by escaping then decoding the text
			text = eventCommon.decodeHtml(eventCommon.escapeHTML(text));
		}

		text = eventCommon.removeAnchorTag(text);

		sentence = editMessage = text;
		$('#editor').html(text).focus();
		autosize.update($('#editor'));

		// show cancel btn
		$("#btn-cancel-area").removeClass("hide");
		eventCommon.setCaretPositionToLastChar();

		// show cancel btn
		$("#btn-cancel-area").removeClass("hide");
		$("#trigger-style-box").addClass("hide");
		$("img", "#btn-cancel-area").attr("src", "/images/chat/close.svg");

		// hide replybox if shown
		if (!$('#reply-box').is(':hidden')) {
			$('#reply-box').removeClass('show').slideToggle(400);
			styleText();
		}
	});

	// NJ-279: Commenting of a selected message
	$(document).on('click', '.chat_menu-comments', function () {
		// clear and hide chat menu dropdown
		$('.chat_menu_wrap').hide();
		eventCommon.resetEditorToDefault();

		var target = $(this).closest('.chat_txt');
		var msg = $('.cnt-sentence', target).html(); 
		var msg_tempId = $('.cnt-sentence', target).attr('id');
		var comment = $('.contents', target).html();
		var comment_temp_id = $('.contents', target).attr('id');
		var hasCorrectionComment = $('.cnt-sentence', target).attr('data-hasCorrectionComment');
		var temp_id = msg_tempId;
		var text = "";
		
		// comment on correction msg
		if (typeof hasCorrectionComment != "undefined") {
			// correction msg with comment
			if (hasCorrectionComment == "true") {
				comment = eventCommon.convertCommentColorToBlackOrWhite(comment, true);
				text = comment;
				temp_id = comment_temp_id;
			// correction msg without comment
			} else {
				text = $('.cnt-sentence', target).html();
			}

		// comment on normal msg
		} else {
			// normal msg with comment
			if (typeof comment != "undefined") {
				comment = eventCommon.convertCommentColorToBlackOrWhite(comment, true);
				text = comment;
				temp_id = comment_temp_id;
			// normal msg without comment
			} else {
				text = msg;
			}
		}
		
		var isEdited = (text.toLowerCase().indexOf(spanTagEdited) >= 0) ? true : false;
		text = eventCommon.removeSpanTagEdited(text);

		// qoute the message for commenting
		$("#chat-msg-quote").attr("data-is-edited", isEdited ).html(text);
		if ($('#reply-box').is(':hidden')) {
			$('#reply-box').addClass('show').slideToggle(400);
		}
		
		$('#text_chat_submit').attr('data-commentChatId', temp_id);
		$('#editor').empty().focus();

		// show cancel btn
		toggleChivoxResultCopyButton();
		$('.btn-hide').hide();
		styleText();
		closeOtherBox(this);
	});

	// NJ-279: Correction menu is clicked, set the correction modal values
	$(document).on('click', '.chat_menu-correct, .btn-area-left .btn-correct', function (e) {
		e.preventDefault();
		e.stopPropagation();
		clearCorrectionMessageModalValues();

		var target = $(this).closest('.chat_txt');
		var msg = $('.cnt-sentence', target).html(); 
		var comment = $('.contents', target).html();
		var msg_tempId = $('.cnt-sentence', target).attr('id');
		var text = "";

		// if creating a new correction, enable editing of orig msg textarea
		if ($(this).hasClass('btn-correct') == true) {
			$('#dialog_correction #modal-original-msg').removeAttr("readonly");
			
		// if correcting a selected msg
		} else {
			// check if msg to be corrected has a comment
			if (typeof comment !== "undefined" && comment !== "") {
				var comment_temp_id = $('.contents', target).attr('id');
				temp_id = comment_temp_id;
				text = setCorrModalTextareaValues(comment);
			} else {
				temp_id = msg_tempId;
				text = setCorrModalTextareaValues(msg);
			}
		}

		text = eventCommon.removeAnchorTag(text);

		// if text have HTML entities, process it, then show plain texts only on the correction modal
		if (text.match("/&amp;|&lt;|&gt;|&quot;|&#039;|&nbsp;/gi")) {
			text = eventCommon.decodeHtml(text); // decode HTML entities and convert to HTML tags
		}

		// remove HTML tags, get the plain text only and trim
		text = eventCommon.removeHtml(text).trim();

		// set the correction modal values
		$('#modal-correction-submit-btn').attr('data-chatId', temp_id);

		if (text !== '') { // has selected message
			$('#modal-original-msg').val(text); 
			$('#modal-correction-msg').focus();
		} else { // no selected message
			$('#modal-original-msg').focus();
		}
		// show modal
		$('#trigger_modal_correction').click();
	});	

	// NJ-279: Editing of correction message
	$(document).on('click', '.chat_menu-edit-correction', function () {
		var sc = $(this).closest('.chat_txt');
		var mistake_msg = $('.mistake', sc).html();
		var correct_msg = $('.correct', sc).html();
		var comment_msg = $('.contents', sc).html();
		var msg_tempId = $('.cnt-sentence', sc).attr('id');
		comment_msg = (typeof comment_msg !== 'undefined') ? comment_msg : null;
		temp_id = msg_tempId;

		mistake_msg = setCorrModalEditingValues(mistake_msg);
		correct_msg = setCorrModalEditingValues(correct_msg);

		if (comment_msg !== null) {
			var comment_temp_id = $('.contents', sc).attr('id');
			temp_id = comment_temp_id;
			comment_msg = setCorrModalEditingValues(comment_msg);
		}

		// set the correction modal values
		$('#modal-correction-submit-btn').attr({'data-chatid': temp_id, 'data-isEditingCorrection': true});
		$('#modal-original-msg').val(mistake_msg); 
		$('#modal-correction-msg').val(correct_msg).attr('data-correction-msg', correct_msg).focus();
		$('#modal-comment-msg').val(comment_msg).attr('data-comment-msg', comment_msg);
		// show modal
		$('#trigger_modal_correction').click();
	});

	// NJ-279: Correction message submit/send and save
	$('#modal-correction-submit-btn').on('click', function (e) {
		e.preventDefault();
		let modified_chat = delete_chat = isEditingMsgComment = isEditingMsgCorrection = false;
		let isEditingCorrection = $(this).attr('data-isEditingCorrection');
		
		// values before edit
		let correction_msg_bfor = $('#modal-correction-msg').attr('data-correction-msg') != undefined ? $('#modal-correction-msg').attr('data-correction-msg') : 'null';
		let comment_msg_bfor = $('#modal-comment-msg').attr('data-comment-msg') != undefined ? $('#modal-comment-msg').attr('data-comment-msg') : 'null';
		correction_msg_bfor = correction_msg_bfor.trim();
		comment_msg_bfor = comment_msg_bfor.trim();
		comment_msg_bfor = (comment_msg_bfor == 'null') ? null : comment_msg_bfor.trim();
		
		// values after editing
		let original_msg = $('#modal-original-msg').val().trim();
		let correction_msg = $('#modal-correction-msg').val().trim();
		let comment_msg = $('#modal-comment-msg').val();
		comment_msg = (comment_msg == '') ? null : comment_msg.trim();
		
		// if editing correction, get the temp_id
		if (typeof isEditingCorrection != 'undefined' && isEditingCorrection == 'true') {
			// return if no changes at all
			if (
				(correction_msg_bfor == correction_msg && comment_msg_bfor == comment_msg)
			) {
				alert("Please make some changes."); return;
			}
			temp_id = $(this).attr('data-chatid');
			modified_chat = true;
			isEditingMsgComment = (comment_msg_bfor !== comment_msg) ? true : false;
			isEditingMsgCorrection = (correction_msg_bfor !== correction_msg) ? true : false;

		// if not editing, create a new tempId
		} else {
			var temp_id = moment().valueOf();
		}

		original_msg = replaceTextareaNewlineToHtmlBr(original_msg); 
		correction_msg = replaceTextareaNewlineToHtmlBr(correction_msg); 
		comment_msg = (comment_msg !== null) ? replaceTextareaNewlineToHtmlBr(comment_msg) : comment_msg;

		// check if original msg is empty
		if (eventCommon.isMsgEmptyOrSpacesOrNewlines(original_msg)) {
			alert("Please input the original sentence that you want to correct."); 
			$('#modal-original-msg').focus();
			return;
		// check if correction msg is empty or equal to original sentence
		} else if (
			eventCommon.isMsgEmptyOrSpacesOrNewlines(correction_msg)
			|| correction_msg == original_msg
		) { 
			alert("Please correct the mistake of the sentence properly."); 
			$('#modal-correction-msg').focus();
			return;
		} else if (isAddedSpaceOrNewlineAtEndOfMsg(original_msg, correction_msg)) {
			alert("Please add a correction of the sentence properly."); 
			$('#modal-correction-msg').focus();
			return;
		} else if (comment_msg !== null && eventCommon.isMsgEmptyOrSpacesOrNewlines(comment_msg)) {
			alert("Please input a valid correction comment."); 
			$('#modal-comment-msg').focus();
			return;
		} else {
			// set data for APP side
			let mistakeArr = strSplitBySpace(original_msg);
			let correctArr = strSplitBySpace(correction_msg);
			let commonWords = getCommonWords(correctArr, mistakeArr);

			original_msg = colorBlackSameWords(commonWords, mistakeArr);
			correction_msg = colorBlackSameWords(commonWords, correctArr);

			sendMessage(original_msg, modified_chat, temp_id, delete_chat, comment_msg, correction_msg, isEditingMsgComment, isEditingMsgCorrection);
			clearCorrectionMessageModalValues();
		}
	});

	// NJ-279: Correction message modal, copying button
	$(document).on('click', '#original-msg-copy-btn', function (e) {
		e.stopPropagation();
		var sc = $(this).closest('.contents');
		var original_msg = $('#modal-original-msg', sc).val();
		$('#modal-correction-msg').val(original_msg).focus(); 
	});

	// NJ-279: Correction modal input fields settings
	$(document).on('keypress', '#modal-original-msg, #modal-correction-msg, #modal-comment-msg', function (e) {
		// disable inputting of keys "<" and ">" to avoid manual HTML tag typing
		if (e.keyCode == 60 || e.keyCode == 62) {
			e.preventDefault();
		}
	});

	// NJ-279: Cancel button is clicked on correction message modal
	$(document).on('click','#modal-correction-cancel-btn', function(){
		clearCorrectionMessageModalValues();
	});
	
	// NJ-279: X button is clicked when editing or commenting of message
	$(document).on('click','.btn-cancel-area #btn_cancel, #trigger-reply-icon', function(){
		let isCloseReply = false;
		editMessage = '';

		if ($(this).hasClass('btn-reply')) {
			isCloseReply = true;
		}

		eventCommon.resetEditorToDefault(isCloseReply);
		toggleChivoxResultCopyButton();

		// show cancel btn
		resetReplyBtn();
		styleText();
		closeOtherBox(this);
		onChangeText();
	});

	// NJ-279: Front-end emoji bug fix
	$(document).on('click', '.emoticons-box-inner', function() {
		let selParentNode = window.getSelection().focusNode.parentNode.id;
		if (selParentNode !== "editor") {
			$("#editor").focus();
			eventCommon.setCaretPositionToLastChar();
			eventCommon.handleActiveStylesOnRefocus();
		}
	});

	// NJ-279: chat menu correct btn
	$(document).on('click', '.chat_menu-correct', function (e) {
		$('#modal-original-msg').removeAttr('style');
		$('#modal-original-msg').attr('readonly', true);
	});

	// NJ-279: correct btn
	$(document).on('click', '.btn-correct', function(){
		$('#modal-original-msg').css({
			'cursor':'auto',
    		'resize':'auto'
		});
		$('#modal-original-msg').attr('readonly', false);
	});
	
	eventCommon.memberType = "teacher";
	chatInitialization(0);

	// prevent page from redirecting
	$("html").on({
    	dragover:  function(e) { e.preventDefault(); e.stopPropagation(); },
    	drop:  function(e) { e.preventDefault(); e.stopPropagation(); }
	});
    $("body").on('dragenter', '.textchat_area_wrap', function (e) { e.stopPropagation();  e.preventDefault(); });
    $("body").on('dragover', '.textchat_area_wrap', function (e) { e.stopPropagation(); e.preventDefault(); });
    $('body').on('drop', '.textchat_area_wrap', function (e) {
        e.stopPropagation();
        e.preventDefault();
    	if (!enableFileUpload || corporateIdsDisabledFileUpload) {
    		return;
    	}
        // validate files
        var dropFiles = e.originalEvent.dataTransfer.files;
		var total_file = dropFiles.length;
		$('#dialog_invalid_files .upload-error').hide();
		// if overall upload more than 10 files
		if ((total_file + tempFileContainer.length)  > maxFileCount) {
			$('#dialog_invalid_files .error-upload-count').show();
			$('#trigger_dialog_invalid_files').click();
			return;
		}
		$.each(dropFiles, function( idx, dfile ) {
			// if file size is more than 5 mb
			if ((dfile.size/1000000) > maxUploadsize) {
				$('#dialog_invalid_files .error-upload-size').show();
				$('#trigger_dialog_invalid_files').click();
				return;
			}
			// if file has an invalid format
			var fileExt = dfile.name.split('.').pop().toLowerCase();
			if (jQuery.inArray(fileExt, allowFiles ) == -1) {
				$('#dialog_invalid_files .error-file-type').show();
				$('#trigger_dialog_invalid_files').click();
				return;
			}
			if ($('.file_preview_wrap img[alt="'+ dfile.name +'"]').length == 0) {
				tempFileContainer.push(dfile);
			}
		});
		// preview selected files
		fileUploadPreview();
		onChangeText();
    });

    // initial file drop area
    $("body").on('click', '.label-file', function (e) {
    	//NJ-279: Hide emoticon box when adding a file/photo
		$('#emoticons-box').hide();

		if ($('img.clicked', this).length == 0) {
			if (tempFileContainer.length == 0) {
				$('.file_preview_wrap').remove();
				$('.textchat_area_wrap').prepend('<div class="file_preview_wrap"><label class="label-dropfile"><div class="design-drop-here"><div class="design-icon-file"><img src="https://nativecamp.net/user/webroot/images/chat/gallery_m.svg" alt="" style="width:40%!important"></div><div class="design-text"><p>Please drop files here or select <br/>files from folder.</p></div></div></label></div>');
				var fileUPloadbtn = "<div class='file_upload_button_wrap'>";
					fileUPloadbtn += "</div>";
				$('.file_preview_wrap').append(fileUPloadbtn);
			}
			// after clicking add attachment, retain and apply active text styles
			eventCommon.handleActiveStylesOnRefocus();
			changeIconFile();
			closeOtherBox(this);
		} else {
			cancelAttachFile();
			onChangeText();
		}
    });

    // NJ-279: Translation of normal message and instant message
	$(document).on('click', '.message_translate_trigger, .instant_msg_translate_trigger', function(){
		var trigger = $(this);
		var target = $(this).closest('.chat_txt');
		var messageType = (trigger.hasClass('message_translate_trigger') == true) ? 'message_translate_trigger' : 'instant_msg_translate_trigger';
		var text = '', temp_id = '';
		var option = {};

		if (messageType == 'message_translate_trigger') {
			text = $('.cnt-sentence', target).text();
			text = eventCommon.removeSpanTagEdited(text);
			temp_id = $('.cnt-sentence', target).attr('id');

		} else if (messageType == 'instant_msg_translate_trigger') {
			text = $('.desc_wrap', target).text();
		}

		option = {
			text: text,
			language: 'en'
		}

		// click limit to one
		trigger.removeClass(messageType);

		$.ajax({
			type: 'POST',
			data: option,
			url: '/teacher/Api/translateText', // API URL
			success: function(res){
				if (res == false) {
					return res;
				}

				var chatTxt = trigger.closest('.chat_txt'); 
				$('.chat_menu-translate', chatTxt).remove();
				
				if (messageType == 'message_translate_trigger') {
					// identify if msg to be translated is from student
					var sender_class = (target.hasClass('t_txt')) ? 't_txt' : 's_txt';
					$('<div class="chat_txt ' + sender_class + ' t_side translated"><span class="cnt-sentence">' + res + '</span></div>').insertAfter(target);

				} else if (messageType == 'instant_msg_translate_trigger') {
					// inserting translation next to the original message
					$('<div class="chat_txt info_txt translated"><div class="desc_wrap">' + res + '</div></div>').insertAfter(target);
				}

				target.addClass('translated');
				target.find(".btn_chat_menu.chat_translate_trigger").remove();
 
				eventTeacher.scrollToLatestMsg();
			},
			error: function(res) {
				target.find(".btn_chat_menu.chat_translate_trigger").remove();
			}
		});
	});

	// NJ-279: Translation of correction message and commented message
	// - correction message data ( correct text and correction comment )  
	// - commented message data ( main message and message comment )
	$(document).on('click', '.correction_or_comment_translate_trigger', function(e){
		e.preventDefault();
		var trigger = $(this);
		var target = trigger.closest('.chat_txt');
		var temp_id = $('p.contents', target).attr('id');
		var message_text = $('div.cnt-sentence p.correct', target).text();
		var comment_text = $('div.comments-area p.contents', target).text();
		var is_comment_on_corr_without_comment = $('.comments-area', target).attr('data-isCommentOnCorrWithoutComment');
		var is_not_correction_msg = false;

		// click limit to one
		trigger.removeClass('correction_or_comment_translate_trigger');
		
		// if translation is not for correction message
		if (typeof message_text === "undefined" || message_text === '') {
			is_not_correction_msg = true;
			message_text = $('.cnt-sentence', target).text();
		}

		// if correction message doesn't have a temp_id because has no comment
		if (!is_not_correction_msg && typeof temp_id === 'undefined') {
			// get temp_id on main msg
			temp_id = $('div.cnt-sentence', target).attr('id');
			comment_text = null;
		}

		message_text = eventCommon.removeSpanTagEdited(message_text);
		var message = {
			text: message_text,
			language: 'en'
		};
		
		if (comment_text !== null) {
			comment_text = eventCommon.removeSpanTagEdited(comment_text);
			var comment = {
				text: comment_text,
				language: 'en'
			};
		}

		$.ajax({
			type: 'POST',
			data: message,
			url: '/teacher/Api/translateText', // API URL
			success: function(res){
				if (res == false) {
					return res;
				}
				// check if msg to be translated is from student
				var sender_class = (target.hasClass('t_txt')) ? 't_txt' : 's_txt';
				var result = '';
				if (is_not_correction_msg) {
					// if the msg that's been commented is a correction without comment
					var myRes = res;
					if (typeof is_comment_on_corr_without_comment !== "undefined" && is_comment_on_corr_without_comment === "true") {
						myRes = '<p class="correct">'+ res +'</p>';
					}
					result = $(`
						<div class="chat_txt ${sender_class} t_side corrected-txt translated">
							<div class="corrected-txt-inner">
								<span class="cnt-sentence" id="${temp_id}_translated_correction">
									${myRes}
								</span>
							</div>
						</div>
					`);

				} else {
					result = $(`
						<div class="chat_txt ${sender_class} t_side corrected-txt translated">
							<div class="corrected-txt-inner">
								<div class="cnt-sentence" id="${temp_id}_translated_correction">
									<p class="correct">${res}</p>
								</div>
							</div>
						</div>
					`);
				}

				// if msg has a comment, hide first, translate comment before showing
				result.insertAfter(target).hide();

				if (typeof comment !== 'undefined' && typeof temp_id !== 'undefined') {
					translateComment(comment, temp_id);
				}

				// show the result after comment translation has been appended
				setTimeout(function() {
					result.show();
				}, 600);

				target.find(".btn_chat_menu.chat_translate_trigger").remove();
				target.addClass('translated');
 
				eventTeacher.scrollToLatestMsg();
			},
			error: function(res) {
				target.find(".btn_chat_menu.chat_translate_trigger").remove();
			}
		});
	});

	$(document)
	.off('click', '#dialog_this_is_live_lesson a.live_lesson_confirmation, #dialog_this_is_live_lesson div.live_lesson_confirmation')
	.on('click', '#dialog_this_is_live_lesson a.live_lesson_confirmation, #dialog_this_is_live_lesson div.live_lesson_confirmation', function() {
		if (
			typeof isLessonTutorial == "undefined" || 
			(typeof isLessonTutorial != "undefined" && isLessonTutorial == false)
		) { 
			setTimeout(function() {
				if(counselingFlag == 1 || customer_support_flg){
					$('#trigger_modal_requests_cfm_counselor_trigger_fetching').click();
				}else{
					$('#trigger_modal_requests_cfm').click();
				}
			}, 300);
		}
	});

	$(document).on('click', '#disable-vbg', function(){
		var isVbgCameraOn = ($('#btn-video_own').hasClass('on')) ? 1 : 0 ;
		var allowReplaceVbgImg = ($('#back_episode_image').length >= 1) ? true : false;
		$.ajax({
			type: "POST",
			cache: false,
			url: '/teacher/VirtualBg/updateVirtualBg',
			data: {
				vbg_id: 'vbg-none',
			},
			dataType: "json",
			success: function(data) {
				if (data.status){
					$('#modal-backdrop').hide()
					if (typeof allowSetBG != 'undefined'){
						allowSetBG = false;
					}

					if (data.status && allowReplaceVbgImg && (userSettingId != '0')) {
						if ((typeof allowSetBG != 'undefined') && (typeof data.content != 'undefined') && $.trim(data.content).length > 0) {
							$('#back_episode_image').attr({'src': data.content});
							allowSetBG = true;
							$("#btn-refresh").trigger("click");
						}
					}
					if(typeof swichVideoOwn == 'function'){
					   swichVideoOwn(isVbgCameraOn);
					}
				}
			}
		});
	})

	$('.btn_close_simple').on('click',function(){
		$('#modal-backdrop').hide();
		$('#modal_req_off_virtualbg_teacher').hide();
	})
	$('#modal-backdrop').on('click',function(){
		$('#modal-backdrop').hide();
		$('#modal_req_off_virtualbg_teacher').hide();
	})
});

/**
 * NJ-57907 - Change the behavior when teacher reloads the page
 */
document.addEventListener("DOMContentLoaded", () => {
	function kbReloadHandler(event){
		if(!event.key) { return; }

		// F5 || Command+R (Mac) or Control+R (Windows/Linux)
		if (
			event.key === 'F5'
			|| (
				event.key.toLowerCase() === 'r'
				&& (event.metaKey || event.ctrlKey)
			)
		) {
			event.preventDefault();
			document.getElementById('btn-refresh').click();
		}
	}

	// ~ NJ-57907 - Add KB Reload Handler to Page
	document.addEventListener('keydown', kbReloadHandler);

	// ~ NJ-57907 - Add Checker for Native iFrame Load to put KB Reload Handler
	var iframeChecker = setInterval(function(){
		var iframe = document.getElementById('textbook-iframe');
		if(iframe){
			var src = iframe.src;
			if (src && src.includes('connect_id=')) {
				iframe.addEventListener('load', function () {
					var iframeWindowDoc = iframe.contentWindow.document;
					iframeWindowDoc.addEventListener('keydown', kbReloadHandler);
				});
				clearInterval(iframeChecker);
			}
		}
	}, 500);
});

/**
 * this event will be triggered
 * hide illustration and show chatbox
 */
function showChatBox(){
	//hide illustration and show chatbox
	$("#chat_area_table").removeClass("standby");
	$("#chat_area_table").addClass("in-lesson");
	$("#teacher_ng_note").addClass("teacher_ng_note_hide");
	$('.chat-student-info-bar').css("display", "block");
}

/**
 * this event will be triggered
 * show illustration and hide chatbox
 */
function hideChatBox(){
	//hide illustration and show chatbox
	$("#chat_area_table").addClass("standby");
	$("#chat_area_table").removeClass("in-lesson");
	$("#teacher_ng_note").removeClass("teacher_ng_note_hide");
	$('.chat-student-info-bar').css("display", "none");
}

/*----------------------------------------------*/
// camera on
/*----------------------------------------------*/
function cameraOn(){
	$('#screen_obj_self_wrap').fadeIn(200);
	$('#switch_camera').addClass('on');
	eventCommon.toggleCamera('own',1);
}

/*----------------------------------------------*/
// camera off
/*----------------------------------------------*/
function cameraOff(){
	$('#screen_obj_self_wrap').fadeOut(200);
	$('#switch_camera').removeClass('on');
	eventCommon.toggleCamera('own',0);
}

/**
 * send message data
 */
function sendMessage(inputText, modifiedChat, tempId, deleteChat = false, comment = null, correctChat = null, isEditingMsgComment = false, isEditingMsgCorrection = false){
	if (inputText) {
		eventCommon.getUserID(function(cb){
			if (cb > 0) {
				getStudId = cb;
				connect.config.userID = getStudId;
				info = connect.config;
				// Save message correction
				if (correctChat !== null && correctChat.length > 0) {
					data = {
						message: inputText, 
						info: info, 
						modifiedChat: modifiedChat,
						tempId:  tempId, 
						deleteChat: deleteChat, 
						correctChat: correctChat,
						isEditingMsgCorrection: isEditingMsgCorrection,
						isEditingMsgComment: isEditingMsgComment,
						comment: comment
					};

				} else {
					// Save message with comment
					if (comment !== null && comment.length > 0) {
						data = {
							message: inputText, 
							info: info, 
							modifiedChat: false, 
							tempId: tempId, 
							deleteChat: deleteChat, 
							correctChat: correctChat,
							comment: comment = eventCommon.convertCommentColorToBlackOrWhite(comment, false),
							commentId : moment().valueOf()
						};

					// Save as normal message
					} else {
						data = {
							message: inputText, 
							info: info, 
							modifiedChat: modifiedChat, 
							tempId: tempId, 
							deleteChat: deleteChat, 
							correctChat: correctChat,
							comment: comment,
							isEditingMsgComment: isEditingMsgComment
						};
					}
				}
				eventCommon.sendMessage(data);
			}

			if (
				typeof isLessonTutorial != 'undefined' && 
				isLessonTutorial == true && 
				typeof correctMessageLessonTutotial != 'undefined' && 
				$.isFunction(correctMessageLessonTutotial)
			) {
				correctMessageLessonTutotial(inputText, correctChat, comment);
			}
		});
	}
}

/*----------------------------------------------*/
// btn video others (1: turn on, 0: turn off)
/*----------------------------------------------*/
function swichVideoOthers(val){
	if(val > 0) {
		$('#btn-video_others').addClass('on');
	} else {
		$('#btn-video_others').removeClass('on');
	}

	/* toggle camera */
	eventCommon.toggleCamera('other', val);
}

/*----------------------------------------------*/
// btn video own (1: turn on, 0: turn off)
/*----------------------------------------------*/
function swichVideoOwn(val){
	$('#own_video_wrap .videoWrap').hide();

	if (val > 0) {
		/* turn on own video */
		$('#btn-video_own').addClass('on');
		$('#own_video_wrap .ownVideo').show().addClass('on');
		// virtual background
		if (typeof allowSetBG !== "undefined" && allowSetBG) {
			$("#ownVideoCanvas").show();
			$("#ownVideo").hide();
		} else {
			$("#ownVideoCanvas").hide();
			$("#ownVideo").show();
		}
	} else {
		/* turn off own video */
		$('#btn-video_own').removeClass('on');
		$('#own_video_wrap .ownVideoAvatar').show();
		$("#ownVideoCanvas").hide();
	}

	if (typeof isLessonTutorial != 'undefined' && isLessonTutorial == true) {
		return;
	}
	eventCommon.toggleCamera('own',val);
}

// toggle video UI
/*----------------------------------------------*/
function updateAudioUI(type,volume) {
	var remove = volume > 50 ? 'level-low' : 'level-high';
	var add = volume > 50 ? 'level-high' : 'level-low';
	var volume_slider = type === 'own' ? "#volume_slider-own" : '#volume_slider-others';
	var volume_btn = type === 'own' ? "#btn-sound_own" : "#btn-sound_others";
	$(volume_btn).removeClass(remove).addClass(add);
	$(volume_slider).slider('value',volume);
	if (volume <= 1) {
		$(volume_btn).removeClass('on');
	} else if (volume > 1 && !$(volume_btn)[0].className.match('on')) {
		$(volume_btn).addClass('on');
	}
}

/*----------------------------------------------*/
// set sound others (volume value)
/*----------------------------------------------*/
function setSoundOthers(val){
	var btn = $('#btn-sound_others');

	// disable button
	btn.addClass('disabled');
	setTimeout(function(){ btn.removeClass('disabled'); }, 500);

	// if value is greater than 4
	if(val > 4){
		// turn on sound
		btn.addClass('on');

		// change volume level icon
		if(val > 50){
			btn.removeClass('level-low').addClass('level-high');

		// show high level icon
		} else {
			btn.removeClass('level-high').addClass('level-low');
		}

	// if disable
	} else {
		// turn off sound
		btn.removeClass('on');

		// save current value
		volume_others = $('#volume_slider-others').slider('value');
	}

	// set slider value
	$('#volume_slider-others').slider('value', val);

	// get slider value
	var volume_value = $('#volume_slider-others').slider('value');

	// change volume
	eventCommon.changeVolume('other',volume_value);

	// save cookie
	$.cookie('volume_others', val, { expires: 365 });
}

/*----------------------------------------------*/
// set sound own (volume value)
/*----------------------------------------------*/
function setSoundOwn(val, playing=false,status = 0){
	var btn = $('#btn-sound_own');

	// disable button
	if(playing) {
		if(status == 1) {
			btn.addClass('disabled');
		}
	} else {
		if(status == 1) {
			btn.removeClass('disabled');
		}
	}

	// if value is greater than 4
	if(val > 4){
		// turn on sound
		btn.addClass('on');

		// change volume level icon
		if(val > 50){
			btn.removeClass('level-low').addClass('level-high');

		// show low level volume
		} else {
			btn.removeClass('level-high').addClass('level-low');
		}

	// else disable
	} else {
		// turn off sound
		btn.removeClass('on');

		// save current value
		volume_own = $('#volume_slider-own').slider('value');
	}

	// set slider value
	$('#volume_slider-own').slider('value', val);

	// get slider value
	var volume_value = $('#volume_slider-own').slider('value');

	// change volume
	eventCommon.changeVolume('own',volume_value);

	// update teacher peer stream
	connect.updateTeacherPeerStream();

	// save cookie
	$.cookie('volume_own', val, { expires: 365 });
}

/**
 * enable/disable chat initialization
 */
function chatInitialization(enabled){
	enabled = (typeof enabled === 'undefined') ? 0 : enabled;
	enabled = isNaN(parseInt(enabled)) ? 0 : parseInt(enabled);

	/* if chat initialization is enabled */
	if (enabled !== 0) {
		/* set allow saving */
		if (typeof eventCommon.allowMessageSaving !== 'undefined') { eventCommon.allowMessageSaving = true; }

	/* else, disable chat boxes */
	} else {
		
	}
}

/*----------------------------------------------*/
// add instant message
/*----------------------------------------------*/
function addIM(str, html){
	/* check if empty */
	if(str.length === 0) {
		return false;
	}

	/* check if html */
	if (typeof html === 'undefined') {
		var strMsg = "";
		strMsg += '<div class="chat_txt info_txt">';
		strMsg += '	<div class="desc_wrap">';
		strMsg += '		<span class="cnt-sentence" style="color: blue;">';
		strMsg += 		str;
		strMsg += '		</span>';
		strMsg += '	</div>';
		strMsg += '	<div class="btn_chat_wrap">';
		strMsg += '		<a href="javascript:void(0);" class="btn_chat_menu chat_translate_trigger instant_msg_translate_trigger"><span class="tooltip">translate</span></a>';
		strMsg += '	</div>';
		strMsg += '</div>';
		str = strMsg;
	}

	/* append to chatbox */
	$('#textchat_area').append(str);

	/* scroll down */
	var obj = document.getElementById('textchat_area');
	if(!obj) return;
	obj.scrollTop = obj.scrollHeight;
}

function getRequest(data = null) {
	// ~ close avatar phrase modal if displayed
	if ($('#avatar_pet_phrases_modal').is(':visible')) {
		$(".btn_close", "#avatar_pet_phrases_modal").click();
	}

	var lessonOnairDetails = data != null ? data : JSON.parse(localStorage.getItem(chatHash));
	// lessonOnairDetails = lessonOnairDetails != null ? lessonOnairDetails : {};
	var requestOther = 'None';
	var tdSelfIntroduce = null;
	var tdPointingMistake = null;
	var tdSelfIntroducePin = null;
	var tdPointingMistakePin = null;
	var requestLessonOnChatBox = '';
	var lessonRequestSelfIntroduction = '<span class="c_red"><b>Need</b></span>';
	var lessonRequestIncorrectGrammar = '<span class="c_red"><b>Need</b></span>';
	var selfIntroduction = 'Need';
	var pointingMistake = 'Need';
	var selfIntroClass = 'true';
	var pointingMisstakeClass = 'true';
	var isChocottoCampLesson = typeof lessonOnairDetails.chocotto_camp_lesson_flg !== "undefined" && lessonOnairDetails.chocotto_camp_lesson_flg > 0;

	//TODO: NJ-42117 append user info on lesson request modal
	let studentProfile = lessonOnairDetails.studentImage;
	let studentName = lessonOnairDetails.studentName;
	let lessonCount = parseInt(lessonOnairDetails.studentLessonCount);
	let lastLessonDate = lessonOnairDetails.last_lesson_date !== 'None' && lessonOnairDetails.last_lesson_date !== 'undefined' ? moment(lessonOnairDetails.last_lesson_date).format("YYYY-M-D") : ' - ';
	// let lastLessonDate = new Date(lessonOnairDetails.last_lesson_date);
	
	$('#student_profile').attr('src', studentProfile);
	$('#student_name').text(studentName);
	$('#lesson_count').html(`<span class="lesson fw_b">Number of lesson with you : </span>${lessonCount}`);

	$('#last_lesson_date').html(`<span class="lesson fw_b">Last time : </span>${(lastLessonDate)}`);

	// for SELF-INTRODUCTION BEFORE THE LESSON
	if (typeof lessonOnairDetails.lessonRequestSelfIntroduction !== 'undefined') {
		// need
		if (lessonOnairDetails.lessonRequestSelfIntroduction == 1) {
			lessonRequestSelfIntroduction = '<span class="c_red"><b>Need</b></span>';
			selfIntroClass = "true";
			selfIntroduction = "Need";			
		// no need
		} else if (lessonOnairDetails.lessonRequestSelfIntroduction == 2) {
			lessonRequestSelfIntroduction = '<span class="c_blue"><b>No Need</b></span>';
			selfIntroClass = "false";
			selfIntroduction = "No Need";			
		}
	}
	// for POINT OUT ERRORS IN GRAMMAR AND PRONUNCIATION
	if (typeof lessonOnairDetails.lessonRequestIncorrectGrammar !== 'undefined') {
		// need
		if (lessonOnairDetails.lessonRequestIncorrectGrammar == 1) {
			lessonRequestIncorrectGrammar = '<span class="c_red"><b>Need</b></span>';
			pointingMisstakeClass = "true";
			pointingMistake = "Need";			
		// no need
		} else if (lessonOnairDetails.lessonRequestIncorrectGrammar == 2) {
			lessonRequestIncorrectGrammar = '<span class="c_blue"><b>No Need</b></span>';
			pointingMisstakeClass = "false";
			pointingMistake = "No Need";			
		}
	} 

	if (typeof lessonOnairDetails.lessonRequestOther !== 'undefined' && lessonOnairDetails.lessonRequestOther != '') {
		requestOther = formatRequestLessonMessageWithUrl(lessonOnairDetails.lessonRequestOther);
	}

	if(!isChocottoCampLesson) {
		requestLessonOnChatBox += '<div class="desc_wrap">';
		requestLessonOnChatBox += '<span class="desc_title">[Requests]</span><br>';
		if (lessonOnairDetails.lessonType == '1') {
			$('tr.request-lesson-time', '#dialog_request_cfm').removeClass('hide');
			requestLessonOnChatBox += 'Lesson Time: <b><span class="c_blue request-lesson-time">' + lessonOnairDetails.lessonRequestTime + ' minutes</span></b><br>';
		}
		requestLessonOnChatBox += 'Self-Introduction:'+ lessonRequestSelfIntroduction +'<br>';
		requestLessonOnChatBox += 'Pointing out mistakes:'+ lessonRequestIncorrectGrammar +'<br>';
		requestLessonOnChatBox += '<span class="request-other">Other requests：</span><br>';
		requestLessonOnChatBox += '<span class="request-other c_blue fw_b">' + requestOther + '</span>';
		requestLessonOnChatBox += '</div>';
	}

	$('#dialog_request_cfm .self-introduction').addClass(selfIntroClass);
	$('#dialog_request_cfm .self-introduction').text(selfIntroduction);
	$('#dialog_request_cfm .pointing-mistake').addClass(pointingMisstakeClass);
	$('#dialog_request_cfm .pointing-mistake').text(pointingMistake);

	$('#dialog_request_cfm #studentImage').attr('src', student_Image);	
	$('#dialog_request_cfm #nickname').text(student_Name);	
	$('#dialog_request_cfm #currentLessonHistoryCount').text(studentTeacherCurrentTotalNumberOfLessons);	
	$('#dialog_request_cfm #latestLessonData').text(studentTeacherLastLessonDate);	

	$('span.request-lesson-info-hide', 'div.lesson-student-init-info').replaceWith(requestLessonOnChatBox);
	$('.request').html(requestOther);

	//- for live reservation
	if (isLive) {
		$('#trigger_modal_this_is_live_lesson').click();
	} else {

		if(!isChocottoCampLesson) {
			if(counselingFlag == 1){
				$('#trigger_modal_requests_cfm_counselor_trigger_fetching').click();
			} else{
				// NJ-52159
				if(!isAllCheckedStudentRequestLesson || typeof isAllCheckedStudentRequestLesson === 'undefined') {
					$('#trigger_modal_requests_cfm').click();
				}
			}
		}
	}
	$('div#textchat_area', 'div.chat_area_cell').scrollTop(0);		

	// avoid fleckering if called multiple times (counseling)
	if (counselingFlag == 1) {
		$('#trigger_modal_requests_cfm').off('click');
		$('#trigger_modal_requests_cfm_counselor_trigger_fetching').off('click');
	}
}

function formatInqMessageWithUrl(message) {
	var dreturn = "";
	message = message.replace(/>/g, '> ');
	var data = message.split(/\n/);
	for (v = 0; v < data.length; v++) {
		var dataSplitted = data[v];
		//if(!/^<a/.test(dataSplitted)){
		var dataSplitted = dataSplitted.split(/\r/);
		var regex = /(http|https):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/;
		var datas = null;
		var string = null;
		for(i = 0; i < dataSplitted.length; i++) {
			datas = dataSplitted[i].split(' ');
			for(x =0; x < datas.length; x++){
				string = datas[x];
				if(!/^<a/.test(string) && /\a>$/.test(string) ){
					dreturn += ' '+ string.replace(/[&<>'"]/g,x=>'&#'+x.charCodeAt(0)+';');
				} else if (regex.test(string)) {
					var tmpString_i = string.replace(/^href|^for=|^id=|^class=|=|"|'|<|>/g,'');
					var tmpString_ii = "<a class='t_link' target='_blank' href='"+ tmpString_i +"'>"+ tmpString_i +"</a>";
					var prpHtml = string.replace(/[&<>'"]/g,x=>'&#'+x.charCodeAt(0)+';');
					dreturn += ' ' + prpHtml.replace(tmpString_i, tmpString_ii);
				} else {
					dreturn += ' '+ string.replace(/[&<>'"]/g,x=>'&#'+x.charCodeAt(0)+';');
				}
			}
		}
		dreturn += ' <br />';
	}
	return dreturn;
}

function formatRequestLessonMessageWithUrl(message) {
	var dreturn = "";
	var data = message.split(/\r?\n/);
	for(i = 0; i < data.length; i++) {
		datas = data[i].split(' ');
		for(x =0; x < datas.length; x++){
			stringdata = datas[x];
			stringdata = $('<div />').text(datas[x]).html();
			stringdata = stringdata.replace("&lt;br&gt;", '');
			stringdata = stringdata.replace(/((http|https):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?)/gi, "<a class='t_link' href='$1' target='_blank'>$1</a>");
			if(x == 0) {
				dreturn += stringdata;
			} else {
				dreturn += ' '+ stringdata;
			}
			
		}
		dreturn += '<br>';
	}
	return dreturn;
}

function textBookNameHtmlChatBox(requestTimeAjx = null){
	$('.lesson-student-init-info').nextAll().not(".callan_progress_chat").remove();
	$('span.request-lesson-textbook-nameEng, span.request-lesson-textbook-nameJpn, br.brTextbooknameEng, br.brTextbooknameJpn', 'div.lesson-student-init-info').addClass('hide');
	globalTextBookIds = angularApp.scope().globalTextbook;
	if (requestTimeAjx == null) {
		var studentLessonLocalizeDir = localStorage.getItem('lessonLocalizeDir');
		$.ajax({
			url: '/teacher/api/lessonOnAirRequestLessonTime?chat_hash='+chat_hash+'&studentLessonLocalizeDir='+studentLessonLocalizeDir,
			dataType: "json",
			type: 'get',
			success: function(res) {
				if ((typeof res.textBookNameEng != 'undefined') && res.textBookNameEng != null) {
					$('span.request-lesson-textbook-nameEng', 'div.lesson-student-init-info').removeClass('hide').html('Textbook: ' + res.textBookNameEng);
					$('br.brTextbooknameEng').removeClass('hide');
				}
				if ((typeof res.textBookName != 'undefined') && res.textBookName != null) {
					$('span.request-lesson-textbook-nameJpn', 'div.lesson-student-init-info').removeClass('hide').html('Textbook: ' + res.textBookName);
					$('br.brTextbooknameJpn').removeClass('hide');
				}

				if ( (typeof res.current_textbook_element != 'undefined') && res.current_textbook_element != null ) {

					if(globalTextBookIds.connect_id == null) {
						$('span#ongoing-textbook-selected').removeClass('hide').html(res.current_textbook_element);
					}else{
						$('span#ongoing-textbook-selected').removeClass('hide').html('<a href="javascript: void(0);" oncontextmenu="return false;" data-msgviewtextbook="'+ globalTextBookIds.connect_id +'">' + res.current_textbook_element +'</a>');
						$('a[data-msgviewtextbook="'+ globalTextBookIds.connect_id +'"]')
						.css('text-decoration', 'underline')
						.attr('onClick', 'msgViewTextbookFunc($(this))');
					}
				}

				// NJ-18780 : add local storage the connect id
				localStorage.setItem('ytTextBookConnectId', globalTextBookIds.connect_id);
			}
		});

	} else {
		
		if ((typeof requestTimeAjx.textBookNameEng != 'undefined') && requestTimeAjx.textBookNameEng != null) {
			if(globalTextBookIds.connect_id == null){
				$('span.request-lesson-textbook-nameEng', 'div.lesson-student-init-info').removeClass('hide').html('Textbook: ' + requestTimeAjx.textBookNameEng);
			}else{
				$('span.request-lesson-textbook-nameEng', 'div.lesson-student-init-info').removeClass('hide').html('Textbook: <a href="javascript: void(0);" oncontextmenu="return false;" data-msgviewtextbook="'+ globalTextBookIds.connect_id +'">' + requestTimeAjx.textBookNameEng +'</a>');
			}
			//
			$('br.brTextbooknameEng').removeClass('hide');
		}
		if ((typeof requestTimeAjx.textBookName != 'undefined') && requestTimeAjx.textBookName != null) {
			$('span.request-lesson-textbook-nameJpn', 'div.lesson-student-init-info').removeClass('hide').html('Textbook: ' + requestTimeAjx.textBookName);
			$('br.brTextbooknameJpn').removeClass('hide');
		}

		if ( (typeof requestTimeAjx.current_textbook_element != 'undefined') && requestTimeAjx.current_textbook_element != null ) {

			if(globalTextBookIds.connect_id == null) {
				$('span#ongoing-textbook-selected').removeClass('hide').html(requestTimeAjx.current_textbook_element);
			}else{
				$('span#ongoing-textbook-selected').removeClass('hide').html('<a href="javascript: void(0);" oncontextmenu="return false;" data-msgviewtextbook="'+ globalTextBookIds.connect_id +'">' + requestTimeAjx.current_textbook_element +'</a>');
			}
			
		}

		if(globalTextBookIds.connect_id != null){
			$('a[data-msgviewtextbook="'+ globalTextBookIds.connect_id +'"]')
			.css('text-decoration', 'underline')
			.attr('onClick', 'msgViewTextbookFunc($(this))');

			// NJ-18780 : add local storage the connect id
			localStorage.setItem('ytTextBookConnectId', globalTextBookIds.connect_id);
		}


	}
}

// file attachment - upload file to aws and get s3 urls
function uploadAttachFile(fileKey){
	$('.file-item-remove-btn').remove();
	$('.file-item-loader').show();
	$('#text_chat_submit').addClass('disabled');
	var attachedFiles = tempFileContainer;
	var fileCount = attachedFiles.length;
	var tempId = moment().valueOf();
	if (fileKey < fileCount) {
		if (maxTimeUpload == null && fileKey == 0) {
			maxTimeUploadChecker();
		}
		if ($('div#file-item-' + fileKey).length < 1) {
			uploadAttachFile((fileKey+1));
			return;
		}
	    var formData =  "";
	    formData = new FormData();
	    formData.append("attached_files", attachedFiles[fileKey]);
		uploadFileAjaxRequest = $.ajax({
			url : '/teacher/api/uploadAttachedFileToAWS',
			cache: false,
			contentType: false,
			processData: false,
			async: true,
			data: formData,
			type: 'POST',
		}).always(function(fileLink, status){
			if (status == 'success' && fileLink.replace(/\s/g, '') != '') {
				fileLink = fileLink.replace('https://', '');
				attachedFilesLink.push(fileLink);
				$('#file-item-' + fileKey + ' .file-item-loader').remove();
				uploadAttachFile((fileKey+1));					
			}
		});
	} else {	
		if (attachedFilesLink.length > 0) {
			clearTimeout(maxTimeUpload);
			maxTimeUpload = null;
			var objAtachedFilesLink = {"file":attachedFilesLink };
	 		objAtachedFilesLink = JSON.stringify(objAtachedFilesLink);
			$('#upload-file').val('');
			$('.file_preview_wrap').remove();
			$('#text_chat_submit').removeClass('disabled');
			$('#gallery-change').removeClass('clicked');
			attachedFilesLink = [];		
			tempFileContainer = [];	
			uploadFileAjaxRequest = null;
			var info = connect.config;
			var msgData = {message: objAtachedFilesLink, tempId: tempId, info, isTeacherFile: true};
			eventCommon.sendMessage(msgData);

			// resest fields and button default state
			onChangeText();
		}
		return;
	}
}

// file attachment - preview file before uplaoding
function fileUploadPreview(input) 
{	
	if (typeof tempFileContainer == "undefined" || tempFileContainer.length == 0) {
		return;
	}
	$('.file_preview_wrap').remove();
	$('.textchat_area_wrap').prepend('<div class="file_preview_wrap"><label class="label-dropfile"><i class="fa fa-plus"></i> Drop files here</label><br ><br ></div>');
	$.each(tempFileContainer, function( idx, file ) {
		var thumbFileSrc = URL.createObjectURL(file);
		var fileExt = file.name.split('.').pop().toLowerCase();
		if (jQuery.inArray(fileExt, isFilesDoc ) != -1) {
			thumbFileSrc = '/user/images/icon/thumb-'+ fileExt +'.png';
		} else if (jQuery.inArray(fileExt, isFilesVid ) != -1) { // if file is in video format
			thumbFileSrc = '/user/images/icon/thumb-video.png';
		} else if (jQuery.inArray(fileExt, isFilesAud ) != -1) { // if file is in audio format
			thumbFileSrc = '/user/images/icon/thumb-sound.png';
		}
		var filePreviewElm = "<div id='file-item-"+ idx +"' class='file-item pull-left'>";
			filePreviewElm += "<div class='preview-img-wrap'>";
			if (jQuery.inArray(fileExt, supportedFilesVid ) != -1) { // if file is in video format
				filePreviewElm += "<video id='file-item-video' src='"+ URL.createObjectURL(file) +"' width='170' height='85' muted style='transform:scale(2.5)'><p>"+ file.name +"</p></video>";
			} else {
 				filePreviewElm += "<img class='file-item-image' alt='"+ file.name +"' src='"+ thumbFileSrc +"'>";
			}
 			filePreviewElm += "</div>";
 			filePreviewElm += "<img class='file-item-loader' src='/user/images/icon/loader.gif'>";
 			filePreviewElm += "<button class='file-item-remove-btn' onclick='previewRemoveFile(this, "+ idx +")'><i class='fa fa-times' aria-hidden='true'></i></button>";
 			filePreviewElm += "</div";
  		$('.file_preview_wrap').append(filePreviewElm);
	});
}

// file attachment - remove certain file from the selection
function previewRemoveFile (elmt, arrID) {
	if ($('#file-item-'+ arrID).length > 0) {
		tempFileContainer.splice(arrID, 1);
	}
	$(elmt).closest('.file-item').remove();
	if ($('.file-item').length == 0 || tempFileContainer.length == 0) {
		$('.file_preview_wrap').remove();
		$('#upload-file').val('');
		$('#gallery-change').removeClass('clicked');
		tempFileContainer = [];
	} else {
		fileUploadPreview();
	}
	
	onChangeText();
}

// file attachment - cancel file uploading
function cancelAttachFile (elmt) {
	$('.file_preview_wrap').remove();
	$('#upload-file').val('');
	$('#text_chat_submit').removeClass('disabled');
	tempFileContainer = [];
	if(uploadFileAjaxRequest !== null && uploadFileAjaxRequest.readyState != 'undefined' && (uploadFileAjaxRequest.readyState > 0 && uploadFileAjaxRequest.readyState < 4)){
		uploadFileAjaxRequest.abort();
	}
	if (attachedFilesLink.length > 0) {
		$.ajax({
			url : '/teacher/api/uploadeCancelDeleteFile',
			data: {fileUrl:attachedFilesLink},
			type: 'POST',
		}).always(function(fileLink){});
	}
	attachedFilesLink = [];		
	uploadFileAjaxRequest = null;
	changeIconFile();
}

// file attachment - Expand image view
function viewExpandImagefileView (imgUrl) {
	var imgUrlExt = imgUrl.split('.').pop().toLowerCase();
	$('.video-target, .img-target').attr({'src':''}).hide();
	$('#forImageSpinner').hide();
	$('#imageSpinner').show();
	if (jQuery.inArray(imgUrlExt, supportedFilesVid) != -1) { // if file is in video format
	    $('#dialog_view_upload_image .video-target').attr('src', imgUrl).on('loadeddata', function() {
	        $('#imageSpinner').hide();
	        $('#forImageSpinner').show();
	    }).show();
	} else {
	    $('#dialog_view_upload_image .img-target').attr('src', imgUrl).on('load', function() {
	        $('#imageSpinner').hide();
	        $('#forImageSpinner').show();
	    }).show();
	}
	$('#dialog_view_upload_image .download-target').attr('href', '/teacher/Api/downloadChatLogFiles?file=' + imgUrl);
	$('#trigger_view_upload_image').click();
}

// file attachment - validate files
function fileUploadValidate(input) 
{	
	$('#dialog_invalid_files .upload-error').hide();
	var total_file=document.getElementById("upload-file").files.length;
	if ((total_file + tempFileContainer.length)  > maxFileCount) { // if overall upload more than 10 files
		$('#dialog_invalid_files .error-upload-count').show();
		$('#trigger_dialog_invalid_files').click();
		return;
	}
 	for(var i=0;i<total_file;i++)
 	{	
 		var fileExt = event.target.files[i].name.split('.').pop().toLowerCase();
 		// if file size is more than 5 mb
 		if ((event.target.files[i].size/1000000) > maxUploadsize) {
			$('#dialog_invalid_files .error-upload-size').show();
			$('#trigger_dialog_invalid_files').click();
			return;
		}
		// if file has an invalid format
 		if (jQuery.inArray(fileExt, allowFiles ) == -1) {
 			$('#dialog_invalid_files .error-file-type').show();
 			$('#trigger_dialog_invalid_files').click();
			return;
 		}
 		if ($('.file_preview_wrap img[alt="'+ event.target.files[i].name +'"]').length == 0) {
 			tempFileContainer.push(event.target.files[i]);
 		}
	}
	// preview selected files
	fileUploadPreview();
	onChangeText();
}

// cancel uploading process after 5 mins
function maxTimeUploadChecker () {
	maxTimeUpload = setTimeout(function(){
		$('#trigger_max_time_uplpoad').click();
		cancelAttachFile();
	}, 5 * 60 * 1000);
}

// check if appversion is not supported for file attachment
function fileUploadSupported (appType, appVer) {
	$('.file-select-div').show();
	var baseVer = null;
	if (appType == 'ios') {
		baseVer = '3.6.8';
	} else if (appType == 'android') {
		baseVer = '4.3.7';
	}
	baseVer = baseVer.split('.');
	appVer = appVer.split('.');
	for (var i = 0; i < appVer.length; i++) {
		var aVer = ~~appVer[i]; // parse int
		var bVer = ~~baseVer[i]; // parse int
		if (aVer > bVer) {
			enableFileUpload = true;
			return enableFileUpload;
		} 
		if (aVer < bVer) {
			enableFileUpload = false;
			$('.file-select-div').hide();
			return enableFileUpload;
		}
	}
	enableFileUpload = true;
	return enableFileUpload;
}

// check if appversion is not supported particular functions
function versionAppSupportChecker (checkerParams) {
	var appVersionMin 	= (typeof checkerParams.appVersionMin != 'undefined') ? checkerParams.appVersionMin : '0.0.0';
	var appVersionUse	= (typeof checkerParams.appVersionUse != 'undefined') ? checkerParams.appVersionUse : '0.0.0';	
	appVersionMin		= appVersionMin.split('.');
	appVersionUse 		= appVersionUse.split('.');
	for (var i = 0; i < appVersionUse.length; i++) {
		var aVer = ~~appVersionUse[i]; // parse int
		var bVer = ~~appVersionMin[i]; // parse int
		if (aVer > bVer) { return true; } 
		if (aVer < bVer) { return false;}
	}
	return true;
}
// P2P audio controll - notify teacher
function secondPlaySound (data) {
	// notify teacher wiht student's audio status
	if ( typeof data.button_type != 'undefined' ) {
		var audioNotifMessage = '';
		switch(data.button_type) {
			case 0: // Stop
				audioNotifMessage = '<span style="color:blue;">The audio is now stopped in the student side<span>';
				break;
			case 1: // Play
				audioNotifMessage = '<span style="color:blue;">The audio is now being played in the student side<span>';
				break;
			case 2: // Pause
				audioNotifMessage = '<span style="color:blue;">The audio is now paused in the student side<span>';
				break;
			case 3: // Replay
				audioNotifMessage = '<span style="color:blue;">The audio is now being replayed in the student side<span>';
				break;
			case 4: // Failed to Play/replay
				if (typeof newAudioButtontStatus != 'undefined') {
					if (newAudioButtontStatus == 1 || newAudioButtontStatus == 3) {
						audioNotifMessage = '<span style="color:red;">Unable to play audio in the student side. Please click play▶ again</span>';
					} else {
						audioNotifMessage = '<span style="color:red;">Unable to pause/stop audio in the student side</span>';
					}
				}
				break;
			case 5: // Finish Playing
				audioNotifMessage = '<span style="color:green;">The audio has finished playing in the student side.</span>';
				break;
			default:
				break;
		}

		if (typeof newAudioButtonTimer != 'undefined' && newAudioButtonTimer !== null) {
			clearTimeout(newAudioButtonTimer);
		}
		addIM(audioNotifMessage);
	}
}

$(function(){
	$(document).on('click', '#trigger-emoticons-box', function(){
		var range = $(this).closest('.textchat_form_inner');
		var target = $('.emoticons-box', range);
		
		if($(target).is(':hidden')){
			$('#editor').focus();
			$(target).slideDown(500, function(){
				$(document).on('click' ,function(e){
					if(!$(e.target).closest('.textchat_form_inner').length) {
						hideEmoticonBox();
					}
				});
			});
			$('#trigger-emoticons-box').addClass("clicked");
		}else{
			hideEmoticonBox();
		}

		closeOtherBox(this);
	});

	$('#addBold, #replyBold').click(function(){
		let id = $(this).attr('id');
		eventCommon.setClassOn('#'+id);
		doCmd('bold');
	});
	$('#addStrike, #replyStrike').click(function(){
		let id = $(this).attr('id');
		eventCommon.setClassOn('#'+id);
		doCmd('strikeThrough'); 
	});
	$('#addColorBlack, #replyBlack').click(function() {
		eventCommon.setClassOn('#addColorBlack');
		doCmd('foreColor', '#555556'); // hex color #555556 is implemented to solve style indicator bug
	});
	$('#addColorBlue, #replyBlue').click(function() {
		eventCommon.setClassOn('#addColorBlue');
		doCmd('foreColor', '#00acee'); 
	});
	$('#addColorRed, #replyRed').click(function() {
		eventCommon.setClassOn('#addColorRed');
		doCmd('foreColor', '#ff0000'); 
	});
	$(document).on('click','.doEmotion',function(){
		var emotion = $(this).text();
		doCmd('insertHTML', emotion); 
	});
	function doCmd(cmdId, param){
		document.execCommand (cmdId, false, param);
		// retain active text styles after on clicks
		eventCommon.handleActiveStylesOnRefocus();
	}
});

function msgViewTextbookFunc (elmt) {
	angularApp.scope().chatViewTextbook(elmt.attr('data-msgviewtextbook'));
}

/**
 * enable/disable camera toggle fucntion
 */
function cameraToggleSetting() {
	var cameraToggleFlagSessionKey = "camera_toggle_flg_" + chatHash;

	/* check if supported lesson for disable camera toggle feature */
	if ( typeof eventTeacher.appVersionSupportLogic !== 'undefined' && $.isFunction(eventTeacher.appVersionSupportLogic) ) {
		eventTeacher.appVersionSupportLogic(connect);
	}

	if ( !lessonDisableCameraToggle ) {
		studentCameraToggleFlag = 0;
		teacherCameraToggleFag = 0;
		sessionStorage.removeItem(cameraToggleFlagSessionKey);
		$('#btn-video_others, #btn-video_own').removeClass('camera-toggle-off');

	} else {	
		if (sessionStorage.getItem(cameraToggleFlagSessionKey)) {
			var cameraToggleFlagSession = JSON.parse(sessionStorage.getItem(cameraToggleFlagSessionKey));
			studentCameraToggleFlag = cameraToggleFlagSession.studentCameraToggleFlag;
			teacherCameraToggleFag = cameraToggleFlagSession.teacherCameraToggleFag;
		} else {
			sessionStorage.setItem(cameraToggleFlagSessionKey, JSON.stringify({
				'studentCameraToggleFlag' : studentCameraToggleFlag,
				'teacherCameraToggleFag' : teacherCameraToggleFag
			}));
		}
		// disable student's camera toggle
		if (studentCameraToggleFlag) {
			$('#btn-video_others').addClass('camera-toggle-off');
		}
		// disable teacher's camera toggle
		if (teacherCameraToggleFag) {
			$('#btn-video_own').addClass('camera-toggle-off');
		}		
	}
}

//NJ-10508
function startAudioAcquisition() {

	// ~ NJ-63913: If Audio Acquisition is disabled, return
	if(
		typeof audioAcquisitionFlag !== "undefined"
		&& !audioAcquisitionFlag // - if audio acquisition is disabled
	){
		return;
	}

	var totalAudioData = 0;

	var studentPercentage = 0;

	var teacherPercentage = 0;

	// - NJ-10636 : get local storage to check if 
	var youtubePlayerAcquisitionAllow = false;

	var localStorageYtAcquisition = localStorage.getItem('allowYoutubePlayerAcquisition');

	if (typeof localStorageYtAcquisition !== 'undefined'){
		youtubePlayerAcquisitionAllow = localStorageYtAcquisition;
	}


	// when the lesson has started
	if(lessonStatus == 3) {
		$('.rec_icon').show();

		audioTimer = setInterval(function(){

			$('#speaking-ratio').show();
			$('.rec_icon').hide();
								
			// total audio data for teacher and student
			totalAudioData = currentStudentAudioData + currentTeacherAudioData;

			// NJ-10636: mod textbook connect 
			var textbookConnectID = localStorage.getItem('ytTextBookConnectId');

			// NJ-10636 : not allow to calculate the speaking ration if yt is playing
			var _calculateAcquisition = true;

			if (
				typeof eventTeacher !== "undefined" && 
				typeof eventTeacher.teacherTextbookYtPlayer !== "undefined" && 
				eventTeacher.teacherTextbookYtPlayer !== null &&
				textbookConnectID
			) {
			
				_calculateAcquisition = false;

				// - fetch the remaining time
				if (youtubePlayerAcquisitionAllow == false){
					var display = '';
					eventCommon.getStartChatTime(display); 
				}


				// - get the remaining seconds
				var _remainingSeconds = localStorage.getItem('youtubePlayerLessonTime');
				var _ytStartTimeSeconds = localStorage.getItem('youtubePlayerStartTime');

				if (
					typeof _remainingSeconds !== 'undefined' && 
					_remainingSeconds && 
					_ytStartTimeSeconds &&  
					(_ytStartTimeSeconds - _remainingSeconds) >= 300 // 5 minutes
				){
					_calculateAcquisition = true;
					// - set local storage to allow youtube player 
					localStorage.setItem('allowYoutubePlayerAcquisition', true);

					youtubePlayerAcquisitionAllow = true;
				}else{
					_calculateAcquisition = false;
					localStorage.setItem('allowYoutubePlayerAcquisition', false);
				}
			}


			if (_calculateAcquisition == true){

				$('#speaking-ratio').show();

				// calculate teacher and student speaking ratio
				studentPercentage = (currentStudentAudioData / totalAudioData) * 100;
				teacherPercentage = (currentTeacherAudioData / totalAudioData) * 100;

				// display speaking ratio 
				if (studentPercentage >= 70 && studentPercentage <= 100) {
					$('.item-teacher').removeClass('is-30 is-40 is-50 is-60 is-70').addClass('is-30');
				} else if (studentPercentage >= 51 && studentPercentage < 70) {
					$('.item-teacher').removeClass('is-30 is-40 is-50 is-60 is-70').addClass('is-40');
				} else if (studentPercentage >= 41 && studentPercentage < 51) {
					$('.item-teacher').removeClass('is-30 is-40 is-50 is-60 is-70').addClass('is-50');
				} else if (studentPercentage >= 31 && studentPercentage < 41) {
					$('.item-teacher').removeClass('is-30 is-40 is-50 is-60 is-70').addClass('is-60');
				} else if (studentPercentage >= 0 && studentPercentage < 31) {
					$('.item-teacher').removeClass('is-30 is-40 is-50 is-60 is-70').addClass('is-70');
				}
				$('#student-ratio').html('<p>'+studentPercentage.toFixed(0)+'<span>%</span></p>');
				$('#teacher-ratio').html('<p>'+teacherPercentage.toFixed(0)+'<span>%</span></p>');

				// if teacher spearking ratio is more than 65% turn bar to red
				if(teacherPercentage >= 65) {
					$('#trigger_modal_speaking_ratio_alert').click();
				} else {
					$('.item-teacher').removeClass('danger');
					// $("#modal_speaking_ratio_alert .close_modal").click(); - not needed I think
				}

				setTimeout(function() {
					$('#speaking-ratio').hide();
					$('.rec_icon').show();
				}, 5000); // show only for 5 seconds

				// NJ-12690: send audio acquisition to student side
				eventCommon.sendAudioAcquisition({studentAudioAcquisition: studentPercentage.toFixed(0), teacherAudioAcquisition: teacherPercentage.toFixed(0), info});
			}

		}, 60 * 2000);

	// start of the lesson
	} else {

		audioTimer = setInterval(function(){

			// NJ-10636 : not allow to calculate the speaking ration if yt is playing
			var _calculateAcquisition = true;

			// NJ-10636: mod textbook connect 
			var textbookConnectID = localStorage.getItem('ytTextBookConnectId');

			if (
				typeof eventTeacher !== "undefined" && 
				typeof eventTeacher.teacherTextbookYtPlayer !== "undefined" && 
				eventTeacher.teacherTextbookYtPlayer !== null &&
				textbookConnectID
			) {
			
				_calculateAcquisition = false;

				// - fetch the remaining time
				if (youtubePlayerAcquisitionAllow == false){
					var display = '';
					eventCommon.getStartChatTime(display); 
				}


				// - get the remaining seconds
				var _remainingSeconds = localStorage.getItem('youtubePlayerLessonTime');
				var _ytStartTimeSeconds = localStorage.getItem('youtubePlayerStartTime');

				if (
					typeof _remainingSeconds !== 'undefined' && 
					_remainingSeconds && 
					_ytStartTimeSeconds &&  
					(_ytStartTimeSeconds - _remainingSeconds) >= 300 // 5 minutes
				){
					_calculateAcquisition = true;
					// - set local storage to allow youtube player 
					localStorage.setItem('allowYoutubePlayerAcquisition', true);

					youtubePlayerAcquisitionAllow = true;
				}else{
					localStorage.setItem('allowYoutubePlayerAcquisition', false);
					_calculateAcquisition = false;
				}
			}

			
			if (_calculateAcquisition == true) {
				$('#speaking-ratio').show();
												
				// total audio data for teacher and student
				totalAudioData = currentStudentAudioData + currentTeacherAudioData;

				// calculate teacher and student speaking ratio
				studentPercentage = (currentStudentAudioData / totalAudioData) * 100;
				teacherPercentage = (currentTeacherAudioData / totalAudioData) * 100;

				if(
					(typeof studentPercentage === 'number' && !isNaN(studentPercentage)) ||
					(typeof teacherPercentage === 'number' && !isNaN(teacherPercentage))
				) {

					// display speaking ratio 
					if (studentPercentage >= 70 && studentPercentage <= 100) {
						$('.item-teacher').removeClass('is-30 is-40 is-50 is-60 is-70').addClass('is-30');
					} else if (studentPercentage >= 51 && studentPercentage < 70) {
						$('.item-teacher').removeClass('is-30 is-40 is-50 is-60 is-70').addClass('is-40');
					} else if (studentPercentage >= 41 && studentPercentage < 51) {
						$('.item-teacher').removeClass('is-30 is-40 is-50 is-60 is-70').addClass('is-50');
					} else if (studentPercentage >= 31 && studentPercentage < 41) {
						$('.item-teacher').removeClass('is-30 is-40 is-50 is-60 is-70').addClass('is-60');
					} else if (studentPercentage >= 0 && studentPercentage < 31) {
						$('.item-teacher').removeClass('is-30 is-40 is-50 is-60 is-70').addClass('is-70');
					}
					$('#student-ratio').html('<p>'+studentPercentage.toFixed(0)+'<span>%</span></p>');
					$('#teacher-ratio').html('<p>'+teacherPercentage.toFixed(0)+'<span>%</span></p>');

					// if teacher spearking ratio is more than 65% turn bar to red
					if(teacherPercentage >= 65) {
						$('#trigger_modal_speaking_ratio_alert').click();
					} else {
						$('.item-teacher').removeClass('danger');
						// $("#modal_speaking_ratio_alert .close_modal").click(); - not needed I think
					}

					setTimeout(function() {
						$('#speaking-ratio').hide();
					}, 5000); // show only for 5 seconds

					// NJ-12690: send audio acquisition to student side
					eventCommon.sendAudioAcquisition({studentAudioAcquisition: studentPercentage.toFixed(0), teacherAudioAcquisition: teacherPercentage.toFixed(0), info});

				} else {
					$('#speaking-ratio').hide();
					$('.rec_icon').hide();
				}
			}

		}, 60 * 2000);
	}
}

function sendChivoxReadingResult(){
	var chivoxScope = $('.reading_chivox_preview');

	var student_chivox_result_text = $('.common-tf-rec-result', chivoxScope).html();
	var teacher_chivox_result_text = sessionStorage.getItem('chivox-result-teacher-reading') || "";

	var msgData = {
		message_student: student_chivox_result_text,
		message_teacher: teacher_chivox_result_text,
		info, 
		isChivox: true, 
		chivox_type: 3
	};
	eventCommon.sendMessage(msgData);
	$('.chivox_preview_wrap').remove();
	eventCommon.resetEditorToDefault();
	chivoxReadingCount = 0;

	if (typeof connect.peerDevice !== "undefined" && typeof connect.peerAppVersion !== "undefined" && connect.peerDevice != 'pc') {
		let allowedUserRecordingMessage = eventCommon.versionCompare({
			appVersionMin : connect.peerDevice == 'ios' ? iosNewDesignSupported : androidNewDesignSupported,
			appVersionUse : connect.peerAppVersion
		});	
		//-- send recorded audios (older versions)
		if ( sessionStorage.getItem('chivoxSessionAudDet') && !allowedUserRecordingMessage) {
			eventCommon.sendMessage({message: sessionStorage.getItem('chivoxSessionAudDet'), info, isStoredSpeechAudio: true});
		}
	}


	return false;
}

function sendChivoxQuestionResult(){
	$('#editor b[id^=score-]').append(' '); //-- add space delimiter
	var data = $('#editor').text().trim();

	if (data.includes('test part') && (data.includes('Question') || data.includes('Narration'))) {
		var teacherChivoxKey = "chivox-result-teacher-";
		var studentChivoxKey = "chivox-result-student-";

		for (var i = 1; i <= 5; i++) {
			if (data.includes('Question ' + i)) {
				teacherChivoxKey += 'question' + i;
				studentChivoxKey += 'question' + i;
				break;
			}
		}

		if (data.includes('Narration')) { 
			teacherChivoxKey += 'narration';
			studentChivoxKey += 'narration'; 
		}
		if (data.includes('Test Part')) { 
			teacherChivoxKey += 'testpart';
			studentChivoxKey += 'testpart';
		}

		var student_chivox_result_text = sessionStorage.getItem(studentChivoxKey) || "";
		var teacher_chivox_result_text = sessionStorage.getItem(teacherChivoxKey) || "";

		console.log("student chivox: " + student_chivox_result_text);
		console.log("teacher chivox: " + teacher_chivox_result_text);

		if (student_chivox_result_text && teacher_chivox_result_text) {
			var msgData = {
				message_student: student_chivox_result_text,
				message_teacher: teacher_chivox_result_text,
				info, 
				isChivox: true, 
				chivox_type: 3
			};
			eventCommon.sendMessage(msgData);
			$('.chivox_preview_wrap').remove();
			eventCommon.resetEditorToDefault();

			if (typeof connect.peerDevice !== "undefined" && typeof connect.peerAppVersion !== "undefined" && connect.peerDevice != 'pc') {
				let allowedUserRecordingMessage = eventCommon.versionCompare({
					appVersionMin : connect.peerDevice == 'ios' ? iosNewDesignSupported : androidNewDesignSupported,
					appVersionUse : connect.peerAppVersion
				});	
				//-- send recorded audios (older versions)
				if ( sessionStorage.getItem('chivoxSessionAudDet') && !allowedUserRecordingMessage) {
					eventCommon.sendMessage({message: sessionStorage.getItem('chivoxSessionAudDet'), info, isStoredSpeechAudio: true});
				}
			}
			
			return false;
		}
	}

}

// NJ-279: plain text only when pasting on correction modal textareas
function handlePasteOnCorrModal(event) {
	event.preventDefault();
	let textResult = "";
	let text = event.clipboardData.getData('text/plain');
	
	// disable pasting of chivox result
	if (
		text.length > 0 &&  text.includes('Result from test part') 
		&& (text.includes('Reading') || text.includes('Question'))
	) {
		alert("Invalid format.");
		return;
	}

	// replace <br> tag into a textarea's new line
	text = text.replaceAll(/<br>/gi, '\n');

	// remove any HTML tags before pasting plain texts
	if (text.match(/<[^>]*>/gi)) {
	    textResult = text.replace(/<[^>]*>/gi, " ");
	} else {
		textResult = text;
	}
	textResult = textResult.trim();
	document.execCommand('insertText', false, textResult);
}

// NJ-279: set teacher side message menu depending on APP's version
// - called on event.teacher.js
function manageTeacherChatMenus(isVersionSupportsNewChatFunc) {
	let result = {};
	let s_txt_chat_menu = t_txt_chat_menu = t_txt_file_menu = '';
	// new chat menu
	if (isVersionSupportsNewChatFunc) {
		// teacher's student msg menu
		s_txt_chat_menu =  '<div class="btn_chat_wrap">';
		s_txt_chat_menu += '	<a href="javascript:void(0);" class="btn_chat_menu chat_translate_trigger message_translate_trigger"><span class="tooltip">translate</span></a>';
		s_txt_chat_menu += '	<a href="javascript:void(0);" class="btn_chat_menu chat_menu_trigger"></a>';
		s_txt_chat_menu += '</div>';
		s_txt_chat_menu += '<div class="chat_menu_wrap hide">';
		s_txt_chat_menu += '	<ul>';
		s_txt_chat_menu += '		<li><a href="javascript:void(0);" class="chat_menu-comments" id="trigger-reply-box"><span>Reply</span><img src="/teacher/images/chat/icon_reply.svg" alt="Reply" class="chat-menu-icon"></a></li>';
		s_txt_chat_menu += ' <li><a href="javascript:void(0);" class="chat_menu-correct"><span>Correct message</span><img src="/teacher/images/chat/icon_correct.svg" alt="Correct message" class="chat-menu-icon"></a></li>';
		s_txt_chat_menu += '	</ul>';
		s_txt_chat_menu += '</div>';

		// teacher's msg menu
		t_txt_chat_menu =  '<div class="btn_chat_wrap">';
		t_txt_chat_menu += '	<a href="javascript:void(0);" class="btn_chat_menu chat_translate_trigger message_translate_trigger"><span class="tooltip">translate</span></a>';
		t_txt_chat_menu += '	<a href="javascript:void(0);" class="btn_chat_menu chat_menu_trigger"></a>';
		t_txt_chat_menu += '</div>';
		t_txt_chat_menu += '	<div class="chat_menu_wrap hide">';
		t_txt_chat_menu += '		<ul>';
		t_txt_chat_menu += '			<li><a href="javascript:void(0);" class="chat_menu-edit"><span>Edit</span><img src="/teacher/images/chat/icon_edit.svg" alt="Edit" class="chat-menu-icon"></a></li>';
		t_txt_chat_menu += '		<li><a href="javascript:void(0);" class="chat_menu-comments" id="trigger-reply-box"><span>Reply</span><img src="/teacher/images/chat/icon_reply.svg" alt="Reply" class="chat-menu-icon"></a></li>';
		t_txt_chat_menu += ' <li><a href="javascript:void(0);" class="chat_menu-correct"><span>Correct message</span><img src="/teacher/images/chat/icon_correct.svg" alt="Correct message" class="chat-menu-icon"></a></li>';
		t_txt_chat_menu += '			<li><a rel="modal" class="chat_menu-delete"><span>Delete</span><img src="/teacher/images/chat/icon_delete.svg" alt="Delete" class="chat-menu-icon"></a></li>';
		t_txt_chat_menu += '		</ul>';
		t_txt_chat_menu += '	</div>';
	
	// old chat menu
	} else {
		// remove new chat functions
		$('#addBold, #addStrike, .btn-color, #trigger-emoticons-box').closest('li').remove();
		$('.btn-area-left').remove();

		// teacher's student msg menu
		s_txt_chat_menu =  '<div class="btn_chat_wrap">';
		s_txt_chat_menu += '	<a href="javascript:void(0);" class="btn_chat_menu chat_translate_trigger message_translate_trigger"><span class="tooltip">translate</span></a>';
		s_txt_chat_menu += '</div>';

		// teacher's msg menu
		t_txt_chat_menu =  '<div class="btn_chat_wrap">';
		t_txt_chat_menu += '	<a href="javascript:void(0);" class="btn_chat_menu chat_translate_trigger message_translate_trigger"><span class="tooltip">translate</span></a>';
		t_txt_chat_menu += '	<a href="javascript:void(0);" class="btn_chat_menu chat_menu_trigger"></a>';
		t_txt_chat_menu += '	<div class="chat_menu_wrap hide">';
		t_txt_chat_menu += '		<ul>';
		t_txt_chat_menu += '			<li><a href="javascript:void(0);" class="chat_menu-edit">Edit message</a></li>';
		t_txt_chat_menu += '			<li><a rel="modal" class="chat_menu-delete c_red">Delete message</a></li>';
		t_txt_chat_menu += '		</ul>';
		t_txt_chat_menu += '	</div>';
		t_txt_chat_menu += '</div>';
	}

	// teacher's file/photo menu
	t_txt_file_menu = `
		<div class="chat_menu_wrap hide">
			<ul>
				<li><a rel="modal" class="chat_menu-delete c_red">Delete<img src="/teacher/images/chat/icon_delete.svg" alt="Delete" class="chat-menu-icon"></a></li>
			</ul>
		</div>
		<div class="btn_chat_wrap">
			<a href="javascript:void(0);" class="btn_chat_menu chat_menu_trigger"></a>
		</div>`;

	return result = {
		's_txt_chat_menu' : s_txt_chat_menu,
		't_txt_chat_menu' : t_txt_chat_menu,
		't_txt_file_menu' : t_txt_file_menu
	}
}

// NJ-279: Translate the comment of the selected msg
function translateComment(comment,temp_id) {
	$.ajax({
		type: 'POST',
		data: comment,
		url: '/teacher/Api/translateText',
		success: function(res){
			if (res !== '') {
				result =  '<div class="comments-area">';
				result += '	<p class="title">Reply</p>';
				result += '	<p class="contents">'+ res +'</p>';
				result += '</div>';
				$('#'+ temp_id +'_translated_correction').css('paddingBottom', '25px');
				$(result).insertAfter('#'+ temp_id +'_translated_correction');
			}
		}
	});
}

// NJ-279: Empty the correction message modal values
function clearCorrectionMessageModalValues() {	
	$('#modal-original-msg').val('');
	$('#modal-correction-msg').val('');
	$('#modal-comment-msg').val('');
	$('#modal-correction-submit-btn').removeAttr('data-chatId data-isEditingCorrection data-correction-msg data-comment-msg');
}

// NJ-279: teacher corrects any msg, set correction modal's textarea values
function setCorrModalTextareaValues(msg) {
	if (msg !== "") {
		msg = eventCommon.removeSpanTagEdited(msg);
		// replace new lines of copied texts (from notepad) to br
		msg = msg.replaceAll(/\n/gi, "<br>");
		// set all "<br>" (not converted from \n) to a spaced " <br> "
		msg = msg.replaceAll(/<br>/gi, " <br> "); 
		// replace all " <br> " with textarea's next line
		msg = msg.replaceAll(/ <br> /gi, "\n"); 
		// replace all "&nbsp;" with space
		msg = msg.replaceAll(/&nbsp;/gi, " ");
		// remove all html tags
		msg = eventCommon.removeHtml(msg).trim();
	}
	return msg;
}

// NJ-279: teacher edits a correction msg, set correction modal's textarea values
function setCorrModalEditingValues(msg) {
	if (msg !== "") {
		msg = eventCommon.removeSpanTagEdited(msg);
		// replace " <br> " with textarea's next line
		msg = msg.replaceAll(/\s*<br>\s*/gi, '\n');
		// remove all html tags
		msg = eventCommon.removeHtml(msg).trim();
	}
	return msg;
}

// NJ-279: For saving on DB and displaying on the chatbox
function replaceTextareaNewlineToHtmlBr(msg) {
	if (msg !== "") {
		msg = msg.replaceAll(/\n/gi, " <br> ");
	}
	return msg;
}

// NJ-279: check if only added space or new line between original and correction msg.
function isAddedSpaceOrNewlineAtEndOfMsg(original_msg, correction_msg) {
	var result = false;
	if (original_msg && correction_msg) {
		correction_msg = correction_msg.replace(original_msg, '');
		correction_msg = eventCommon.isMsgEmptyOrSpacesOrNewlines(correction_msg);
		result = (correction_msg === true) ? true : false;
	}
	return result;
}

// NJ-279: teacher side correction msg highlighting to app side, step 1
function strSplitBySpace(str) {
	var result = [];
	// add spaces around br tag before splitting for accurate highlighting of word differences
	str.replaceAll(/<br>/gi, ' <br> ');
	str.split(' ').forEach(function(val, i) { result.push(val); });
	return result;
}

// NJ-279: teacher side correction msg highlighting to app side, step 2
function getCommonWords(str1, str2) {
	var result = [];
	for(var i = 0; i < str1.length; i++) {
		if ($.inArray(str1[i], str2) !== -1) { 
			result.push(str1[i]);
		}
	}
	return result;
}

// NJ-279: teacher side correction msg highlighting
function colorBlackSameWords(commonWords, mainStr) {
	var result = [];
	for(var i = 0; i < mainStr.length; i++) {
		if (mainStr[i]) {
			// color black common words
			if ($.inArray(mainStr[i], commonWords) !== -1) {
				result.push(mainStr[i]);
			// color red/green uncommon words
			} else {
				result.push("<span class='focus'>" + mainStr[i] + "</span>");
			}
		}
	} 
	result = result.join(" ");
	// undo spaces around br tag to display the expected word difference result
	result.replaceAll(/ <br> /gi, '<br>');
	return result;
}

// NJ-279: enable/disable Chivox result copy button
function toggleChivoxResultCopyButton () {
	// if teacher is at commenting state, disable Chivox copy button
	if ($("#quote-area").is(":visible")) {
		$("#textbook-iframe").contents().find(".func_copy").css("opacity", 0.4).attr("disabled", true);
		$("#textbook-iframe").contents().find(".send-me").css("user-select", "none");
	} else {
		$("#textbook-iframe").contents().find(".func_copy").css("opacity", 1).removeAttr("disabled");
		$("#textbook-iframe").contents().find(".send-me").css("user-select", "auto");
	}
}

// NJ-16457
function generateMessageLessonTutorial(textbook){
	var lessonStartMsg = $('#lesson_tutorial_textbook_message_template').clone();

	var defaultLessonDate = new Date();
	defaultLessonDate.setDate(defaultLessonDate.getDate() -1);
	defaultLessonDate = formatDate(defaultLessonDate);

	lessonStartMsg.find('a').attr('data-msgviewtextbook',textbook.textbook.connect_id);
	lessonStartMsg.find('#lt_categoryNameEng').text(textbook.categoryNameEng);
	lessonStartMsg.find('#lt_classNameEng').text(textbook.classNameEng);
	lessonStartMsg.find('#lt_chapterNameEng').text(textbook.chapterNameEng);
	lessonStartMsg.find('#lt_defaultLessonDate').text(defaultLessonDate);
	
	checkTextChatAreaVisibility(lessonStartMsg); // check if the chat area is visible before render the message
}

function generateMessageChangeTextbook(msgData) {
	var strMsg = "";
		strMsg += '<div class="chat_txt info_txt">';
		strMsg += '	<div class="desc_wrap">';
		strMsg += '		<span class="cnt-sentence">';
		strMsg += 		msgData;
		strMsg += '		</span>';
		strMsg += '	</div>';

	addIM(strMsg, true);
}

function checkTextChatAreaVisibility(lessonStartMsg) {
  	const targetTextChatArea = $('#textchat_area');
	// validate if the target div are visible
  	if (targetTextChatArea.is(':visible')) {
		addIM(lessonStartMsg, true);
  	} else {
		// add waiting time to render the lessonStartMsg
		setTimeout(() =>{
			checkTextChatAreaVisibility(lessonStartMsg)
		},500);
  	}
}

function correctMessageLessonTutotial(mistakeMsg, correctMsg, comment) {
	var lessonCorrectionMsg = $('#lesson_tutorial_correction_message_template').clone();

	lessonCorrectionMsg.find('#lt_mistake').text(eventCommon.removeHtml(mistakeMsg));
	lessonCorrectionMsg.find('#lt_correct').text(eventCommon.removeHtml(correctMsg));
	lessonCorrectionMsg.find('#lt_contents').text(eventCommon.removeHtml(comment));

	$('#textchat_area').append(lessonCorrectionMsg);
	$('#dialog_correction .close_modal').click();
}


function formatDate(date) {
  	var day = date.getDate();
  	var month = date.getMonth() + 1;
  	var year = date.getFullYear();
  	var hours = date.getHours();
  	var minutes = date.getMinutes();

  	// Add leading zeros if necessary
  	day = addLeadingZero(day);
  	month = addLeadingZero(month);
  	hours = addLeadingZero(hours);
  	minutes = addLeadingZero(minutes);

  	return `${month}/${day}/${year} ${hours}:${minutes}`;
}

function addLeadingZero(value) {
  	return value < 10 ? "0" + value : value;
}

/* START NJ-19823 */
$(document).on('click', '#trigger-upload-file', () => {
	$('#upload-file-box').fadeToggle();
});

$('#trigger-style-box').on('click', function() {
	const elem = this;
	const styleBox = $(this);

	if ($("#reply-box").is(":visible")) {
		$("#reply-box ul").toggleClass('hide');
		$("#im_row--mid2").show();
	} else {
		$('#style-box').slideToggle(400, function(){
			$(document).on('click' ,function(e){
				if(!$(e.target).closest('.textchat_form_inner').length) {
					$('#style-box').slideUp(200)
					styleBox.removeClass("clicked");
					closeOtherBox(elem);
					styleText();
				}
			});
		});
	}

	if (styleBox.hasClass("clicked")) {
		styleBox.removeClass("clicked");
	} else {
		styleBox.addClass("clicked");
	}

	closeOtherBox(this);
});

// About icons
function changeIconFile() {
	var button = $('#gallery-change');
	button.toggleClass("clicked");

	if (button.hasClass('clicked')) {
		$('#upload-file').click();
	} else {
	}
}

$('#editor').on('input', function() {
	onChangeText();
});

// Simplified code for inserting DIV elements
const insertDiv = (switchClass, targetClass) => {
  const switchElements = document.querySelectorAll(switchClass);
  const targetElement = document.querySelector(targetClass);

  switchElements.forEach(element => {
    element.parentNode.removeChild(element);
    targetElement.parentNode.insertBefore(element, targetElement);
  });
};

// Insert emoticons DIV
insertDiv('.emoticons-box', '.input-txt');

// Insert style DIV
insertDiv('.style-box', '.input-txt');

// Insert reply DIV
insertDiv('.reply-box', '.input-txt');

// close other open box
function closeOtherBox(elem) {
	const element = $(elem);
	const triggerId = element.attr('id');

	$.each([ 'trigger-style-box', 'trigger-emoticons-box' ], function( index, value ) {
		let = currentElement = $('#'+value);
		if (triggerId != value && currentElement.hasClass("clicked")) {
			currentElement.removeClass("clicked");

			if ('trigger-style-box' == value) {
				$('#style-box').hide();
			}
			
			if ('trigger-emoticons-box' == value) {
				$('#emoticons-box').hide();
			}
		}
	});

	styleText();
}

// set textarea style
function styleText() {
	const textInput = $("#editor");
	const styleBox = $("#trigger-style-box");
	const emoticonsBox = $("#trigger-emoticons-box");
	const replyBox = $("#reply-box");

  	if (styleBox.hasClass("clicked") || emoticonsBox.hasClass("clicked") || replyBox.hasClass("show")) {
		// Change SVG to the revert SVG
		textInput.removeAttr("style").css({"border-radius": "0 0 15px 15px", "border-top": "none", "transition": "all 0.3s ease"});
	} else {
		// Revert to original SVG
		textInput.removeAttr("style").css("transition", "all 0.5s ease");
	}

	//for space
	if ($('#reply-box ul').hasClass('hide')) {
        $("#im_row--mid2").hide();
    }
	if (styleBox.hasClass("clicked") || replyBox.hasClass("show")) {
		// Scroll to the bottom of the messages list
		var totalHeight = 0;
		$('.chat_txt').each(function() {
		totalHeight += $(this).outerHeight(true); 
		});

		// Scroll to the total height
		$('#textchat_area').animate({ scrollTop: totalHeight }, "fast");

		$("#im_row--mid1").show();
	}
	else {
		$(".im_row--mid1, .im_row--mid2").hide();
	}
}

// check input on textarea
function onChangeText() {
	var input = $('#editor').text();
  	var hideElements = $('.btn-hide');
	const replyBox = $("#reply-box");

	if (input.trim() !== '' || tempFileContainer.length > 0) {
		if (tempFileContainer.length <= 0) {
			hideElements.hide();
		} else {
			$('.btn-hide.correction').hide();
		}
		
		$(".btn-send").show();
  	} else {
		hideElements.show();
		$(".btn-send").hide();
  	}
}

// reset reply button
function resetReplyBtn() {
	$('#reply-box').removeClass('show');
	$('ul', '#reply-box').addClass('hide');
	$("img", "#btn-cancel-area").attr("src", "/images/chat/back.svg");
	$("#btn-cancel-area").addClass("hide");
	$("#reply-box").hide('slide', {direction: 'down'}, 400);
	$("#trigger-style-box").removeClass("hide");
	$('.btn-hide').show();
}

function hideEmoticonBox(triggleElem) {
	$('.emoticons-box', '.textchat_form_inner').slideUp(500);
	$('#trigger-emoticons-box').removeClass("clicked");
	styleText();
}
/* END NJ-19823 */

// NJ-33115
function updatePageNumberValue(pagenum){
	if (!$('#pageNumberOption option[value="' + pagenum + '"]').length) {
		$('#pageNumberOption').append($('<option>', {
			value: pagenum,
			text: pagenum
		}));
	}
	// Set the newly added option as selected
	$('#pageNumberOption').val(pagenum);
	$('#tb_page_jump_confirm').click();
}

function showAvatarDraggableIcon(data) {
	let avatarDraggableIcon = $('#avatar_pet_phrases', document);
	let buttons = '';
		
	if (!avatarDraggableIcon.length || typeof data.avatarId == "undefined" || typeof data.avatarPhraseList == "undefined" || data.avatarId === 0 || data.avatarId === null) {
		return false;
	} 
	
	if (avatarDraggableIcon.data('avatar-id') != data.avatarId) {
		var loopCtr = 0;
		$.each(data.avatarPhraseList, function( index, value ) {
			buttons += `<li><a href="javascript:;" data-phrase_id="${index}" data-audio_url="${value.audio_url}" id="pet_phrase_${loopCtr}" class="play_pet_phrase">${value.text}</a></li>`;
		});
		avatarDraggableIcon.find('ul').html(buttons);

		if (typeof data.avatarImage != "undefined") {
			avatarDraggableIcon.find('img').attr('src', data.avatarImage);
		}
	}
	
	avatarDraggableIcon.removeClass('hide');
}

function set_game_data(chatHashGameKey = null){
	if(!chatHashGameKey){ return; }
	let game_start_time = game_get_current_date_time();

	const game_data = {
		chat_hash : chatHashGameKey,
		start_time : game_start_time,
		teacher_id: "449595",
		user_id: connect.config.userID,
	}

	var profile_params = {
		teacher_id: "449595",
		user_id: connect.config.userID,
	}
	$.ajax({
		url: "/teacher/Api/gameGetPlayersProfile",
		type: 'post',
		data: profile_params,
		dataType : 'json',
		success: function(res) {
			if (res.error) {
			} else {

				var elemIframeDiscon = document.getElementById('textbook-iframe');
				if (elemIframeDiscon != null && typeof elemIframeDiscon.contentWindow.gameState !== 'undefined') {
					elemIframeDiscon.contentWindow.gameState.playersProfile = res.profile_data;

					elemIframeDiscon.contentWindow.gameState.chatHash = game_data.chat_hash;
					elemIframeDiscon.contentWindow.gameState.userId = game_data.user_id;
					elemIframeDiscon.contentWindow.gameState.teacherId = game_data.teacher_id;
					elemIframeDiscon.contentWindow.gameState.startTime = game_data.start_time;
					elemIframeDiscon.contentWindow.gameState.saveGameDataMemcache('players_profile', {...game_data, players_profile : res.profile_data});
				}
				
				// - socket : send players profile to student's end
				eventCommon.gameEvent('players_profile', {...game_data, players_profile : res.profile_data});
			}
		}
	});
}

function game_get_current_date_time(){
	const date = new Date();
	let hour = date.getHours();
	let minutes = date.getMinutes();
	let seconds = date.getSeconds();
	minutes = (minutes < 10) ? '0' + minutes : minutes;
	seconds = (seconds < 10) ? '0' + seconds : seconds;
 
	// let currentDate = `${day}-${month}-${year}`;
	let game_start_time = date.toJSON().slice(0, 10) + ` ${hour}:${minutes}:${seconds}`;
	return game_start_time;
}

function showAvatarPhraseModal() {
	if (localStorage.getItem('show_avatar_use_phrase_modal')) {
		localStorage.removeItem('show_avatar_use_phrase_modal');

		if (typeof(window.avatarFlg) !== 'undefined' 
			&& window.avatarFlg 
			&& typeof angularApp.scope().showAvatarPhraseModal !== 'undefined' 
			&& $.isFunction(angularApp.scope().showAvatarPhraseModal)) {
			angularApp.scope().showAvatarPhraseModal();
		}
	}
}

$(document).on('click','#notice_complete',function() {
	location.reload(); // reload after lesson complete confirmation
});


/**
 * set default speech to text language based on student localizedDir
 */
function speechToTextToggleDefaultLang() {
	var studentSelectedLessonLocalizeDir = localStorage.getItem('lessonLocalizeDir');
	var $selectElementLangTo = $("#menu-translate-to-lang");
	if (studentSelectedLessonLocalizeDir && $selectElementLangTo.find('option[value="' + studentSelectedLessonLocalizeDir + '"]').length > 0) {
		$selectElementLangTo.val(studentSelectedLessonLocalizeDir);
	} else {
		$selectElementLangTo.val("ja");
	}
}
var speechErrorTranslations = {"ja":"\u3014\u30a8\u30e9\u30fc\u3015\uff1a\u97f3\u58f0\u8a8d\u8b58\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002\u30d8\u30c3\u30c9\u30bb\u30c3\u30c8\u3042\u308b\u3044\u306f\u30a4\u30e4\u30db\u30f3\u306e\u7740\u7528\uff0f\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u74b0\u5883\u306e\u3054\u78ba\u8a8d\u3092\u304a\u9858\u3044\u3057\u307e\u3059","ko":"[\uc624\ub958] : \uc74c\uc131 \uc778\uc2dd\uc5d0 \ubb38\uc81c\uac00 \uc788\uc2b5\ub2c8\ub2e4. \ud5e4\ub4dc\uc14b \ub610\ub294 \uc774\uc5b4\ud3f0 \ucc29\uc6a9\/\uc778\ud130\ub137 \ud658\uacbd \ud655\uc778 \ubd80\ud0c1\ub4dc\ub9bd\ub2c8\ub2e4.","zh-cn":"[\u9519\u8bef]\uff1a\u8bed\u97f3\u8bc6\u522b\u51fa\u73b0\u95ee\u9898\u3002\u8bf7\u4f69\u6234\u8033\u673a\/\u68c0\u67e5\u60a8\u7684\u7f51\u7edc\u73af\u5883\u3002","zh-tw":"\u3014\u932f\u8aa4\u3015\uff1a\u8a9e\u97f3\u8fa8\u8b58\u767c\u751f\u554f\u984c\u3002\u8acb\u4f7f\u7528\u8033\u6a5f\u6216\u6aa2\u67e5\u60a8\u7684\u7db2\u8def\u74b0\u5883","vi":"[L\u1ed7i]: C\u00f3 v\u1ea5n \u0111\u1ec1 v\u1edbi nh\u1eadn d\u1ea1ng gi\u1ecdng n\u00f3i. Vui l\u00f2ng \u0111eo tai nghe ho\u1eb7c tai nghe\/ki\u1ec3m tra m\u00f4i tr\u01b0\u1eddng internet c\u1ee7a b\u1ea1n.","en":"[Error]: There is a problem with voice recognition. Please wear a headset or earphones\/check your internet environment.","pt-br":"[Erro]: H\u00e1 um problema com o reconhecimento de voz. Por favor, verifique o uso de headset ou fones de ouvido \/ a sua conex\u00e3o com a internet."};
var errorLang = 'ja';
$(document).on('click','div#dialog_lesson_completed .lesson_completed_btn',function() {
	if ($(this).hasClass('close_modal')) {
		let redirectionURL = $(this).attr('data-reload-url');
		close_window(redirectionURL);
	}
});

</script><div class="lesson_tutorial_chat_template" style="display: none;">
    <!-- textbook message template -->
    <div class="chat_txt info_txt lesson-student-init-info" id="lesson_tutorial_textbook_message_template">
        <div class="cnt-sentence c_gray">

            <div class="desc_wrap">
                <span class="desc_title fw_b">[Requests]</span><br>
                <span class="item_name">Lesson Time</span>: <b><span class="c_blue request-lesson-time">10 minutes</span></b><br>
                <span class="item_name">Self-Introduction:</span> <span class="c_red">Need</span> <br>
                <span class="item_name">Pointing out mistakes:</span> <span class="c_red">Need</span> <br>
                <span class="item_name">Other requests:</span><br>
                <span class="request-other c_blue fw_b">I am a beginner in English and I want my pronunciation corrected. I want you to use a chatbox. I want you to speak slowly.</span>
            </div>

            <div class="desc_wrap">
                <span class="c_red"><b>[Today’s Lesson]</b></span><br>
                Name: <span class="fw_b"><b>Hiroshi</b></span><br>
                Device: <span class="c_blue"><b>PC</b></span><br>
                <p class="student-nation">Nationality: <span class="nation-text">Japan</span></p>
                <span>
                    <a href="javascript: void(0);" oncontextmenu="return false;" data-msgviewtextbook="" style="text-decoration: underline;" onclick="msgViewTextbookFunc($(this))">
                    [ Course or Textbook ] <span id="lt_categoryNameEng"></span><br>
                    [ Category ] <span id="lt_classNameEng"></span><br>
                    [ Chapter ] <span id="lt_chapterNameEng"></span><br>
                    </a>
                </span>
            </div>

            <div class="desc_wrap">
                <span class="c_red"><b>[Lesson history with you]</b></span><br>
                Number of past lessons: <span class="fw_b">5</span><br>
                Previous lesson date: <span id="lt_defaultLessonDate"></span><br>
                <span>
                [ Course or Textbook ] <span id="lt_categoryNameEng"></span><br>
                [ Category ] <span id="lt_classNameEng"></span><br>
                [ Chapter ]  <span id="lt_chapterNameEng"></span><br>
                </span>
                <div class="btn_chat_wrap">
                    <a href="javascript:void(0);" class="btn_chat_menu chat_translate_trigger instant_msg_translate_trigger"><span class="tooltip">translate</span></a>
                </div>
            </div>

        </div>
    </div>
    <!-- end textbook message template -->

    <!-- correct message template -->
    <div class="chat_txt t_txt t_side corrected-txt commented-txt" id="lesson_tutorial_correction_message_template">
        <div class="corrected-txt-inner">
            <div class="cnt-sentence" data-hascorrectioncomment="true">
                <p class="mistake" id="lt_mistake"></p>
                <p class="correct" id="lt_correct"></p>
            </div>
            <div class="comments-area">
                <p class="title" id="lt_contents"></p>
            </div>
        </div>
    </div>
    <!-- end correct message template -->
</div>
<script>
   window.addEventListener('message', function (event) {
     // For security, you can optionally validate event.origin
     if (event.data === 'actualLessonStarted') {
       alert('🔔 The actual lesson has started!');
       // Or call any other function here
     }
   });
 </script>





<div id="modal_overlay" onclick="getAnnouncement()" class="disable" style="visibility: visible; display: none; opacity: 0.5;"></div><div id="ui-datepicker-div" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-header ui-widget-header ui-helper-clearfix ui-corner-all"><a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="Prev"><span class="ui-icon ui-icon-circle-triangle-w">Prev</span></a><a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="Next"><span class="ui-icon ui-icon-circle-triangle-e">Next</span></a><div class="ui-datepicker-title"><span class="ui-datepicker-month">September</span>&nbsp;<span class="ui-datepicker-year">2025</span></div></div><table class="ui-datepicker-calendar"><thead><tr><th class="ui-datepicker-week-end"><span title="Sunday">Su</span></th><th><span title="Monday">Mo</span></th><th><span title="Tuesday">Tu</span></th><th><span title="Wednesday">We</span></th><th><span title="Thursday">Th</span></th><th><span title="Friday">Fr</span></th><th class="ui-datepicker-week-end"><span title="Saturday">Sa</span></th></tr></thead><tbody><tr><td class=" ui-datepicker-week-end ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td><td class=" ui-datepicker-days-cell-over  ui-datepicker-current-day ui-datepicker-today" data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default ui-state-highlight ui-state-active ui-state-hover" href="#">1</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">2</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">3</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">4</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">5</a></td><td class=" ui-datepicker-week-end " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">6</a></td></tr><tr><td class=" ui-datepicker-week-end " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">7</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">8</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">9</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">10</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">11</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">12</a></td><td class=" ui-datepicker-week-end " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">13</a></td></tr><tr><td class=" ui-datepicker-week-end " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">14</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">15</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">16</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">17</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">18</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">19</a></td><td class=" ui-datepicker-week-end " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">20</a></td></tr><tr><td class=" ui-datepicker-week-end " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">21</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">22</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">23</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">24</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">25</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">26</a></td><td class=" ui-datepicker-week-end " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">27</a></td></tr><tr><td class=" ui-datepicker-week-end " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">28</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">29</a></td><td class=" " data-handler="selectDay" data-event="click" data-month="8" data-year="2025"><a class="ui-state-default" href="#">30</a></td><td class=" ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td><td class=" ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td><td class=" ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td><td class=" ui-datepicker-week-end ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td></tr></tbody></table></div></body>